!function(t){function e(e){for(var i,a,c=e[0],u=e[1],l=e[2],h=e[3]||[],f=0,b=[];f<c.length;f++)a=c[f],Object.prototype.hasOwnProperty.call(r,a)&&r[a]&&b.push(r[a][0]),r[a]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(t[i]=u[i]);for(d&&d(e),s.push.apply(s,h);b.length;)b.shift()();return o.push.apply(o,l||[]),n()}function n(){for(var t,e=0;e<o.length;e++){for(var n=o[e],i=!0,c=1;c<n.length;c++){var l=n[c];0!==r[l]&&(i=!1)}i&&(o.splice(e--,1),t=u(u.s=n[0]))}return 0===o.length&&(s.forEach((function(t){if(void 0===r[t]){r[t]=null;var e=document.createElement("link");u.nc&&e.setAttribute("nonce",u.nc),e.rel="prefetch",e.as="script",e.href=a(t),document.head.appendChild(e)}})),s.length=0),t}!function(){var t;document.currentScript&&(t=document.currentScript.src);var e=function(){if(e.p)return e.p;var n;if(t)n=t.slice(0,t.split("?")[0].lastIndexOf("/")+1);else{var i=window.OfficeFormServerInfo||{},r=JSON.parse(decodeURIComponent(i.webSettings||"{}")).CdnEndPoint;n=i.isCdnEnabled&&r?r+"/scripts/dists/":location.protocol+"//"+location.host+"/Scripts/dists/"}return e.p=n,e.p};e.p=null,window.setPublicPath=e}(),window.replaceChunkSrc=function(t){return window.OfficeFormServerInfo&&window.OfficeFormServerInfo.ring&&!window.OfficeFormServerInfo.isCdnEnabled?t+"?ring="+window.OfficeFormServerInfo.ring:t};var i={},r={3:0},o=[],s=[];function a(t){return u.p+"design-page.chunk."+({0:"file-saver",2:"customervoiceintroduction",4:"insight",5:"intelligence",6:"ir",7:"json_intelligence_scenario_templates",8:"json_intelligence_useractionsignals",9:"json_msa_templates",10:"json_teams_featured_templates",11:"json_templates",12:"json_themes",13:"ls-af-json",14:"ls-am-et-json",15:"ls-ar-json",16:"ls-as-in-json",17:"ls-az-latn-az-json",18:"ls-be-json",19:"ls-bg-json",20:"ls-bn-bd-json",21:"ls-bn-in-json",22:"ls-bs-latn-ba-json",23:"ls-ca-es-valencia-json",24:"ls-ca-json",25:"ls-cs-json",26:"ls-cy-gb-json",27:"ls-da-json",28:"ls-de-json",29:"ls-default-json",30:"ls-el-json",31:"ls-en-gb-json",32:"ls-en-us-json",33:"ls-es-json",34:"ls-es-mx-json",35:"ls-et-json",36:"ls-eu-json",37:"ls-fa-json",38:"ls-fi-json",39:"ls-fil-ph-json",40:"ls-fr-ca-json",41:"ls-fr-json",42:"ls-ga-ie-json",43:"ls-gd-json",44:"ls-gl-json",45:"ls-gu-json",46:"ls-ha-latn-ng-json",47:"ls-he-json",48:"ls-hi-json",49:"ls-hr-json",50:"ls-hu-json",51:"ls-hy-json",52:"ls-id-json",53:"ls-is-json",54:"ls-it-json",55:"ls-ja-json",56:"ls-ka-json",57:"ls-kk-json",58:"ls-km-kh-json",59:"ls-kn-json",60:"ls-ko-json",61:"ls-kok-json",62:"ls-ky-json",63:"ls-lb-lu-json",64:"ls-lo-json",65:"ls-lt-json",66:"ls-lv-json",67:"ls-mi-nz-json",68:"ls-mk-json",69:"ls-ml-json",70:"ls-mn-json",71:"ls-mr-json",72:"ls-ms-json",73:"ls-mt-mt-json",74:"ls-nb-no-json",75:"ls-ne-np-json",76:"ls-nl-json",77:"ls-nn-no-json",78:"ls-or-in-json",79:"ls-pa-json",80:"ls-pl-json",81:"ls-prs-af-json",82:"ls-pt-br-json",83:"ls-pt-pt-json",84:"ls-quz-pe-json",85:"ls-ro-json",86:"ls-ru-json",87:"ls-sd-arab-pk-json",88:"ls-si-lk-json",89:"ls-sk-json",90:"ls-sl-json",91:"ls-sq-json",92:"ls-sr-cyrl-ba-json",93:"ls-sr-cyrl-rs-json",94:"ls-sr-latn-rs-json",95:"ls-sv-json",96:"ls-sw-json",97:"ls-ta-json",98:"ls-te-json",99:"ls-th-json",100:"ls-tk-tm-json",101:"ls-tr-json",102:"ls-tt-json",103:"ls-ug-json",104:"ls-uk-json",105:"ls-ur-json",106:"ls-uz-latn-uz-json",107:"ls-vi-json",108:"ls-zh-cn-json",109:"ls-zh-tw-json",110:"math",111:"phishing",112:"postsubmit",113:"question.datetime",114:"question.fileupload",115:"question.likert",116:"question.nps",117:"question.ranking",118:"question.rating",119:"recyclebin",120:"ribbon_editor",121:"shareform",122:"specificsharing",123:"surveyindividualviewcontainer",124:"surveyindividualviewcontainerv2"}[t]||t)+"."+{0:"c17cf4d",2:"1b5827e",4:"f4ccfa4",5:"adb4fdd",6:"cabdc5a",7:"dc5a5f1",8:"5d441f7",9:"1eb3fcc",10:"6dc479c",11:"757ebdd",12:"ee12e1f",13:"cbd6755",14:"5deb8c6",15:"ec4f7fd",16:"aad2a73",17:"f71c0b0",18:"61979b9",19:"0d0a2af",20:"760da45",21:"ed188a8",22:"f447cec",23:"23a1026",24:"1c1d885",25:"69c6bda",26:"7cde44f",27:"0b102a2",28:"8b70e4b",29:"32c93ce",30:"dbbb905",31:"765224f",32:"c331366",33:"6d97029",34:"0c05dec",35:"61b3b65",36:"e467429",37:"91d0c08",38:"e4bda3a",39:"1250951",40:"fc6c18d",41:"63e686f",42:"b48315c",43:"5c49487",44:"b563345",45:"868b8f3",46:"e18ae44",47:"7b74df1",48:"a4f8698",49:"569216d",50:"e9f4cbd",51:"49d8f00",52:"1473957",53:"8d9c7b3",54:"1e4ea31",55:"c162183",56:"ddb8f27",57:"d116fb5",58:"0594170",59:"71a4a99",60:"a0a0100",61:"5319912",62:"7e7dbe1",63:"c1f700a",64:"6fb8110",65:"02db1a4",66:"c9d71f6",67:"60d8c5a",68:"032e391",69:"70b01ee",70:"f412524",71:"5255ad3",72:"2d2eb30",73:"3d0aeaa",74:"b51faf7",75:"a8df4e5",76:"b73ad41",77:"ef9d289",78:"30f5296",79:"02679b5",80:"bcf0cea",81:"248599c",82:"568d71c",83:"a3a00d2",84:"a819b5a",85:"d8ba30e",86:"a854239",87:"2f637ee",88:"50b6abc",89:"8abe60c",90:"54b1f24",91:"f92b2a5",92:"a2b2c37",93:"afcd4f9",94:"5be4901",95:"a9b4f97",96:"d0bf0ba",97:"711bf77",98:"39cbef4",99:"1a92fe7",100:"b47a5ef",101:"6ab5935",102:"2db1794",103:"e4c5f3f",104:"7ba4206",105:"f5adda8",106:"33a51bb",107:"49e3cfb",108:"776bacd",109:"771a066",110:"8725ed6",111:"b05e3eb",112:"97e7d69",113:"033f519",114:"82ec4d5",115:"7f8ed96",116:"2e3de04",117:"c350e89",118:"31a6057",119:"cd6125b",120:"96fd421",121:"f9b14d1",122:"c75cac2",123:"c61c8b8",124:"db53d11"}[t]+".js"}if("function"==typeof a){var c=a;a=function(){try{if("function"!=typeof replaceChunkSrc)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");var t=replaceChunkSrc(c.apply(this,arguments));if(!t||"string"!=typeof t)throw new Error("WebpackRequireFrom: 'replaceChunkSrc' does not return string. See https://github.com/agoldis/webpack-require-from#troubleshooting");return t}catch(t){return console.error(t),c.apply(this,arguments)}}}function u(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,u),n.l=!0,n.exports}u.e=function(t){var e=[],n=r[t];if(0!==n)if(n)e.push(n[2]);else{var i=new Promise((function(e,i){n=r[t]=[e,i]}));e.push(n[2]=i);var o=new Error;var s=function e(n,i){var s,c=document.createElement("script"),l="&retry-attempt="+(2-i+1);c.charset="utf-8",c.timeout=120,u.nc&&c.setAttribute("nonce",u.nc),c.src=n,s=function(n){c.onerror=c.onload=null,clearTimeout(h);var s=r[t];if(0!==s)if(s)if(0===i){var u=n&&("load"===n.type?"missing":n.type),f=n&&n.target&&n.target.src;o.message="Loading chunk "+t+" failed after 2 retries.\n("+u+": "+f+")",o.name="ChunkLoadError",o.type=u,o.request=f,s[1](o),r[t]=void 0}else{var d="cache-bust=true"+l,b=e(a(t)+"?"+d,i-1);document.head.appendChild(b)}else r[t]=void 0};var h=setTimeout((function(){s({type:"timeout",target:c})}),12e4);return c.onerror=c.onload=s,c}(a(t),2);document.head.appendChild(s)}return Promise.all(e)},u.m=t,u.c=i,u.d=function(t,e,n){u.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},u.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},u.t=function(t,e){if(1&e&&(t=u(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(u.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)u.d(n,i,function(e){return t[e]}.bind(null,i));return n},u.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return u.d(e,"a",e),e},u.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},u.p="",u.oe=function(t){throw console.error(t),t},Object.defineProperty(u,"p",{get:function(){try{if("function"!=typeof setPublicPath)throw new Error("WebpackRequireFrom: 'setPublicPath' is not a function or not available at runtime. See https://github.com/agoldis/webpack-require-from#troubleshooting");return setPublicPath()}catch(t){return console.error(t),""}}});var l=window.webpackJsonp=window.webpackJsonp||[],h=l.push.bind(l);l.push=e,l=l.slice();for(var f=0;f<l.length;f++)e(l[f]);var d=h,b=(o.push([268,1]),n());e([[],{},0,[112,123,124]])}([function(t,e){t.exports=React},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"d",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"c",(function(){return b})),n.d(e,"b",(function(){return m}));var i,r,o,s=n(28),a=n(15),c=n(112),u={};function l(){return o}function h(t){o=t}function f(){return i||(i=new Promise((function(t,e){o?t(o):r?r.then((function(e){h(e),t(e)})).catch((function(){Object(c.b)().then((function(e){h(e),t(e)})).catch(e)})):Object(c.b)().then((function(e){h(e),t(e)})).catch(e)}))),i}function d(t){r=t}function b(t){var e=u[t];return e||(u[t]=new Promise((function(e,n){m(t).then(e,(function(){Object(c.a)(t).then(e).catch((function(){f().then(e,n)}))}))})),e=u[t]),e}function m(t){try{t=t||Object(a.i)().toLowerCase();var e=s.a.Resolve("ILazyLoadResourceStringsFunc");return e(t).catch((function(){var n=null==t?void 0:t.split("-")[0];return t!==n?e(n).catch((function(){return e(void 0)})):e(void 0)})).then((function(t){return t}))}catch(t){return Promise.reject(t)}}},function(t,e,n){"use strict";n.r(e),n.d(e,"__extends",(function(){return r})),n.d(e,"__assign",(function(){return o})),n.d(e,"__rest",(function(){return s})),n.d(e,"__decorate",(function(){return a})),n.d(e,"__param",(function(){return c})),n.d(e,"__metadata",(function(){return u})),n.d(e,"__awaiter",(function(){return l})),n.d(e,"__generator",(function(){return h})),n.d(e,"__exportStar",(function(){return f})),n.d(e,"__values",(function(){return d})),n.d(e,"__read",(function(){return b})),n.d(e,"__spread",(function(){return m})),n.d(e,"__spreadArrays",(function(){return v})),n.d(e,"__await",(function(){return g})),n.d(e,"__asyncGenerator",(function(){return O})),n.d(e,"__asyncDelegator",(function(){return p})),n.d(e,"__asyncValues",(function(){return j})),n.d(e,"__makeTemplateObject",(function(){return y})),n.d(e,"__importStar",(function(){return w})),n.d(e,"__importDefault",(function(){return S})),n.d(e,"__classPrivateFieldGet",(function(){return N})),n.d(e,"__classPrivateFieldSet",(function(){return I}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */
var i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])})(t,e)};function r(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var o=function(){return(o=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var r in e=arguments[n])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function s(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}function a(t,e,n,i){var r,o=arguments.length,s=o<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(r=t[a])&&(s=(o<3?r(s):o>3?r(e,n,s):r(e,n))||s);return o>3&&s&&Object.defineProperty(e,n,s),s}function c(t,e){return function(n,i){e(n,i,t)}}function u(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)}function l(t,e,n,i){return new(n||(n=Promise))((function(r,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}function h(t,e){var n,i,r,o,s={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(r=2&o[0]?i.return:o[0]?i.throw||((r=i.return)&&r.call(i),0):i.next)&&!(r=r.call(i,o[1])).done)return r;switch(i=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,i=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!(r=s.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){s.label=o[1];break}if(6===o[0]&&s.label<r[1]){s.label=r[1],r=o;break}if(r&&s.label<r[2]){s.label=r[2],s.ops.push(o);break}r[2]&&s.ops.pop(),s.trys.pop();continue}o=e.call(t,s)}catch(t){o=[6,t],i=0}finally{n=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,a])}}}function f(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function d(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function b(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var i,r,o=n.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){r={error:t}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(r)throw r.error}}return s}function m(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(b(arguments[e]));return t}function v(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var i=Array(t),r=0;for(e=0;e<n;e++)for(var o=arguments[e],s=0,a=o.length;s<a;s++,r++)i[r]=o[s];return i}function g(t){return this instanceof g?(this.v=t,this):new g(t)}function O(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,r=n.apply(t,e||[]),o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(t){r[t]&&(i[t]=function(e){return new Promise((function(n,i){o.push([t,e,n,i])>1||a(t,e)}))})}function a(t,e){try{(n=r[t](e)).value instanceof g?Promise.resolve(n.value.v).then(c,u):l(o[0][2],n)}catch(t){l(o[0][3],t)}var n}function c(t){a("next",t)}function u(t){a("throw",t)}function l(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function p(t){var e,n;return e={},i("next"),i("throw",(function(t){throw t})),i("return"),e[Symbol.iterator]=function(){return this},e;function i(i,r){e[i]=t[i]?function(e){return(n=!n)?{value:g(t[i](e)),done:"return"===i}:r?r(e):e}:r}}function j(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=d(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(i,r){(function(t,e,n,i){Promise.resolve(i).then((function(e){t({value:e,done:n})}),e)})(i,r,(e=t[n](e)).done,e.value)}))}}}function y(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function w(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function S(t){return t&&t.__esModule?t:{default:t}}function N(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}function I(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}},function(t,e){t.exports=_},,function(t,e,n){"use strict";n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"f",(function(){return b})),n.d(e,"g",(function(){return m})),n.d(e,"a",(function(){return v}));var i=n(15),r=n(12),o=n(145),s=n(28),a=n(245);function c(t,e,n,i,r){d("UnhandleException",{columnNo:i,error:r&&r.toString(),fileName:e,lineNo:n,message:t,stack:r&&r.stack})}var u=[];function l(t){v().logFormsProEvent(t)}function h(t){v().logForTeamsTab(t)}function f(t,e,n,s){void 0===s&&(s=!1),v().logData({correlationId:n,eventName:t,eventType:"engagement_event",extraData:e},s),Object(r.c)("LogUserActionSignals")&&"Design"===Object(i.m)()&&(0===u.length&&Object(o.d)().then((function(t){u=t})),t&&u.indexOf(t)>=0&&Object(a.a)(t,6,4))}function d(t,e,n){void 0===n&&(n=!1),v().logData({eventName:t,eventType:"error_event",extraData:e},n)}function b(t,e){v().logData({eventName:t,eventType:"nav_perf_event",extraData:e},!1)}function m(t){v().logData({eventName:"session_start",eventType:"session_start",extraData:t},!1)}function v(){return s.a.Resolve("ILogger")}var g=window.onerror;window.onerror=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];c.apply(void 0,t),g&&g.apply(this,t)}},,function(t,e,n){"use strict";function i(){return window.OfficeFormServerInfo}function r(t){window.OfficeFormServerInfo=t}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(20),s=function(t){function e(e){var n,i,r=t.call(this,e)||this;return r.state={},i=n=r,a.forEach((function(t){var e=i[t];e&&(i[t]=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];try{return e.apply(n,i)}catch(e){return c(n,t,e),null}})})),r}return Object(i.__extends)(e,t),e.prototype.getHtmlElement=function(){return o.findDOMNode(this)},e}(r.Component),a=["componentWillMount","componentDidMount","componentWillReceiveProps","shouldComponentUpdate","componentWillUpdate","componentDidUpdate","componentWillUnmount","render"];function c(t,e,n){try{if(window.onerror){var i="React error in "+t.constructor.name+"."+e;n&&n.message&&(i+=": "+n.message),window.onerror(i,"",0,0,n)}}catch(n){}}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"j",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"k",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"i",(function(){return d})),n.d(e,"a",(function(){return b}));var i=n(82);function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t.map((function(t){return t&&t.trim()})).filter((function(t){return!!t})).join(" ");return n||t.some((function(t){return""===t}))||(n=void 0),n}function o(t,e,n,i,r){i=i||0,n=n||0;var o=e.height(),s=t.outerHeight();if(t.offset()&&e.offset()){var a=t.offset().top-e.offset().top;if(a<0)e.scrollTop(e.scrollTop()+a-(s+n>o?0:n));else{var c=Math.min(s,o),u=a+c-o;s+n+i<o?u=a+(c=s+i)-o:s+n<o&&(c=s+n,u=a-n),u>0&&(r?e.animate({scrollTop:e.scrollTop()+u},"fast"):e.scrollTop(e.scrollTop()+u))}}}function s(t,e){void 0===e&&(e=!0);var n=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"&quot;");return e&&(n=n.replace(/'/g,"&apos;")),n}function a(t,e){var n=Object(i.d)({},t);for(var o in e)switch(o){case"className":case"aria-labelledby":case"aria-describedby":n[o]=r(n[o],e[o]);break;case"children":case"defaultValue":case"value":e.hasOwnProperty(o)&&(null!=n[o]?n[o]=[].concat(n[o],e[o]):n[o]=e[o]);break;case"style":null!=n[o]?Object(i.d)(n[o],e[o]):n[o]=e[o];break;case"onCopy":case"onCut":case"onPaste":case"onCompositionEnd":case"onCompositionStart":case"onCompositionUpdate":case"onFocus":case"onBlur":case"onChange":case"onInput":case"onSubmit":case"onLoad":case"onError":case"onKeyDown":case"onKeyPress":case"onKeyUp":case"onAbort":case"onCanPlay":case"onCanPlayThrough":case"onDurationChange":case"onEmptied":case"onEncrypted":case"onEnded":case"onLoadedData":case"onLoadedMetadata":case"onLoadStart":case"onPause":case"onPlay":case"onPlaying":case"onProgress":case"onRateChange":case"onSeeked":case"onSeeking":case"onStalled":case"onSuspend":case"onTimeUpdate":case"onVolumeChange":case"onWaiting":case"onClick":case"onContextMenu":case"onDoubleClick":case"onDrag":case"onDragEnd":case"onDragEnter":case"onDragExit":case"onDragLeave":case"onDragOver":case"onDragStart":case"onDrop":case"onMouseDown":case"onMouseEnter":case"onMouseLeave":case"onMouseMove":case"onMouseOut":case"onMouseOver":case"onMouseUp":case"onSelect":case"onTouchCancel":case"onTouchEnd":case"onTouchMove":case"onTouchStart":case"onScroll":case"onWheel":n[o]=c(n[o],e[o]);break;default:void 0!==e[o]&&(n[o]=e[o])}return n}function c(t,e){return function(n){t&&t(n),e&&e(n)}}function u(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(n){(0===e.length||e.indexOf(n.keyCode)>=0)&&t(n)}}function l(t){var e=t.nativeEvent.explicitOriginalTarget;return t.relatedTarget||e||document.activeElement}function h(){return window.innerWidth}function f(t){var e="hiddeon-open-iframe",n=document.getElementById(e);n&&n.parentNode.removeChild(n),(n=document.createElement("iframe")).id=e,n.name=e,n.hidden=!0,document.body.appendChild(n),n.contentWindow.location.href=t}function d(t){return function(t){var e=document.createElement("span");return e.innerHTML=t,t=e.innerHTML}(function(t){var e=["b"],n=e.map((function(t){return"<"+t+">"})),r=e.map((function(t){return"</"+t+">"})),o=e.map((function(t){return"&lt;"+t+"&gt;"})),s=e.map((function(t){return"&lt;/"+t+"&gt;"})),a=Object(i.c)(t);return e.forEach((function(t,e){a=a.replaceAll(o[e],n[e]).replaceAll(s[e],r[e])})),a}(t))}function b(t,e){var n=document.createElement("script");n.type="text/javascript",n.src=t,n.onload=e,document.head.appendChild(n)}},function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"a",(function(){return h}));var i,r=n(12),o=n(7);function s(t,e){return t()}function a(t){return t()}function c(){}function u(){return void 0===i&&(i=!!Object(o.a)().proEnabled&&Object(r.c)("FormsPro")),i}function l(){throw new Error("unreachable code")}FormsPro.initializeStyleBasis=c;var h={}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"f",(function(){return o})),n.d(e,"i",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"g",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"h",(function(){return h})),n.d(e,"c",(function(){return f}));var i=n(28);function r(){return i.a.Resolve("IMixin").getMixinFormMaster()}function o(){return i.a.Resolve("IMixin").getMixinImageInfoMaster()}function s(){return i.a.Resolve("IMixin").getMixinQuestionMaster()}function a(){return i.a.Resolve("IFormApiMixin").getMixinFormApi()}function c(){return i.a.Resolve("IMixin").getMixinFormElementManager()}function u(){return i.a.Resolve("IMixin").getMixinImageSettingsMaster()}function l(){return i.a.Resolve("IMixin").getMixinDesignPageUxStateMaster().getInstance()}function h(){return i.a.Resolve("IMixin").getMobileDesignPageUxStateMaster().getInstance()}function f(){return i.a.Resolve("IMixin").getFileUploadConfirmDialog()}},function(t,e,n){"use strict";var i;n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"g",(function(){return f})),n.d(e,"e",(function(){return b})),function(t){t[t.ResponsePage=1]="ResponsePage",t[t.TeamsResponsePage=2]="TeamsResponsePage",t[t.AssignmentResponsePage=4]="AssignmentResponsePage"}(i||(i={}));var r,o=n(33),s=n(7);function a(){return d(i.ResponsePage)&&!b()}function c(){return d(i.ResponsePage|i.TeamsResponsePage|i.AssignmentResponsePage)&&h("DelayLoadThirdPartyJs")}function u(){return d(i.ResponsePage)&&!b()}function l(){return a()&&h("ShuffleSupportForIncLoadForms")}function h(t){return Object(o.a)().Flighting.isEnabled(t)}function f(){return b()||h("TextFormat")}function d(t){return 0!=(r&t)}function b(){return!!Object(s.a)().proEnabled&&h("FormsPro")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return H}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(12),c=n(7),u=n(99),l=n(11),h=n(44),f=n(14),d=(n(10),n(5)),b=n(30),m=n(15),v=n(88),g=n(25),O=n(31),p=function(){function t(t,e){if(this.O=t,this.N=Object(O.i)(t),this.N){var n=this.N.getDesignForm;switch(this.O.SyncContext){case g.a.SharedTimeForm:n=this.N.getSharedForm;break;case g.a.ResponseTimeForm:n=this.N.getRuntimeForm;break;case g.a.AnalysisTimeForm:n=this.N.getAnalysisTimeForm;break;case g.a.ResponseDetailTimeForm:n=this.N.getResponseDetailRuntimeForm;break;case g.a.AdminPhishingReviewForm:n=this.N.getAdminPhishingReviewForm}this.T=n.bind(this.N)}}var e=t.prototype;return e.add=function(t){return this.O.SyncContext===g.a.LocalForm?new Promise((function(){})):this.O.SyncContext===g.a.DesignTimeForm?this.N.createForm(t):void Object(b.b)("Trying to create a form without design type.")},e.delete=function(t){if(this.O.SyncContext===g.a.DesignTimeForm)return this.P(),this.N.deleteForm(this.O.Model.Id);Object(b.b)("Trying to delete a form without design type.")},e.query=function(t){if(!this.T){return Promise.reject({innerCode:1001,type:"ExpectedFailure"})}var e=o.a.getFieldSchemaInfo(this.O.Schema.LocalizedResources).Attributes.SourceFieldName,n=t.filter((function(t){return t!==e})),s=[];return s.push(this.T(this.O.Model.Id,n)),r.find(t,(function(t){return t===e}))&&!Object(m.u)()&&s.push(this.O.getAllLocaleResources()),Promise.all(s).then((function(t){return r.extend.apply(r,Object(i.__spreadArrays)([{}],t))}))},e.update=function(t){if(this.O.SyncContext===g.a.LocalForm)return new Promise((function(){}));if(this.O.SyncContext!==g.a.DesignTimeForm)return Promise.resolve();var e=o.a.getFieldSchemaInfo(H.Schema.SoftDeleted).Attributes.SourceFieldName;if(e in t)t[e]===v.a.SoftDeleted&&this.P();else if(this.O.isFieldReady(H.Schema.SoftDeleted)&&this.O.Model.SoftDeleted===v.a.SoftDeleted)return Promise.resolve();return this.N.updateForm(this.O.Model.Id,t)},e.P=function(){var t=this;return this.N.removeRecentForm(this.O.Model.Id).then((function(){var e=Forms.Mru.MruDocumentCollectionMaster.getInstance();e&&e.removeDocument(t.O.Model.Id)}))},t}(),j=n(134),y=n(113),w=n(58),S=n(137),N=n(22),I=n(45),C=n(66),k=function(){function t(t){this.L=t,this.N=Object(O.i)(this.L.Form)}var e=t.prototype;return e.add=function(t){if(!t.localeId||!t.localeName||this.L.Form.SyncContext!==g.a.DesignTimeForm)return Promise.resolve();var e={elementKey:"localename",elementValue:t.localeName,locale:t.localeId,questionId:""};return this.N.createLocaleItem(this.L.FormId,e)},e.delete=function(t){return t.localeId&&this.L.Form.SyncContext===g.a.DesignTimeForm?this.N.deleteLocale(this.L.FormId,t.localeId):Promise.resolve()},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||!t.localeName||this.L.Form.SyncContext!==g.a.DesignTimeForm)return Promise.resolve();var n=null!==e.ValuesBefore.localeName,i={elementKey:"localename",elementValue:t.localeName,locale:this.L.Model.localeId,questionId:null};return n?this.N.updateLocaleItem(this.L.FormId,i):this.N.createLocaleItem(this.L.FormId,i)},t}(),T={localeId:s.a.string({IsKeyField:!0}),localeName:s.a.string()},x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("LocaleInfoMaster",T,(function(t){return new k(t)}))),F=n(80),P=n(166),D=n(205),M=n(182),L=n(164),A=n(103),R=n(95),E=n(188),B=n(239),_={Id:s.a.string({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),Description:s.a.string({SourceFieldName:"description"}),Background:s.a.fromMasterClass(l.f,{SourceFieldName:"background"}),Category:s.a.string({SourceFieldName:"category"}),Logo:s.a.fromMasterClass(l.f,{SourceFieldName:"logo"}),MeetingId:s.a.string({SourceFieldName:"meetingId"}),ModifiedDate:s.a.string({SourceFieldName:"modifiedDate"}),CreatedDate:s.a.string({SourceFieldName:"createdDate"}),OtherInfo:s.a.string({SourceFieldName:"otherInfo"}),OwnerId:s.a.string({SourceFieldName:"ownerId"}),OwnerTenantId:s.a.string({SourceFieldName:"ownerTenantId"}),OwnerUserType:s.a.string({SourceFieldName:"ownerUserType"}),RowCount:s.a.number({SourceFieldName:"rowCount"}),SharedBy:s.a.string({SourceFieldName:"sharedBy"}),SharedFormOwnerName:s.a.string({SourceFieldName:"ownerDisplayName"}),SharedDate:s.a.string({SourceFieldName:"dateTimeShared"}),TableId:s.a.string({IsSourceGenerated:!0,SourceFieldName:"tableId"}),TenantSwitches:s.a.number({SourceFieldName:"tenantSwitches"}),PrivacyUrl:s.a.string({SourceFieldName:"privacyUrl"}),Title:s.a.string({SourceFieldName:"title"}),Version:s.a.string({SourceFieldName:"version"}),XlWorkbookId:s.a.string({SourceFieldName:"xlWorkbookId"}),XlExportingTag:s.a.string({SourceFieldName:"xlExportingTag"}),XlFileUnsynced:s.a.boolean({SourceFieldName:"xlFileUnSynced"}),XlUnsyncedReason:s.a.string({SourceFieldName:"xlUnsyncedReason"}),Permissions:s.a.collectionOf((function(){return P.a}),{SourceFieldName:"permissions"}),ResponderPermissions:s.a.collectionOf((function(){return M.a}),{SourceFieldName:"responderPermissions"}),PermissionTokens:s.a.collectionOf((function(){return D.a}),{SourceFieldName:"permissionTokens"}),Questions:s.a.collectionOf(l.i,{SourceFieldName:"questions"}),DescriptiveElements:s.a.collectionOf((function(){return w.a}),{SourceFieldName:"descriptiveQuestions"}),MovingToRecycleBin:s.a.boolean({IsLocalField:!0}),FormsInsightsInfo:s.a.string({SourceFieldName:"formsInsightsInfo"}),SoftDeleted:s.a.enumeration((function(){return v.a}),{SourceFieldName:"softDeleted",IsNumberTypeInDataSource:!0}),BusinessCdsId:s.a.string({SourceFieldName:"BusinessCdsId"}),BusinessCdsRegion:s.a.string({SourceFieldName:"BusinessCdsRegion"}),IsDefaultCds:s.a.string({SourceFieldName:"IsDefaultCds"}),LastEmbedConfig:s.a.string({SourceFieldName:"LastEmbedConfig"}),FormsProBranchRules:s.a.string({SourceFieldName:"FormsProBranchRules"}),MfpBranchingData:s.a.string({SourceFieldName:"mfpBranchingData"}),PipesDetails:s.a.string({SourceFieldName:"formsProConfiguredPipes"}),FormsProRTTitle:s.a.string({SourceFieldName:"formsProRTTitle"}),FormsProRTDescription:s.a.string({SourceFieldName:"formsProRTDescription"}),ResponseThresholdCount:s.a.string({SourceFieldName:"responseThresholdCount"}),InviteExpiryDays:s.a.string({SourceFieldName:"inviteExpiryDays"}),FormsProEmbedCode:s.a.string({SourceFieldName:"formsProEmbedCode"}),FormsProAnswerTagMap:s.a.collectionOf({name:s.a.string(),value:s.a.string(),questionId:s.a.string()},{IsLocalField:!0}),FormsProAnswerTagMapRT:s.a.collectionOf({name:s.a.string(),value:s.a.string()},{IsLocalField:!0}),FooterText:s.a.string({SourceFieldName:"footerText"}),CustomCssFileName:s.a.string({SourceFieldName:"customCssFileName"}),CustomDomainSenderEmail:s.a.string({SourceFieldName:"customDomainSenderEmail"}),ProjectId:s.a.string({SourceFieldName:"projectId"}),InitialFormId:s.a.string({SourceFieldName:"initialFormId"}),InitialFormOwnerId:s.a.string({SourceFieldName:"initialFormOwnerId"}),SurveyFont:s.a.string({SourceFieldName:"surveyFont"}),HeaderFont:s.a.string({SourceFieldName:"headerFont"}),Alias:s.a.string({SourceFieldName:"alias"}),ShortUrl:s.a.string({SourceFieldName:"shortUrl"}),ProjectName:s.a.string({SourceFieldName:"projectName"}),ProjectGroupId:s.a.string({SourceFieldName:"projectGroupId"}),FileUploadStorage:s.a.string({SourceFieldName:"fileUploadStorage"}),SurveyPermanentId:s.a.string({SourceFieldName:"surveyPermanentId"}),EmailTemplatesMapping:s.a.string({SourceFieldName:"emailTemplatesMapping"}),InvitesCoolingPeriod:s.a.number({SourceFieldName:"invitesCoolingPeriod"}),OverSurveySettingEnabled:s.a.boolean({SourceFieldName:"overSurveySettingEnabled"}),TrackingId:s.a.string({SourceFieldName:"trackingId"}),ThankYouMessage:s.a.string({SourceFieldName:"thankYouMessage"}),EmailReceiptEnabled:s.a.boolean({SourceFieldName:"emailReceiptEnabled"}),Flags:s.a.number({SourceFieldName:"flags"}),Type:s.a.reference({SourceFieldName:"type"}),ReputationTier:s.a.number({SourceFieldName:"reputationTier"}),BufferResponses:s.a.collectionOf(s.a.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),CoAuthors:s.a.collectionOf(s.a.reference(),{IsLocalField:!0}),DeleteCollaborationPermission:s.a.boolean({IsLocalField:!0}),LastSyncTime:s.a.number({IsLocalField:!0}),RtcStatus:s.a.number({IsLocalField:!0}),HasValidBranching:s.a.boolean({IsLocalField:!0}),HasQuestionMedia:s.a.boolean({IsLocalField:!0}),Created:s.a.string({IsLocalField:!0}),Modified:s.a.string({IsLocalField:!0}),PredefinedResponses:s.a.collectionOf({Id:s.a.number({IsKeyField:!0}),Answers:s.a.collectionOf({QuestionId:s.a.string(),Answer:s.a.reference()})},{IsLocalField:!0}),PrimaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),QuizQuestionsCount:s.a.number({IsLocalField:!0}),SecondaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),Responses:s.a.collectionOf(s.a.reference({},(function(t){return t.Id.toString()})),{IsLocalField:!0}),ResponsesCount:s.a.number({IsLocalField:!0}),XlExportingLocalTag:s.a.string({IsLocalField:!0}),SerializedSettings:s.a.string({SourceFieldName:"settings"}),Settings:s.a.fromMasterClass((function(){return E.a}),{IsLocalField:!0}),SerializedPredefinedResponses:s.a.string({SourceFieldName:"predefinedResponses"}),TertiaryCustomizedThemeColor:s.a.string({IsLocalField:!0}),Theme:s.a.fromMasterClass((function(){return B.a}),{IsLocalField:!0}),ResponseModels:s.a.collectionOf((function(){return L.a}),{IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0}),LogoInfo:s.a.fromMasterClass(l.g,{IsLocalField:!0}),CreatedFromOneDrive:s.a.boolean({IsLocalField:!0}),TemplateId:s.a.string({IsLocalField:!0}),TransferInProgress:s.a.boolean({IsLocalField:!0}),DataClassificationLabel:s.a.string(),DefaultLanguage:s.a.string({SourceFieldName:"defaultLanguage"}),LocaleList:s.a.collectionOf((function(){return x}),{SourceFieldName:"localeList"}),LocalizedResources:s.a.collectionOf((function(){return C.a}),{SourceFieldName:"localizedResources"}),CreatedBy:s.a.string({SourceFieldName:"createdBy"}),FileUploadFormInfo:s.a.create({errorCode:s.a.string()},{SourceFieldName:"fileUploadFormInfo"}),ProgressBarEnabled:s.a.string({SourceFieldName:"progressBarEnabled"}),YouTubeMessageBarState:s.a.enumeration((function(){return A.a}),{IsLocalField:!0}),QuizPreviousResponsesCount:s.a.number({IsLocalField:!0}),NotifiedAdminForApproval:s.a.boolean({IsLocalField:!0})},H=function(t){function e(n,i,r,o,s,a){void 0===o&&(o=!1);var c=this,u=new h.a;i=Object(R.h)(i),(c=t.call(this,i,{Scheduler:new y.a(e.name),MasterReady:u.promise()})||this).initializing=u,c.syncBlocker=s?new h.c(s):c.initializing,c.isGroupForm=r,c._=o,c.U=n,c.$=a;var f=Object(l.e)();return c.formElementManager=new f(c),c.W(i),c.J(i),c.X(i),e.Rules.forEach((function(t){return c.addRule(t)})),c.Z(),c}Object(i.__extends)(e,t);var n=e.prototype;return n.getSyncBlocker=function(){return this.syncBlocker},Object.defineProperty(n,"IsGroupForm",{get:function(){return this.isGroupForm},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsSampleForm",{get:function(){return this._},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsAssignmentForm",{get:function(){return!!this.isFieldReady(this.Schema.Category)&&"assignments"===this.Model.Category},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SyncContext",{get:function(){return this.U},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormElementManager",{get:function(){return this.formElementManager},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SettingMaster",{get:function(){return o.a.getObjectMasterFromModel(this.Model.Settings)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ThemeMaster",{get:function(){return o.a.getObjectMasterFromModel(this.Model.Theme)},enumerable:!1,configurable:!0}),n.getRelatedSourceFields=function(t){return Object(R.g)(t)},n.getImageMaster=function(t){return Object(N.e)(this.getModelByFieldSchema(t))},n.getImageSettingsMaster=function(t){return Object(I.e)(this.getModelByFieldSchema(t))},n.getQuestionById=function(t){return this.formElementManager.getQuestionById(t)},n.getElementById=function(t){return this.formElementManager.getElementMasterById(t)},n.getReleasedResponsesByResponder=function(t){var e=this;return t&&!this.SettingMaster.Model.IsAnonymous?Object(j.c)(this,t).then((function(t){return Object(a.d)()?e.$.normalizeResponses(t):e.normalizeResponses(t)})):Promise.resolve(null)},n.getRuntimeResponse=function(t){var e=this;return t?Object(j.e)(this,t).then((function(t){return e.Y(t)})):Promise.resolve(null)},n.ensureReadyToResponse=function(){return this.ensureFieldsReady(Object(R.d)())},n.ensureReadyToShare=function(){return this.ensureFieldsReady(Object(R.e)())},n.getDefaultResponse=function(){var t={};return Object(u.a)()&&r.forEach(this.Model.Questions,(function(e){return t[e.Id]=e.DefaultValue})),t},n.hasSection=function(){return this.FormElementManager.SectionMasters.length>0},n.syncRuntimeResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return Object(j.f)(t)})).then((function(e){t.updatingResponsesFromServer=!0,t.bulkEdit((function(){return t.Model.Responses=t.normalizeResponses(e)})),t.updatingResponsesFromServer=!1}))},n.submitResponse=function(t){var e=this;if(this.syncBlocker.states()===h.b.Pending)return Promise.resolve(void 0);var n=0,i=0,o=!1;return(t=r.clone(t)).Answers=r.map(t.Answers,(function(t){var s=e.getQuestionById(t.QuestionId);return s&&s.Model&&((t=r.clone(t)).Answer=s.serializeAnswer(t.Answer),"Question.TextField"===s.Model.Type&&(n++,t.Answer&&(i+=t.Answer.length),!o&&s.Model.IsMathQuiz&&(o=!0))),t})),o&&this.nt(t),Object(d.b)("ResponsePage.Form.TextQuestionInfoOfSubmit",{textQuestionCount:n,textQuestionAnswerTotalLength:i,isQuiz:this.SettingMaster.Model.IsQuizMode}),new Promise((function(n){e.Synchronizer.existingInDataSource().then((function(){return n(Object(j.g)(e,t))}))}))},n.getSnapshotToCopy=function(){var t=this.getSnapshot(Object(R.b)()),e=null;return t.XlWorkbookId&&((e=r.clone(t)).XlWorkbookId="WaitingForExport"),this.Model.OwnerTenantId!==Object(c.a)().userInfo.TenantId&&t.DataClassificationLabel&&(e||(e=r.clone(t)),e.DataClassificationLabel=null),null===e?t:e},n.getLocaleResouceById=function(t){return Object(O.h)(this.Model.Id).getLocaleResource(this.Model.Id,t).then((function(t){return Object(F.g)(t)}))},n.totalSectionCount=function(){return this.formElementManager.SectionMasters.length+(this.formElementManager.HeaderTopQuestionMasters.length>0?1:0)},n.ensureFieldsReady=function(e){return t.prototype.ensureFieldsReady.call(this,e)},n.J=function(t){t.ExistingInDataSource?this.isFieldReady(e.Schema.ModifiedDate)&&(this.Model.Modified=this.Model.ModifiedDate):this.Model.Modified=(new Date).toISOString()},n.X=function(t){t.ExistingInDataSource?this.isFieldReady(e.Schema.CreatedDate)&&(this.Model.Created=this.Model.CreatedDate):this.Model.Created=(new Date).toISOString()},n.W=function(t){this.rt=new S.a(this,e.Schema.OtherInfo,Object(R.f)()),t.InitialData&&this.isFieldReady(e.Schema.OtherInfo)&&(t.ExistingInDataSource||t.InitialData.OtherInfo?this.rt.deserialize():this.rt.serialize())},n.normalizeResponses=function(t){var e=this;return this.bulkEdit((function(){t=t.map((function(t){return e.Y(t)}))})),t},n.Y=function(t){var e=this.Model.Settings.IsQuizMode&&this.SyncContext!==g.a.ResponseTimeForm,n={};this.FormElementManager.QuestionMasters.forEach((function(t){return n[t.Model.Id]=t})),(t=r.clone(t)).Answers=r.map(t.Answers,(function(t){var i=n[t.QuestionId];return i?((t=r.clone(t)).Answer=i.deserializeAnswer(t.Answer),t.IsMathAnswer=!i.Model.IsAnswerPlainText,null==t.Score&&e&&i.autoGradeAnswer(t),t):null})).filter((function(t){return!!t}));var i=this.getResponseModelById(t.Id);return i&&(Object(L.c)(i).updateWithNormalizedResponse(t),t=i),t},n.getResponseModelById=function(t){return o.a.Collection.getItemWithKeyFields(this.Model.ResponseModels,{Id:t})},n.nt=function(t){var e=this,n={QuestionCount:0,GradableQuestionCount:0,MathResponses:0,MathGradableResponses:0,TextResponses:0,TextGradableResponses:0,EmptyResponses:0,TotalLength:0};r.forEach(t.Answers,(function(t){var i=e.getQuestionById(t.QuestionId);if(i&&i.Model&&"Question.TextField"===i.Model.Type&&i.Model.IsMathQuiz){i.hasCorrectAnswers()?n.GradableQuestionCount++:n.QuestionCount++;var r=Object(f.G)(t.Answer);null!=r&&r.Answer?(n.TotalLength+=r.Answer.length,i.hasCorrectAnswers()?r.IsMath?n.MathGradableResponses++:n.TextGradableResponses++:r.IsMath?n.MathResponses++:n.TextResponses++):n.EmptyResponses++}})),Object(d.b)("ResponsePage.Form.TextFieldSubmissionMathInfo",n)},n.Z=function(){var t=this;this.formElementManager.adjustElementOrders();var n=[e.Schema.Questions,e.Schema.DescriptiveElements],i=this.$;this.addRule({Name:"ElementOrder",InterestedFields:n,onChange:function(){i&&!i.isFormLoadingComplete()||t.formElementManager.adjustElementOrders()}})},Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{Name:"DeserializeSettings",InterestedFields:[t.SerializedSettings],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model.SerializedSettings||"{}",n=JSON.parse(e);t.Master.setData({Settings:n})}}},{Name:"DeserializePredefinedResponses",InterestedFields:[t.SerializedPredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model.SerializedPredefinedResponses||"[]",n=JSON.parse(e);t.Master.setData({PredefinedResponses:n})}}},{Name:"QuestionMediaProperties",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var e=t.Master.Model,n=o.a.convertToArray(t.Master.getSnapshot().Questions),i=o.a.convertToArray(t.Master.getSnapshot().DescriptiveElements);e.HasQuestionMedia=n.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))||i.some((function(t){return!(!t.ImageInfo.ResourceUrl&&!t.VideoInfo.Url)}))}},{Name:"QuestionBranchValidity",InterestedFields:[t.Questions,t.DescriptiveElements],onChange:function(t){var n=t.Master.Model,i=!1;t.Master.isFieldReady(e.Schema.Questions)&&(i=o.a.convertToArray(t.Master.Model.Questions).some((function(t){return o.a.getObjectMasterFromModel(t).hasValidBranching()})));var r=!1;t.Master.isFieldReady(e.Schema.DescriptiveElements)&&(r=o.a.convertToArray(t.Master.Model.DescriptiveElements).some((function(t){return t.BranchInfo&&o.a.getObjectMasterFromModel(t.BranchInfo).isValid()})));n.HasValidBranching=i||r;var s=o.a.convertToArray(t.Master.getSnapshot().Questions);n.QuizQuestionsCount=s.filter((function(t){return t.IsQuiz})).length}}]}return e.rules},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("FormMaster",_,(function(t,e){return t.getSyncBlocker().promise().then((function(){return new p(t,e)}))})));FormsPro.FormMaster=H},function(t,e,n){"use strict";n.d(e,"b",(function(){return d})),n.d(e,"i",(function(){return b})),n.d(e,"v",(function(){return m})),n.d(e,"w",(function(){return v})),n.d(e,"x",(function(){return g})),n.d(e,"f",(function(){return O})),n.d(e,"a",(function(){return p})),n.d(e,"B",(function(){return j})),n.d(e,"o",(function(){return y})),n.d(e,"m",(function(){return w})),n.d(e,"n",(function(){return S})),n.d(e,"r",(function(){return N})),n.d(e,"t",(function(){return I})),n.d(e,"s",(function(){return C})),n.d(e,"A",(function(){return k})),n.d(e,"p",(function(){return T})),n.d(e,"z",(function(){return x})),n.d(e,"l",(function(){return F})),n.d(e,"C",(function(){return P})),n.d(e,"q",(function(){return D})),n.d(e,"D",(function(){return M})),n.d(e,"d",(function(){return L})),n.d(e,"G",(function(){return A})),n.d(e,"g",(function(){return R})),n.d(e,"F",(function(){return E})),n.d(e,"h",(function(){return B})),n.d(e,"k",(function(){return _})),n.d(e,"y",(function(){return H})),n.d(e,"E",(function(){return G})),n.d(e,"e",(function(){return q})),n.d(e,"c",(function(){return Q})),n.d(e,"u",(function(){return V})),n.d(e,"j",(function(){return U}));var i=n(23),r=n(37),o=n(5),s=n(41),a=n(15),c=n(12),u=n(7),l=n(9),h=n(36),f=n(82);function d(t,e){if(!t&&!Object(s.f)()&&!Object(s.e)()){var n=(new Error).stack;console.assert(t,e,n)}}function b(){return Object(f.h)(Object(h.d)(),"embed","oembedsso","themecolor","preview")}function m(){return!!Object(h.d)().embed}function v(){return Object(u.a)().isOembedSPO}function g(){return!!Object(h.d)().oembedsso&&!!Object(h.d)().preview}function O(){return!(!Object(i.k)()&&!p())}function p(){return!(!Object(i.q)()||!Object(s.f)()||"Analyze"===Object(a.m)())}function j(){return!Object(r.j)()&&!Object(a.w)()}function y(){var t=navigator.userAgent.toLowerCase();return-1!==t.indexOf("msie")||-1!==t.indexOf("trident/")}function w(){return-1!==navigator.userAgent.toLowerCase().indexOf("edge/")}function S(){return-1!==navigator.userAgent.toLowerCase().indexOf("firefox/")}function N(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(navigator.userAgent)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0,4))}function I(){return Object(l.e)()<=640&&N()}function C(){return N()&&Object(l.e)()<=640}function k(){return $(window).width()<=768}function T(){return/ip(hone|od|ad)/.test(navigator.userAgent.toLowerCase())&&!window.MSStream}function x(){var t=navigator.userAgent.toLowerCase(),e=-1!==t.indexOf("version/9")||-1!==t.indexOf("version/13");return-1!==t.indexOf("mac os x")&&e&&-1!==t.indexOf("safari")}function F(){return!!navigator.userAgent.match(/android/i)}function P(){return-1!==navigator.userAgent.toLowerCase().indexOf("tbs/")}function D(){return-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger/")}function M(){return-1!==navigator.platform.toLowerCase().indexOf("win")}function L(t){var e=Object(f.a)(t);return Object(f.b)(e,(function(t,n){Object(f.e)(t)&&(e[n]=L(t))})),e}function A(t){try{return JSON.parse(t)}catch(e){return t}}function R(t){return Object(f.f)(t).filter($.isNumeric).map((function(e){return t[e]}))}function E(t,e,n){var i=new Date;i.setTime(i.getTime()+n);var r="expires="+i.toUTCString();document.cookie=t+"="+e+"; "+r+"; path=/"}function B(t){t+="=";var e=document.cookie.split(";").filter((function(e){return e.indexOf(t)>=0}));if(e.length>0){var n=e[0].trim();return n.substring(t.length,n.length)}return null}function _(t){for(var e=0,n=0;n<t.length;n++)e=t.charCodeAt(n)+((e<<5)-e);return e}function H(){return document&&document.body&&"rtl"===document.body.getAttribute("dir")}function G(){if(I()){var t=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",t+"px")}}function q(t){if("function"==typeof CustomEvent)window.setTimeout((function(){return window.dispatchEvent(new CustomEvent(t))}));else{var e=document.createEvent("CustomEvent");e.initEvent(t,!0,!0),document.createElement("element").dispatchEvent(e)}}function Q(t){document.execCommand("print",!1,null)||window.print(),"function"==typeof t&&(navigator.userAgent.indexOf("Safari")>-1?setTimeout((function(){t()}),3e3):t())}function V(t){return null==t}var z=!1;function U(t){return Object(c.c)("EnableUnicodeNormalization")&&!V(t)?"function"==typeof t.normalize?t.normalize("NFC"):(z||(Object(o.b)("Utility.GetUnicodeNormalization"),z=!0),t):t}},function(t,e,n){"use strict";n.d(e,"x",(function(){return u})),n.d(e,"q",(function(){return h})),n.d(e,"r",(function(){return f})),n.d(e,"p",(function(){return d})),n.d(e,"l",(function(){return b})),n.d(e,"m",(function(){return m})),n.d(e,"w",(function(){return v})),n.d(e,"s",(function(){return g})),n.d(e,"A",(function(){return O})),n.d(e,"z",(function(){return p})),n.d(e,"y",(function(){return j})),n.d(e,"v",(function(){return y})),n.d(e,"o",(function(){return w})),n.d(e,"u",(function(){return S})),n.d(e,"b",(function(){return N})),n.d(e,"j",(function(){return I})),n.d(e,"a",(function(){return C})),n.d(e,"h",(function(){return k})),n.d(e,"n",(function(){return T})),n.d(e,"d",(function(){return x})),n.d(e,"c",(function(){return F})),n.d(e,"k",(function(){return P})),n.d(e,"g",(function(){return D})),n.d(e,"i",(function(){return M})),n.d(e,"f",(function(){return L})),n.d(e,"e",(function(){return A})),n.d(e,"t",(function(){return R}));var i=n(7),r=n(10),o=n(171),s=n(41),a=n(12),c=n(36);function u(){var t=_();return t.indexOf("cus-000.forms.osi.office.net")>=0||t.indexOf("tip.forms.office.com")>=0||t.indexOf("tip.customervoice.microsoft.com")>=0}function l(){return!!window.location.pathname.toLocaleLowerCase().startsWith("/formspro")}function h(){return Object(a.c)("EnableCustomerVoice")&&!Object(a.c)("CustomerVoiceBlackList")}function f(){return _().indexOf("customervoice.microsoft.us")>=0}function d(){var t=Object(s.a)();return"CVInt"===t||"CVProd"===t||"CVTip"===t||"CVFastfood"===t||f()}function b(){switch(Object(s.a)()){case"WWProd":return"https://c.office.com";case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"https://c1.microsoft.com";case"Int":return"https://c.office-int.com";case"MSInt":default:return null}}function m(){var t=window.location.pathname.toLowerCase();switch(l()&&(t=t.substring("/formspro".length)),t){case"/pages/designpage.aspx":case"/pages/teamsdesignpage.aspx":case"/pages/onenoteaddinpage.aspx":case"/pages/delegatepage.aspx":case"/pages/teamsmeetingpollpage.aspx":return"Design";case"/pages/responsepage.aspx":case"/pages/teamsresponsepage.aspx":return"Response";case"/pages/analysispage.aspx":return"Analyze";case"/pages/teamsconfigpage.aspx":return"TeamsConfig";case"/pages/shareformpage.aspx":return"ShareForm";case"/adminsettings.aspx":return"AdminSettings";case"/pages/responsepreviewpage.aspx":return"ResponsePreviewPage";case"/pages/adminphishingreviewpage.aspx":return"AdminPhishingReviewPage";case"/pages/portalpage.aspx":return"PortalPage";default:return"Unknown"}}function v(){var t=Object(s.a)();return"USGovProd"===t||"USDoDProd"===t||"USGovGccProd"===t||"USNat"===t||"USSec"===t}function g(){var t=Object(s.a)();return"USGovProd"===t||"USDoDProd"===t||"USNat"===t||"USSec"===t}function O(){return"USGovGccProd"===Object(s.a)()}function p(){return"USGovProd"===Object(s.a)()}function j(){var t=Object(s.a)();return"USDoDProd"===t||"USNat"===t||"USSec"===t}function y(){return"72f988bf-86f1-41af-91ab-2d7cd011db47"===Object(i.a)().userInfo.TenantId}function w(){return Object(s.d)()}function S(){switch(window.location.pathname.toLowerCase()){case"/pages/mobiledesignpage.aspx":return!0;default:return!1}}function N(){var t=Object(o.a)();return Object(s.f)()?t?"https://login.windows.net/":"https://login.microsoftonline.com/":"https://login.windows-ppe.net/"}function I(){return Object(r.c)((function(){return g()?"https://graph.microsoft.us/v1.0":"WWProd"===(t=Object(s.a)())||"MSProd"===t||"CVProd"===t||"CVTip"===t||"CVFastfood"===t||O()?"https://graph.microsoft.com/v1.0":"https://graph.microsoft-ppe.com/v1.0";var t}),r.f)}function C(){return"USGovProd"===Object(s.a)()||"USDoDProd"===Object(s.a)()?"032e56fd-dfe5-4a50-8017-89692bcbcb0e":"038ed4f5-da78-47bc-8176-9153c79e0edb"}function k(){return"USGovProd"===Object(s.a)()||"USDoDProd"===Object(s.a)()?"153a74ba-783f-4394-bc9a-a109ef69f5c2":"c9a559d2-7aab-4f13-a6ed-e7e9c52aec87"}function T(){return"https://portal.{0}/account/#personalinfo".format(Object(s.f)()?E(Object(s.a)(),!0):E("Int",!0))}function x(){return"https://account.{0}".format(Object(s.f)()?B(Object(s.a)()):B("Trial"))}function F(t){return"lists."+E(t)}function P(){switch(Object(s.a)()){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"72f988bf-86f1-41af-91ab-2d7cd011db47";default:return"f686d426-8d16-42db-81b7-ab578e110ccd"}}function D(){switch(Object(s.a)()){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return["89d8a01e-e5db-493e-8720-b820d953ef20","b6338c92-533e-4f6d-a327-994263712399"];default:return["f686d426-8d16-42db-81b7-ab578e110ccd"]}}function M(){var t=Object(i.a)().cultureInfo;return t&&t.Name||Object(c.d)().lang}function L(){return Object(c.d)().lang||null}function A(){return"Int"}function R(t){switch((t||M()||"").toLowerCase()){case"fr":case"fr-ca":case"fr-fr":case"fr-be":case"fr-lu":case"fr-ch":return!0;default:return!1}}function E(t,e){switch(void 0===e&&(e=!1),null==t&&(t=Object(s.a)()),t){case"USNat":return"eaglex.ic.gov";case"USSec":return"microsoft.scloud";case"USDoDProd":return e?"apps.mil":"osi.apps.mil";case"USGovProd":return e?"office365.us":"osi.office365.us";case"USGovGccProd":return e?"office.com":"gcc.osi.office365.us";case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"CVTip":case"CVFastfood":return"office.com";case"Trial":return"officeppe.com";default:return"office-int.com"}}function B(t){switch(null==t&&(t=Object(s.a)()),t){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"microsoft.com";case"Trial":return"microsoft-ppe.com";default:return"microsoft-int.com"}}function _(){return window.location.host.toLocaleLowerCase()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(2),r=n(0),o=n(3),s=n(9),a=n(43),c=n(18);function u(t){var e,n,u=o.clone(t)||{},l=o.clone(u.HTMLAttributes)||{};switch(u.HTMLAttributes=l,t.GlyphButtonStyle){case 1:case"Vertical":l.className=Object(s.b)(l.className,"glyph-button-control-vertical");break;case 2:case"GlyphOnly":case 0:case"Horizontal":default:l.className=Object(s.b)(l.className,"glyph-button-control-horizontal")}if(l["aria-label"]=l["aria-label"]||t.Text,t.Icon){var h={HTMLAttributes:{className:t.IconClassName},IconName:t.Icon,key:"icon"};e=r.createElement(c.a,Object(i.__assign)({},h))}switch("GlyphOnly"!==t.GlyphButtonStyle&&2!==t.GlyphButtonStyle?n=r.createElement("span",{className:t.TextClassName,key:"text"},t.Text):t.Text&&(u.Tooltip=u.Tooltip||t.Text,u.Tooltip!==t.Text&&(l.title=t.Text)),t.GlyphLocation){case 1:case"Right":u.children=[n,t.children,e];break;case 0:default:u.children=[e,n,t.children]}return Object(a.b)(u)}},function(t,e,n){"use strict";n.d(e,"g",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"f",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"h",(function(){return M})),n.d(e,"d",(function(){return L}));var i,r,o,s,a,c,u=n(2),l=n(3),h=n(6),f=n(30),d=n(4),b=n(11),m=n(44),v=n(83),g=n(14),O=n(5),p=n(148),j=n(113),y=n(22),w=n(45),S=n(137),N=n(154),I=n(70),C=n(143),k=n(237),T=(n(10),n(31)),x=n(25),F=function(){function t(t,e){this.ot=t,this.N=Object(T.i)(this.ot.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.ot.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.ot.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionType",{get:function(){return this.ot.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExtraQosData",{get:function(){var t=this.ot.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&t.hasSection()}},enumerable:!1,configurable:!0}),e.add=function(t){var e=this;if(this.ot.Form.SyncContext===x.a.DesignTimeForm){var n=this.ot.ParentQuestionMaster;return n?n.Synchronizer.existingInDataSource().then((function(){return e.at(t)})):this.at(t)}Object(f.b)("Trying to create a question without design type.")},e.delete=function(t){var e=this;this.ot.Form.SyncContext!==x.a.DesignTimeForm&&Object(f.b)("Trying to delete a question without design type.");var n=this.ot.ParentQuestionMaster;if(n&&n.Deleted)return Promise.resolve();var i=this.ot.SubQuestionMasters.map((function(t){return t.Synchronizer.flush()}));return Promise.all(i).then((function(){return e.ot.createSyncJob((function(){return e.N.deleteFormQuestion(e.FormId,t.id,e.QuestionType,e.ExtraQosData)}))})).then(null,(function(t){if(t&&621===t.innerCode)return Promise.resolve();throw t}))},e.query=function(t){Object(f.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=this;if(this.ot.Form.SyncContext!==x.a.DesignTimeForm)return Promise.resolve();if("id"in t){var i=t.id,r=e.ValuesBefore.id;Object(O.c)("DataSourceUpdatingQuestionId",{newId:i,oldId:r})}if(null===t.allowMultipleValues)try{throw Error("allowMultipleValues null error")}catch(t){Object(O.c)("DataSourceUpdatingQuestionNullAllowMultipleValues",{stack:t.stack})}return this.ot.createUploadSyncJob((function(){return n.N.updateFormQuestion(n.FormId,n.QuestionId,n.QuestionType,t,n.ExtraQosData)}))},e.at=function(t){var e=this,n=this.ot.createSyncJob((function(){return e.N.createFormQuestion(e.FormId,t,e.ExtraQosData)})).then((function(t){var e=t;return e.FileUploadSPOInfo&&(t.fileUploadSPOInfo={driveId:e.FileUploadSPOInfo.DriveId,errorCode:e.FileUploadSPOInfo.ErrorCode,folderId:e.FileUploadSPOInfo.FolderId,linkInfo:e.FileUploadSPOInfo.linkInfo,anonymousLinkInfo:e.FileUploadSPOInfo.anonymousLinkInfo}),t}));return n.then((function(t){"id"in t&&t.id!==e.QuestionId&&Object(O.c)("ChangedIdFromServerSide",{formId:e.FormId,newId:t.id,oldId:e.QuestionId})})),n},t}(),P=n(203),D={Id:d.a.string({IsKeyField:!0,SourceFieldName:"id"}),DefaultValue:d.a.reference({SourceFieldName:"defaultValue"}),ImageInfo:d.a.fromMasterClass(b.f,{SourceFieldName:"image"}),ImageSettings:d.a.fromMasterClass(b.g,{IsLocalField:!0}),Order:d.a.number({SourceFieldName:"order"}),QuestionInfo:d.a.string({SourceFieldName:"questionInfo"}),Required:d.a.boolean({SourceFieldName:"required"}),Subtitle:d.a.string({SourceFieldName:"subtitle"}),CombinedTitle:d.a.string({SourceFieldName:"title"}),Type:d.a.reference({SourceFieldName:"type"}),GroupId:d.a.string({SourceFieldName:"groupId"}),ShowSubtitle:d.a.boolean({IsLocalField:!0}),Hidden:d.a.boolean({IsLocalField:!0}),FormsProRTQuestionTitle:d.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProCalculateSentiment:d.a.boolean({IsLocalField:!0}),FormsProRTSubtitle:d.a.string({SourceFieldName:"formsProRTSubtitle"}),FormsProEnableAnswerTag:d.a.boolean({IsLocalField:!0}),FormsProAnswerTag:d.a.string({IsLocalField:!0}),FormsProAnswerTagHasError:d.a.boolean({IsLocalField:!0}),Title:d.a.string({IsLocalField:!0}),BranchInfo:d.a.fromMasterClass((function(){return p.a}),{IsLocalField:!0}),IntegratedSavingState:d.a.reference({IsLocalField:!0}),SavingState:d.a.reference({IsLocalField:!0}),IsQuiz:d.a.boolean({SourceFieldName:"isQuiz"}),GradingBasis:d.a.string({IsLocalField:!0}),Point:d.a.number({IsLocalField:!0}),ChoiceType:d.a.reference({IsLocalField:!0}),Choices:d.a.collectionOf({Description:d.a.string(),BranchInfo:d.a.fromMasterClass((function(){return p.a})),IsAnswerKey:d.a.boolean(),AnswerHint:d.a.string(),IsGenerated:d.a.boolean(),IsMathOption:d.a.boolean(),FormsProDisplayRTText:d.a.string()},{IsLocalField:!0}),Hint:d.a.string({IsLocalField:!0}),AllowMultipleValues:d.a.boolean({SourceFieldName:"allowMultipleValues"}),AllowOtherAnswer:d.a.boolean({IsLocalField:!0}),OptionDisplayStyle:d.a.enumeration((function(){return c}),{IsLocalField:!0}),ShuffleOptions:d.a.boolean({IsLocalField:!0}),BranchInfoForOtherChoice:d.a.fromMasterClass((function(){return p.a}),{IsLocalField:!0}),ChoiceGroup:d.a.collectionOf((function(){return C.a}),{SourceFieldName:"choices"}),Length:d.a.number({IsLocalField:!0}),RatingShape:d.a.enumeration((function(){return s}),{IsLocalField:!0}),LeftDescription:d.a.string({IsLocalField:!0}),RightDescription:d.a.string({IsLocalField:!0}),FormsProRTLeftDescription:d.a.string({IsLocalField:!0}),FormsProRTRightDescription:d.a.string({IsLocalField:!0}),ShowRatingLabel:d.a.boolean({IsLocalField:!0}),MinRating:d.a.number({IsLocalField:!0}),FormsProSmileyList:d.a.string({IsLocalField:!0}),Multiline:d.a.boolean({IsLocalField:!0}),IsNumber:d.a.boolean({IsLocalField:!0}),HasTFRestrictionForPro:d.a.boolean({IsLocalField:!0}),Placeholder:d.a.string({IsLocalField:!0}),NumberValidationRule:d.a.enumeration((function(){return r}),{IsLocalField:!0}),FormsProValidationType:d.a.enumeration((function(){return i}),{IsLocalField:!0}),NumberMinBoundary:d.a.string({IsLocalField:!0}),NumberMaxBoundary:d.a.string({IsLocalField:!0}),FormsProCustomRegEx:d.a.string({IsLocalField:!0}),FormsProCustomPlaceholder:d.a.string({IsLocalField:!0}),Date:d.a.boolean({IsLocalField:!0}),Time:d.a.boolean({IsLocalField:!0}),FileUploadSPOInfo:d.a.create({anonymousLinkInfo:d.a.string(),driveId:d.a.string(),folderId:d.a.string(),errorCode:d.a.string(),linkInfo:d.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FileTypes:d.a.create({Word:d.a.boolean(),Excel:d.a.boolean(),PowerPoint:d.a.boolean(),PDF:d.a.boolean(),Image:d.a.boolean(),Video:d.a.boolean(),Audio:d.a.boolean()},{IsLocalField:!0}),MaxFileCount:d.a.number({IsLocalField:!0}),MaxFileSize:d.a.number({IsLocalField:!0}),HasSpecificFileType:d.a.boolean({IsLocalField:!0}),CoAuthors:d.a.collectionOf(d.a.reference(),{IsLocalField:!0}),IsMathQuiz:d.a.boolean({IsLocalField:!0}),IsPlainTextInMathField:d.a.boolean({IsLocalField:!0}),IsAnswerPlainText:d.a.boolean({IsLocalField:!0}),IsMathInputDefault:d.a.boolean({IsLocalField:!0}),InputSwitcherDisabled:d.a.boolean({IsLocalField:!0}),MathPatterns:d.a.collectionOf(d.a.string(),{IsLocalField:!0}),MathAriaLabels:d.a.collectionOf(d.a.string(),{IsLocalField:!0}),LastMathMLFormula:d.a.string({IsLocalField:!0}),VideoInfo:d.a.create({Url:d.a.string(),Title:d.a.string(),Author:d.a.string(),Thumbnail_url:d.a.string(),OriginalWidth:d.a.number(),OriginalHeight:d.a.number(),ShowWarningBar:d.a.boolean()},{IsLocalField:!0}),TrackingId:d.a.string({SourceFieldName:"trackingId"}),QuestionTagForIntelligence:d.a.string({SourceFieldName:"questionTagForIntelligence"}),InsightsInfo:d.a.string({SourceFieldName:"insightsInfo"}),IsFromSuggestion:d.a.boolean({SourceFieldName:"isFromSuggestion"}),SuspiciousEvidence:d.a.number({IsLocalField:!0})};!function(t){t[t.Number=0]="Number",t[t.Email=1]="Email",t[t.Custom=2]="Custom"}(i||(i={})),function(t){t[t.None=0]="None",t[t.Greater=1]="Greater",t[t.GreaterOrEqual=2]="GreaterOrEqual",t[t.Less=3]="Less",t[t.LessOrEqual=4]="LessOrEqual",t[t.Equal=5]="Equal",t[t.NotEqual=6]="NotEqual",t[t.Between=7]="Between",t[t.NotBetween=8]="NotBetween",t[t.Max=9]="Max"}(r||(r={})),function(t){t[t.SingleChoice=1]="SingleChoice",t[t.MultiChoice=2]="MultiChoice"}(o||(o={})),function(t){t[t.Number=0]="Number",t[t.Star=1]="Star",t[t.Smiley=2]="Smiley"}(s||(s={})),function(t){t[t.Success=0]="Success",t[t.RequiredError=1]="RequiredError",t[t.NumberValidationError=2]="NumberValidationError",t[t.QuizWrongChoiceError=3]="QuizWrongChoiceError",t[t.MathLengthError=4]="MathLengthError",t[t.MultiChoiceQuestionLengthLimitError=5]="MultiChoiceQuestionLengthLimitError",t[t.RegExValidationError=6]="RegExValidationError"}(a||(a={})),function(t){t[t.Dropdown=0]="Dropdown",t[t.ListAll=1]="ListAll"}(c||(c={}));D.Choices[0],D.ChoiceGroup[0];function M(t){return h.a.getObjectMasterFromModel(t)}var L=function(t){function e(n){var i=this,r=new m.a;return n.InitialData?(e.resolveQuestionNullTypeIssue(n.InitialData),(n=l.clone(n)).InitialData=l.clone(n.InitialData),void 0!==n.InitialData.CombinedTitle?Object(P.b)(n.InitialData):Object(P.a)(n.InitialData)):Object(f.b)("Question model should created with initial data."),(i=t.call(this,n,{MasterReady:r.promise(),Scheduler:new j.a(e.name)})||this).fieldsReady([e.Schema.ChoiceGroup]).then((function(){h.a.Collection.setComparer(i.Model.ChoiceGroup,(function(t,e){return t.Order-e.Order}));var t=h.a.getCollectionMasterFromModel(i.Model.ChoiceGroup);Object(I.c)(t,t.Schema[0].SavingState,(function(t){var e=[i.Model.SavingState,t];i.Model.IntegratedSavingState=Object(I.a)(e)}))})),i.ct(n),Object(w.d)(i,e.Schema.ImageInfo,e.Schema.ImageSettings),i.ut(n),i.redressGradingBasis(),i.coAuthorTimers={},i.initializing=r,i}Object(u.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageInfoMaster",{get:function(){return Object(y.e)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageSettingsMaster",{get:function(){return Object(w.e)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ParentQuestionMaster",{get:function(){if(!this.isFieldReady(this.Schema.GroupId))return null;var t=this.Model.GroupId;return t&&this.Form.getQuestionById(t)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestionMasters",{get:function(){var t=this;return this.Form.FormElementManager.QuestionMasters.filter((function(e){return e.Model.GroupId===t.Model.Id}))},enumerable:!1,configurable:!0}),n.isFieldReady=function(n){return n=e.getSourceFields([n])[0],t.prototype.isFieldReady.call(this,n)},n.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,e.getSourceFields(n))},n.fieldsReady=function(n){return t.prototype.fieldsReady.call(this,e.getSourceFields(n))},n.hasValidVideoUrl=function(){return Object(g.B)()?this.ht()&&Object(v.e)(this.Model.VideoInfo.Url):this.ht()&&Object(v.f)(this.Model.VideoInfo.Url)},n.createSyncJob=function(t){var e=this,n=new m.a,i=n.promise().then((function(){return e.Form.getQuestionSyncBlocker(i)})).then(t);return n.resolve(),i},n.createUploadSyncJob=function(t){var e=this,n=new m.a,i=Promise.all([n,this.ft]).then((function(){return e.createSyncJob(t)}));return n.resolve(),this.ft=Object(m.d)(i),i},n.getMethodDelegator=function(){var t=this.Model.Type;this.dt=this.dt||(this.dt={});var e=this.dt[t];e||(e=new(Object(k.a)(t))(this),this.dt[t]=e);return e},n.getChoiceById=function(t){var e=l.find(this.Model.ChoiceGroup,(function(e){return e.Id===t}));return e&&Object(C.b)(e)},n.getChoiceByKey=function(t){var e=l.find(this.Model.ChoiceGroup,(function(e){return e.Key===t}));return e&&Object(C.b)(e)},n.hasValidBranching=function(){var t=this.Model;return l.map(t.Choices,(function(t){return t.BranchInfo})).concat([t.BranchInfo,t.BranchInfoForOtherChoice]).map(h.a.getObjectMasterFromModel).some((function(t){return t.isValid()}))},n.ct=function(t){this.bt=new S.a(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.bt.deserialize():this.bt.serialize()),this.justifyQuestionInfo()},n.ut=function(t){!t.ExistingInDataSource&&t.InitialData.FileUploadSPOInfo&&(this.Model.FileUploadSPOInfo=null)},n.hasRuntimeError=function(){var t=this.Model.FileUploadSPOInfo;return!!t&&!(!this.Form.SettingMaster.Model.IsAnonymous||!t.anonymousLinkInfo)},n.ht=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new N.a([e.Schema.VideoInfo,e.Schema.ShowSubtitle,e.Schema.Hidden,e.Schema.BranchInfo,e.Schema.ShowRatingLabel,e.Schema.Point,e.Schema.FormsProCalculateSentiment,e.Schema.ImageSettings,e.Schema.GradingBasis,e.Schema.ChoiceType,e.Schema.Choices,e.Schema.Hint,e.Schema.AllowOtherAnswer,e.Schema.OptionDisplayStyle,e.Schema.ShuffleOptions,e.Schema.BranchInfoForOtherChoice,e.Schema.Length,e.Schema.RatingShape,e.Schema.LeftDescription,e.Schema.RightDescription,e.Schema.Multiline,e.Schema.IsNumber,e.Schema.Placeholder,e.Schema.NumberValidationRule,e.Schema.NumberMinBoundary,e.Schema.NumberMaxBoundary,e.Schema.Date,e.Schema.Time,e.Schema.IsMathQuiz,e.Schema.IsPlainTextInMathField,e.Schema.IsAnswerPlainText,e.Schema.InputSwitcherDisabled,e.Schema.IsMathInputDefault,e.Schema.MathPatterns,e.Schema.MathAriaLabels,e.Schema.HasSpecificFileType,e.Schema.FileTypes,e.Schema.MaxFileCount,e.Schema.MaxFileSize,e.Schema.MinRating,e.Schema.FormsProRTLeftDescription,e.Schema.FormsProRTRightDescription,e.Schema.FormsProEnableAnswerTag,e.Schema.FormsProAnswerTag,e.Schema.FormsProAnswerTagHasError,e.Schema.HasTFRestrictionForPro,e.Schema.FormsProValidationType,e.Schema.FormsProCustomRegEx,e.Schema.FormsProCustomPlaceholder,e.Schema.FormsProSmileyList])),e.questionInfoFieldSet},enumerable:!1,configurable:!0}),e.resolveQuestionNullTypeIssue=function(t){if(!t.Type){var e={choiceType:t.ChoiceType,date:t.Date,time:t.Time,ratingShape:t.RatingShape,multiline:t.Multiline};t.Type=null!=e.choiceType?"Question.Choice":null!=e.date||null!=e.time?"Question.DateTime":e.ratingShape?"Question.Rating":"Question.TextField",Object(O.c)("QuestionNullTypeError",{message:"question type resolved",conditions:e,resolvedType:t.Type})}},e.getSourceFields=function(t){return l.uniq(t.map((function(t){return e.QuestionInfoFieldSet.covers(t)?e.Schema.QuestionInfo:t})))},e}(h.a.createObjectMasterClass("QuestionMaster",D,(function(t,e){return new F(t,e)})));Object.keys({verify:null,isEmpty:null,getTypeDisplayName:null,getBranchedResult:null,isNumberType:null,resetBranchInfo:null,getNormalizedAnswer:null,hasAnswer:null,justifyNumberBoundaries:null,getNumberValidationErrorMessage:null,getValidationErrorMessage:null,supportsQuestionLevelBranching:null,supportsChoiceLevelBranching:null,getSnapshotWithoutBranchInfo:null,insertChoice:null,setAnswerKey:null,createQuizResult:null,autoGradeAnswer:null,autoGradeWithQuizResult:null,serializeAnswer:null,deserializeAnswer:null,justifyQuestionInfo:null,showAsDropdown:null,hasCorrectAnswers:null,isCorrectAnswer:null,redressGradingBasis:null}).forEach((function(t){L.prototype[t]=function(){var e=this.getMethodDelegator();return e[t].apply(e,arguments)}}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(3),s=n(9);function a(t){return r.createElement(c,Object(i.__assign)({},t))}var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t=o.clone(this.props.HTMLAttributes)||{};return t.className=Object(s.b)("ms-Icon",this.props.IconName?"ms-Icon--"+this.props.IconName:"",t.className),this.props.Accessible||(t.role="presentation",t["aria-hidden"]="true"),r.createElement("i",Object(i.__assign)({},t))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"o",(function(){return o})),n.d(e,"n",(function(){return s})),n.d(e,"F",(function(){return a})),n.d(e,"I",(function(){return c})),n.d(e,"H",(function(){return u})),n.d(e,"G",(function(){return l})),n.d(e,"p",(function(){return h})),n.d(e,"D",(function(){return f})),n.d(e,"b",(function(){return d})),n.d(e,"c",(function(){return b})),n.d(e,"k",(function(){return m})),n.d(e,"t",(function(){return v})),n.d(e,"s",(function(){return g})),n.d(e,"q",(function(){return O})),n.d(e,"E",(function(){return p})),n.d(e,"v",(function(){return j})),n.d(e,"u",(function(){return y})),n.d(e,"z",(function(){return w})),n.d(e,"r",(function(){return S})),n.d(e,"d",(function(){return N})),n.d(e,"l",(function(){return I})),n.d(e,"w",(function(){return C})),n.d(e,"C",(function(){return k})),n.d(e,"h",(function(){return T})),n.d(e,"g",(function(){return x})),n.d(e,"i",(function(){return F})),n.d(e,"a",(function(){return P})),n.d(e,"x",(function(){return D})),n.d(e,"y",(function(){return M})),n.d(e,"m",(function(){return L})),n.d(e,"f",(function(){return A})),n.d(e,"e",(function(){return R})),n.d(e,"j",(function(){return E})),n.d(e,"B",(function(){return B})),n.d(e,"K",(function(){return _})),n.d(e,"J",(function(){return H})),n.d(e,"A",(function(){return G}));var i=n(33),r=n(10);function o(){return Object(r.c)((function(){return 90}),r.f)}function s(){return 4e3}function a(){return Object(i.a)().Flighting.isEnabled_Deprecated("Question200Limit")?200:100}function c(){return 4e3}function u(){return 2e3}function l(){return 1e3}function h(){return 128}function f(){return 1e3}function d(){return 1e3}function b(){return 4e3}function m(){return 1e3}function v(){return 50}function g(){return 800}function O(){return 600}function p(){return 719}function j(){return 320}function y(){return 240}function w(){return 120}function S(){return 5242880}function N(){return-1}function I(){return 422}function C(){return["image/bmp","image/gif","image/jpeg","image/png"]}function k(){return 10}function T(){return 1}function x(){return 375}function F(){return 300}function P(){return"AnalyzerToken"}function D(){return Object(r.c)((function(){return 7}),r.f)}function M(){return 20}function L(){return 5242880}function A(){return"yyyy-MM-dd"}function R(){return 4e3}function E(){return 40}function B(){return 3e3}function _(){return Object(r.c)((function(){return 10}),r.f)}function H(){return/^[\w+!#$%&'*+-/=?^_`{|}~.]+@[\w+.-]+\.[\w+.]+$/}function G(){return 5}},function(t,e){t.exports=ReactDOM},,function(t,e,n){"use strict";n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"g",(function(){return S})),n.d(e,"e",(function(){return N})),n.d(e,"f",(function(){return I})),n.d(e,"d",(function(){return C})),n.d(e,"b",(function(){return k}));var i,r,o=n(2),s=n(3),a=n(6),c=n(4),u=n(44),l=n(30),h=n(52),f=n(11),d=n(29),b=n(5),m=n(58),v=n(13),g=n(17),O=n(31),p=function(){function t(t,e){this.vt=t;var n,i=this.vt.Parent;if(i instanceof v.a)n=i;else{if(!(i instanceof g.d||i instanceof m.a))throw"Wrong parent type of ImageInfoMaster.";n=i.Form}var r=n.IsGroupForm?3:2;this.N=Object(O.i)(n),this.gt=d.a.getInstance().createImageProvider(r,n.Model.OwnerTenantId,n.Model.OwnerId);var o=a.a.getFieldSchemaInfo(t.Membership.FieldSchema);this.Ot=o.Attributes.SourceFieldName||o.Name}var e=t.prototype;return e.add=function(t){return new Promise((function(t){window.setTimeout((function(){t()}))}))},e.delete=function(t){return Object(l.b)("not supported")},e.query=function(t){return Object(l.b)("not supported")},e.update=function(t){var e,n=t.uploadParameters;return n?(n.Delete?e=this.pt():n.ImageFile?e=this.jt(n.ImageFile):n.Url&&(e=this.yt(n.Url,n.Size)),e?e.then((function(t){var e=s.clone(t);return e.uploadParameters=null,e})):void 0):this.wt()},e.wt=function(){var t=this,e=a.a.convertToSourceData(this.vt.getSnapshot(),Object(f.f)().Schema);delete e.uploadParameters;var n,i={};i[this.Ot]=e;var r=this.vt.Parent;if(r instanceof v.a)n=this.N.updateForm(r.Model.Id,i);else{if(!(r instanceof g.d||r instanceof m.a))return Object(l.b)("not supported");var o=r;n=o.createUploadSyncJob((function(){return t.N.updateFormQuestion(o.Form.Model.Id,o.Model.Id,o.Model.Type,i)}))}return n.then((function(e){return e&&e[t.Ot]}))},e.yt=function(t,e){var n=this,i={SourceUrl:t,Title:Object(h.c)(),Size:e},r=this.vt.Parent;if(r instanceof v.a)return this.N.createFormImageFromUrl(r.Model.Id,this.Ot,i);if(r instanceof g.d||r instanceof m.a){var o=r;return o.createUploadSyncJob((function(){return n.N.createQuestionImageFromUrl(o.Form.Model.Id,o.Model.Id,i)}))}return Object(l.b)("not supported")},e.jt=function(t){var e=this,n={ImageBlob:t,ImageName:Object(h.c)(),ImageType:t.type},i=this.vt.Parent;if(i instanceof v.a)return this.gt.uploadFormImage(i.Model.Id,this.Ot,n);if(i instanceof g.d||i instanceof m.a){var r=i;return r.createUploadSyncJob((function(){return e.gt.uploadQuestionImage(r.Form.Model.Id,r.Model.Id,e.Ot,n)}))}return Object(l.b)("not supported")},e.pt=function(){var t,e=this,n=this.vt.Parent;if(n instanceof v.a)t=this.gt.deleteFormImage(n.Model.Id,this.Ot);else{if(!(n instanceof g.d||n instanceof m.a))return Object(l.b)("not supported");var i=n;t=i.createUploadSyncJob((function(){return e.gt.deleteQuestionImage(i.Form.Model.Id,i.Model.Id,e.Ot)}))}return t.then(null,(function(t){if(t&&805===t.innerCode)return Object(b.c)("DeleteImageNotFoundError",{imageUrl:e.vt.Model.ResourceUrl}),Promise.resolve();throw t})).then((function(){return{altText:null,contentType:null,fileIdentifier:null,height:null,imageFile:null,originalFileName:null,resourceId:null,resourceUrl:null,size:null,width:null}}))},t}(),j=n(113),y=n(70),w={AltText:c.a.string({SourceFieldName:"altText"}),ContentType:c.a.string({SourceFieldName:"contentType"}),FileIdentifier:c.a.string({SourceFieldName:"fileIdentifier"}),OriginalFileName:c.a.string({SourceFieldName:"originalFileName"}),ResourceId:c.a.string({SourceFieldName:"resourceId"}),ResourceUrl:c.a.string({SourceFieldName:"resourceUrl"}),Width:c.a.number({SourceFieldName:"width"}),Height:c.a.number({SourceFieldName:"height"}),UploadParameters:c.a.reference({SourceFieldName:"uploadParameters"}),ErrorType:c.a.enumeration((function(){return r}),{IsLocalField:!0}),ResponseError:c.a.reference({IsLocalField:!0}),ImageProcessingStatus:c.a.enumeration((function(){return i}),{IsLocalField:!0}),IsPredefined:c.a.boolean({IsLocalField:!0}),SavingState:c.a.reference({IsLocalField:!0})};function S(t){if(!t)return!1;if(t.ResourceUrl)return!0;var e=t.UploadParameters;return!!e&&!!e.ImageFile}function N(t){return a.a.getObjectMasterFromModel(t)}function I(t,e,n,i){if(t>n||e>i){var r=Math.min(i/e,n/t);t*=r,e*=r}return{width:t,height:e}}function C(){return{UploadParameters:null,ErrorType:r.NoError,ResponseError:null,ImageProcessingStatus:i.Idle,Width:null,Height:null}}!function(t){t[t.Idle=0]="Idle",t[t.Picking=1]="Picking",t[t.Uploading=2]="Uploading",t[t.Deleting=3]="Deleting"}(i||(i={})),function(t){t[t.NoError=0]="NoError",t[t.SizeTooLarge=1]="SizeTooLarge",t[t.InvalidType=2]="InvalidType",t[t.BrokenImage=3]="BrokenImage",t[t.ServerError=4]="ServerError",t[t.DeleteFailError=5]="DeleteFailError"}(r||(r={}));var k=function(t){function e(n){var o=this,a=new u.a,c=!n.ExistingInDataSource&&n.InitialData&&!!n.InitialData.ResourceUrl,l=s.clone(n.InitialData);(n=s.clone(n)).InitialData=c?s.extend({},l,{ImageProcessingStatus:i.Uploading}):s.extend({},l,C());var h=new j.a(e.name);h.setMaxRetryTimesForUpdate(0);var f=(o=t.call(this,n,{Scheduler:h,MasterReady:a.promise()})||this).Synchronizer;return f.observe((function(t){var e;s.contains(t.FieldSchemas,f.Schema.CreationError)?e=f.Model.CreationError:s.contains(t.FieldSchemas,f.Schema.UpdateError)&&(e=f.Model.UpdateError),e&&o.bulkEdit((function(){o.Model.ResponseError=e;var t=o.Model.UploadParameters;t&&t.Delete?o.Model.ErrorType=r.DeleteFailError:o.Model.ErrorType=r.ServerError}))}),[f.Schema.CreationError,f.Schema.UpdateError]),o.addRule({InterestedFields:[o.Schema.ResourceId],Name:"ResetErrorStatus",onChange:function(t){!t.BeingDeleted&&o.Model.ResourceId&&o.resetStatus(i.Idle)}}),o.initializing=a,o.duplicatingImage=c,o.originalInitialData=l,Object(y.b)(o),o}Object(o.__extends)(e,t);var n=e.prototype;return n.getSettingsMaster=function(){return this.St},n.setSettingsMaster=function(t){this.St=t},n.resetStatus=function(t){var e=this.Model;this.bulkEdit((function(){e.ErrorType=r.NoError,e.ResponseError=void 0,e.ImageProcessingStatus=t}))},e}(a.a.createObjectMasterClass("ImageInfoMaster",w,(function(t,e){return new p(t,e)})))},function(t,e,n){"use strict";n.d(e,"c",(function(){return l})),n.d(e,"t",(function(){return h})),n.d(e,"s",(function(){return f})),n.d(e,"j",(function(){return d})),n.d(e,"a",(function(){return g})),n.d(e,"f",(function(){return O})),n.d(e,"i",(function(){return p})),n.d(e,"n",(function(){return j})),n.d(e,"h",(function(){return y})),n.d(e,"q",(function(){return w})),n.d(e,"p",(function(){return S})),n.d(e,"k",(function(){return N})),n.d(e,"r",(function(){return I})),n.d(e,"l",(function(){return C})),n.d(e,"b",(function(){return k})),n.d(e,"o",(function(){return T})),n.d(e,"m",(function(){return x})),n.d(e,"g",(function(){return F})),n.d(e,"d",(function(){return P})),n.d(e,"e",(function(){return D}));var i,r=n(7),o=n(36);!function(t){t[t.signup=1]="signup"}(i||(i={}));var s,a,c,u,l="Token",h="platform",f="jsSdkVersion",d="id",b=null,m=!1;function v(){return c||g()}function g(){var t=c||Object(o.d)().Host||Object(o.b)().Host;switch(t){case"OneNote":case"OneNoteUwp":case"Outlook":case"Teams":case"TeamsBot":case"TeamsPollTab":case"TeamsPollBubble":case"Excel":case"OneDrive":case"Excel_Win32":case"PowerPointContent":case"PowerPointTaskpane":case"Assignments":case"ProjectShimla":case"Stream":case"StreamMobile":case"Union":case"ODC":return t;default:return null}}function O(){return s||Object(o.d)().groupId||Object(o.b)().groupId}function p(){return a||Object(o.d)().tid||Object(o.b)().tid}function j(){return!!g()||!!Object(r.a)().isOembedSPO}function y(){var t=Object(o.d)().route;if(t){var e=t.toLowerCase();switch(e){case"start":case"appitems":case"groupitems":case"officehome":case"templates":return e;default:return"others"}}}function w(){var t=v();return("Teams"===t||"TeamsBot"===t||"TeamsPollTab"===t||"TeamsPollBubble"===t)&&"undefined"!=typeof microsoftTeams}function S(){return"Guest"===u}function N(){return"Assignments"===v()}function I(){return"Union"===v()}function C(){return"/pages/assignmentsdesignpage.aspx"===window.location.pathname.toLowerCase()||"/pages/assignmentsresponsepage.aspx"===window.location.pathname.toLowerCase()}function k(){return w()||N()||"Stream"===v()||"StreamMobile"===v()}function T(){return"PowerPointTaskpane"===v()||"PowerPointContent"===v()||"PowerPointLive"===v()}function x(){if(null===b){var t=window.location.pathname.trimEnd("/").toLowerCase();b=t.lastIndexOf("delegatepage.aspx")===t.length-"delegatepage.aspx".length}return b}function F(){return m}function P(){return Object(o.d)().cdsId}function D(){return Object(o.d)().cdsRegion}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var i=n(2),r=n(0),o=n(3),s=n(43),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Nt=r.createRef(),e}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t;return(t=o.clone(this.props)||{}).children=this.props.Text,t.ref=this.Nt,t.HTMLAttributes=o.clone(t.HTMLAttributes)||{},t.HTMLAttributes["aria-label"]=t.HTMLAttributes["aria-label"]||this.props.Text,r.createElement(s.a,Object(i.__assign)({},t))},n.focus=function(){this.Nt.current&&this.Nt.current.focus()},e}(n(8).a);function c(t){return r.createElement(a,Object(i.__assign)({},t))}},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.DesignTimeForm=1]="DesignTimeForm",t[t.ResponseTimeForm=2]="ResponseTimeForm",t[t.SharedTimeForm=3]="SharedTimeForm",t[t.LocalForm=4]="LocalForm",t[t.AnalysisTimeForm=5]="AnalysisTimeForm",t[t.ResponseDetailTimeForm=6]="ResponseDetailTimeForm",t[t.AdminPhishingReviewForm=7]="AdminPhishingReviewForm"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return d}));var i=n(41),r=n(54),o=n(7),s=Object(o.a)().hashMapping,a=Object(o.a)().isCdnEnabled,c=Object(o.a)().addPrefixForProWhenNoCdn,u={defaultFolder:{css:"/css/dist/",js:"/Scripts/dists/"},vendorsFolder:{css:"/css/",js:"/Scripts/"}};function l(t){return t?a?d(t):c?"/FormsPro"+t:t:""}function h(t,e){if(!t)return"";var n=t.split(".").pop();if("js"!==n&&"css"!==n)return t;var i=function(t,e){return(/^vendors\//i.test(t)?u.vendorsFolder:u.defaultFolder)[e]}(t,n)+t;if(a&&void 0!==s){var r=s[t.toLowerCase()];if(void 0!==r)return d(i.replace(new RegExp(n+"$"),r+"."+n))}var l=i+(e?"?v="+Object(o.a)().version:""),h=Object(o.a)().ring;return!a&&h&&(l=l+(e?"&":"?")+"ring="+h),c?"/FormsPro"+l:l}function f(t){return t?a?d(t.replace(/\/intl\//i,"/intl_cdn/")):c?"/FormsPro"+t:t:""}function d(t){if(t=t.toLowerCase(),Object(i.d)()){var e=Object(r.a)("CdnEndPoint");if(e)return e+t}return"/cdn"+t}},function(t,e,n){"use strict";n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return O})),n.d(e,"a",(function(){return p}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(12),c=n(19),u=n(9),l=n(14),h=n(42),f=n(10),d=n(5),b=n(8),m=n(123),v=n(192);function g(t){return r.createElement(j,t)}function O(t,e,n,i,r,o){return Object(f.c)((function(){return g(t)}),f.f)}function p(t,e,n,i,r){return void 0===n&&(n=null),void 0===i&&(i=!0),e?O(t):g(t)}var j=function(t){function e(e){var n=t.call(this,e)||this;return n.It=r.createRef(),n.Ct=n.Ct.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.AutoFocus&&this.focus()},n.focus=function(){this.It.current&&this.It.current.focus()},n.createReactNodes=function(){return[this.kt(),this.Tt()]},n.kt=function(){var t=this.props,e=t.Options;if(t.Label||t.ShowRequiredStar)return r.createElement("div",null,r.createElement("span",{className:e&&e.classNameForInnerLabel},t.Label),t.ShowRequiredStar?r.createElement(v.a):void 0)},n.Tt=function(){var t,n,i,s,l=this,f=this.props,d=f.Options,b="DesignPage.ShortCut.Clipboard",m=Object(u.g)(d&&d.HTMLPropsForInnerElement,{value:f.Value||"",className:"office-form-textfield-input form-control border-no-radius",rows:this.props.Rows,placeholder:f.Placeholder,ref:this.It,style:{height:f.MinimalHeight+"px",overflowY:1===f.TextFieldType?"auto":void 0},spellCheck:!0,disabled:f.Disabled,onChange:this.xt.bind(this),maxLength:f.MaxLength?f.MaxLength:Object(c.k)(),onFocus:f.AutoSelection?function(){if(l.It.current){var t=o.findDOMNode(l.It.current);t&&t.select()}}:void 0,onKeyDown:Object(u.h)((function(t){if(t.ctrlKey){var n=new Date,i=String.fromCharCode(t.keyCode),r="Ctrl+"+i;switch(i){case"C":case"X":l.Ft(e.prevTimeKeyDown,n.getTime())>e.minDuration&&l.Pt(t,b,r),e.prevTimeKeyDown=n.getTime();break;case"V":l.Pt(t,b,r);break;case"Y":case"Z":l.Pt(t,"DesignPage.ShortCut.UndoRedo",r)}}})),onCopy:function(t){var n=new Date;l.Ft(e.prevTimeOnCopy,n.getTime())>e.minDuration&&l.Pt(t,b,"onCopy"),e.prevTimeOnCopy=n.getTime()},onPaste:function(t){l.Pt(t,b,"onPaste")},onCut:function(t){var n=new Date;l.Ft(e.prevTimeOnCut,n.getTime())>e.minDuration&&l.Pt(t,b,"onCut"),e.prevTimeOnCut=n.getTime()}});switch(f.TextFieldType){case 2:var v=m,g=null==f.MinimalHeight?80:f.MinimalHeight>0?f.MinimalHeight:0;v.MinHeight=g.toString()+"px",t=function(t){return r.createElement(y,t)}(v);break;case 1:n=r.createElement("textarea",m);break;case 0:default:i=r.createElement("input",m)}if(f.ShowCharCounter){var O=!f.Value||m.maxLength>f.Value.length?"office-form-textfield-counter":"office-form-textfield-counter textfield-counter-warning";s=r.createElement("label",{className:O},this.Dt(f.Value,m.maxLength))}var p,j=Object(u.b)("office-form-textfield",f.Options&&f.Options.classNameForInnerDiv);return Object(a.c)("TextFormat")&&!Object(a.e)()&&this.props.AllowRichText&&(j=Object(u.b)(j,"textfield-with-text-format"),p=Object(h.a)({Value:this.props.Value,onKeyDown:this.props.HTMLAttributes.onKeyDown,PlaceHolder:this.props.Placeholder,updateContentToBindBox:this.Ct})),r.createElement("div",{className:j},p,t,n,i,s)},n.Ct=function(t){this.props.onValueChange(t)},n.xt=function(t){if(!this.props.Disabled){var e=t.target,n=Object(l.j)(e.value);if(n&&n.length>e.maxLength&&(n=n.slice(0,e.maxLength)),this.props.onValueChange(n),this.props.ShowCharCounter){var i=o.findDOMNode(e).nextSibling;i&&(i.innerText=this.Dt(n,e.maxLength))}}},n.Dt=function(t,e){return(t||"").length.toString()+" / "+e.toString()},n.Pt=function(t,e,n){var i;this.props.HTMLAttributes&&(i=this.props.HTMLAttributes.className),Object(d.b)(e,{targetClassName:i,operation:n})},n.Ft=function(t,e){return e-t},e.prevTimeKeyDown=0,e.prevTimeOnCopy=0,e.prevTimeOnCut=0,e.minDuration=500,e}(m.a);var y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.It=r.createRef(),e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.Mt(),this.Lt=this.Mt.bind(this),window.addEventListener("resize",this.Lt)},n.componentDidUpdate=function(){this.Mt()},n.componentWillUnmount=function(){window.removeEventListener("resize",this.Lt)},n.focus=function(){this.It.current&&this.It.current.focus()},n.render=function(){var t=s.clone(this.props);return t.ref=this.It,delete t.MinHeight,r.createElement("textarea",t)},n.Mt=function(){if(!Object(a.c)("PrintForm")||!this.It.current.hasAttribute("rows")){var t=o.findDOMNode(this),e=this.props,n=t.parentElement,i=n.style.height;n.style.height=window.getComputedStyle(n).height,t.style.height=e.MinHeight;var r=t.offsetHeight-t.clientHeight;t.style.height=t.scrollHeight+r+"px",n.style.height=i,t.style.minHeight=e.MinHeight}},e}(b.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=function(){function t(){this.At=!1,this.Rt=!1}var e=t.prototype;return e.UsingSingleton=function(t){return this.Et(t,!0)},e.UsingFactory=function(t){return this.Et(t,!1)},e.Create=function(){return this.At?(this.Bt||(this.Bt=this._t()),this.Bt):this._t()},e.Et=function(t,e){return this.At=e,this.Ht=t,this},e._t=function(){if(this.Rt)throw Error("Circular dependency detected ");this.Rt=!0;var t=this.Ht();return this.Rt=!1,t},t}(),r=function(){function t(){this.Gt={}}var e=t.prototype;return e.Add=function(t,e){this.Gt[t]=e},e.Get=function(t){return this.Gt[t]},t}(),o=new(function(){function t(){this.qt=new r}var e=t.prototype;return e.Resolve=function(t){var e,n=this.qt.Get(t);if(!n)throw Error("Failed to resolve "+t+", make sure you have registered it by calling Register()");try{e=n.Create()}catch(e){throw Error("Exception when resolving "+t+": "+e)}return e},e.Register=function(t){var e=new i;return this.qt.Add(t,e),e},t}())},function(t,e,n){"use strict";n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return O})),n.d(e,"c",(function(){return p}));var i=n(41),r=n(15),o=n(7),s=n(186),a=n(11),c=n(206),u=n(112),l=n(52),h=n(46),f=n(33),d=(n(10),n(71)),b=n(96),m=function(){function t(t){for(this.Qt=t.trim();"/"===this.Qt.charAt(this.Qt.length-1);)this.Qt=this.Qt.substr(0,this.Qt.length-1)}var e=t.prototype;return e.deleteQuestionImage=function(e,n,i){var r=this;return v().then((function(o){return t.deleteImageInternal(o,r.Vt(t.getQuestionImageUrl(e,n,i)))}))},e.uploadQuestionImage=function(e,n,i,r){var o=this;return v().then((function(s){return t.uploadImageInternal(s,o.Vt(t.getQuestionImageUrl(e,n,i)),i,r)}))},e.deleteFormImage=function(e,n){var i=this;return v().then((function(r){return t.deleteImageInternal(r,i.Vt(t.getFormImageUrl(e,n)))}))},e.uploadFormImage=function(e,n,i){var r=this;return v().then((function(o){return t.uploadImageInternal(o,r.Vt(t.getFormImageUrl(e,n)),n,i)}))},t.getFormImageUrl=function(e,n){return t.formImageUrlPattern.format(e,n)},t.getQuestionImageUrl=function(e,n,i){return t.questionImageUrlPattern.format(e,n,i)},t.deleteImageInternal=function(e,n){var i=new d.a("Image.Delete");i.start();return t.sendRequest({methodName:"DELETE",url:n,headers:{Authorization:e?"Bearer "+e:"","X-CorrelationId":i.CorrelationId,"X-UserSessionId":Object(b.b)()},successHandler:function(){return i.end({resultType:"Success"})},errorHandler:function(t){var e={correlationId:i.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return i.end({resultType:"Failure",extraData:{imageUrl:n,error:e}}),e}})},t.uploadImageInternal=function(e,n,i,r){var o=new d.a("Image.Upload");o.start();return t.sendRequest({methodName:"PUT",url:n,headers:{Authorization:e?"Bearer "+e:"","Content-Type":r.ImageType,"Content-Disposition":"attachment; name={0}; filename={1}".format(Object(l.c)(),r.ImageName),"X-CorrelationId":o.CorrelationId,"X-UserSessionId":Object(b.b)()},successHandler:function(t){if(!t||!t.resourceId){var e={correlationId:o.CorrelationId,innerCode:5200,statusCode:0,innerMessage:"Upload image return bad response",statusText:"CollabDb bad response"};throw o.end({resultType:"Failure",extraData:{imageUrl:n,error:e,imageType:i}}),e}o.end({resultType:"Success",extraData:{imageType:i}});var r={};return r.altText=t.altText,r.contentType=t.contentType,r.fileIdentifier=t.fileIdentifier,r.originalFileName=t.originalFileName,r.resourceId=t.resourceId,r.resourceUrl=t.resourceUrl,r.height=t.height,r.width=t.width,r},errorHandler:function(t){var e={correlationId:o.CorrelationId,innerCode:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.code,statusCode:t.status,innerMessage:t.responseJSON&&t.responseJSON.error&&t.responseJSON.error.message,statusText:t.statusText};return o.end({resultType:"Failure",extraData:{imageUrl:n,error:e}}),e},blob:r.ImageBlob})},t.sendRequest=function(e){var n=e.methodName,i=e.url,s=e.headers,a=e.successHandler,l=e.errorHandler,d=e.data,b=e.blob,m=new XMLHttpRequest;return m.open(n,i),Object(r.o)()&&m.setRequestHeader("__RequestVerificationToken",Object(o.a)().antiForgeryToken),Object.keys(s).forEach((function(t){m.setRequestHeader(t,s[t])})),d?(m.setRequestHeader("content-type","application/json; charset=utf-8"),m.send(d)):b?m.send(b):m.send(),new Promise((function(t,e){m.onreadystatechange=function(){if(m.readyState===XMLHttpRequest.DONE){var n=m.status;200===n||202===n||201===n||204===n?t(m.responseText&&JSON.parse(m.responseText)):e(m.statusText)}}})).then(a,(function(e){if(!Object(c.a)(e))return l(e);Object(f.a)().AuthContext.refreshToken().then((function(){Object(u.e)().then((function(){return t.sendRequest({methodName:n,url:i,headers:s,successHandler:a,errorHandler:l,data:d,blob:b})})).catch(h.d)}))}))},e.Vt=function(t){return this.Qt+"/"+t},t.formImageUrlPattern="forms('{0}')/{1}",t.questionImageUrlPattern="forms('{0}')/questions('{1}')/{2}",t}();function v(){return Object(f.a)().AuthContext.getFormApiToken()}var g=function(){function t(){if(t.instance)return t.instance;t.instance=this}var e=t.prototype;return t.getInstance=function(){return new t},e.getOwnerServiceUrl=function(t,e,n){return 1===t?this.getFormApiServiceUrl():4===t?this.getFormApiServiceUrl()+"me/":e&&n?this.getFormApiServiceUrl()+e+(3===t?"/groups/":"/users/")+n+"/":null},e.createDataProvider=function(t,e,n){void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null);var i=Object(a.d)();if(1===t)return this.defaultDataProvider||(this.defaultDataProvider=new i(this.getFormApiServiceUrl(),this.getFormApiServiceUrl())),this.defaultDataProvider;var r=this.getOwnerServiceUrl(t,e,n);return r&&new i(this.getFormApiServiceUrl(),r)},e.createImageProvider=function(t,e,n){if(void 0===t&&(t=1),void 0===e&&(e=null),void 0===n&&(n=null),1===t)return this.currentImageProvider||(this.currentImageProvider=new m(this.getFormApiServiceUrl())),this.currentImageProvider;var i=this.getOwnerServiceUrl(t,e,n);return i&&new m(i)},e.getFormApiServiceUrl=function(){return this.getServiceUrl("formapi/api/")},e.getCollabDBServiceUrl=function(){var t;return t=Object(i.d)()?Object(i.a)():Object(r.e)(),Object(r.c)(t)},e.getServiceUrl=function(t){return Object(s.a)()+t},t}();function O(){return g.getInstance().createDataProvider()}function p(t){return g.getInstance().createDataProvider(3,Object(o.a)().userInfo.TenantId,t)}},,function(t,e,n){"use strict";n.d(e,"d",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"i",(function(){return d})),n.d(e,"h",(function(){return b})),n.d(e,"a",(function(){return m})),n.d(e,"j",(function(){return v})),n.d(e,"c",(function(){return g})),n.d(e,"b",(function(){return O})),n.d(e,"l",(function(){return p})),n.d(e,"k",(function(){return j}));var i=n(6),r=n(81),o=n(29),s=n(5),a=n(13),c=n(95);function u(t,e,n){var r=function(t){return Object(c.g)(t||i.a.getSubFieldSchemas(a.a.Schema)).map((function(t){var e=i.a.getFieldSchemaInfo(t);if(!e.Attributes.IsLocalField)return e.Attributes.SourceFieldName||e.Name})).filter((function(t){return t}))}(t);r.push("status");var u=i.a.getFieldSchemaInfo(a.a.Schema.Version).Attributes.SourceFieldName;r.indexOf(u)&&r.push(u);var l=4,h=null,f=null;e&&(h=e.OwnerTenantId,f=e.OwnerId,l=e.IsGroupForm?3:2);var d=o.a.getInstance().createDataProvider(l,h,f);return d.getForms(r,n).then((function(t){var e=[],n=0,r=[];return t.forEach((function(t){if("Deleted"===t.status)++n,d.deleteForm(t.id);else if(t.version){var o=i.a.convertFromSourceData(t,a.a.Schema);r.push(o)}else e.push(t.id)})),(e.length||n)&&Object(s.b)("PortalPage.FilteredOutForms",{deletedFormCount:n,oldVersionForms:e}),r}))}function l(t,e){return o.a.getInstance().createDataProvider().getCachedSimpleForms(t,e)}function h(){return o.a.getInstance().createDataProvider().getFormsResponseCount()}function f(){return o.a.getInstance().createDataProvider(4).getFormsSharedWithCurrentUser().then((function(t){return t.map((function(t){return i.a.convertFromSourceData(t,a.a.Schema)}))}))}function d(t){if(!t.isFieldReady(a.a.Schema.OwnerTenantId)||!t.isFieldReady(a.a.Schema.OwnerId))return o.a.getInstance().createDataProvider();var e=1;if(t.IsGroupForm)e=3;else{if(!t.Model.OwnerTenantId||!t.Model.OwnerId)return null;e=2}return o.a.getInstance().createDataProvider(e,t.Model.OwnerTenantId,t.Model.OwnerId)}function b(t){var e=Object(r.a)(t),n=1;return e.IsGroupOwner?n=3:e.OrgId&&e.OwnerId&&(n=2),o.a.getInstance().createDataProvider(n,e.OrgId,e.OwnerId)}function m(t,e,n){return d(t).downloadExcelFile(t.Model.Id,e,n)}function v(t){return d(t).getFormResponseCount(t.Model.Id)}function g(t){return b(t).getAnalysisSurveyData(t)}function O(t){return b(t).getAnalysisQuizData(t)}function p(t){return b(t).getResultSharingAnalysisSurveyData(t)}function j(t){return b(t).getResultSharingAnalysisQuizData(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"b",(function(){return f}));var i,r=n(2),o=n(6),s=n(4),a=n(57),c={ExportToExcelCalloutVersion:s.a.string(),NewFormTeachingCalloutVersion:s.a.string(),SendTeachingCalloutVersion:s.a.string(),ThemeSuggestCalloutVersion:s.a.string(),WhatsNewVersion:s.a.string(),PortalFormIntroduction:s.a.string(),PortalFormsProIntroduction:s.a.string(),OutlookQuickPollTeachingUI:s.a.string(),FormsProSampleForm:s.a.string(),FlowTeachingCallout:s.a.string(),ExcelSurveyIntroduction:s.a.string(),ToggleExpTeachingBubble:s.a.string(),ProCardTeachingBubble:s.a.string(),MSRewardsTeachingCoach:s.a.string(),MSRewardsCommandBarTeachingCoach:s.a.string(),IsNotFirstTimePhishingDetected:s.a.boolean(),FormsProAvailableTeachingCallout:s.a.string(),CustomerVoiceDesignerCallout:s.a.string(),CalculateSentimentTeachingCallout:s.a.string(),AddBranchingTeachingCalloutVersion:s.a.string(),CustomerVoiceIntroductionDialog:s.a.string()},u=2;function l(){return i||(i=new f)}function h(t){var e=parseInt(t);return isNaN(e)||e<u}var f=function(t){function e(){var n=t.call(this,{InitialData:e.getInitialData()})||this;return n.observe((function(t){return n.zt(t.FieldSchemas)})),n}Object(r.__extends)(e,t);var n=e.prototype;return e.getInitialData=function(){var t=Object(a.a)(),n={};return Object.keys(e.Schema).forEach((function(e){return n[e]=t.getItem(e)})),n},n.zt=function(t){var e=Object(a.a)(),n=this.getSnapshot();t.map(o.a.getFieldSchemaInfo).map((function(t){return t.Name})).forEach((function(t){return e.setItem(t,n[t])}))},e}(o.a.createObjectMasterClass("UserProfileMaster",c))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(28);function r(){return i.a.Resolve("IPageContext")}},function(t,e,n){"use strict";function i(t){var e=document.createElement("a");return e.href=t,e.href}function r(t){var e=document.createElement("a");return e.href=t,e.hostname}function o(t,e,n){var i=t.indexOf("#"),r=-1===i?"":t.substr(i);t=-1===i?t:t.substr(0,i);var o=new RegExp("([?&])"+e+"=.*?(&|$)","i"),s=-1!==t.indexOf("?")?"&":"?";return(t=t.match(o)?t.replace(o,"$1"+e+"="+n+"$2"):t+s+e+"="+n)+r}function s(t,e){var n=function(t){var e=document.createElement("a");return e.href=t,e.search}(t),i=n.slice(1),r=new RegExp(e.join("=|")+"="),o=i.split("&"),s=[];o.forEach((function(t){t&&!1===r.test(t)&&s.push(t)}));var a=s.length?"?"+s.join("&"):"";return t.replace(n,a)}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return s}))},function(t,e,n){"use strict";n.d(e,"n",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"m",(function(){return a})),n.d(e,"g",(function(){return c})),n.d(e,"i",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"o",(function(){return h})),n.d(e,"p",(function(){return f})),n.d(e,"j",(function(){return d})),n.d(e,"c",(function(){return b})),n.d(e,"l",(function(){return m})),n.d(e,"k",(function(){return v})),n.d(e,"h",(function(){return g})),n.d(e,"f",(function(){return O})),n.d(e,"e",(function(){return p}));var i=n(28);function r(t){return j().createPreviewSettingPane(t)}function o(t){return j().addSurveyFontToSchemas(t)}function s(t){return j().addHeaderFontToSchemas(t)}function a(t,e){return j().getModifiedTextField(t,e)}function c(t){return j().getFooterElement(t)}function u(){return j().getLazyLoadThemes()}function l(){return j().getDefaultTheme()}function h(t){return j().getThemeBackground(t)}function f(t){return j().getThemeStyle(t)}function d(){return j().getMediaPickerPaneText()}function b(){return j().areImageUploadButtonsEnabled()}function m(){return j().getMediaPickerPaneTitle()}function v(){return j().getMediaPickerPaneInfoContent()}function g(){return j().getImagePickerLocalContainerClassName()}function O(){return j().getFlexPaneWidth()}function p(){return j().getErrorPage()}function j(){return i.a.Resolve("ICustomerVoiceUxFactory")}},function(t,e,n){"use strict";n.d(e,"d",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return a}));n(82);function i(t){return s(t||window.location.search.substring(1))}function r(t){return s(t||window.location.hash.substring(1))}function o(t){return"string"==typeof t&&(t=document.querySelector(t)),t?window.getComputedStyle?parseInt(window.getComputedStyle(t).height):t.clientHeight:0}function s(t){var e={};return t&&t.trim().split("&").forEach((function(t){var n=t.indexOf("=");-1===n&&(n=t.length);var i=t.substring(0,n).trim();i&&(e[i]=decodeURIComponent(t.substring(n+1)||"").trim())})),e}function a(t,e){if(t&&e)return t[e]||t[e.toLowerCase()]||void 0}},function(t,e,n){"use strict";n.d(e,"e",(function(){return b})),n.d(e,"d",(function(){return m})),n.d(e,"i",(function(){return v})),n.d(e,"h",(function(){return g})),n.d(e,"g",(function(){return O})),n.d(e,"j",(function(){return p})),n.d(e,"k",(function(){return j})),n.d(e,"f",(function(){return y})),n.d(e,"c",(function(){return w})),n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return N})),n.d(e,"l",(function(){return I}));var i,r,o,s=n(41),a=n(15),c=n(23),u=n(7),l=n(47),h=n(5),f=n(29),d=n(140);function b(){return C().then(l.k,(function(){return!1}))}function m(){return C().then(l.j,(function(){return!1}))}function v(){return C().then((function(){return p()&&!Object(l.q)()}),(function(){return!1}))}function g(){return C().then((function(){return!!Object(l.p)()}),(function(){return!1}))}function O(){return C().then(l.l,(function(){return!1}))}function p(){var t=Object(u.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(s.b)())}function j(){var t=Object(u.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(a.k)())}function y(){var t=Object(u.a)().userInfo.TenantId;return t&&-1!==Object(a.g)().indexOf(t.toLowerCase())}function w(){return C().then(l.e,(function(){return 0}))}function S(){return r||(r=new Promise((function(t,e){$(document).ready((function(){f.a.getInstance().createDataProvider().getDataClassificationLabels().then(t,e)}))}))).catch((function(t){Object(h.c)("TenantDataClassificationLevelsGetFailure",t)})),r}function N(t,e){if(!o){var n=f.a.getInstance().createDataProvider();(o=n.getDataClassificationLabelDetail(t,e)).catch((function(t){Object(h.c)("TenantDataClassificationLevelDetailGetFailure",t)}))}return o}function I(){Object(d.d)().then((function(t){Object(l.r)(t.licenses,t.isPaidUser)})).catch((function(t){Object(h.c)("RefreshUserInfoFailed",t)}))}function C(){return i||(i=new Promise((function(t,e){$(document).ready((function(){if(Object(u.a)().userInfo.UserId||Object(c.l)()||Object(c.q)())try{var n=Object(u.a)().userLicenseInfo;if(null==n?void 0:n.id){var i=Object(l.r)(n.licenses,n.isPaidUser);t(i)}else Object(d.b)().then((function(e){var n=Object(l.r)(e.licenses,e.isPaidUser);t(n)})).catch(e)}catch(t){e(t)}else t({})}))}))).catch((function(t){Object(h.c)("UserInfoGetFailure",t)})),i}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"g",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"f",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h}));var i,r=n(3);n(264);function o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(t&&document.activeElement&&t.contains(document.activeElement)){var i=$(":focusable");e&&e.forEach((function(t){i=i.not((function(e,n){return t.contains(n)}))}));var r=i.index(document.activeElement);if(!(r<0)){for(var o=r+1;o<i.length;++o){var s=i[o];if(!t.contains(s)&&!d(s))return void i[o].focus()}for(o=r-1;o>=0;--o){s=i[o];if(!t.contains(s)&&!d(s))return void i[o].focus()}}}}function s(t){$(t).on("keydown",f)}function a(t){$(t).off("keydown",f)}function c(t,e){i||(i={}),i[t]||delete i[t],i[t]=e}function u(t){i&&i[t]&&(i[t](),delete i[t])}function l(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=$(t).find(":focusable");e&&e.forEach((function(t){i=i.not((function(e,n){return t.contains(n)}))})),i[i.length-1].focus()}function h(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var i=$(t).find(":focusable");e&&e.forEach((function(t){i=i.not((function(e,n){return t.contains(n)}))})),i.length>0&&i[0].focus()}function f(t){if(9===t.keyCode){t.stopPropagation(),t.preventDefault();var e=$(this),n=r.union(e.filter(":focusable").toArray(),e.find(":focusable").toArray()),i=n.indexOf(document.activeElement);if(!(i<0)){var o=r.union(n.slice(i+1),n.slice(0,i));t.shiftKey&&o.reverse(),o.push(n[i]);var s=r.find(o,(function(t){return!d(t)}));s&&s.focus()}}}function d(t){var e=Number(t.getAttribute("tabindex"));return!isNaN(e)&&e<0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(0);function r(t,e){return t.__lazyComponentClass||(t.__lazyComponentClass=i.lazy(e)),t.__lazyComponentClass}},function(t,e,n){"use strict";var i=n(2),r=n(0),o=r.PureComponent,s=r.Suspense,a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=t.children,n=t.fallback;return r.createElement(s,{fallback:n},e)},e.defaultProps={fallback:null},e}(o);e.a=a},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"b",(function(){return l}));var i=n(7);function r(){return Object(i.a)().environmentType}function o(){return window.location.host.toLocaleLowerCase()}function s(){return o().indexOf("forms.microsoft")>=0}function a(){var t=r();return/.*(Prod|Int|Tip|CVFastfood)$/.test(t)}function c(){return o().indexOf(".forms.osi.office.net")>0}function u(){var t=r();return/.*Prod$/.test(t)||"CVTip"===t||"CVFastfood"===t}function l(){switch(r()){case"WWProd":case"MSProd":case"CVProd":case"CVTip":case"CVFastfood":return"9188040d-6c67-4c5b-b112-36a304b66dad";default:return"4925308c-f164-4d2d-bc7e-0631132e9375"}}},function(t,e,n){"use strict";n.d(e,"c",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return b}));var i,r,o=n(2),s=n(0),a=n(10),c=n(40),u=n(39);function l(){return function(){if(!i){var t=Object(a.c)((function(){return{ALLOWED_ATTR:["style","href","target"],ALLOWED_TAGS:["strong","em","u","a","b","i"]}}),a.f);(i=n.e(120).then(n.t.bind(null,269,7)).then((function(e){return function(n){return e.sanitize(n,t)}}))).then((function(t){r=t}))}return i}()&&r}function h(t){return l()?r(t):t}function f(t,e){return e?t?$("<div/>").html(t).text():"":t}function d(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(120).then(n.bind(null,383))];case 1:return[2,{default:t.sent().EditorRibbonCombination}]}}))}))}function b(t){var e=Object(u.a)(b,d);return s.createElement(c.a,null,s.createElement(e,Object(o.__assign)({},t)))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l}));var i=n(2),r=n(0),o=n(3),s=n(9),a=n(33),c=n(8);function u(t){return r.createElement(l,Object(i.__assign)({},t))}var l=function(t){function e(e){var n=t.call(this,e)||this;return n.Ut=o.uniqueId("b"),n.$t=r.createRef(),n.Wt=0,n.state={ShowTooltip:!1},n.Kt=n.Kt.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){window.clearTimeout(this.Wt)},n.componentDidUpdate=function(){var t=this.$t.current;if(this.state.ShowTooltip&&t){var e=t.getBoundingClientRect(),n=this.getHtmlElement();if(e.right>window.innerWidth){var i=n.getBoundingClientRect();t.style.left="auto",t.style.right=i.right-window.innerWidth+"px"}e.bottom>window.innerHeight&&(t.style.bottom=n.clientHeight+"px")}},n.render=function(){var t=this,e=o.extend({},this.props.HTMLAttributes);switch(e.className=Object(s.b)(e.className,"button-control"),e["aria-pressed"]=this.props.ToggleActive,this.props.ToggleActive&&(e.className=Object(s.b)(e.className,"active")),this.props.ButtonStyle){case"LightBackground":e.className=Object(s.b)(e.className,"light-background-button");break;case"DarkBackGround":e.className=Object(s.b)(e.className,"dark-background-button")}var n=null,c=this.props.Tooltip,u=e.title;if(Object(a.a)().Flighting.isEnabled("A11yTooltip")&&(c||u)){var l=void 0;u&&u!==c&&(l=r.createElement("span",{key:"s"},u));var f=void 0;if(c){var d=void 0;e["aria-label"]===c||e["aria-describedby"]||(d=this.Ut+"-tooltip",e["aria-describedby"]=d),f=r.createElement("span",{id:d,key:"t"},c)}var b=this.state.ShowTooltip?"button-tooltip":"screenReaderReference";n=r.createElement("div",{className:b,key:"t",onClick:h,ref:this.$t},l,f),e.title=void 0,e.onKeyUp=Object(s.k)(e.onKeyUp,this.Kt),e.onFocus=Object(s.k)(e.onBlur,(function(){return t.Jt(!0)})),e.onMouseOver=Object(s.k)(e.onMouseOver,(function(){return t.Jt(!0)})),e.onBlur=Object(s.k)(e.onBlur,(function(){return t.Jt(!1)})),e.onMouseOut=Object(s.k)(e.onMouseOut,(function(){return t.Jt(!1)}))}return r.createElement("button",Object(i.__assign)({},e),r.createElement("div",{className:"button-content"},this.props.children),n)},n.focus=function(){this.getHtmlElement().focus()},n.Kt=function(t){this.state.ShowTooltip&&27===t.keyCode&&(t.stopPropagation(),this.setState({ShowTooltip:!1}))},n.Jt=function(t){var e=this;window.clearTimeout(this.Wt),this.state.ShowTooltip!==t&&(this.Wt=window.setTimeout((function(){e.setState({ShowTooltip:t}),e.Wt=0}),t?500:300))},e}(c.a);function h(t){t.stopPropagation()}},function(t,e,n){"use strict";function i(t){return new Promise((function(e,n){t.then(e,n)}))}function r(t){var e=function(){return Promise.resolve(null)};return t?t.then(e,e):e()}function o(){return new Promise((function(){}))}var s;n.d(e,"f",(function(){return i})),n.d(e,"d",(function(){return r})),n.d(e,"e",(function(){return o})),n.d(e,"b",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"a",(function(){return c})),function(t){t[t.Pending=0]="Pending",t[t.Resolved=1]="Resolved",t[t.Rejected=2]="Rejected"}(s||(s={}));var a=function(){function t(t){var e=this;t.then((function(){e.Xt=s.Resolved}),(function(){e.Xt=s.Rejected})),this.Zt=t,this.Xt=s.Pending}var e=t.prototype;return e.promise=function(){return this.Zt},e.states=function(){return this.Xt},t}(),c=function(){function t(){var t=this;this.Zt=new a(new Promise((function(e,n){t.Yt=e,t.ee=n})))}var e=t.prototype;return e.promise=function(){return this.Zt.promise()},e.resolve=function(t){return this.Yt(t),this},e.reject=function(t){return this.ee(t),this},e.states=function(){return this.Zt.states()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"e",(function(){return m})),n.d(e,"d",(function(){return v})),n.d(e,"b",(function(){return g}));var i,r,o=n(2),s=n(3),a=n(6),c=n(4),u=n(19),l=n(7),h=n(33),f=n(13),d=n(22),b={Layout:c.a.enumeration((function(){return i})),Size:c.a.enumeration((function(){return r})),NaturalWidth:c.a.number(),NaturalHeight:c.a.number(),ContainerWidth:c.a.number(),ContainerHeight:c.a.number(),ActualWidth:c.a.number(),ActualHeight:c.a.number(),Left:c.a.number(),Top:c.a.number()};function m(t){return a.a.getObjectMasterFromModel(t)}function v(t,e,n){t.fieldsReady([e]).then((function(){var i=t.getModelByFieldSchema(e),r=Object(d.e)(i);t.ensureFieldsReady([n]).then((function(){var e=m(t.getModelByFieldSchema(n));r.setSettingsMaster(e)}))}))}!function(t){t[t.Horizontal=1]="Horizontal",t[t.Vertical=2]="Vertical",t[t.Square=3]="Square"}(i||(i={})),function(t){t[t.Small=1]="Small",t[t.Large=2]="Large"}(r||(r={}));var g=function(t){function e(e){var n=t.call(this,e)||this;return e.MasterTreeReady&&e.MasterTreeReady.then((function(){var t=n.Parent;t instanceof f.a&&t.fieldsReady([f.a.Schema.LogoInfo]).then((function(){t.Model.LogoInfo===n.Model&&(n.ne=!0)}))})),n}Object(o.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"IsFormLogo",{get:function(){return this.ne},enumerable:!1,configurable:!0}),n.validateImageSettings=function(t){var e=s.clone(this.getSnapshot());if(744===e.ContainerWidth&&(e.ContainerHeight=e.ContainerHeight*Object(u.E)()/e.ContainerWidth,e.ContainerWidth=Object(u.E)(),!t)){var n=this.Model;n.ContainerWidth=e.ContainerWidth,n.ContainerHeight=e.ContainerHeight}if(null==e.ContainerHeight||null==e.ContainerWidth||null==e.ActualHeight||null==e.ActualWidth||null==e.Top||this.IsFormLogo&&(120!==e.ContainerHeight||120!==e.ContainerWidth)||e.Left>0||e.ContainerWidth>e.Left+e.ActualWidth||e.Top>0||e.ContainerHeight>e.Top+e.ActualHeight){var i=this.getDefaultImageSettings();for(var r in i)e[r]=Math.round(i[r]),t||(this.Model[r]=e[r])}return e},n.calcLogoLayout=function(t){var e,n,r,o=(this.Model.NaturalWidth||Object(u.s)())/(this.Model.NaturalHeight||Object(u.q)()),s=(t=t||{}).isSmallSize,a=t.isMobile,c=t.isSlimSize;if(a)(n=(e=c?30:s?70:80)*o)>e?(n=(e=c?40:e)*o,r=i.Vertical):r=i.Horizontal;else{var l=void 0;s?(e=70,l=125):c?(e=40,l=95):(e=120,l=215),(n=e*o)>l?(n=(e=c?30:s?40:70)*o,r=i.Vertical):r=i.Horizontal}return{ActualWidth:n=Math.min(n,750),ActualHeight:e,Layout:r}},n.getDefaultImageSettings=function(){var t,e=this.Model;e.NaturalHeight&&e.NaturalWidth?t={NaturalHeight:e.NaturalHeight,NaturalWidth:e.NaturalWidth}:t={NaturalHeight:e.NaturalHeight||Object(u.q)(),NaturalWidth:e.NaturalWidth||Object(u.s)()};if((!Object(h.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")||!Object(l.a)().userInfo.IsMsa)&&this.IsFormLogo)return t;var n=this.ie();if(null==n.Height?(t.ContainerWidth=n.Width,t.ContainerHeight=n.Width*t.NaturalHeight/t.NaturalWidth):null==n.Width?(t.ContainerWidth=n.Height*t.NaturalWidth/t.NaturalHeight,t.ContainerHeight=n.Height):(t.ContainerWidth=n.Width,t.ContainerHeight=n.Height),null==n.Height||null==n.Width)t.Left=0,t.Top=0,t.ActualWidth=t.ContainerWidth,t.ActualHeight=t.ContainerHeight;else{var i=Math.max(t.ContainerWidth/t.NaturalWidth,t.ContainerHeight/t.NaturalHeight);t.ActualWidth=i*t.NaturalWidth,t.ActualHeight=i*t.NaturalHeight,t.Left=(t.ContainerWidth-t.ActualWidth)/2,t.Top=(t.ContainerHeight-t.ActualHeight)/2}return t},n.ie=function(){var t=this.Model;if(this.IsFormLogo)return{Height:120,Width:120};if(null==t.Size||t.Size===r.Small)switch(t.Layout){case i.Square:return{Width:314,Height:314};case i.Vertical:return{Height:314};case i.Horizontal:default:return{Width:314}}else switch(t.Layout){case i.Square:return{Width:414,Height:414};case i.Vertical:return{Height:414};case i.Horizontal:default:return{Width:Object(u.E)()}}},e}(a.a.createObjectMasterClass("ImageSettingsMaster",b))},function(t,e,n){"use strict";n.d(e,"c",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"f",(function(){return h})),n.d(e,"e",(function(){return f})),n.d(e,"b",(function(){return d}));var i=n(96),r=n(15),o=n(7),s=n(34);function a(t){return b().then((function(){window.location.assign(t)}))}function c(){return l(!1)}function u(){return l(!0)}function l(t){return b().then((function(){window.location.reload(t)}))}function h(t){return b().then((function(){window.location.replace(t)}))}function f(t){return b().then((function(){var e=window.location,n=e.origin+t+e.search+e.hash;window.location.replace(n)}))}function d(){var t=encodeURIComponent(window.location.href),e=Object(o.a)().userInfo.IsMsa,n="Response"===Object(r.m)(),i=Object(o.a)().signInLink;return!e||n?i=Object(s.d)(i,"state",t):(i=Object(o.a)().signInLinkMsa,i=Object(s.d)(i,"redirecturl",t)),i}function b(){return Object(i.a)()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"d",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"k",(function(){return C})),n.d(e,"j",(function(){return k})),n.d(e,"q",(function(){return T})),n.d(e,"p",(function(){return x})),n.d(e,"l",(function(){return F})),n.d(e,"m",(function(){return P})),n.d(e,"o",(function(){return D})),n.d(e,"n",(function(){return M})),n.d(e,"f",(function(){return L})),n.d(e,"i",(function(){return A})),n.d(e,"h",(function(){return R})),n.d(e,"g",(function(){return E})),n.d(e,"r",(function(){return B})),n.d(e,"e",(function(){return _}));var i,r,o,s,a,c,u,l,h,f,d,b,m,v,g,O,p,j,y,w,S,N=n(180),I=n(82);function C(){return f}function k(){return d}function T(){return b}function x(){return m}function F(){return v}function P(){return y}function D(){return w}function M(){return S}function L(){return g}function A(){return O}function R(){return p}function E(){return j}function B(t,e){var n=Object(I.g)(t.map((function(t){var e=t.licenseName,n=t.skus;return[e.toUpperCase(),JSON.parse(n)]})));return function(t){for(var e in i)if(t.hasOwnProperty(i[e])){var n=t[i[e]];if(n&&n.length>0)return void(f=!0)}f=!1}(n),function(t){for(var e in r)if(t.hasOwnProperty(r[e])){var n=t[r[e]];if(n&&n.length>0)return d=!0,void(g=parseInt(e))}d=!1}(n),function(t){for(var e in o){if(t.hasOwnProperty(o[e]))if((n=t[o[e]])&&n.length>0){m=!0,O=parseInt(e);break}}for(var e in s){if(t.hasOwnProperty(s[e]))if((n=t[s[e]])&&n.length>0){p=parseInt(e);break}}for(var e in a){var n;if(t.hasOwnProperty(a[e]))if((n=t[a[e]])&&n.length>0){j=parseInt(e);break}}}(n),function(t){b=!(!Object(N.b)()||!t)}(e),function(t){for(var e in c)if(t.hasOwnProperty(c[e])){var n=t[c[e]];if(n&&n.length>0)return void(v=!0)}v=!1}(n),function(t){for(var e in u){if(t.hasOwnProperty(u[e]))(n=t[u[e]])&&n.length>0&&(y=!0)}for(var e in l){if(t.hasOwnProperty(l[e]))(n=t[l[e]])&&n.length>0&&(S=!0)}for(var e in h){var n;if(t.hasOwnProperty(h[e]))(n=t[h[e]])&&n.length>0&&(w=!0)}}(n),n}function _(){var t=0;return C()&&(t=1),k()&&(t|=2),Object(N.c)()&&(t|=8),Object(N.b)()&&(T()?t|=16:t|=4),F()&&(t|=64,P()?t|=128:M()?t|=256:D()&&(t|=512)),t}!function(t){t[t.OFFICE_FORMS_PLAN_2=0]="OFFICE_FORMS_PLAN_2",t[t.OFFICE_FORMS_PLAN_3=1]="OFFICE_FORMS_PLAN_3"}(i||(i={})),function(t){t[t.FORMS_PLAN_E1=0]="FORMS_PLAN_E1",t[t.FORMS_PLAN_E3=1]="FORMS_PLAN_E3",t[t.FORMS_PLAN_E5=2]="FORMS_PLAN_E5",t[t.FORMS_PLAN_K=3]="FORMS_PLAN_K"}(r||(r={})),function(t){t[t.FORMS_GOV_E1=0]="FORMS_GOV_E1",t[t.FORMS_GOV_E3=1]="FORMS_GOV_E3",t[t.FORMS_GOV_E5=2]="FORMS_GOV_E5",t[t.FORMS_GOV_F1=3]="FORMS_GOV_F1"}(o||(o={})),function(t){t[t.FORMS_GCCHIGH_E1=0]="FORMS_GCCHIGH_E1",t[t.FORMS_GCCHIGH_E3=1]="FORMS_GCCHIGH_E3",t[t.FORMS_GCCHIGH_E5=2]="FORMS_GCCHIGH_E5",t[t.FORMS_GCCHIGH_F1=3]="FORMS_GCCHIGH_F1"}(s||(s={})),function(t){t[t.FORMS_DOD_E1=0]="FORMS_DOD_E1",t[t.FORMS_DOD_E3=1]="FORMS_DOD_E3",t[t.FORMS_DOD_E5=2]="FORMS_DOD_E5",t[t.FORMS_DOD_F1=3]="FORMS_DOD_F1"}(a||(a={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO",t[t.FORMS_PRO_USL=1]="FORMS_PRO_USL",t[t.FORMS_PRO_USL_GCC=2]="FORMS_PRO_USL_GCC",t[t.FORMS_PRO_CE=3]="FORMS_PRO_CE",t[t.FORMS_PRO_SERVICE=4]="FORMS_PRO_SERVICE",t[t.FORMS_PRO_FS=5]="FORMS_PRO_FS",t[t.FORMS_PRO_MARKETING=6]="FORMS_PRO_MARKETING",t[t.FORMS_PRO_PLAN=7]="FORMS_PRO_PLAN",t[t.FORMS_PRO_PS=8]="FORMS_PRO_PS",t[t.FORMS_PRO_SALESENT=9]="FORMS_PRO_SALESENT",t[t.FORMS_PRO_TALENT=10]="FORMS_PRO_TALENT",t[t.FORMS_PRO_OPERATIONS=11]="FORMS_PRO_OPERATIONS",t[t.FORMS_PRO_RELATIONSHIP_SALES=12]="FORMS_PRO_RELATIONSHIP_SALES",t[t.FORMS_PRO_CUSTOMER_INSIGHTS=13]="FORMS_PRO_CUSTOMER_INSIGHTS",t[t.FORMS_PRO_SERVICE_GCC=14]="FORMS_PRO_SERVICE_GCC",t[t.FORMS_PRO_FS_GCC=15]="FORMS_PRO_FS_GCC",t[t.FORMS_PRO_HUMAN_RESOURCES_GCC=16]="FORMS_PRO_HUMAN_RESOURCES_GCC",t[t.FORMS_PRO_PS_GCC=17]="FORMS_PRO_PS_GCC",t[t.FORMS_PRO_SALESENT_GCC=18]="FORMS_PRO_SALESENT_GCC"}(c||(c={})),function(t){t[t.FORMS_PRO_USL=0]="FORMS_PRO_USL",t[t.FORMS_PRO_USL_GCC=1]="FORMS_PRO_USL_GCC"}(u||(u={})),function(t){t[t.FORMS_PRO_CE=0]="FORMS_PRO_CE",t[t.FORMS_PRO_SERVICE=1]="FORMS_PRO_SERVICE",t[t.FORMS_PRO_FS=2]="FORMS_PRO_FS",t[t.FORMS_PRO_MARKETING=3]="FORMS_PRO_MARKETING",t[t.FORMS_PRO_PLAN=4]="FORMS_PRO_PLAN",t[t.FORMS_PRO_PS=5]="FORMS_PRO_PS",t[t.FORMS_PRO_SALESENT=6]="FORMS_PRO_SALESENT",t[t.FORMS_PRO_TALENT=7]="FORMS_PRO_TALENT",t[t.FORMS_PRO_OPERATIONS=8]="FORMS_PRO_OPERATIONS",t[t.FORMS_PRO_RELATIONSHIP_SALES=9]="FORMS_PRO_RELATIONSHIP_SALES",t[t.FORMS_PRO_CUSTOMER_INSIGHTS=10]="FORMS_PRO_CUSTOMER_INSIGHTS",t[t.FORMS_PRO_SERVICE_GCC=11]="FORMS_PRO_SERVICE_GCC",t[t.FORMS_PRO_FS_GCC=12]="FORMS_PRO_FS_GCC",t[t.FORMS_PRO_HUMAN_RESOURCES_GCC=13]="FORMS_PRO_HUMAN_RESOURCES_GCC",t[t.FORMS_PRO_PS_GCC=14]="FORMS_PRO_PS_GCC",t[t.FORMS_PRO_SALESENT_GCC=15]="FORMS_PRO_SALESENT_GCC"}(l||(l={})),function(t){t[t.FORMS_PRO=0]="FORMS_PRO"}(h||(h={}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(8),s=n(12),a=n(42),c=n(10),u=n(130),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t,e=this.props,n=e.Html;e.RenderHtml&&!Object(c.b)((function(){return!Object(s.c)("TextFormat")}))||(n=Object(u.a)(e.Html)),t=Object(s.g)()?Object(a.c)(n):n;var o={id:e.Id,dangerouslySetInnerHTML:{__html:t}};return r.createElement("span",Object(i.__assign)({},o))},e}(o.a);function h(t){return r.createElement(f,Object(i.__assign)({},t))}var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t;return"RichText"===(this.props.RenderMode||"PlainText")?(t={id:this.props.Id,Html:this.props.Text,RenderHtml:this.props.ContainsHtml},r.createElement(l,Object(i.__assign)({},t))):(t={id:this.props.Id},r.createElement("span",Object(i.__assign)({},t),this.props.Text))},e}(o.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"g",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"e",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"f",(function(){return f}));var i=n(50),r=n(1),o=n(10);function s(t){return Object(i.d)()?2===t||3===t||4===t:3===t||4===t}function a(t){return Object(i.d)()&&2===t}function c(t){return 3===t||4===t}function u(t){return 4===t}function l(t){return 3===t}function h(t,e){switch(e){case"Design":case"Analyze":case"ShareForm":return function(t){switch(t){case 4:return Object(o.c)((function(){return Object(r.a)().Phishing_Form_Warning_Message_100}),o.f);case 3:return Object(i.d)()?Object(o.c)((function(){return Object(r.a)().Phishing_Form_Warning_Message_2}),o.f):Object(o.c)((function(){return Object(r.a)().Phishing_Form_Warning_Message_2_AAD}),o.f);case 2:return Object(o.c)((function(){return Object(r.a)().Phishing_Form_Warning_Message_1}),o.f);default:return""}}(t);case"Response":return function(t){switch(t){case 4:return Object(o.c)((function(){return Object(r.a)().Phishing_Form_ResponsePage_Warning_Message_4}),o.f);case 3:return Object(o.c)((function(){return Object(r.a)().Phishing_Form_ResponsePage_Warning_Message_2}),o.f);case 2:return Object(o.c)((function(){return Object(r.a)().Phishing_Form_ResponsePage_Warning_Message_1}),o.f);default:return""}}(t);default:return}}function f(t){var e=t;return!(!e||6102!==e.innerCode&&6106!==e.innerCode)}},function(t,e,n){"use strict";n.d(e,"h",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"g",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"e",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"f",(function(){return b})),n.d(e,"c",(function(){return m}));var i=n(15),r=n(41),o=n(81),s=null,a=null;function c(t){s=t}function u(){return s&&s()}function l(t){a=t}function h(){return a&&a()}function f(){var t=Object(o.a)(u()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===Object(i.k)()}function d(){var t=Object(o.a)(u()||"");return!!t.OrgId&&t.OrgId.toLowerCase()===Object(r.b)()}function b(){var t=Object(o.a)(u()||"");return!!t.OrgId&&-1!==Object(i.g)().indexOf(t.OrgId.toLowerCase())}function m(){var t=u();return t&&Object(o.a)(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(6),o=n(58),s=n(13),a=n(17),c=function(){function t(t){this.formMaster=t}var e=t.prototype;return Object.defineProperty(t,"QuestionOrderFloor",{get:function(){return 500},enumerable:!1,configurable:!0}),Object.defineProperty(t,"QuestionOrderDefaultStep",{get:function(){return 100},enumerable:!1,configurable:!0}),t.isDescriptiveElement=function(t){return"Question.ColumnGroup"===t},t.isSection=function(t){return"Question.ColumnGroup"===t},Object.defineProperty(e,"TopQuestionMasters",{get:function(){return i.filter(this.formMaster.Model.Questions,(function(t){return!t.GroupId})).map(r.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HeaderTopQuestionMasters",{get:function(){var t=this.SectionMasters,e=t.length&&t[0].Model.Order;return e>0?this.re(null,e):this.TopQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HeaderQuestionMasters",{get:function(){var t=this.SectionMasters,e=t.length&&t[0].Model.Order;return e>0?this.re(null,e,!0):this.QuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionMasters",{get:function(){return r.a.convertToArray(this.formMaster.Model.Questions).map(r.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DescriptiveElementMasters",{get:function(){return r.a.convertToArray(this.formMaster.Model.DescriptiveElements).map(r.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SectionMasters",{get:function(){return i.filter(this.DescriptiveElementMasters,(function(e){return t.isDescriptiveElement(e.Model.Type)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e,"AllElementMasters",{get:function(){return this.getAllElements().map(r.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TopElementMasters",{get:function(){return this.se(!0).map(r.a.getObjectMasterFromModel)},enumerable:!1,configurable:!0}),e.getQuestionById=function(t){var e=r.a.Collection.getItemWithKeyFields(this.formMaster.Model.Questions,{Id:t});return e&&Object(a.h)(e)},e.getElementMasterById=function(t){return this.getQuestionById(t)||this.getDescriptiveElementMasterById(t)},e.getDescriptiveElementMasterById=function(t){var e=r.a.Collection.getItemWithKeyFields(this.formMaster.Model.DescriptiveElements,{Id:t});return e&&Object(o.c)(e)},e.findQuestionsInSection=function(t,e){if(t){var n=this.SectionMasters,r=i.indexOf(n,t);return r>=0?this.re(n[r].Model.Order,r+1<n.length?n[r+1].Model.Order:null,e):[]}return e?this.HeaderQuestionMasters:this.HeaderTopQuestionMasters},e.findContainerSection=function(t){var e=this.SectionMasters;return e[i.findLastIndex(e,(function(e){return e.Model.Order<=t.Model.Order}))]},e.adjustElementOrders=function(){var e=this;if(this.formMaster.isFieldReady(s.a.Schema.Questions)){var n=this.formMaster.isFieldReady(s.a.Schema.DescriptiveElements),i=this.getAllElements();i.length&&this.formMaster.bulkEdit((function(){i.sort(t.questionComparer),i[0].Order||(i[0].Order=t.QuestionOrderFloor+t.QuestionOrderDefaultStep);for(var r=0,o=i[0].Order,s=1;s<=i.length;++s){var a=i[s]&&i[s].Order;if(!a)break;if(o!==a){var c=(a-o)/(s-r);for(o+=c;++r<s;)i[r].Order=o,o+=c}}for(;++r<i.length;)o+=t.QuestionOrderDefaultStep,i[r].Order=o;e.formMaster.Model.Questions=i.filter((function(e){return!t.isDescriptiveElement(e.Type)})).map((function(t){return t})),n&&(e.formMaster.Model.DescriptiveElements=i.filter((function(e){return t.isDescriptiveElement(e.Type)})))}))}},e.getSectionNodes=function(){var t=this,e=[],n=this.HeaderTopQuestionMasters;return n.length&&e.push({TopQuestionMasters:n}),this.SectionMasters.forEach((function(n){e.push({Section:n,TopQuestionMasters:t.findQuestionsInSection(n)})})),e},e.getAllElements=function(){return this.se(!1)},e.se=function(e){var n=r.a.convertToArray(this.formMaster.Model.Questions);e&&(n=i.filter(n,(function(t){return!t.GroupId})));var o=n;return this.formMaster.isFieldReady(s.a.Schema.DescriptiveElements)&&(o=o.concat(r.a.convertToArray(this.formMaster.Model.DescriptiveElements)).sort(t.questionComparer)),o},t.questionComparer=function(t,e){var n=t.Order-e.Order;return t.Order&&e.Order||(n=-n),n||t.Id.localeCompare(e.Id)},e.re=function(t,e,n){var i;return i=n?this.QuestionMasters:this.TopQuestionMasters,null!==e&&(i=i.filter((function(t){return e>t.Model.Order}))),null!==t&&(i=i.filter((function(e){return e.Model.Order>=t}))),i},t}()},function(t,e,n){"use strict";function i(){return t=[s()+s(),s(),s(),s(),s()+s()+s()].join("-"),e=parseInt(t.charAt(19),16),n=(e=3&e|8).toString(16),t=a(t,14,"4"),t=a(t,19,n);var t,e,n}function r(t){return/^[0-9a-fA-F\-]*$/.test(t)&&/^[^\-]{8}(\-[^\-]{4}){4}[^\-]{8}$/.test(t)}function o(t){var e=t.match(/[0-9a-fA-F]*/g),n="";return e.map((function(t){return n+=t})),!t||/^[0-]*$/.test(t)}function s(){return function(t,e,n){for(var i=t.length,r=n.length;i<e;i+=r)t=n+t;return t}(Math.floor(65536*Math.random()).toString(16),4,"0")}function a(t,e,n){return t.substring(0,e)+n+t.substring(e+1)}n.d(e,"c",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return l})),n.d(e,"f",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"d",(function(){return b})),n.d(e,"i",(function(){return m})),n.d(e,"j",(function(){return v})),n.d(e,"h",(function(){return g})),n.d(e,"m",(function(){return O})),n.d(e,"k",(function(){return p})),n.d(e,"n",(function(){return y})),n.d(e,"g",(function(){return w})),n.d(e,"p",(function(){return S})),n.d(e,"e",(function(){return N})),n.d(e,"l",(function(){return I})),n.d(e,"o",(function(){return C}));var i=n(3),r=n(6);function o(t){return[].concat.apply([],t)}var s=n(74);function a(t){return o(t.getResponses().map((function(t){return r.a.convertToArray(t.Answers)})))}function c(t,e){return o(t.getResponses().filter((function(t){return t.Id===e})).map((function(t){return r.a.convertToArray(t.Answers)})))}function u(t,e){var n=a(t),r=t.getWrappedForm().getQuestionById(e).SubQuestionMasters.map((function(t){return t.Model.Id}));return n.filter((function(t){return t.QuestionId===e||i.contains(r,t.QuestionId)}))}function l(t,e){var n=u(t,e);return n.filter((function(t){return n[0]&&t.QuestionId===n[0].QuestionId}))}function h(t){return i.reduce(t,(function(t,e){return t+(e&&e.Score?e.Score:0)}),0)}function f(t,e){return t.getResponses().filter((function(t){return t.Id===e}))[0]}function d(t,e,n){var r=f(t,e);if(r){var o=t.getWrappedForm().getQuestionById(n).SubQuestionMasters;if(o.length>0){var a=i.map(o,(function(t){return t.Model.Id})),c=i.filter(r.Answers,(function(t){return-1!==a.indexOf(t.QuestionId)}));return c[c.length-1]}return Object(s.c)(r,n)}}function b(t,e){var n,r=c(t,e).map((function(t){return t.QuestionId})),o=t.getWrappedForm().FormElementManager.QuestionMasters.filter((function(t){var e=i.contains(r,t.Model.Id),n=t.SubQuestionMasters.length>0&&i.filter(t.SubQuestionMasters,(function(t){return i.contains(r,t.Model.Id)})).length>0;return e||n})),s=i.map(o,(function(t){return t.Model}));return n=s,i.reduce(n,(function(t,e){return t+(e&&e.Point?e.Point:0)}),0)}function m(t,e){return h(c(t,e))}function v(t,e){var n=function(t,e){return t.getQuestions().filter((function(t){return t.Id===e}))[0]}(t,e);return(n&&n.Point?n.Point:0)*l(t,e).length}function g(t,e){return h(u(t,e))}function O(t){var e=a(t),n=t.getQuestions().filter((function(t){return t.IsQuiz})),r=[];e.forEach((function(t){null!=i.find(n,(function(e){return t.QuestionId===e.Id}))&&r.push(t)}));var o=r.map((function(t){return t.Score}));return i.every(o,i.isNumber)}function p(t){return!a(t).every(I)}function j(){return new Date("0001-01-01T00:00:00Z")}function y(t){var e=new Date,n=t.getResponses().map((function(t){return t.ReleaseDate})).filter((function(t){return!!t}));return i.every(n,(function(t){return t<=e&&t>j()}))}function w(t){return null==t?void 0:t.Feedback}function S(t){var e=t.ReleaseDate;return e&&e<=new Date&&e>j()}function N(t){return t.getResponses().filter(S)}function I(t){return t.IsAutoGraded}function C(){var t=document.getElementById("grading-by-people-tab");return!!t&&"true"===t.getAttribute("aria-selected")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"c",(function(){return u}));var i,r=n(7),o=decodeURI(Object(r.a)().webSettings||"{}"),s={};function a(t){var e,n;if(void 0===i)try{i=JSON.parse(o)}catch(t){i={}}return null!==(n=null!==(e=i[t])&&void 0!==e?e:s[t])&&void 0!==n?n:""}function c(t){var e=a(t);if(e)try{return JSON.parse(e)}catch(t){}return null}function u(t,e){var n=a(t);if(n){var i=parseInt(n);if(!isNaN(i))return i}return e}function l(t,e){s[t]=e}l("CustomerVoiceTransitionCompletionDate","08/30/2020"),l("CustomerVoiceUrl","https://customervoice.microsoft-int.com")},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(40),s=n(39);function a(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(110).then(n.bind(null,375))];case 1:return[2,{default:t.sent().MathjaxFormulaRenderer}]}}))}))}function c(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(110).then(n.bind(null,382))];case 1:return[2,{default:t.sent().VirtualKeyboardControl}]}}))}))}function u(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(110).then(n.bind(null,376))];case 1:return[2,{default:t.sent().FormulaDesigner}]}}))}))}function l(t){var e=Object(s.a)(l,c);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function h(t){var e=Object(s.a)(h,a);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function f(t){var e=Object(s.a)(f,u);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(2),r=n(0),o=n(12),s=n(48),a=n(123),c=n(192),u=n(18);function l(t){return r.createElement(h,t)}var h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ae=!1,e.ce=!1,e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.ce=!0,this.ae||window.setTimeout((function(){t.ae=!0,t.ce&&t.forceUpdate()}))},n.componentWillUnmount=function(){this.ce=!1},n.createReactNodes=function(){var t,e=this.props,n=e.ShowRequiredStar?r.createElement(c.a):void 0,i=e.ShowOrdinal?r.createElement("span",{className:"ordinal-number",key:"ordinalNumber"},this.props.Ordinal+"."):void 0;e.Alert&&!this.ae||(t=Object(s.b)({ContainsHtml:Object(o.g)()&&!!e.HtmlContent,Text:e.Label,RenderMode:Object(o.g)()?"RichText":void 0}));var a=e.ShowWarningIcon&&Object(u.b)({HTMLAttributes:{className:"forms-icon-size20x20 warning-icon-style",title:e.WarningIconTooltip},Accessible:!0,IconName:"Error"});return e.Bold?[r.createElement("b",void 0,i,t,n),e.children]:[i,t,n,a,e.children]},e}(a.a)},function(t,e,n){"use strict";var i,r,o,s;n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return b}));var a=null,c=null;function u(){return i||(i=l())instanceof m&&(i=h()),i}function l(){return r||(r=d()?window.localStorage:f()),r}function h(){return o||(o=b()?window.sessionStorage:f()),o}function f(){return s||(s=new m),s}function d(){if(null==a)try{var t="officeforms.__storage_test__";window.localStorage.setItem(t,t),window.localStorage.removeItem(t),a=!0}catch(t){a=!1}return a}function b(){if(null==c)try{var t="officeforms.__storage_test__";window.sessionStorage.setItem(t,t),window.sessionStorage.removeItem(t),c=!0}catch(t){c=!1}return c}var m=function(){function t(){}var e=t.prototype;return e.clear=function(){},e.getItem=function(t){},e.key=function(t){return null},e.removeItem=function(t){},e.setItem=function(t,e){},t}()},function(t,e,n){"use strict";n.d(e,"c",(function(){return N})),n.d(e,"b",(function(){return I})),n.d(e,"a",(function(){return C}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(1),c=n(11),u=n(44),l=n(83),h=n(14),f=n(5),d=n(148),b=n(113),m=n(22),v=n(45),g=n(31),O=n(25),p=function(){function t(t,e){this.ue=t,this.N=Object(g.i)(this.ue.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.ue.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ElementId",{get:function(){return this.ue.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ElementType",{get:function(){return this.ue.Model.Type},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExtraQosData",{get:function(){var t=this.ue.Form;return{WithSection:t.isFieldReady(t.Schema.DescriptiveElements)&&!!t.FormElementManager.SectionMasters.length}},enumerable:!1,configurable:!0}),e.add=function(t){var e=this;if(this.ue.Form.SyncContext!==O.a.DesignTimeForm)throw Error("Trying to create an element without design type.");return this.ue.createSyncJob((function(){return e.N.createFormDescriptiveElement(e.FormId,t,e.ExtraQosData)}))},e.delete=function(t){var e=this;if(!t||!t.id)throw Error("Trying to delete an empty element.");if(this.ue.Form.SyncContext!==O.a.DesignTimeForm)throw Error("Trying to delete an element without design type.");return this.ue.createSyncJob((function(){return e.N.deleteFormDescriptiveElement(e.FormId,t.id||"",e.ElementType,e.ExtraQosData)})).then(null,(function(t){if(t&&621===t.innerCode)return Promise.resolve();throw t}))},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){var n=this;return this.ue.Form.SyncContext!==O.a.DesignTimeForm?Promise.resolve():this.ue.createUploadSyncJob((function(){return n.N.updateFormDescriptiveElement(n.FormId,n.ElementId,n.ElementType,t,n.ExtraQosData)}))},t}(),j=n(137),y=n(154),w=n(70),S={BranchInfo:s.a.fromMasterClass((function(){return d.a}),{IsLocalField:!0}),CoAuthors:s.a.collectionOf(s.a.reference(),{IsLocalField:!0}),FileUploadSPOInfo:s.a.create({anonymousLinkInfo:s.a.string(),driveId:s.a.string(),errorCode:s.a.string(),folderId:s.a.string(),linkInfo:s.a.string()},{SourceFieldName:"fileUploadSPOInfo"}),FormsProRTQuestionTitle:s.a.string({SourceFieldName:"formsProRTQuestionTitle"}),FormsProRTSubtitle:s.a.string({SourceFieldName:"formsProRTSubtitle"}),Id:s.a.string({IsKeyField:!0,SourceFieldName:"id"}),ImageInfo:s.a.fromMasterClass(c.f,{SourceFieldName:"image"}),ImageSettings:s.a.fromMasterClass(c.g,{IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),Order:s.a.number({SourceFieldName:"order"}),QuestionInfo:s.a.string({SourceFieldName:"questionInfo"}),SavingState:s.a.reference({IsLocalField:!0}),ShowSubtitle:s.a.boolean({IsLocalField:!0}),Subtitle:s.a.string({SourceFieldName:"subtitle"}),Title:s.a.string({SourceFieldName:"title"}),Type:s.a.reference({SourceFieldName:"type"}),VideoInfo:s.a.create({Author:s.a.string(),OriginalHeight:s.a.number(),OriginalWidth:s.a.number(),ShowWarningBar:s.a.boolean(),Thumbnail_url:s.a.string(),Title:s.a.string(),Url:s.a.string()},{IsLocalField:!0})};function N(t){return o.a.getObjectMasterFromModel(t)}function I(){return{Title:Object(a.a)().DesciptiveElementType_Section_DefaultTitle,Type:"Question.ColumnGroup"}}var C=function(t){function e(n){var i=this,o=new u.a;if(!n.InitialData)throw Error("Element model should created with initial data.");return(n=r.clone(n)).InitialData=r.clone(n.InitialData),n.InitialData.FormsProRTQuestionTitle||(n.InitialData.FormsProRTQuestionTitle=null),n.InitialData.FormsProRTSubtitle||(n.InitialData.FormsProRTSubtitle=null),i=t.call(this,n,{MasterReady:o.promise(),Scheduler:new b.a(e.name)})||this,Object(w.b)(i),i.le(),i.ct(n),Object(v.d)(i,e.Schema.ImageInfo,e.Schema.ImageSettings),e.Rules.forEach((function(t){return i.addRule(t)})),i.fe={},o.resolve(),i}Object(i.__extends)(e,t);var n=e.prototype;return e.supportMobileDesign=function(t){return!1},Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageInfoMaster",{get:function(){return Object(m.e)(this.Model.ImageInfo)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ImageSettingsMaster",{get:function(){return Object(v.e)(this.Model.ImageSettings)},enumerable:!1,configurable:!0}),n.isFieldReady=function(n){return n=e.getSourceFields([n])[0],t.prototype.isFieldReady.call(this,n)},n.ensureFieldsReady=function(n){return t.prototype.ensureFieldsReady.call(this,e.getSourceFields(n))},n.fieldsReady=function(n){return t.prototype.fieldsReady.call(this,e.getSourceFields(n))},n.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},n.setVideoUrl=function(t,n){var i=this.Model.VideoInfo;o.a.getObjectMasterFromModel(i).bulkEdit((function(){i.Url=Object(l.a)(t),i.Title="",i.Author="",i.Thumbnail_url="",i.OriginalWidth=e.defaultWidth,i.OriginalHeight=e.defaultHeight,i.ShowWarningBar=n&&Object(l.c)(t)}))},n.hasValidVideoUrl=function(){return Object(h.B)()?this.ht()&&Object(l.e)(this.Model.VideoInfo.Url):this.ht()&&Object(l.f)(this.Model.VideoInfo.Url)},n.clearVideoInfo=function(){this.Model.VideoInfo={Author:"",OriginalHeight:e.defaultHeight,OriginalWidth:e.defaultWidth,ShowWarningBar:!1,Thumbnail_url:"",Title:"",Url:""}},n.resetBranchInfo=function(){e.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},n.createSyncJob=function(t){var e=this,n=new u.a,i=n.promise().then((function(){return e.Form.getQuestionSyncBlocker(i)})).then(t);return n.resolve(),i},n.createUploadSyncJob=function(t){var e=this,n=new u.a,i=Promise.all([n,this.ft]).then((function(){return e.createSyncJob(t)}));return n.resolve(),this.ft=Object(u.d)(i),i},n.updateCoAuthors=function(t){var e=this,n=r.filter(this.Model.CoAuthors,(function(e){return t.userId===e.userId}))[0],i=function(){n&&s.deleteItems([n]),t.userId in e.fe&&(clearTimeout(e.fe[t.userId]),delete e.fe[t.userId])},s=o.a.getCollectionMasterFromModel(this.Model.CoAuthors);s.bulkEdit((function(){i(),n=o.a.Collection.addItems(e.Model.CoAuthors,[t])[0]}));this.fe[t.userId]=window.setTimeout(i,1e4)},e.getBranchInfoMaster=function(t){return o.a.getObjectMasterFromModel(t)},n.ct=function(t){this.bt=new j.a(this,e.Schema.QuestionInfo,e.QuestionInfoFieldSet),t.InitialData&&this.isFieldReady(e.Schema.QuestionInfo)&&(t.ExistingInDataSource||t.InitialData.QuestionInfo?this.bt.deserialize():this.bt.serialize())},n.le=function(){this.isFieldReady(e.Schema.ImageInfo)?this.Model.IntegratedSavingState=Object(w.a)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},n.ht=function(){return this.Model.VideoInfo&&this.Model.VideoInfo.Url},Object.defineProperty(e,"QuestionInfoFieldSet",{get:function(){return e.questionInfoFieldSet||(e.questionInfoFieldSet=new y.a([e.Schema.BranchInfo,e.Schema.ImageSettings,e.Schema.ShowSubtitle,e.Schema.VideoInfo])),e.questionInfoFieldSet},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{InterestedFields:[t.Id],Name:"block id changes",onChange:function(t){var e,n=t.Master.Model,i=n.Id,r=t.OldValues.Id;n.Id=r;try{throw Error("Changing element id")}catch(t){e=t}Object(f.c)("UpdatingElementId",{newId:i,oldId:r,stack:e.stack})}},{InterestedFields:[t.ImageInfo.SavingState,t.SavingState],Name:"IntegrateSavingState",onChange:function(t){return t.Master.le()}}]}return e.rules},enumerable:!1,configurable:!0}),e.getSourceFields=function(t){return r.uniq(t.map((function(t){return e.QuestionInfoFieldSet.covers(t)?e.Schema.QuestionInfo:t})))},e.defaultWidth=459,e.defaultHeight=256,e}(o.a.createObjectMasterClass("DescriptiveElementMaster",S,(function(t,e){return new p(t,e)})))},function(t,e,n){"use strict";n.d(e,"d",(function(){return G})),n.d(e,"b",(function(){return q})),n.d(e,"c",(function(){return Q})),n.d(e,"a",(function(){return z}));var i=n(2),r=n(0),o=n(20),s=n(3),a=(n(265),n(6)),c=n(12),u=n(19),l=n(7),h=n(1),f=n(26),d=n(9),b=n(11),m=n(14),v=n(89),g=n(91),O=n(42),p=n(103),j=n(17),y=n(32),w=n(22),S=n(80),N=n(199),I=n(65),C=n(10),k=n(234),T=n(5),x=n(225),F=n(18),P=n(16),D=n(97),M=n(27),L=n(177),A=n(110),R=n(114),E=n(8),B=n(193);var _=n(238),H=n(179),G=-1,q=-3,Q=-4;function V(){Object(y.c)().Model.AddBranchingTeachingCalloutVersion=y.a.toString()}var z=function(t){function e(e){var n=t.call(this,e)||this;n.be=r.createRef(),n.me=[],n.ve={},n.ge=r.createRef(),n.Oe=function(){return n.pe()},n.je=n.je.bind(n),n.ye=n.ye.bind(n),n.we=n.we.bind(n),n.Se=n.Se.bind(n),n.Ne=n.Ne.bind(n),n.Ie=n.Ie.bind(n),n.Ce=n.Ce.bind(n),n.onClickDeleteButton=n.onClickDeleteButton.bind(n),n.ke=n.ke.bind(n),n.Te=n.Te.bind(n),n.xe=n.xe.bind(n);var i=n.props.Master.Model.Point,o={SelectedElementIndex:G,QuizPoint:null==i?void 0:i.toString()};return n.state=o,n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){Object(y.c)().observe(this.Oe,[y.b.Schema.AddBranchingTeachingCalloutVersion]);var t=s.without(a.a.getSubFieldSchemas(Object(b.i)().Schema),Object(b.i)().Schema.Order);this.props.Master.observe(this.Oe,t)},n.componentDidMount=function(){this.updateComponentNodesStatus(),this.state.SelectedElementIndex===G&&this.setFocusToTitleElement()},n.componentDidUpdate=function(){this.updateComponentNodesStatus()},n.componentWillUnmount=function(){Object(y.c)().unobserve(this.Oe),this.props.Master.Model.Title=this.props.Master.Model.Title.replace(/\s*$/,""),"ImagePicker"===Object(b.b)().Model.FlexPane&&(Object(b.b)().Model.FlexPane="None"),this.props.Master.unobserve(this.Oe)},n.render=function(){return r.createElement("div",{className:"office-form-question-designer-container office-form-theme-focus-border office-form-theme-border-top"},this.createMainContent())},Object.defineProperty(n,"QuestionElementRef",{get:function(){return this.be},enumerable:!1,configurable:!0}),n.onClickDeleteButton=function(){var t=this.props.Master,e=t.Model,n=t.Form.FormElementManager.TopElementMasters,i=n.indexOf(t),r=n[i+1];!function(t){t.Form.FormElementManager.deleteFormQuestion(t)}(t),r?this.props.designElement(r):this.props.focusOnAddButton(),"Question.Choice"===e.Type||"Question.TextField"===e.Type?Object(T.b)("DesignPage.Questions.Delete",{isMathQuiz:!!e.IsMathQuiz,questionType:e.Type}):Object(T.b)("DesignPage.Questions.Delete",{questionType:e.Type})},n.updateComponentNodesStatus=function(){this.Fe()},n.createReactNodes=function(){throw Error("to be overridden.")},n.createMainContent=function(){var t=s.extend({},this.props.HTMLAttributes);return t.className=Object(d.b)(t.className,"__question-designer__","office-form-question-designer"),t.onTouchStart=t.onTouchStart||function(){},t.ref=this.be,r.createElement(r.Fragment,null,this.Pe(),r.createElement("div",Object(i.__assign)({},t),this.De(),this.Me(),this.Le(),this.createPhishingWarningBar(),this.createSuggestionBar(),this.createReactNodes(),r.createElement("hr",{"aria-hidden":!0,className:"design-question-hr"}),this.Ae(),!1,this.Re(),this.Ee()))},n.createPhishingWarningBar=function(){return null},n.createSuggestionBar=function(){return null},n.createMathBar=function(){return null},n.getErrorMessage=function(){return null},n.getElementFocusingProps=function(t){var e=this;return{onBlur:function(n){var i=e.getElementRef(t).current,r=Object(d.d)(n);e.state.SelectedElementIndex!==t||i&&r&&i.contains(r)||e.setState({SelectedElementIndex:-2})},onFocus:function(){e.setState({SelectedElementIndex:t})}}},n.getElementRef=function(t){var e;switch(t){case G:e="title";break;case-2:e="other";break;case Q:e="subtitle";break;case-5:e="move-up";break;case-6:e="move-down";break;default:e="element"+t}return this.ve[e]||(this.ve[e]=r.createRef()),this.ve[e]},n.onTitleValueChange=function(){},n.createValidationItem=function(){return null},n.createMoreMenuItems=function(){return[{Checked:this.props.Master.Model.ShowSubtitle,Description:Object(h.a)().Designer_MenuItemForSubtitle,Key:"subtitleItem",MenuItemType:1,onExecute:this.ye}]},n.onUpdateDone=function(t){this.me.push(t)},n.setFocusToTitleElement=function(){this.setState({SelectedElementIndex:G});var t=o.findDOMNode(this.getElementRef(G).current);t&&$(t).find("textarea").focus()},n.createAnswerTagMenuItem=function(){return!1},n.createAnswerTagDiv=function(t){return!1},n.createAddBranchMenuItem=function(){var t,e=this;return Object(C.b)((function(){t={Checked:!1,Description:Object(h.a)().Designer_MenuItemForAddBranch,Key:"addbranchItem",MenuItemType:1,onExecute:e.je}})),t},n.we=function(t){this.props.Master.bulkEdit((function(e){Object(c.g)()?(e.Title=t?Object(O.b)(t,!0):t,e.FormsProRTQuestionTitle=Object(O.c)(t)):e.Title=t})),this.onTitleValueChange()},n.Se=function(t){this.props.Master.bulkEdit((function(e){Object(c.g)()?(e.Subtitle=t?Object(O.b)(t,!0):t,e.FormsProRTSubtitle=Object(O.c)(t)):e.Subtitle=t}))},n.ye=function(){var t=this,e=this.props.Master.Model;Object(T.b)("DesignPage.QuestionMenu.Subtitle",{questionId:e.Id,questionType:e.Type,value:!e.ShowSubtitle}),e.ShowSubtitle||this.onUpdateDone((function(){var e=o.findDOMNode(t.getElementRef(Q).current);$(e).find(":focusable").focus()})),e.ShowSubtitle=!e.ShowSubtitle},n.je=function(){V();var t=this.props.Master.Model,e=Object(b.b)().Model.FormMaster.Model.HasValidBranching;if(t.Id&&(Object(b.b)().Model.BranchingElementId=t.Id,this.be.current&&this.be.current.parentElement)){var n=this.be.current.parentElement.getBoundingClientRect().top;Object(b.b)().Model.RelativeScrollHeight=n}Object(b.b)().Model.TopView="Branch",Object(T.b)("DesignPage.QuestionMenu.AddBranch",{questionId:t.Id,questionType:t.Type,value:e})},n.Pe=function(){if(this.getErrorMessage()){var t=Object(F.b)({HTMLAttributes:{className:"forms-icon-size16x16 design-question-warning-icon"},IconName:"Error",key:"warningIcon"});return r.createElement(r.Fragment,null,r.createElement("div",{className:"design-question-error-message-container"},t,r.createElement("span",{className:"design-question-question-error-bar"},this.getErrorMessage())),r.createElement("div",{className:"design-question-question-mask"}))}},n.De=function(){var t=this,e=this.props.Master.Model;if(e.CoAuthors&&e.CoAuthors.length>0)return e.CoAuthors[e.CoAuthors.length-1].userId===Object(l.a)().userInfo.UserId?void 0:r.createElement("div",{className:"question-coAuthor-notification-container-design-mode"},s.map(e.CoAuthors,(function(e){return t.Be(e)})))},n.Be=function(t){if(t.userId!==Object(l.a)().userInfo.UserId){var e=Object(h.a)().DesignPage_NavBar_CoAuthor_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return r.createElement(A.a,{ariaLabel:e,displayText:Object(R.a)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.Re=function(){var t,n=this,i=this.props.Master,o=i.Model,s=!!this.getErrorMessage(),a=s||"Question.FileUpload"===o.Type&&!!Object(x.a)(i.Form);t=i.Form.reachedQuestionNumberLimitation()?e.createActionBarButton(Object(h.a)().DesignPage_LimitMessage_QuestionNumber,"Copy","forms-icon-size16x16",a,(function(){})):e.createActionBarButton(Object(h.a)().Designer_ActionBar_Duplicate,"Copy","forms-icon-size16x16",a,(function(){var t=i.Form.FormElementManager.duplicateElement(i);n.props.designElement(t);var e=i.Form.Model.LocalizedResources;if(e&&e.length>0){for(var r=t.Model.ChoiceGroup,s=[],a=0;a<r.length;a++)s[a]=r[a].Key;var c=[{newId:t.Model.Id,oldId:i.Model.Id}];if(t.SubQuestionMasters&&t.SubQuestionMasters.length>0)for(a=0;a<t.SubQuestionMasters.length;a++)c.push({newId:t.SubQuestionMasters[a].Model.Id,oldId:i.SubQuestionMasters[a].Model.Id});Object(S.e)(e,c)}Object(T.b)("DesignPage.Questions.Duplicate",{questionType:o.Type})}));var c=e.createActionBarButton(Object(h.a)().Designer_ActionBar_Delete,"Delete","forms-icon-size16x16",!1,this.Te),u=e.createActionBarButton(Object(h.a)().Designer_ActionBar_MoveUp,"Up","forms-icon-size15x15",s,this.Ie,this.getElementRef(-5)),l=e.createActionBarButton(Object(h.a)().Designer_ActionBar_MoveDown,"Down","forms-icon-size15x15",s,this.Ce,this.getElementRef(-6));return r.createElement("div",{className:"question-designer-action-bar",key:"ActionBar"},t,c,u,l)},n.Ie=function(){var t=this,e=this.props.Master,n=e.Model;this.props.IsFirstElement||(Object(T.b)("DesignPage.Questions.MoveUp",{questionType:n.Type}),this.props.DesignFocus.setLocked(!0),e.Form.FormElementManager.moveElementUp(e),setTimeout((function(){t.props.DesignFocus.setLocked(!1)})))},n.Ce=function(){var t=this,e=this.props.Master,n=e.Model;this.props.IsLastElement||(Object(T.b)("DesignPage.Questions.MoveDown",{questionType:n.Type}),this.props.DesignFocus.setLocked(!0),e.Form.FormElementManager.moveElementDown(e),setTimeout((function(){t.props.DesignFocus.setLocked(!1)})))},n.Me=function(){var t=this.props.Master.Model,e=r.createElement("div",{className:"design-question-ordinal",key:"Ordinal"},Object(h.a)().Designer_QuestionOrdinal.format(this.props.Ordinal)),n=Object(M.c)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:this.state.SelectedElementIndex===G?"design-question-title-with-image active":"design-question-title-with-image"},key:"Title",MaxLength:Object(u.I)(),MinimalHeight:Object(u.j)(),onValueChange:this.we,Options:this._e(),Placeholder:Object(h.a)().Designer_QuestionTitle_Placeholder,ref:this.ge,TextFieldType:2,Value:Object(c.g)()&&t.FormsProRTQuestionTitle||t.Title},this.props.Master.Form,!0);return r.createElement("div",{className:"design-question-title-bar",key:"TitleBar"},e,this.He(n))},n._e=function(){return{HTMLPropsForInnerElement:Object(d.g)(this.getElementFocusingProps(G),{"aria-label":Object(h.a)().Designer_QuestionTitle,className:"design-question-textbox mixer-focus-target"})}},n.He=function(t){var e=this,n=this.props.Master,i=n.Model,s=i.ImageInfo,a="design-question-title-image-picker office-form-theme-button";this.state.SelectedElementIndex===G&&(a=Object(d.b)(a,"active"));var c,u=Object(P.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:Object(d.g)(this.getElementFocusingProps(G),{className:a,onClick:function(){Object(T.b)("DesignPage.Questions.AddImage",{questionId:i.Id,questionType:i.Type}),Object(N.b)().then((function(t){t.Image?n.ImageInfoMaster.addImage(t.Image):t.Video&&n.setVideoUrl(t.Video,!0)})).catch((function(t){t&&-2===e.state.SelectedElementIndex&&e.setState({SelectedElementIndex:G},(function(){var t=o.findDOMNode(e.getElementRef(G).current);t&&$(t).find(".design-question-title-image-picker").focus()}))}))}}),Icon:"Photo2",IconClassName:"forms-icon-size20x20",key:"ImagePicker",Text:Object(h.a)().ImagePicker_Insert_Mdeia_button||void 0});c=s&&(s.ImageProcessingStatus===w.c.Picking||s.ErrorType||Object(w.g)(s))?this.Ge():n.hasValidVideoUrl()?this.qe():[t,u];var l=this.getElementRef(G);return r.createElement("div",{className:"design-question-image-title-container",key:"TitleContainer",ref:l},c)},n.Ge=function(){var t=Object(_.a)({ImageMaster:this.props.Master.ImageInfoMaster,ImageSettingsMaster:this.props.Master.ImageSettingsMaster,IsFormLogo:!1,key:"ImageAndEditPane"});return[this.Qe(),t]},n.qe=function(){var t=this.Ve();return[this.Qe(),t]},n.Qe=function(){var t,e=this,n=this.props.Master.Model,i=n.ImageInfo,r=n.VideoInfo,o="design-question-image-title",s=2,a=Object(u.j)();return i.ErrorType===w.a.NoError&&i.ResourceUrl&&n.ImageSettings.ContainerWidth?n.ImageSettings.ContainerWidth<Object(u.E)()?(t="calc(100% - "+n.ImageSettings.ContainerWidth+"px)",s=1,a=n.ImageSettings.ContainerHeight):o="design-question-image-title-big-horizontal":r&&r.Url?o="design-question-image-title-big-horizontal":(t="calc(100% - "+Object(u.v)()+"px)",a=Object(u.u)(),s=1),Object(M.c)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:o,style:{width:t}},key:"ImageTitle",MaxLength:Object(u.I)(),MinimalHeight:a,onValueChange:function(t){return e.we(t)},Options:this._e(),TextFieldType:s,Value:Object(c.g)()&&n.FormsProRTQuestionTitle||n.Title},this.props.Master.Form,!0)},n.Le=function(){var t=this.props.Master.Model;if(t.ShowSubtitle){if(t.IsMathQuiz)return this.createMathBar();var e=Object(M.c)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"design-question-subtitle"},MaxLength:Object(u.H)(),MinimalHeight:Object(u.j)(),onValueChange:this.Se,Options:{HTMLPropsForInnerElement:{"aria-label":Object(h.a)().Designer_QuestionSubtitle,className:"design-question-textbox mixer-focus-target"}},Placeholder:Object(h.a)().Designer_PlaceholderForQuestionSubtitle,ref:this.getElementRef(Q),TextFieldType:2,Value:Object(c.g)()&&t.FormsProRTSubtitle||t.Subtitle},this.props.Master.Form,!0);return r.createElement("div",{className:"design-question-element",key:"Subtitle"},e)}},n.Ae=function(){var t=this,e=this.props.Master.Form.Model.Questions,n=null;return Object(C.b)((function(){e.length>1&&t.props.Master.Model.Id===e[1].Id&&(n=function(t,e){if(!Object(y.d)(Object(y.c)().Model.AddBranchingTeachingCalloutVersion))return null;var n=Object(h.a)().FirstRun_Callout_AddBranch_Text,i=Object(I.g)(n),r=Object(I.e)((function(){V()})),o=Object(I.f)(Object(f.b)("/Images/branching.gif"));return Object(I.d)(i,o,r,t,e)}("teachingCallout-addbranch","teachingCallout-addbranch-direction"))})),r.createElement("div",{className:"design-question-bottombar-container clearfix",key:"BottomBar"},this.ze(this.props.Master),r.createElement("div",{className:"design-question-bottombar"},!1,this.Ue(),this.$e(),!1,this.We(),n))},n.ze=function(t){var e=this,n=t.Model;if(n.IsQuiz){var i=Object(M.c)({HTMLAttributes:{className:"design-quiz-point-box"},onValueChange:function(t){if(""===t)n.Point=null,e.setState({QuizPoint:t});else{var i=Object(k.validateQuizPoint)(t);null!=i&&(n.Point=i.point,e.setState({QuizPoint:i.pointString}))}Object(T.b)("DesignPage.Quiz.Point",{QuestionId:n.Id,Value:n.Type})},Options:{HTMLPropsForInnerElement:{"aria-label":Object(h.a)().Common_Points_Text,className:"design-quiz-point-box-input"}},Value:e.state.QuizPoint});return r.createElement("div",{className:"design-quiz-point-bar"},r.createElement("div",{className:"design-quiz-point-label"},Object(h.a)().Common_Points_Text+":"),i)}},n.Ue=function(){var t=this.props.Master.Model;switch(t.Type){case"Question.Choice":case"Question.TextField":case"Question.MatrixChoice":var e=t.OptionDisplayStyle===j.c.Dropdown;return Object(L.a)({Disabled:e,HTMLAttributes:{className:"design-question-bottombar-element",title:e?Object(h.a)().QuestionBar_DesignTime_MultipleChoice_Tooltip:""},Label:"Question.TextField"===t.Type?Object(h.a)().Designer_AllowMultipleLines:Object(h.a)().Designer_AllowMultipleChoices,onValueChange:function(e){if("Question.TextField"===t.Type)Object(T.b)("DesignPage.Questions.LongAnswer",{questionId:t.Id,questionType:t.Type,value:e}),t.Multiline=e;else{Object(T.b)("DesignPage.Questions.MultipleAnswers",{isQuiz:t.IsQuiz,questionType:t.Type});var n=t;n.ChoiceType=e?j.a.MultiChoice:j.a.SingleChoice,n.IsQuiz&&n.ChoiceType===j.a.SingleChoice&&s.rest(s.filter(n.Choices,(function(t,e){return t.IsAnswerKey}))).map((function(t,e){return t.IsAnswerKey=!1}));var i=n.DefaultValue&&JSON.parse(n.DefaultValue);if(i){var r=Object.getOwnPropertyNames(i);if(n.ChoiceType!==j.a.MultiChoice&&r.length>1){for(var o=1;o<r.length;o++)delete i[r[o]];n.DefaultValue=JSON.stringify(i)}}}},Options:{classNameForInnerLabel:"design-question-toggle-label"},Value:"Question.TextField"===t.Type?t.Multiline:t.ChoiceType===j.a.MultiChoice});default:return null}},n.$e=function(){var t=this.props.Master,e=t.Model;return Object(L.a)({HTMLAttributes:{className:"design-question-bottombar-element"},Label:Object(h.a)().Designer_IsRequired,onValueChange:function(n){Object(T.b)("DesignPage.Questions.AnswerRequired",{isQuiz:e.IsQuiz,questionId:e.Id,questionType:e.Type,value:n}),e.Required=n,t.SubQuestionMasters.forEach((function(t){t.Model.Required=e.Required}))},Options:{classNameForInnerLabel:"design-question-toggle-label toggle-label-margin-right"},Value:e.Required})},n.We=function(){var t=this,e={"aria-label":Object(h.a)().Common_More_Options_Text,children:Object(F.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"More"}),className:"design-question-more-options",title:Object(h.a)().QuestionCard_DesignTime_Menu_Tooltip};return r.createElement(D.a,{ButtonStyle:"LightBackground",ClassNameForContainer:"design-question-bottombar-element",HTMLAttributes:e,MenuItemType:1,onMenuExpand:function(){Object(T.b)("DesignPage.QuestionMenu.Navigate",{questionType:t.props.Master.Model.Type})},UnorderListMenuItems:this.createMoreMenuItems().concat([this.createAddBranchMenuItem()])})},n.Ke=function(t){},n.Je=function(t){},n.Ne=function(){var t=this.props.Master.Model,e=document.getElementById("Geo");Object(T.e)({eventInfo:{Component:"QuestionDesignerBase",Geo:e&&e.value||"",tenantId:Object(l.a)().userInfo.TenantId},type:"MFPUI_AnswerTag"}),t.FormsProEnableAnswerTag=!t.FormsProEnableAnswerTag},e.createActionBarButton=function(t,e,n,i,r,o){return Object(P.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"question-edit-button",disabled:i,onClick:r},Icon:e,IconClassName:n,ref:o,Text:t})},n.Fe=function(){var t=document.activeElement,e=o.findDOMNode(this.getElementRef(-5).current),n=o.findDOMNode(this.getElementRef(-6).current),i=this.getErrorMessage();this.props.IsFirstElement&&t===e?(n.disabled=!1,n.focus()):this.props.IsLastElement&&t===n&&(e.disabled=!1,e.focus()),e.disabled=this.props.IsFirstElement||!!i,n.disabled=this.props.IsLastElement||!!i},n.Ve=function(){var t=this,n=this.props.Master,i=n.Form,o=n.Model.VideoInfo,s=Object(v.d)(o.Url,n.Form),a="design-question-title-video office-form-theme-border";s&&(a=Object(d.b)(a,"youTubeDisabled"));var c=Object(P.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"video-delete-button office-form-theme-button-foreground",onClick:function(){Object(T.b)("DesignPage.VideoEditPane.Delete"),t.props.Master.clearVideoInfo(),Object(v.a)(i)||i.Model.YouTubeMessageBarState!==p.a.Shown||(i.Model.YouTubeMessageBarState=p.a.Default)}},Icon:"Delete",IconClassName:s?"forms-icon-size14x14":"forms-icon-size18x18",Text:Object(h.a)().VideoEditPane_Delete_Button}),u=Object(m.r)();return r.createElement("div",{"aria-label":Object(h.a)().VideoPane_Video_Container,className:a,key:"VideoContainer",tabIndex:0},this.Xe(),s&&r.createElement(B.a,{InDesignMode:!0,IsMobile:u,LocalizedStrings:Object(h.a)(),VideoUrl:o.Url}),!s&&r.createElement("iframe",{allowFullScreen:!0,className:"design-question-title-video-frame",frameBorder:"0",height:e.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:o.Url,width:"100%"}),c)},n.Xe=function(){if(Object(m.B)()&&this.props.Master.Model.VideoInfo.ShowWarningBar){var t=this.props.Master.Form.SettingMaster,e=t.Model.IsAnonymous?Object(h.a)().Designer_QuestionTitle_StreamVideoTipForAnonymousForm:Object(h.a)().Designer_QuestionTitle_StreamVideoTip;return Object(g.d)({TipBarIconClassName:"ms-Icon ms-Icon--Info forms-icon-size16x16",Info:e,TipBarLocation:"Up",TipBarStyle:t.Model.IsAnonymous?"RedBackground":"YellowBackground",ShouldClose:!0,onClose:this.xe})}},n.xe=function(t){t.stopPropagation(),t.preventDefault(),this.props.Master.Model.VideoInfo.ShowWarningBar=!1},e.calcVideoDisplayHeight=function(){if(Object(m.r)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/1.7777777777777777}return Object(u.l)()},n.pe=function(){var t=this.me;this.me=[],this.forceUpdate((function(){t.forEach((function(t){return t()}))}))},n.Ee=function(){var t=this;return Object(C.c)((function(){return t.state.ShowConfirmDialog&&r.createElement(H.a,{clickCancelButton:t.ke,clickDeleteQuestion:t.onClickDeleteButton})}),C.f)},n.Te=function(){var t=this;Object(C.c)((function(){t.props.Master.Form.Model.LocaleList.length?t.setState({ShowConfirmDialog:!0}):t.onClickDeleteButton()}),C.f)},n.ke=function(){var t=this;this.setState({ShowConfirmDialog:!1,SelectedElementIndex:G},(function(){var e=t.ge.current;e&&e.focus&&e.focus()}))},e}(E.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(0),r=n(1),o={};Object.defineProperty(o,"LocalizedStrings",{get:r.a});var s=i.createContext(o)},function(t,e,n){"use strict";n.d(e,"a",(function(){return N}));var i=n(3),r=n(93),o=n(6),s=n(1),a=n(126),c=n(174),u=n(13),l=n(79),h=n(146),f=n(147),d=n(115),b=n(5),m=0,v=0,g=0,O=0,p={ChoiceOptionSuggestsOption:0};function j(t){return!t||t.indexOf(Object(s.a)().Designer_DefaultFormTitle)>=0||t.indexOf(Object(s.a)().Designer_DefaultQuizTitle)>=0}function y(t){var e;switch(t.QuestionType){case"Question.Choice":(e=l.a.createDefaultDefinition()).Choices=t.ChoiceCandidates.map((function(t){return{Description:t,IsGenerated:!0}}));break;case"Question.DateTime":e=h.a.createDefaultDefinition();break;case"Question.TextField":(e=d.a.createDefaultDefinition()).Multiline=!!t.QuestionSettings&&t.QuestionSettings.Multiline;break;case"Question.Rating":e=f.a.createDefaultDefinition();break;default:return null}return e.Title=t.QuestionTitle,e}function w(t,e){var n=t;return n&&n.Results&&n.Results.length&&n.Results[0].Result&&n.Results[0].Result.ChoiceCandidates?{MatchQuery:e===m,Suggestion:n.Results[0].Result}:null}function S(t,e){return a.a.createIntelligenceProvider().textAnalyzeWithFeatures(t,e)}var N={askSuggestion:function(t){var e=++p[t.Feature];return Object(c.a)().initialize().then((function(n){var i=n[t.Feature];return t.Variation=i||"None",a.a.createIntelligenceProvider().askSuggestion(t).then((function(n){return n.MatchQuery=e===p[t.Feature],function(t,e){var n;Object(b.b)("Intelligence."+e.Feature+".Ask",{ActionSubCategory:t,DetectedLanguage:e.DetectedLang,Feature:e.Feature,HasSuggestion:(null===(n=e.Suggestion)||void 0===n?void 0:n.length)>0,ModelName:e.ModelName,SuggestionId:e.SuggestionId,Variation:e.Variation})}("Ask",n),n}))}))},createQuestionByType:y,getChoiceOptionSuggestion:function(t){var e=++m;return function(t){return a.a.createIntelligenceProvider().textAnalyze(t)}(t).then((function(t){return w(t,e)}))},getDefaultQuestionResult:function(){return Promise.resolve({MatchQuery:!0,Templates:[]})},getFilteredTemplates:function(t){return t.filter((function(t){return!!t})).filter((function(t){return t.Questions&&t.Questions.filter((function(t){return"Question.MatrixChoice"!==t.Type})).length>0}))},getHistoryFormSuggestion:function(t,e,n){var i=++v,s={MatchQuery:!0,Templates:[]};return j(t)?Promise.resolve(s):a.a.createIntelligenceProvider().getHistorySuggestion(t,e).then((function(t){if(t&&t.Result){var a=t.Result;s.Templates.push({AlgorithmType:t.SuggestionType,FormTitle:a.Title||"",Questions:o.a.convertToArray(a.Questions),TemplateId:"HistoryTemplateIdentify"}),s.Templates=N.getFilteredTemplates(s.Templates),s.Templates.forEach((function(t){return t.Questions.forEach((function(t){return Object(r.f)(t)}))}))}return Object(b.b)("Ingelligence.HistorySuggestion.Get",{Addressable:t.IsAddressable,FormId:e,IsQuiz:n}),s.MatchQuery=i===v,s}))},getLikertQuestionSuggest:function(t){var e=++m;return S(8192,t).then((function(t){return w(t,e)}))},getOptionToOptionSuggestion:function(t,e){return function(t,e,n){void 0===n&&(n="None");var i=++m;return a.a.createIntelligenceProvider().getOptionToOptionSuggestion(t,e,n).then((function(t){var e={MatchQuery:i===m,Result:{ChoiceCandidates:[],MatchingPart:null,QuestionType:null}};return e.MatchQuery&&t&&t.ChoiceCandidates&&t.ChoiceCandidates.length>0?e.Result=t:e.MatchQuery&&t&&(e.Result.MatchingPart=t.MatchingPart),e}))}(t,e)},getQuestionsIntelligenceResult:function(t){var e=++O;return S(2048,JSON.stringify(t)).then((function(t){var n,i=t;if(i&&i.Results&&i.Results.length&&i.Results[0].Result&&i.Results[0].Result.Questions){var r=i.Results[0].Result,o=[];r.Questions.map((function(t){var e=y(t);e&&o.push(e)})),(n={MatchQuery:e===O,Templates:[]}).Templates.push({Questions:o,TemplateId:r.Id}),n.Templates=N.getFilteredTemplates(n.Templates)}return n})).catch((function(t){throw t}))},getQuestionsSuggestion:function(t){var e=++O;return S(2048,JSON.stringify(t)).then((function(t){var n={MatchQuery:e===O,Templates:[]},i=t;if(i&&i.Results&&i.Results.length&&i.Results[0].Result&&i.Results[0].Result.Questions){var r=[];i.Results[0].Result.Questions.map((function(t){var e=y(t);e&&r.push(e)})),n.Templates.push({Questions:r,TemplateId:i.Results[0].Result.Id}),n.Templates=N.getFilteredTemplates(n.Templates)}return n})).catch((function(t){throw t}))},getThemeSuggestion:function(t){var e=++g,n={MatchQuery:!0,ThemeCategories:[]};return j(t)?Promise.resolve(n):S(65536,t).then((function(t){if(t&&t.Results&&t.Results.length&&t.Results[0].Result){var r=t.Results[0].Result;i.isArray(r)&&(n.ThemeCategories=r)}return n.MatchQuery=e===g,n.MatchQuery&&Object(b.b)("IntelligenceStatistic.ThemeSuggestion.Get",{Suggestions:n.ThemeCategories}),n}))},HISTORYTEMPLATEID:"HistoryTemplateIdentify",isDefaultTitle:j,logSuggestionKept:function(t,e,n){void 0===n&&(n="None"),Object(b.b)("Intelligence."+e.Feature+".Kept",{ActionSubCategory:t,DetectedLanguage:e.DetectedLang,Feature:e.Feature,ModelName:e.ModelName,SuggestionId:e.SuggestionId,Variation:e.Variation}),Object(b.b)("IntelligenceStatistic."+e.Feature+".Kept",{ActionSubCategory:t,DetectedLanguage:e.DetectedLang,ExtraData:e.ExtraData,ExtraUserSignals:n,Feature:e.Feature,ModelName:e.ModelName,Variation:e.Variation},null,!0)},logSuggestionSeen:function(t,e){Object(b.b)("Intelligence."+e.Feature+".Seen",{ActionSubCategory:t,DetectedLanguage:e.DetectedLang,Feature:e.Feature,ModelName:e.ModelName,SuggestionId:e.SuggestionId,Variation:e.Variation}),Object(b.b)("IntelligenceStatistic."+e.Feature+".Seen",{ActionSubCategory:t,DetectedLanguage:e.DetectedLang,ExtraData:e.ExtraData,Feature:e.Feature,ModelName:e.ModelName,Variation:e.Variation},null,!0)},logUserSignal:function(t){return a.a.createIntelligenceProvider().logUserSignal(t)},predictResponseTime:function(t,e){return void 0===e&&(e=!1),new Promise((function(n,r){t.fieldsReady([u.a.Schema.Title,u.a.Schema.Questions]).then((function(){var o=i.filter(t.Model.Questions,(function(t){return"Question.Choice"===t.Type})),s=0,c=0,u=0;o.forEach((function(t){u+=t.Title.length,c+=t.Choices.length,i.forEach(t.Choices,(function(t){s+=t.Description.length}))}));var l=i.filter(t.Model.Questions,(function(t){return"Question.MatrixChoiceGroup"===t.Type})),h=0,f=0,d=0;l.forEach((function(t){h+=t.ChoiceGroup.length,d+=t.Title.length,i.forEach(t.ChoiceGroup,(function(t){f+=t.Description.length}))}));var m=i.filter(t.Model.Questions,(function(t){return"Question.Rating"===t.Type})),v=0,g=0;m.forEach((function(t){v+=t.Length,g+=t.Title.length}));var O=i.filter(t.Model.Questions,(function(t){return"Question.Ranking"===t.Type})),p=0,j=0,y=0;O.forEach((function(t){j+=t.ChoiceGroup.length,y+=t.Title.length,i.forEach(t.ChoiceGroup,(function(t){p+=t.Description.length}))}));var w=t.Model.Title,S={ChoiceCount:o.length,ChoiceTotalChoiceCount:c,ChoiceTotalChoiceLength:s,ChoiceTotalTitleLength:u,DateCount:i.filter(t.Model.Questions,(function(t){return"Question.DateTime"===t.Type})).length,LikertAverageOptionCount:h/l.length,LikertCount:l.length,LikertTotalOptionLength:f,LikertTotalStatementCount:i.filter(t.Model.Questions,(function(t){return"Question.MatrixChoice"===t.Type})).length,LikertTotalTitleLength:d,NPSCount:i.filter(t.Model.Questions,(function(t){return"Question.NPS"===t.Type})).length,RankingCount:O.length,RankingTotalChoiceCount:j,RankingTotalChoiceLength:p,RankingTotalTitleLength:y,RatingAverageOptionCount:v/m.length,RatingCount:m.length,RatingTotalTitleLength:g,TextCount:i.filter(t.Model.Questions,(function(t){return"Question.TextField"===t.Type})).length,TextTotalTitleLength:w?w.length:0};return a.a.createIntelligenceProvider().predictResponseTime(S).then((function(t){return e&&Object(b.b)("Intelligence.PredictResponseTime.Time",{EstimatedTimeInSeconds:t.EstimatedTimeInSeconds,NonTextPartEstimatedTimeInSeconds:t.NonTextPartEstimatedTimeInSeconds}),t})).then(n,r)}))}))},textAnalyzeWithFeatures:S}},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(9),c=n(8),u=n(18);function l(t){return r.createElement(h,Object(i.__assign)({},t))}var h=function(t){function e(n){var i=t.call(this,n)||this;i.Ze=s.uniqueId(e.name),i.Ye=i.Ze+"_placeholder",i.tn=r.createRef(),i.en=i.en.bind(i),i.nn=i.nn.bind(i);var o=i.in(),a=s.findIndex(o,(function(t){return t.Value===i.props.Value}));return i.rn=a<0?void 0:o[a].Key,i.state={Expanded:!1},i}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillUpdate=function(t,n){var i=e.GetSelectOptions(t),r=s.findIndex(i,(function(e){return e.Value===t.Value}));this.rn=r<0?void 0:i[r].Key},n.componentDidUpdate=function(){if(this.sn(),this.state.Expanded){if(this.an(),this.props.NeedScroll){var t=this.tn.current;if(t){var e=$(".office-form-content"),n=t.getBoundingClientRect().bottom,i=e.height()-n;if(i<70){var r=o.findDOMNode(this.refs.menu);e.scrollTop(e.scrollTop()+r.offsetHeight-i)}}}var s=this.refs[this.rn];if(s){var a=o.findDOMNode(s);a&&a.focus()}}},n.an=function(){var t=document.getElementById(this.Ze),e=window.getComputedStyle(t),n=t.offsetWidth,i=o.findDOMNode(this.refs.menu);(this.props.AllowWrap||i.offsetWidth<n)&&(i.style.width=n+"px"),i.style.top=t.offsetHeight-parseInt(e.borderTopWidth)+"px",i.style.left="-"+e.borderLeftWidth},n.render=function(){var t=this,e=s.extend({},this.props.HTMLAttributes),n=Object(a.g)(e,{"aria-describedby":this.Ye,"aria-expanded":this.state.Expanded,"aria-label":e["aria-label"]||this.props.Label||this.props.Placeholder,className:"select-control",id:this.Ze,onBlur:this.en,onClick:e.disabled?void 0:function(){return t.cn()},onKeyDown:this.nn,ref:this.tn,role:"combobox",tabIndex:e.disabled?-1:0});return r.createElement("div",Object(i.__assign)({},n),this.un(),this.ln())},e.GetSelectOptions=function(t){var e=t.SelectOptions;if(e)return e;var n=t.SelectOptionGroups;return s.flatten(n.map((function(t){return t.SelectOptions})))},n.in=function(){return e.GetSelectOptions(this.props)},n.hn=function(){return!!this.fn()},n.fn=function(){return this.props.SelectOptionGroups},n.un=function(){var t,e=this,n=this.in(),i=s.findIndex(n,(function(t){return void 0===e.rn?t.Value===e.props.Value:t.Key===e.rn}));i>=0&&(t=this.props.DisplayValue?this.props.Value:n[i].DisplayContent||n[i].DisplayName),t||(t=this.props.Placeholder||"");var o=this.rn?"select-placeholder-text":"select-placeholder-text default",a=this.state.Expanded?"off":"polite",c=this.props.PlaceholderIcon&&r.createElement("div",{className:"select-placeholder-icon","aria-hidden":"true"},r.createElement(u.a,{IconName:this.props.PlaceholderIcon}));return r.createElement("div",{className:"select-placeholder"},c,r.createElement("span",{"aria-live":a,id:this.Ye,className:o,"aria-label":this.dn(n[i])},r.createElement("span",null,t)),this.bn())},n.dn=function(t){return this.props.DisplayValue&&this.props.Value?this.props.Value.toString():t&&t.DisplayName?t.DisplayName:this.props.Placeholder||""},n.bn=function(){var t={HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size14x14"},IconName:this.state.Expanded?"ChevronUp":"ChevronDown"};return r.createElement(u.a,Object(i.__assign)({},t))},n.ln=function(){var t=this;if(this.state.Expanded){var e={className:"select-option-menu-container",ref:"menu",onWheel:function(e){e.preventDefault();var n=e.deltaY,i=o.findDOMNode(t.refs.menu),r=i.scrollTop+n;if(n>=0){var s=i.scrollHeight-i.clientHeight;i.scrollTop=Math.min(r,s)}else i.scrollTop=Math.max(r,0)},role:"listbox"};return r.createElement("ul",Object(i.__assign)({},e),this.mn())}},n.mn=function(){var t=this;return this.hn()?this.fn().map((function(e,n){return t.vn(e,n)})):this.gn(this.in())},n.vn=function(t,e){var n=!(!t.SelectOptions.length||!t.DisplayName)&&r.createElement("h5",{className:"select-group-header office-form-theme-primary-color",key:"group_header"+e},t.DisplayName);return r.createElement(r.Fragment,{key:"group_"+e},n,this.gn(t.SelectOptions))},n.gn=function(t){var e=this;return t.map((function(t){return e.On(t)}))},n.On=function(t){var e=this,n=t.Key===this.rn,s={"aria-selected":n,"aria-disabled":t.Disabled,className:this.props.AllowWrap?"select-option-nocheck":"select-option",tabIndex:n?0:-1,key:t.Key,ref:t.Key&&t.Key.toString(),role:"option"};t.AriaLabel&&(s["aria-label"]=t.AriaLabel),t.Disabled?s.className=Object(a.b)(s.className,"disabled"):s.onClick=function(n){o.findDOMNode(e).focus(),e.rn&&e.rn===t.Key||e.props.onValueChange(t.Value),e.setState({Expanded:!1}),n.stopPropagation()};var c,l="select-option-state forms-icon-size14x14";this.props.PlaceholderIcon&&(l=Object(a.b)(l,"hasPlaceholderIcon")),this.props.AllowWrap||(c=r.createElement(u.a,{HTMLAttributes:{className:l},IconName:"CheckMark"})),n&&(s.className=Object(a.b)(s.className,"selected"));var h=t.DisplayContent;return h||(h=r.createElement("span",{role:"button"},t.DisplayName)),r.createElement("li",Object(i.__assign)({},s),r.createElement("div",{className:"select-option-content"},c,h))},n.en=function(t){var e=o.findDOMNode(this),n=Object(a.d)(t);e.contains(n)||this.setState({Expanded:!1})},n.nn=function(t){var e=this;switch(t.stopPropagation(),t.keyCode){case 32:this.setState({Expanded:!0}),t.preventDefault();break;case 13:this.cn(!0),t.preventDefault();break;case 9:this.state.Expanded&&(this.setState({Expanded:!1},(function(){e.tn.current&&e.tn.current.focus()})),t.preventDefault());break;case 27:this.state.Expanded&&this.setState({Expanded:!1},(function(){e.tn.current&&e.tn.current.focus()})),t.preventDefault();break;case 37:case 39:this.state.Expanded||(37===t.keyCode?this.pn():this.jn()),t.preventDefault();break;case 38:case 40:t.altKey?this.setState({Expanded:!this.state.Expanded}):38===t.keyCode?this.pn():this.jn(),t.preventDefault()}},n.pn=function(){for(var t=this,e=this.in(),n=s.findIndex(e,(function(e){return e.Key===t.rn}));n>0;){var i=e[n-1];if(!i.Disabled){this.props.onValueChange(i.Value);break}n--}},n.jn=function(){for(var t=this,e=this.in(),n=s.findIndex(e,(function(e){return e.Key===t.rn}));n<e.length-1;){var i=e[n+1];if(!i.Disabled){this.props.onValueChange(i.Value);break}n++}},n.cn=function(t){var e=this.in();this.state.Expanded?o.findDOMNode(this).focus():t&&void 0===this.rn&&e[0]&&this.props.onValueChange(e[0].Value);this.setState({Expanded:!this.state.Expanded})},n.sn=function(){if(this.state.Expanded){var t=$(o.findDOMNode(this.refs.menu)),e=t.find(".select-option.selected");Object(a.j)(e,t)}},n.focus=function(){o.findDOMNode(this).focus()},e}(c.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return g})),n.d(e,"c",(function(){return O})),n.d(e,"d",(function(){return p})),n.d(e,"e",(function(){return j})),n.d(e,"g",(function(){return y})),n.d(e,"f",(function(){return w})),n.d(e,"h",(function(){return S}));n(239);var i=n(3),r=n(6),o=n(23),s=n(7),a=n(81),c=n(11),u=n(108),l=n(25),h=n(13),f=n(95),d={},b={},m=new u.a.CallbackManager;function v(t){return g(t,!0)}function g(t,e,n){if(void 0===n&&(n=!1),e&&(t.SoftDeleted=t.SoftDeleted),t.Id)return j(t,n);if(e?(t.OwnerId=t.OwnerId||Object(o.f)(),!t.OwnerId&&Object(c.b)().Model.GroupMaster&&(t.OwnerId=Object(c.b)().Model.GroupMaster.Model.id),t.OwnerTenantId=t.OwnerTenantId||Object(o.i)()||Object(s.a)().userInfo.TenantId):(t.OwnerId=t.OwnerId||Object(s.a)().userInfo.UserId,t.OwnerTenantId=t.OwnerTenantId||Object(s.a)().userInfo.TenantId),!t.OwnerId||!t.OwnerTenantId)throw new Error("Form OwnerId or OwnerTenantId cannot be null!");return p(t,e?"Group":"User",n)}function O(t,e){var n=new(Object(c.a)())(l.a.DesignTimeForm,{ExistingInDataSource:!0,InitialData:t},e);return n.forceFieldsReady(Object(f.c)()),b[n.getInstanceId()]=n,m.trigger(n),n.Synchronizer.Model.CreationInProcess=!0,n}function p(t,e,n){var o=Object(f.a)().map(r.a.getFieldSchemaInfo).map((function(t){return t.Name}));t=i.pick(t,o);var s=new(Object(c.a)())(l.a.DesignTimeForm,{ExistingInDataSource:!1,InitialData:t},"Group"===e,n);return b[s.getInstanceId()]=s,s.existingOnServerSide().then((function(){d[s.Model.Id]=s})),m.trigger(s),s}function j(t,e,n){void 0===n&&(n=!1);var o=d[t.Id];if(o&&!n){var s=r.a.convertToSourceData(t,h.a.Schema);return o.Synchronizer.onSourceDataReceived(s),o}var u=Object(a.a)(t.Id);return(t=i.clone(t)).OwnerId=u.OwnerId,t.OwnerTenantId=u.OrgId,t.TableId=u.TableId,o=new(Object(c.a)())(l.a.DesignTimeForm,{ExistingInDataSource:!0,InitialData:t},u.IsGroupOwner,e),b[o.getInstanceId()]=o,d[t.Id]=o,m.trigger(o),o}function y(t){return b[t]}function w(t){return d[t]}function S(t){m.register(t)}},function(t,e,n){"use strict";n.d(e,"d",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"b",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"c",(function(){return b}));var i=n(1);var r,o,s=n(149),a=n(11),c=n(141),u=n(5);function l(t,e,n){Object(u.b)(Object(c.a)(e)?"Error.ErrorMessageBar.Show.Expected":"Error.ErrorMessageBar.Show.Unexpected",{Error:JSON.stringify(e),Key:n,Scenario:t},e&&e.correlationId),r=t,o=n,Object(i.d)().then((function(){var t;Object(a.b)().Model.ErrorBarMessage=(t=e.innerCode,t&&Object(s.a)(""+t)||(r?function(t,e){var n=null!=e?e:Object(i.a)();switch(t){case"CreateQuestion":return n.Error_Bar_Message_CreateQuestion;case"DeleteForm":return n.Error_Bar_Message_DeleteForm;case"DeleteQuestion":return n.Error_Bar_Message_DeleteQuestion;case"ExportResponsesToExcel":return n.Error_Bar_Message_ExportResponsesToExcel;case"RefreshResponses":return n.Error_Bar_Message_RefreshResponses;case"SaveForm":return n.Error_Bar_Message_SaveForm;case"SaveQuestion":return n.Error_Bar_Message_SaveQuestion;default:return""}}(r):null))}))}function h(t,e){t===r&&e===o&&(Object(u.b)("Error.ErrorMessageBar.Hide",{Key:e,Scenario:t}),r=void 0,o=void 0,Object(a.b)().Model.ErrorBarMessage=null)}function f(t){t&&t.Synchronizer.Model.CreationFailed&&!Object(a.b)().Model.CriticalError&&Object(a.b)().Model.ErrorBarMessage&&h("SaveForm",t.getInstanceId())}function d(t){Object(a.b)().Model.InfoBarMessageType=t}function b(){Object(a.b)().Model.InfoBarMessageType=void 0}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"g",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"i",(function(){return b})),n.d(e,"h",(function(){return m}));var i=n(0),r=n(1),o=n(9),s=n(24),a=0,c=2,u=3;function l(t,e,n,r,s){return i.createElement("div",{className:"firstrun-callout-container","aria-live":"polite"},i.createElement("div",{id:r,className:"firstrun-callout"},i.createElement("div",{className:Object(o.b)("firstrun-callout-beak",s)}),i.createElement("div",{className:"teaching-callout-text-wrap"},t),i.createElement("div",{className:"teaching-callout-img-wrap"},e),n))}function h(t){return i.createElement("div",{className:"teaching-callout-text"},t)}function f(t){return i.createElement("img",{className:"teaching-callout-img",src:t,alt:Object(r.a)().AltText_Gif})}function d(t){return Object(s.b)({HTMLAttributes:{className:"teaching-callout-button",onClick:t,"aria-label":Object(r.a)().TeachingUI_Theme_Suggestion},Text:Object(r.a)().TeachingUi_GotIt,ButtonStyle:"LightBackground"})}function b(t){return parseInt(t)===u}function m(t){var e=parseInt(t);return isNaN(e)||e<c}},function(t,e,n){"use strict";n.d(e,"a",(function(){return b}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(201),c=n(31),u=n(25),l=n(80),h=function(){function t(t){this.L=t,this.N=Object(c.i)(this.L.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.L.Form.SyncContext!==u.a.DesignTimeForm)return Promise.resolve();var n=this.L.Form;return n?n.Synchronizer.existingInDataSource().then((function(){var n,i=[];for(n in t)if(t.hasOwnProperty(n)){var o=Object(l.f)(r.pick(t,[n]));null!==o.elementKey&&"localename"!==o.elementKey&&(o.locale=e.L.Model.localeId,o.questionId="",i.push(Object(a.a)(o,e.L.FormId)))}return Promise.all(i).then((function(t){}))})):Promise.reject()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.L.Form.SyncContext!==u.a.DesignTimeForm)return Promise.resolve();var n,i=[];for(n in t)if(t.hasOwnProperty(n)){var o=null!==e.ValuesBefore[n],s=Object(l.f)(r.pick(t,[n]));s.locale=this.L.Model.localeId,s.questionId="",i.push(o?this.N.updateLocaleItem(this.L.FormId,s):this.N.createLocaleItem(this.L.FormId,s))}return Promise.all(i).then((function(){}))},t}(),f=n(106),d={footerText:s.a.string(),formCloseMessage:s.a.string(),formsprortlocalesubtitle:s.a.string(),formsprortlocaletitle:s.a.string(),localeId:s.a.string({IsKeyField:!0}),localeName:s.a.string(),questionResources:s.a.collectionOf((function(){return f.a})),subtitle:s.a.string(),thankYouMessage:s.a.string(),title:s.a.string()},b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LocaleId",{get:function(){return this.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LocaleName",{get:function(){return this.Model.localeName},enumerable:!1,configurable:!0}),e.getFormResourceMaster=function(t,e){var n=r.find(e.Model.LocalizedResources,(function(e){return e.localeId===t}));if(n)return o.a.getObjectMasterFromModel(n);throw Error("This locale does not exist in form.")},e.getQuestionResourceMaster=function(t,e,n){var i=n.Model.LocalizedResources,r=o.a.Collection.getItemWithKeyFields(i,{localeId:t});if(r){if(r.questionResources||(r.questionResources=[]),r.questionResources.length>0){var s=o.a.Collection.getItemWithKeyFields(r.questionResources,{localeId:t,questionId:e});if(s)return o.a.getObjectMasterFromModel(s)}return Object(l.d)({localeId:t,localeName:r.localeName},e,r,n)}throw Error("This locale does not exist in form.")},e}(o.a.createObjectMasterClass("FormLocalizedItemMaster",d,(function(t){return new h(t)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(52),o=n(5),s=function(){return function(t,e,n){this.answer=t,this.id=e||Object(r.c)(),this.isMath=n}}(),a=function(){function t(e){if(this.yn=[],null!=e.GradingBasis)try{this.yn=JSON.parse(e.GradingBasis)}catch(n){this.yn=[],Object(o.c)("ShortTextGradingBasisJsonParseFailure",{gradingBasisLength:e.GradingBasis.length,nonAsciiDetected:t.doesContainNonAsciiCharacters(e.GradingBasis)})}else this.yn=[]}var e=t.prototype;return e.serialize=function(){return JSON.stringify(this.yn)},e.getAnswers=function(){return i.clone(this.yn)},e.areAnyAnswersDefined=function(){return 0!==this.yn.length},e.addAnswer=function(t,e){return!this.wn(t)&&(!this.Sn(t)&&(this.yn.push(new s(t,void 0,e)),!0))},e.updateAnswer=function(t,e,n){if(this.wn(e))return!1;if(this.Sn(e,t))return!1;var i=this.Nn(t);if(i<0)return!1;var r=this.yn[i];return this.yn[i]=new s(e,r.id,n),!0},e.deleteAnswer=function(t){var e=this.Nn(t);e>=0&&this.yn.splice(e,1)},e.isCorrect=function(t){return!this.wn(t)&&(t=(t+="").trim().toUpperCase(),null!=i.find(this.yn,(function(e){return e.answer.trim().toUpperCase()===t})))},e.Sn=function(t,e){var n=(t+="").toUpperCase();return null!=i.find(this.yn,(function(t){return t.answer.toUpperCase()===n&&t.id!==e}))},e.wn=function(t){return null==t||""===t},e.Nn=function(t){return i.findIndex(this.yn,(function(e){return e.id===t}))},t.doesContainNonAsciiCharacters=function(t){for(var e=0;e<t.length;e++)if(t.charCodeAt(e)>127)return!0;return!1},t}()},function(t,e,n){"use strict";n.d(e,"f",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"b",(function(){return c})),n.d(e,"j",(function(){return u})),n.d(e,"d",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"g",(function(){return f})),n.d(e,"i",(function(){return d})),n.d(e,"h",(function(){return b}));function i(t){var e=[t.R,t.G,t.B].map((function(t){return(t/=255)<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4)}));return.2126*e[0]+.7152*e[1]+.0722*e[2]}function r(t){return(i({R:255,G:255,B:255})+.05)/(i(t)+.05)>4.5}function o(t){for(var e=46;!r(t)&&e>=25;){var n=u(t);n.V=.01*e,t=l(n),e--}return t}function s(t){return r(t)?{R:255,G:255,B:255}:{R:0,G:0,B:0}}function a(t){var e=t.toString(16);return 1===e.length?"0"+e:e}function c(t){return"#"+a(t.R)+a(t.G)+a(t.B)}function u(t){var e,n=t.R,i=t.G,r=t.B,o=Math.max(n,i,r),s=Math.min(n,i,r),a=o-s,c=0===o?0:a/o,u=o/255;switch(o){case s:e=0;break;case n:e=i-r+a*(i<r?6:0),e/=6*a;break;case i:e=r-n+2*a,e/=6*a;break;case r:e=n-i+4*a,e/=6*a}return{H:e,S:c,V:u}}function l(t){var e,n,i,r,o,s,a,c,u=t.H,l=t.S,h=t.V;switch(s=h*(1-l),a=h*(1-(o=6*u-(r=Math.floor(6*u)))*l),c=h*(1-(1-o)*l),r%6){case 0:e=h,n=c,i=s;break;case 1:e=a,n=h,i=s;break;case 2:e=s,n=h,i=c;break;case 3:e=s,n=a,i=h;break;case 4:e=c,n=s,i=h;break;case 5:e=h,n=s,i=a}return{R:Math.round(255*e),G:Math.round(255*n),B:Math.round(255*i)}}function h(t){t.startsWith("#")&&(t=t.substring(1));var e=parseInt(t,16);return{R:e>>16&255,G:e>>8&255,B:255&e}}function f(t){var e=h(t),n=u(e);return i(e)>186&&(n.V=.45,e=l(n)),c(e)}function d(t){var e=u(h(t));return c(l({H:e.H,S:e.S,V:e.V>=.1?e.V-.1:0}))}function b(t){var e,n=u(h(t));return e=n.S>.05?.05:0,c(l({H:n.H,S:e,V:.95}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var i=n(41);var r,o=n(7),s=n(158),a=n(26);function c(t){return p[t]||(p[t]=u(g[t]||[]).then((function(){return function(t){return function(){void 0===r&&(t=m,r=Object.keys(t).reduce((function(e,n){return e[n]=function(t,e){return v.indexOf(t)>=0?e||"":Object(a.c)(e,!1)}(n,t[n]),e}),{}));var t}(),function(t,e,n){return new Promise((function(i,r){if(!t)throw Error("No script path for "+t);var o=document.getElementsByTagName("head")[0];if(!o)return r(Error("No head element found!"));var s=document.createElement("script");s.type="text/javascript",s.async=!0,s.src=t,e&&n&&(s.crossOrigin="anonymous"),s.onload=function(){return i()},s.onerror=function(){o.removeChild(s),r(Error("Failed to load javascript file: "+t))},o.appendChild(s)}))}(r[t],Object(o.a)().isCdnEnabled,function(t){return v.indexOf(t)<0}(t))}(t)})),"undefined"!=typeof Forms&&Object(s.b)("script:"+t,p[t])),p[t]}function u(t){return Promise.all(t.map(c))}var l,h,f,d=Object(o.a)().scriptSuffix,b=Object(o.a)().isCdnEnabled,m={"combined-design":b?"Vendors/combinedmin/design_v3.min.js":"Vendors/combined/design_v3_e982333.js","combined-response":b?"Vendors/combinedmin/response_v2.min.js":"Vendors/combined/response_v2_e8aff49.js","aria-odata-v2":b?"Vendors/combinedmin/aria_odata_v2.min.js":"Vendors/combined/aria_odata_v2_2405dcd.js",BootStrap:"Vendors/bootstrap/3.4.1/bootstrap."+d,DataTables:"Vendors/DataTables."+d,Chart:"Vendors/Chart-2.6."+d,Clipboard:"Vendors/clipboard-1.7.1.min.js",ColorThief:"Vendors/color-thief/color-thief.min.js",Cropper_Modified:"Vendors/cropper/cropper.modified."+d,D3:"Vendors/d3/d3."+d,Heatmap:"Vendors/highcharts/heatmap.min.js",HighCharts:"Vendors/highcharts/highcharts.min.js",HighCharts_More:"Vendors/highcharts/highcharts-more.min.js",ImmersiveReader:"Vendors/ImmersiveReader/immersive-reader-sdk.0.0.2.min.js",Ivy:"//edera.cloudapp.net/javascripts/api/ivy.js",OfficeBrowserFeedback:"Vendors/officebrowserfeedback/1.4.2/officebrowserfeedback_floodgate.min.js",JQuery_RateIt:"Vendors/rating-1.1.0/jquery.rateit."+d,JQuery_Picker:"Vendors/pickadate-3.5.6/picker."+d,JQuery_Picker_Date:"Vendors/pickadate-3.5.6/picker.date."+d,JQuery_Picker_Time:"Vendors/pickadate-3.5.6/picker.time."+d,JQuery_QRCode:"Vendors/jquery.qrcode.min.js",Linkify:"Vendors/linkify-2.1.8/linkify.min.js",Linkify_JQuery:"Vendors/linkify-2.1.8/linkify-jquery.min.js",MathJax:Object(i.d)()?"../scripts/vendors/mathjax/MathJax.js?config=TeX-AMS_HTML":"//cdn.bootcss.com/mathjax/2.7.5/MathJax.js?config=TeX-AMS_HTML",MathQuill:"Vendors/mathquill/mathquill."+d,O365ShellBootstrap:(l=Object(o.a)(),h=l.o365ShellBootHost,f=l.o365ShellBootstrapperUrl,h?f||h.concat("/api/shellbootstrapper/",Object(o.a)().userInfo.IsMsa?"consumer":"business","/oneshell"):""),Pattern_Fill:"Vendors/highcharts/pattern-fill.min.js",Mark:"Vendors/markjs-8.9.0/mark."+d,SignalR:"Vendors/SignalR/jquery.signalR-2.4.1.min.js",Sortable:"Vendors/sortablejs-1.8.4/Sortable.modified."+d,WordCloud:"Vendors/highcharts/wordcloud.min.js",Xlsx:"Vendors/xlsx.core.min.js"};var v=["Ivy","MathJax","O365ShellBootstrap"];var g={};function O(t,e){g[t]=e}O("JQuery_Picker_Date",["JQuery_Picker"]),O("JQuery_Picker_Time",["JQuery_Picker"]),O("Linkify_JQuery",["Linkify"]),O("WordCloud",["HighCharts"]),O("HighCharts_More",["HighCharts"]),O("Heatmap",["HighCharts"]),O("Pattern_Fill",["HighCharts"]);var p={}},function(t,e,n){"use strict";n.d(e,"b",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a}));var i=n(3),r=n(6);function o(t){var e=t.Synchronizer;e.observe((function(){return c(t)}),[e.Schema.CreationFailed,e.Schema.CreationInProcess,e.Schema.CreationScheduled,e.Schema.UpdateFailed,e.Schema.UpdateInProcess,e.Schema.UpdateScheduled]),c(t)}function s(t,e,n){var o=r.a.convertToArray(t.Model).map(r.a.getObjectMasterFromModel);function s(){var t=o.map((function(t){return t.getModelByFieldSchema(e)}));n(a(t))}s(),t.observe((function(t){t.AddedModels.length&&(o=o.concat(t.AddedModels.map(r.a.getObjectMasterFromModel))),t.RemovedModels.length&&t.RemovedModels.map(r.a.getObjectMasterFromModel).forEach((function(t){t.Synchronizer.deletedFromDataSource().then((function(){o=i.without(o,t),s()}))})),s()}),[e])}function a(t){return i.contains(t,"Saving")?"Saving":i.contains(t,"Scheduled")?"Scheduled":i.contains(t,"Failed")?"Failed":"Idle"}function c(t){var e=t.Synchronizer.Model;e.CreationInProcess||e.UpdateInProcess?t.Model.SavingState="Saving":e.CreationScheduled||e.UpdateScheduled?t.Model.SavingState="Scheduled":e.CreationFailed||e.UpdateFailed?t.Model.SavingState="Failed":t.Model.SavingState="Idle"}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(76),r=n(52),o=n(82),s=n(5),a=function(){function t(t,e){void 0===e&&(e=null),this.In={correlationId:e||Object(r.c)(),duration:0,eventName:t,eventType:"qos_event",extraData:void 0},this.Cn=null}var e=t.prototype;return Object.defineProperty(e,"CorrelationId",{get:function(){return this.In.correlationId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ExtraData",{get:function(){return this.In.extraData},set:function(t){this.In.extraData=t},enumerable:!1,configurable:!0}),e.start=function(t){void 0===t&&(t=null),this.Cn=t||Object(i.b)();var e=this.Tn(this.In,"Start");Object(s.a)().logData(e,!1)},e.end=function(t,e){void 0===e&&(e=null);var n=this.Tn(t,"End");e&&(n.duration=e-this.Cn),Object(s.a)().logData(n,!1)},e.log=function(t){var e=this.Tn(t,"Log");Object(s.a)().logData(e,!1)},e.Tn=function(t,e){var n=Object(o.a)(this.In);switch(null!==this.Cn&&"Start"!==e&&(n.duration=Object(i.b)()-this.Cn),t.logLevel&&(n.logLevel=t.logLevel),t.extraData&&(n.extraData=t.extraData),e){case"Start":n.eventName+="."+e;break;case"Log":n.eventName+="."+e,t.resultCode&&(n.eventName+="."+t.resultCode);break;case"End":t.resultType&&(n.eventName+="."+t.resultType)}return n},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(3),r=n(13),o=n(7),s=n(162);function a(t,e){var n;if(Object(s.b)(t))n=t;else if(t){var a=t;if(a.isFieldReady(r.a.Schema.OwnerId)&&!a.IsGroupForm&&a.Model.OwnerId!==Object(o.a)().userInfo.UserId)return!1;a.isFieldReady(r.a.Schema.Category)&&(n=a.Model.Category)}return!!n&&i.contains({Poll:["Settings.AllowResponderGetAllResponses","DisableEditForm","ResponsePage.PollView"],"Teams Poll":["DisableEditForm"]}[n],e)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return O})),n.d(e,"f",(function(){return p})),n.d(e,"g",(function(){return j})),n.d(e,"h",(function(){return y})),n.d(e,"c",(function(){return w})),n.d(e,"d",(function(){return S})),n.d(e,"a",(function(){return N})),n.d(e,"e",(function(){return C})),n.d(e,"k",(function(){return k})),n.d(e,"i",(function(){return T})),n.d(e,"j",(function(){return F}));var i=n(0),r=n(3),o=n(1),s=n(57),a=(n(10),n(18)),c=["mp3","aif","iff","m3u","m4a","mid","mpa","ra","wav","wma"],u=["xls","xlt","xlm","xlsx","xlsm","xltx","xltm"],l=["jpg","jpeg","png","gif","bmp","tiff","psd","thm","yuv","ai","drw","eps","ps","svg","3dm","max"],h=["ppt","pot","pps","pptx","pptm","potx","potm","ppam","ppsx","ppsm","sldx","sldm"],f=["pdf"],d=["avi","mp4","mov","wmv","asf","3g2","3gp","asx","flv","mpg","rm","swf","vob"],b=["doc","dot","wbk","docx","docm","dotx","dotm","docb"],m={};c.forEach((function(t){return m[t]="Audio"})),u.forEach((function(t){return m[t]="Excel"})),l.forEach((function(t){return m[t]="Image"})),h.forEach((function(t){return m[t]="PowerPoint"})),f.forEach((function(t){return m[t]="PDF"})),d.forEach((function(t){return m[t]="Video"})),b.forEach((function(t){return m[t]="Word"}));var v={Audio:c,Excel:u,Image:l,PDF:f,PowerPoint:h,Video:d,Word:b},g={Audio:{Color:"#666666",Name:"Microphone"},Excel:{Color:"#217346",Name:"ExcelDocument"},Image:{Color:"#666666",Name:"Photo2"},PDF:{Color:"#666666",Name:"PDF"},PowerPoint:{Color:"#B7472A",Name:"PowerPointDocument"},Text:{Color:"#666666",Name:"TextField"},Video:{Color:"#666666",Name:"Video"},Word:{Color:"#2B579A",Name:"WordDocument"}},O={"10MB":10,"100MB":100,"1GB":1e3};function p(t){if(t.isFieldReady(t.Schema.FileUploadFormInfo)&&t.Model.FileUploadFormInfo&&t.Model.FileUploadFormInfo.errorCode&&"3"!==t.Model.FileUploadFormInfo.errorCode)return Object(o.a)().UploadFile_ErrorMessage_PortalPage_FormCard_Bar}function j(t){var e=Object(o.a)(),n="";switch(t){case"3":n=e.UploadFile_ErrorMessage_ErrorCode_3;break;case"6611":n=e.Error_Message_6611;break;case"6612":n=e.Error_Message_6612;break;case"6613":n=e.Error_Message_6613;break;case"6614":n=e.Error_Message_6614;break;default:n=e.UploadFile_Creation_Error_Message}return n}function y(t,e){var n="";switch(t){case 1:n=Object(o.a)().UploadFile_ErrorMessage_DesignPage_1;break;case 14:n=Object(o.a)().UploadFile_ErrorMessage_DesignPage_14;break;case 16:n=Object(o.a)().UploadFile_ErrorMessage_DesignPage_16;break;default:n=Object(o.a)().UploadFile_Creation_Error_Message}return e?n=Object(o.a)().UploadFile_ErrorMessage_DesignPage_AnonymousDisabled+" "+n:n||(n=Object(o.a)().UploadFile_Creation_Error_Message),n}function w(t){var e=[];return Object.keys(t).forEach((function(n){t[n]&&(e=e.concat(v[n]))})),e}function S(t){var e=I(t),n={className:"forms-icon-size20x20 office-form-theme-quiz-point analyze-view-file-icon",style:{color:e.Color}};return i.createElement(a.a,{HTMLAttributes:n,IconName:e.Name})}function N(t,e){switch(e){case"Audio":return t.UploadFile_Type_Audio;case"Excel":return t.UploadFile_Type_Excel;case"Image":return t.UploadFile_Type_Image;case"PowerPoint":return t.UploadFile_Type_PowerPoint;case"PDF":return t.UploadFile_Type_PDF;case"Video":return t.UploadFile_Type_Video;case"Word":return t.UploadFile_Type_Word;default:return""}}function I(t){var e=t.split("."),n=e[e.length-1].toLowerCase();return g[m[n]]||{Color:"#666666",Name:"TextDocument"}}function C(t){var e=I(t);return'<i class="ms-Icon ms-Icon--'+e.Name+' forms-icon-size20x20 response-dialog-fileIcon office-form-theme-quiz-point" style="color: '+e.Color+';"></i>'}function k(t,e){var n=t.Model.Id,i=!!r.find(t.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}));if(T(n)||!i){var o=x(),a=r.find(o,(function(t){return t.FormId===n}));a?a.ShowConfirmDialog=a.ShowConfirmDialog&&e:o.push({FormId:n,ShowConfirmDialog:!0}),Object(s.b)().setItem("officeforms.fileuploaddialogmap",JSON.stringify(o))}}function T(t){var e=r.find(x(),(function(e){return e.FormId===t}));return!!e&&e.ShowConfirmDialog}function x(){var t=[],e=Object(s.b)().getItem("officeforms.fileuploaddialogmap");return e&&(t=JSON.parse(e)),t}function F(t){var e=t.Model.FileTypes;Object.keys(e).forEach((function(t){e[t]=!0}))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return o})),n.d(e,"d",(function(){return s})),n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var i=n(3),r=n(1);function o(t,e){var n=i.filter(t.Answers,(function(t){return t.QuestionId===e}))[0];if(n)return n}function s(t){var e=function(t){return-1===t.Responder.indexOf("@")}(t),n=e?void 0:t.ResponderName,i=e?void 0:t.Responder;return{name:n=n?1===t.Id?n:Object(r.a)().DisplayFormat_DuplicateUserName.format(n,t.Id-1):Object(r.a)().DisplayFormat_AnonymousUserName.format(Object(r.a)().ResponderNameForAnonymousUser,t.Id-1),email:i}}function a(t){var e=t.map(s).map((function(t){return t.email?t.name+" <"+t.email+">":t.name})),n=i.countBy(e,(function(t){return t})),o=[];for(var a in n)if(n.hasOwnProperty(a)){var c=n[a],u=c>1?a+" ("+c+")":a;o.push(u)}return o.join(Object(r.a)().GradingView_MultipleStudents_Separator)}function c(t,e){var n={},r={};return t.filter((function(t){return"Question.Choice"===t.Type||"Question.TextField"===t.Type})).forEach((function(t){var s=t.Type;t.IsMathQuiz&&(s+=".Math"),n[s]=n[s]||0,++n[s],i.each(e,(function(e){var n=o(e,t.Id);n&&n.IsAutoGraded&&(r[s]=r[s]||0,++r[s])}))})),{responderCount:e.length,autogradableQuestionCount:n,autogradedResponsesCount:r}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(23);function r(t,e,n,r){if(Object(i.q)()){var o=$("<a></a>");return o.attr("href",t),e||(e="_blank"),o.attr("target",e),o[0].click(),o.remove(),null}return e||n||r?n||r?r?window.open(t,e,n,r):window.open(t,e,n):window.open(t,e):window.open(t)}},function(t,e,n){"use strict";function i(t,e){return t&&e?t.getFullYear()===e.getFullYear()&&t.getMonth()===e.getMonth()&&t.getDate()===e.getDate():void 0}function r(t,e){return t&&e?1e3*(60*(60*t.getHours()+t.getMinutes())+t.getSeconds())+t.getMilliseconds()-(1e3*(60*(60*e.getHours()+e.getMinutes())+e.getSeconds())+e.getMilliseconds()):void 0}function o(){return Date.now||(Date.now=function(){return(new Date).getTime()}),Math.floor(Date.now())}n.d(e,"c",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return m}));var i,r,o=n(2),s=n(112),a=n(26),c=n(35),u="Customized Theme",l="Default Theme";function h(){return r||(r=Object(c.i)()),r}function f(t){return i||(i=Object(s.c)(t||Object(c.d)().Name).then(JSON.parse)),i}function d(t){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,h()];case 1:return[2,m(e.sent()[t])||Object(c.d)()]}}))}))}function b(t){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,f(t)];case 1:return[2,m(e.sent()[t])||Object(c.d)()]}}))}))}function m(t){if(!t)return t;var e=t.BackgroundImage,n=t.Thumbnail;return null!=e&&/^\/Images\//i.test(e)&&(t.BackgroundImage=Object(a.b)(e)),null!=n&&/^\/Images\//i.test(n)&&(t.Thumbnail=Object(a.b)(n)),t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(9),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.props.Ignorable?Object(o.b)(this.props.ClassName,"optional-cell"):this.props.ClassName;return r.createElement("div",{className:t},r.createElement("div",{className:"common-spinner-circle"}),this.xn())},n.xn=function(){if(this.props.LoadingDescription)return r.createElement("div",{className:"loading-control-description",role:"status"},this.props.LoadingDescription)},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return l})),n.d(e,"b",(function(){return h}));var i=n(2),r=n(3),o=n(6),s=n(1),a=n(10),c=n(100),u=n(17),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(e,"MinimumOptionsForDropDown",{get:function(){return 7},enumerable:!1,configurable:!0}),e.getElementTypeName=function(){return"Question.Choice"},e.createDefaultDefinition=function(){var t=[{Description:Object(s.a)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0},{Description:Object(s.a)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0}];return{Type:e.getElementTypeName(),Title:Object(s.a)().Question_DefaultTitle,Choices:t,ChoiceType:u.a.SingleChoice,OptionDisplayStyle:u.c.ListAll,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&t.OptionDisplayStyle!==u.c.Dropdown},n.verify=function(t){return!this.Model.Required||t&&"[]"!==t?t&&t.length>e.MaxAnswerLength?u.e.MultiChoiceQuestionLengthLimitError:u.e.Success:u.e.RequiredError},n.isEmpty=function(t){return this.Model.ChoiceType===u.a.SingleChoice?!t:!t||"[]"===t},n.getTypeDisplayName=function(){switch(this.Model.ChoiceType){case u.a.SingleChoice:return Object(s.a)().QuestionType_SingleChoice;case u.a.MultiChoice:return Object(s.a)().QuestionType_MultiChoice;default:throw Error("Choice Question Type Not Supported")}},n.supportsQuestionLevelBranching=function(){return this.Model.ChoiceType!==u.a.SingleChoice},n.supportsChoiceLevelBranching=function(){return this.Model.ChoiceType===u.a.SingleChoice},n.getSnapshotWithoutBranchInfo=function(){var e=t.prototype.getSnapshotWithoutBranchInfo.call(this);return e.Choices=o.a.convertToArray(e.Choices).map((function(t){return delete(t=r.clone(t)).BranchInfo,t})),e},n.resetBranchInfo=function(){var e=this;t.prototype.resetBranchInfo.call(this),o.a.convertToArray(this.Model.Choices).filter((function(t){return e.getBranchInfoMaster(t.BranchInfo).resetToDefault()})),this.getBranchInfoMaster(this.Model.BranchInfoForOtherChoice).resetToDefault()},n.insertChoice=function(t,e){var n=this.Model.Choices,i=r.find(n,(function(t){return t.IsGenerated}));if(!i||e&&""!==i.Description){var s=o.a.Collection.addItems(n,[{Description:t,IsMathOption:e}]);i=s[0]}else{var c=o.a.getObjectMasterFromModel(i);Object(a.c)((function(){c.bulkEdit((function(){i.Description=t,i.IsGenerated=null,i.IsMathOption=e}))}),a.f)}return i},n.hasCorrectAnswers=function(t){return t?r.some(t.IsAnswerKeys):r.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))},n.isCorrectAnswer=function(t){var e=h(t,this.Model),n=o.a.convertToArray(this.Model.Choices).filter((function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).sort();return r.isEqual(n,e.SelectedOptions.sort())},n.justifyQuestionInfo=function(){var t=this.Master.Model;if(null==t.OptionDisplayStyle){var n=t.ChoiceType===u.a.SingleChoice&&!t.IsMathQuiz&&!t.AllowOtherAnswer&&t.Choices.length>=e.MinimumOptionsForDropDown;t.OptionDisplayStyle=n?u.c.Dropdown:u.c.ListAll}},n.showAsDropdown=function(){return this.Master.Model.OptionDisplayStyle===u.c.Dropdown},n.setAnswerKey=function(t,e){var n=this;this.Master.bulkEdit((function(){t.IsAnswerKey=e,n.Model.ChoiceType===u.a.SingleChoice&&t.IsAnswerKey&&o.a.convertToArray(n.Model.Choices).forEach((function(e){e.IsAnswerKey&&e!==t&&(e.IsAnswerKey=!1)}))}))},n.createQuizResult=function(t){if(this.Model.IsQuiz){var e=o.a.convertToArray(this.Model.Choices);return e.some((function(t){return t.IsAnswerKey}))?{IsAnswerCorrect:this.isCorrectAnswer(t),AnswerHints:e.map((function(t){return t.AnswerHint})),IsAnswerKeys:e.map((function(t){return t.IsAnswerKey})),Choices:e.map((function(t){return t.Description})),GradingBasis:this.Model.GradingBasis}:void 0}},n.autoGradeAnswer=function(e){if(r.some(this.Model.Choices,(function(t){return t.IsAnswerKey}))){var n=this.Model.Point?this.Model.Point:0;e.Score=this.isCorrectAnswer(e.Answer)?n:0,e.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,e)},n.autoGradeWithQuizResult=function(t,e){return e?e.IsAnswerCorrect?this.Model.Point:0:null},n.getBranchingResult=function(e){var n=this;if(this.Model.ChoiceType!==u.a.SingleChoice)return t.prototype.getBranchingResult.call(this,e);var i=o.a.convertToArray(this.Model.Choices),s=i.filter((function(t){return t.BranchInfo&&o.a.getObjectMasterFromModel(t.BranchInfo).isValid()})),a=o.a.getObjectMasterFromModel(this.Model.BranchInfoForOtherChoice);if(0===s.length&&!a.isValid())return t.prototype.getBranchingResult.call(this,e);var c,l=i.filter((function(t){return n.Fn(e,t)})),h=r.intersection(l,s);h.length>0||l.length>0?c=(h[0]||l[0]).BranchInfo:this.isEmpty(e)||(c=this.Model.BranchInfoForOtherChoice);return c?this.getBranchInfoMaster(c).getBranchingResult():{Type:"Pending"}},n.Fn=function(t,e){return e.Description===t},e.MaxAnswerLength=4e3,e}(c.a);function h(t,e){var n=e.ChoiceType===u.a.SingleChoice;if(null!=t){var i=o.a.convertToArray(e.Choices).map((function(t){return t.Description}));if(!n||!e.AllowOtherAnswer&&!r.contains(i,t))try{var s=JSON.parse(t);if(Array.isArray(s)){if(!s.some((function(t){return!r.isString(t)})))return{IsSingleChoiceAnswer:!1,IsLegacyChoiceAnswer:!1,SelectedOptions:s}}else if(r.isObject(s)){var a=r.values(s);if(!a.some((function(t){return!r.isString(t)})))return{IsSingleChoiceAnswer:n&&a.length<=1,IsLegacyChoiceAnswer:!0,SelectedOptions:a}}}catch(t){}}return{IsSingleChoiceAnswer:n,IsLegacyChoiceAnswer:!1,SelectedOptions:null==t?[]:[t]}}},function(t,e,n){"use strict";n.d(e,"g",(function(){return s})),n.d(e,"f",(function(){return c})),n.d(e,"h",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"i",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return b})),n.d(e,"e",(function(){return p}));var i=n(3),r=n(6),o=n(5);function s(t){return{localizedResources:a(t)}}function a(t){var e=function(t){var e=t.filter((function(t){return!t.questionId})),n=i.groupBy(e,(function(t){return t.locale}));return i.map(n,(function(t){var e={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:null,localeName:null,questionResources:[],subtitle:null,thankYouMessage:null,title:null};return t.forEach((function(t){!function(t,e){switch(t.elementKey){case"thankyoumessage":e.thankYouMessage=t.elementValue;break;case"formclosemessage":e.formCloseMessage=t.elementValue;break;case"footertext":e.footerText=t.elementValue;break;default:m(t,e)}}(t,e)})),e}))}(t),n=function(t){var e=t.filter((function(t){return t.questionId})),n=i.groupBy(e,(function(t){return t.locale})),r={};return i["map"](n,(function(t,e){var n=i["groupBy"](t,(function(t){return t.questionId}));var r=i["map"](n,(function(t,n){var r={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:e,localeName:null,option:null,questionId:n,rightDescription:null,subtitle:null,title:null};var o=t.filter((function(t){return t.elementKey&&t.elementKey.startsWith("choiceid_")}));if(o&&o.length>0){var s=i["map"](o,(function(t){var e={choiceId:null,description:null,key:null};O(t,e);return e}));r.choices=s}var a=t.filter((function(t){return t.elementKey&&!t.elementKey.startsWith("choiceid_")}));if(a){a.forEach((function(t){g(t,r)}))}return r}));return r})).forEach((function(t){var e=t.length>0&&t[0].localeId;e&&(r[e]=t)})),r}(t);return e.forEach((function(t){if(t.localeId){var e=n[t.localeId];e&&(t.questionResources=e)}})),e}function c(t){var e=v(t);return null!=t.formCloseMessage?(e.elementKey="formclosemessage",e.elementValue=t.formCloseMessage):null!=t.thankYouMessage?(e.elementKey="thankyoumessage",e.elementValue=t.thankYouMessage):null!=t.footerText&&(e.elementKey="footertext",e.elementValue=t.footerText),e}function u(t){var e=v(t);return null!=t.leftDescription?(e.elementKey="leftdescription",e.elementValue=t.leftDescription):null!=t.rightDescription?(e.elementKey="rightdescription",e.elementValue=t.rightDescription):null!=t.option&&'{"choicesV1":[]}'!==t.option?(e.elementKey="option",e.elementValue=t.option):null!=t.formsprortlocaleldescription?(e.elementKey="formsprortlocaleldescription",e.elementValue=t.formsprortlocaleldescription):null!=t.formsprortlocalerdescription&&(e.elementKey="formsprortlocalerdescription",e.elementValue=t.formsprortlocalerdescription),e}function l(t,e){var n=e.Model;if(!r.a.Collection.getItemWithKeyFields(n.LocalizedResources,{localeId:t.localeId})){var i={footerText:null,formCloseMessage:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,localeId:t.localeId,localeName:t.localeName,questionResources:[],subtitle:null,thankYouMessage:null,title:null};r.a.Collection.itemsAddedInSource(n.LocalizedResources,[i])}}function h(t,e){var n=e.Model,i=r.a.Collection.getItemWithKeyFields(n.LocalizedResources,{localeId:t});i&&r.a.Collection.itemsDeletedInSource(n.LocalizedResources,[i])}function f(t,e,n,o){var s={choices:[],choicesV1:[],formsprortlocaleldescription:null,formsprortlocalerdescription:null,formsprortlocalesubtitle:null,formsprortlocaletitle:null,leftDescription:null,localeId:t.localeId,localeName:t.localeName,option:null,questionId:e,rightDescription:null,subtitle:null,title:null},a=r.a.Collection.getItemWithKeyFields(o.Model.Questions,{Id:e});if(a&&a.ChoiceGroup&&a.ChoiceGroup.length>0){var c=i.map(a.ChoiceGroup,(function(t){return{choiceId:t.Id.toString(),description:null,key:t.Key}}));s.choices=c}var u=r.a.Collection.itemsAddedInSource(n.questionResources,[s]);return r.a.getObjectMasterFromModel(u[0])}function d(t,e,n){var i={choiceId:t,description:null,key:e},o=r.a.Collection.itemsAddedInSource(n.choices,[i]);return r.a.getObjectMasterFromModel(o[0])}function b(t){var e=r.a.Collection.itemsAddedInSource(t.choicesV1,[{choiceId:null,description:"",formsProDisplayRTText:""}]);return r.a.getObjectMasterFromModel(e[0])}function m(t,e){switch(e.localeId=t.locale,t.elementKey){case"title":e.title=t.elementValue;break;case"subtitle":e.subtitle=t.elementValue;break;case"localename":e.localeName=t.elementValue;break;case"formsprortlocaletitle":e.formsprortlocaletitle=t.elementValue;break;case"formsprortlocalesubtitle":e.formsprortlocalesubtitle=t.elementValue;break;default:var n=t.elementValue&&t.elementValue.length,i="Unexpected locale element key:["+t.elementKey+"], value length:"+n,r=new Error(i).stack;return console.log(r),void Object(o.c)("UnexpectedLocaleElementKey",i+", call stack:"+r)}}function v(t){var e={elementKey:null,elementValue:null,locale:null,questionId:null};return null!=t.title?(e.elementKey="title",e.elementValue=t.title):null!=t.subtitle?(e.elementKey="subtitle",e.elementValue=t.subtitle):null!=t.localeName?(e.elementKey="localename",e.elementValue=t.localeName):null!=t.formsprortlocaletitle?(e.elementKey="formsprortlocaletitle",e.elementValue=t.formsprortlocaletitle):null!=t.formsprortlocalesubtitle&&(e.elementKey="formsprortlocalesubtitle",e.elementValue=t.formsprortlocalesubtitle),e}function g(t,e){switch(e.questionId=t.questionId,t.elementKey){case"leftdescription":e.leftDescription=t.elementValue;break;case"rightdescription":e.rightDescription=t.elementValue;break;case"option":e.option=t.elementValue;break;case"formsprortlocaleldescription":e.formsprortlocaleldescription=t.elementValue;break;case"formsprortlocalerdescription":e.formsprortlocalerdescription=t.elementValue;break;default:m(t,e)}}function O(t,e){var n=t.elementKey;n&&n.startsWith("choiceid_")&&(e.choiceId=n.split("_")[1]),e.description=t.elementValue}function p(t,e){t&&t.length>0&&i.forEach(t,(function(t){var n=[];i.forEach(e,(function(e){var o=i.filter(t.questionResources,(function(t){return t.questionId===e.oldId}));i.forEach(o,(function(t){(t=i.clone(r.a.getObjectMasterFromModel(t).getSnapshot())).questionId=e.newId,n.push(t)}))})),r.a.Collection.addItems(t.questionResources,n)}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));function i(t){var e=function(t){try{t=t.replace(/_/g,"/").replace(/-/g,"+");var e=(l=t,window.atob(l.replace(/ /g,"")).split("").map((function(t){return t.charCodeAt(0)}))),n=r(e.slice(0,16)),i=r(e.slice(16,32)),o=function(t,e){if(null==t||0===t.length)return t;var n=t.length;for(;--n>=0&&!(e.indexOf(t.charAt(n))<0););return t.substr(0,n+1)}(function(t){for(var e="",n=0;n<t.length;++n)e+=String.fromCharCode(t[n]);return e}(e.slice(32)),"."),s={},a=o.split("$%@#");if(a.length>1){o=a[0];for(var c=1;c<a.length;c++){var u=a[c].split("=");u&&2===u.length&&(s[u[0]]=u[1])}}return{OrgId:n,OwnerId:i,TableId:o,MoreInfo:s}}catch(t){return{OrgId:null,OwnerId:null,TableId:null,MoreInfo:null}}var l}(t),n=!1;return e.MoreInfo&&"g"===e.MoreInfo.t&&(n=!0),{OrgId:e.OrgId,OwnerId:e.OwnerId,TableId:e.TableId,IsGroupOwner:n}}function r(t){if(16!==t.length)return null;var e=function(t){for(var e="",n="",i=0;i<t.length;i++)n=1===(n=t[i].toString(16)).length?"0"+n:n,e+=n;return e}([].concat(t.slice(0,4).reverse(),t.slice(4,6).reverse(),t.slice(6,8).reverse(),t.slice(8)));return e=e.slice(0,8)+"-"+e.slice(8,12)+"-"+e.slice(12,16)+"-"+e.slice(16,20)+"-"+e.slice(20)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"e",(function(){return c})),n.d(e,"f",(function(){return u})),n.d(e,"h",(function(){return l})),n.d(e,"g",(function(){return h}));var i=n(3),r=i.each,o=i.clone,s=i.escape,a=i.extend,c=i.isObject,u=i.keys,l=i.omit,h=(i.pick,i.object)},function(t,e,n){"use strict";n.d(e,"f",(function(){return o})),n.d(e,"c",(function(){return s})),n.d(e,"e",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return l}));var i=n(36),r=n(14);function o(t){return/^(https ?\:\/\/)?((www\.)?youtube\.com|youtu\.?be)\/.+$/.test(t)}function s(t){return/^(https ?\:\/\/)?(?:msit|web)\.microsoftstream\.com\/.+$/.test(t)}function a(t){return o(t)||s(t)}function c(t){return o(t)?"YouTube":s(t)?"Stream":"Other"}function u(t){var e=document.createElement("a");return e.href=t,e.host&&e.host!==window.location.host}function l(t){return Object(r.B)()?o(t)?h(t):s(t)?function(t){var e=t.indexOf("/video"),n=t.substring(t.indexOf("?")+1),r=Object(i.d)(n),o=r.st?"st="+r.st+"&amp;":"",s=t.indexOf("?")>-1?t.slice(e,t.indexOf("?")):t.slice(e);return t.slice(0,e)+"/embed"+s+"?"+o+"autoplay=false&amp;showinfo=true&amp;app=forms"}(t):void 0:h(t)}function h(t){var e=document.createElement("a");e.href=t;var n=e.pathname.split("/"),r=t.substring(t.indexOf("?")+1),o=Object(i.d)(r);return"https://www.youtube.com/embed/"+(o.v||n[0]||n[1])+"?feature=oembed&amp;modestbranding=1&amp;rel=0"+(o.t?"&amp;start="+o.t:"")}},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.Desktop=0]="Desktop",t[t.Mobile=1]="Mobile",t[t.Auto=2]="Auto",t[t.Embed=3]="Embed"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var i=n(2),r=n(6),o=n(4),s={height:o.a.number(),id:o.a.string({IsKeyField:!0}),value:o.a.reference(),width:o.a.number()};var a=function(t){function e(){return t.call(this,{ExistingInDataSource:!0})||this}return Object(i.__extends)(e,t),e.prototype.getUrl=function(){var t=this;return this.Pn||(this.Pn=this.ensureFieldsReady([this.Schema.value]).then((function(){return e=t.Model.value,new Promise((function(t,n){var i=new FileReader;i.readAsDataURL(e),i.onloadend=function(e){return t("string"==typeof i.result?i.result:"")},i.onerror=n}));var e}))),this.Pn},e}(r.a.createObjectMasterClass("PhotoMaster",s,(function(t){for(var e=0,n=u;e<n.length;e++){var i=(0,n[e])(t);if(i)return i}throw Error("Not supported")})));function c(t){u.push(t)}var u=[]},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(26),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=t.src,n=Object(i.__rest)(t,["src"]);return r.createElement("img",Object(i.__assign)({src:Object(o.b)(e)},n))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(9),c=n(18),u=n(8),l=n(38),h=n(16);function f(t){return r.createElement(d,Object(i.__assign)({},t))}var d=function(t){function e(n){var i=t.call(this,n)||this;return i.Dn=s.uniqueId(e.name),i.Mn=i.Mn.bind(i),i}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){(void 0===this.props.TrapFocus||this.props.TrapFocus)&&Object(l.g)(o.findDOMNode(this))},n.shouldComponentUpdate=function(t){return!s.isEqual(this.props,t)},n.render=function(){var t=this;if(this.props.ShowDialog){var e=Object(a.g)(this.props.HTMLAttributes,{className:this.props.ClassName||"simple-dialog-container",key:"dialogContainer",ref:"dialogContainer",tabIndex:-1,onBlur:function(e){var n=Object(a.d)(e);o.findDOMNode(t.refs.dialogContainer).contains(n)||t.props.onBlur&&t.props.onBlur()},onKeyDown:function(e){return t.nn(e)},onMouseLeave:this.props.onMouseLeave,onMouseOver:this.props.onMouseOver});return r.createElement("div",Object(i.__assign)({},e),this.props.children,this.Ln(),this.An(),this.Rn(),this.En())}return null},n.Ln=function(){var t=this.props;if(t.IconName){var e={HTMLAttributes:{className:t.IconClassName},IconName:t.IconName,key:"icon"};return r.createElement(c.a,Object(i.__assign)({},e))}},n.An=function(){if(this.props.Description){var t=Object(a.b)("description-container",this.props.TextClassName);return r.createElement("div",{className:t,id:this.Dn,key:"descriptionContainer"},this.props.Description)}return null},n.En=function(){return this.props.WarningMessage?r.createElement("div",{className:"warning-container",id:this.Dn+"_warning",key:"warningContainer"},this.props.WarningMessage):null},n.Mn=function(t,e){return Object(h.a)({ButtonStyle:t.ButtonStyle,GlyphButtonStyle:t.GlyphButtonStyle,HTMLAttributes:{"aria-describedby":t.ConveyDescription?this.Dn:"",autoFocus:0===e,className:t.ClassName,title:t.Title,onClick:function(e){e.preventDefault(),e.stopPropagation(),t.onClick&&t.onClick(e)}},Icon:t.IconClass,IconClassName:Object(a.b)(t.IconClassName,"forms-icon-size24x24"),IsDisabled:t.IsDisabled,key:t.Key,ref:t.ref,Text:t.Text,TextClassName:t.TextClassName})},n.Rn=function(){var t=this.props.ButtonsProps||[];return t.length>0?r.createElement("div",{className:"buttons-container",key:"buttonsContainer"},t.filter((function(t){return!!t})).map(this.Mn)):null},n.nn=function(t){27===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.props.onDismiss&&this.props.onDismiss())},e}(u.a)},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.Normal=0]="Normal",t[t.SoftDeleted=1]="SoftDeleted"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"d",(function(){return a})),n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u}));var i=n(3),r=n(83),o=n(138),s="officeforms.youtubebarstatus";function a(t,e){return!c(e)&&Object(r.f)(t)}function c(t){return Object(o.a)().Model.FormsTenantSettings.bingImageSearch||t&&t.isFieldReady(t.Schema.TenantSwitches)&&1===t.Model.TenantSwitches}function u(t){if(!c(t)){var e=t.FormElementManager.TopQuestionMasters,n=t.FormElementManager.SectionMasters;return i.some(e,l)||i.some(n,l)}}function l(t){var e=t.Model.VideoInfo&&t.Model.VideoInfo.Url;return e&&Object(r.f)(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(2),r=n(0);function o(t){return t.SubMenu||!t.Active?t.children:r.createElement("div",Object(i.__assign)({},t.HTMLAttributes),t.children)}},function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"d",(function(){return l})),n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return b}));var i=n(2),r=n(0),o=n(40),s=n(39);function a(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(111).then(n.bind(null,384))];case 1:return[2,{default:t.sent().PhishingReviewPageNavBar}]}}))}))}function c(t){var e=Object(s.a)(c,a);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function u(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(111).then(n.bind(null,377))];case 1:return[2,{default:t.sent().WarningBar}]}}))}))}function l(t){var e=Object(s.a)(l,u);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function h(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(111).then(n.bind(null,379))];case 1:return[2,{default:t.sent().PhishingPopUpMessage}]}}))}))}function f(t){var e=Object(s.a)(f,h);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function d(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(111).then(n.bind(null,380))];case 1:return[2,{default:t.sent().BlockUsingFormsWarningPage}]}}))}))}function b(){var t=Object(s.a)(b,d);return r.createElement(o.a,null,r.createElement(t,null))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return S})),n.d(e,"b",(function(){return N})),n.d(e,"a",(function(){return I})),n.d(e,"g",(function(){return C})),n.d(e,"f",(function(){return k})),n.d(e,"e",(function(){return T})),n.d(e,"d",(function(){return x})),n.d(e,"h",(function(){return F}));var i,r=n(5),o=n(71),s=n(210),a=n(23),c=n(12),u=n(2),l=function(){function t(e){if(this.secureUUID=e,t.initialize(),!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}var e=t.prototype;return e.initializeNativeEventCallback=function(t){window.officeMobileHandleNativeEvent=t},t.initialize=function(){window.officeMobileHandleNativeMessage||(window.officeMobileHandleNativeMessage=function(t){if(!t)return"responseObject is Empty";if(!t.callbackId)return"CallbackId and message are Empty";var e=window.mOfficeMobileNativeCallbackMap.get(t.callbackId);return e?(window.mOfficeMobileNativeCallbackMap.delete(t.callbackId),e(t.args)):"Unable to find callback"}),window.mOfficeMobileNativeCallbackMap||(window.mOfficeMobileNativeCallbackMap=new Map)},e.updateAndGetAuthTokenCallback=function(e,n){var i=this;t.initialize();var r=Date.now().toString()+"-"+t.callbackIndex++;return window.mOfficeMobileNativeCallbackMap.set(r,(function(t){var r=null;return t?t.UUID!==i.secureUUID&&(r="uuid is not same with the expected secure uuid"):r="Args is empty",null!==r?n(r):t.isSuccess?e(t.response):n(t.response),r})),r},t.callbackIndex=1e3,t}(),h=function(t){function e(e){return t.call(this,e)||this}return Object(u.__extends)(e,t),e.prototype.getServerAuthToken=function(){var e=this;return new Promise((function(n,i){if(void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.getServerAuthToken){var r=t.prototype.updateAndGetAuthTokenCallback.call(e,n,i);window.OMWebViewJSInterface.getServerAuthToken(e.secureUUID,r)}else i("App Interface not found")}))},e}(l),f=function(t){function e(e){return t.call(this,e)||this}return Object(u.__extends)(e,t),e.prototype.getServerAuthToken=function(){var e=this;return new Promise((function(n,i){var r,o;if(void 0!==window.webkit&&void 0!==window.webkit.messageHandlers.AuthToken){var s=t.prototype.updateAndGetAuthTokenCallback.call(e,n,i);null===(o=null===(r=window.webkit.messageHandlers)||void 0===r?void 0:r.AuthToken)||void 0===o||o.postMessage({UUID:e.secureUUID,callbackId:s})}else i("App Interface not found")}))},e}(l);function d(){return window.webkit&&window.webkit.messageHandlers.PageLoadCompleted?i.IOS:window.OMWebViewJSInterface&&window.OMWebViewJSInterface.onPageLoadCompleted?i.Android:i.Unknown}!function(t){t[t.Android=0]="Android",t[t.IOS=1]="IOS",t[t.Unknown=2]="Unknown"}(i||(i={}));var b,m=function(){function t(){}var e=t.prototype;return e.resolvePlatformAndgetInterface=function(t,e){var n=d();return this.getInterface(t,e,n)},e.getInterface=function(t,e,n){switch(e){case"v1_0_0":switch(+n){case i.Android:return new h(t);case i.IOS:return new f(t);default:return null}default:return null}},t}(),v=function(){function t(t){if(this.secureUUID=t,!this.secureUUID||0===this.secureUUID.trim().length)throw Error("The union secure uuid is null or empty.")}t.prototype;return t}(),g=function(t){function e(e){return t.call(this,e)||this}Object(u.__extends)(e,t);var n=e.prototype;return n.sendLinkViaApp=function(t,e){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.sendLinkViaApp&&window.OMWebViewJSInterface.sendLinkViaApp(this.secureUUID,t,e)},n.exitWebView=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.exitWebView&&window.OMWebViewJSInterface.exitWebView(this.secureUUID)},n.onPageLoadCompleted=function(){void 0!==window.OMWebViewJSInterface&&void 0!==window.OMWebViewJSInterface.onPageLoadCompleted&&window.OMWebViewJSInterface.onPageLoadCompleted(this.secureUUID)},e}(v),O=function(t){function e(e){return t.call(this,e)||this}Object(u.__extends)(e,t);var n=e.prototype;return n.sendLinkViaApp=function(t,e){var n,i;void 0!==window.webkit&&(null===(i=null===(n=window.webkit.messageHandlers)||void 0===n?void 0:n.SendLinkViaApp)||void 0===i||i.postMessage({UUID:this.secureUUID,link:t,app:e}))},n.exitWebView=function(){var t,e;void 0!==window.webkit&&(null===(e=null===(t=window.webkit.messageHandlers)||void 0===t?void 0:t.ExitWebView)||void 0===e||e.postMessage({UUID:this.secureUUID}))},n.onPageLoadCompleted=function(){var t,e;void 0!==window.webkit&&(null===(e=null===(t=window.webkit.messageHandlers)||void 0===t?void 0:t.PageLoadCompleted)||void 0===e||e.postMessage({UUID:this.secureUUID}))},e}(v),p=function(){function t(){}var e=t.prototype;return e.resolvePlatformAndgetInterface=function(t,e){var n=d();return this.getInterface(t,e,n)},e.getInterface=function(t,e,n){switch(e){case"v1_0_0":switch(+n){case i.Android:return new g(t);case i.IOS:return new O(t);default:return null}default:return null}},t}(),j=n(36),y=n(11),w=n(14);function S(){return new Promise((function(t,e){var n,u=function(){var t=P(),e=D(),n=null;n=t===i.Unknown?(new m).resolvePlatformAndgetInterface(window.UnionUuid,e):(new m).getInterface(window.UnionUuid,e,t);n||Object(r.c)("createGetTokenInterface",{errorInfo:L()});return n}(),l=new o.a("Union.GetToken");if(l.start(),!u)return A(l,n="the nativeInterface is null"),void e(n);u.getServerAuthToken().then((function(i){i?(l.end({resultType:"Success"}),Object(s.a)(i).finally((function(){return t(i)}))):(A(l,n="the token is null or empty"),e(n))}),(function(t){l.end({resultType:"ExpectedFailure"}),Object(a.r)()&&Object(c.c)("TokenFetchErrorPage")?e({innerCode:10302,innerMessage:t,type:"ExpectedFailure"}):e(t)}))}))}function N(){try{M().exitWebView()}catch(t){Object(r.c)("Union.exitWebViewFailed",{errorInfo:t.message})}}function I(){var t,e=Object(y.h)().Model;Object(a.r)()&&Object(c.c)("ShowSavingSpinner")&&!e.ShowSavingSpinner&&e.FormMaster&&("Saving"===(t=e.FormMaster.Model.IntegratedSavingState)||"Scheduled"===t||"Failed"===t)?e.ShowSavingSpinner=!0:N()}function C(){return new Promise((function(t,e){try{t(M().onPageLoadCompleted())}catch(t){Object(r.c)("Union.onPageLoadCompletedFailed",{errorInfo:t.message}),e(t)}}))}function k(){return Object(a.r)()&&Object(c.c)("UnionSSOEnabled")}function T(){return Object(a.r)()&&Object(c.c)("UnionFeatureEnabled")}function x(){return Object(a.r)()&&Object(c.c)("UnionFastAutoSaveEnabled")}function F(){return(Object(c.c)("EnableNewUxForAllMobileUsers")||Object(a.r)())&&Object(c.c)("MobileNewUXEnabled")}function P(){var t=Object(j.d)()[a.t],e=i.Unknown;if(t)switch(t){case"Android":e=i.Android;break;case"IOS":e=i.IOS}else e=d();return e===i.Unknown&&(e=Object(w.l)()?i.Android:Object(w.p)()?i.IOS:i.Unknown),e}function D(){var t=Object(j.d)()[a.s];return t||"v1_0_0"}function M(){var t=P(),e=D(),n=null;return(n=t===i.Unknown?(new p).resolvePlatformAndgetInterface(window.UnionUuid,e):(new p).getInterface(window.UnionUuid,e,t))||Object(r.c)("createNativeInterface",{errorInfo:L()}),n}function L(){var t=P(),e=D(),n=Object(j.d)(),i=window.location.hash?Object(j.d)(window.location.hash):null;return"platform:"+t+";version:"+e+";platformInUrl:"+(null==n?void 0:n[a.t])+";versionInUrl:"+(null==n?void 0:n[a.s])+";id:"+(null==n?void 0:n[a.j])+";action:"+(null==i?void 0:i["#Action"])+";formId:"+(null==i?void 0:i["#FormId"])}function A(t,e){t.end({resultType:"Failure",extraData:{error:e}})}!function(t){t[t.Mail=0]="Mail",t[t.Teams=1]="Teams"}(b||(b={}))},function(t,e,n){"use strict";n.d(e,"e",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"b",(function(){return d}));var i=n(3),r=n(175),o=n(55),s=n(22),a=n(48);function c(t){return t.IsMathQuiz&&!!t.ShowSubtitle&&!!t.Subtitle?Object(o.c)({Formula:t.Subtitle}):null}function u(t){return Object(s.g)(t.ImageInfo)}function l(t){return t.IsMathOption&&!!t.Description?Object(o.c)({Formula:t.Description,DisableLinebreaks:!0}):Object(a.b)({Text:t.Description,RenderMode:"RichText"})}function h(t,e){return i.find(t.getWrappedForm().FormElementManager.QuestionMasters,(function(t){return t.Model.Id===e}))}function f(t){if(t.QuestionInfo&&(JSON.parse(t.QuestionInfo).IsMathQuiz&&t.Title)){t.IsMathQuiz=!0;var e=t.Title;t.Title=e.split(r.a)[0]}}function d(t,e){return t.IsQuiz?0:e?2:1}},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(1),c=n(9),u=n(5),l=n(18),h=n(8),f=(n(160),[["#0078d8","#01439e"],["#ee2872","#a7183f"],["#8cc83f","#458114"],["#13a89f","#066a62"],["#922790","#5e115d"],["#e92224","#a3140b"],["#4655a0","#182d72"],["#672e91","#3a0f62"],["#117d10","#044604"]]),d=function(t){function e(e){var n=t.call(this,e)||this;return n.Bn=Date.now(),n.props.setCurrentViewInsight(n.props.Insight),n._n=n._n.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillUpdate=function(t,e){this.Hn=!s.isEqual(this.props,t)||!s.isEqual(this.state,e)},n.componentDidUpdate=function(){this.Hn&&(this.registerTooltipMouseOverEventHandler(),this.Gn(),this.props.focusOnInsightDialog(),this.updateContent())},n.componentDidMount=function(){this.props.focusOnInsightDialog(),this.registerTooltipMouseOverEventHandler()},n.componentWillUnmount=function(){this.Gn(),this.unregisterTooltipMouseOverEventHandler()},n.render=function(){return r.createElement("div",{className:"insight-view-content",ref:"insight-content"},this.qn(),this.Qn())},n.qn=function(){return r.createElement("div",{className:"insight-view-description-summary"},r.createElement("div",{className:"insight-view-description-summary-detail"},this.insightViewDescriptionDetail()))},n.Qn=function(){var t=this;if(!this.shouldShowSourceQuestions())return null;var e,n=null;this.state.ShowSourceDetail?(n=this.insightViewSourceQuestions(),e="ChevronUp"):e="ChevronDown";var o={"aria-label":this.getSourceButtonTitle(),className:"insight-view-descrption-source-title",onClick:function(){return t.setState({ShowSourceDetail:!t.state.ShowSourceDetail})},tabIndex:0,onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||t.setState({ShowSourceDetail:!t.state.ShowSourceDetail})}};return r.createElement("div",{className:"insight-view-source-questions"},r.createElement("div",{className:"insight-view-description-source-container"},r.createElement("div",Object(i.__assign)({},o),r.createElement("span",{className:"insight-view-description-source-text"},this.getSourceButtonTitle()),r.createElement(l.a,{HTMLAttributes:{className:"insight-view-description-source-icon forms-icon-size14x14 select-placeholder-arrow"},IconName:e}))),n)},n.shouldShowSourceQuestions=function(){return!0},n.getSourceButtonTitle=function(){return Object(a.a)().AnalyzeView_Insight_Source_Title},n.createSourceQuestionTitle=function(t){return Object(a.a)().AnalyzeView_Insight_Source_Question_Template.format(t.QuestionOrder,t.Title)},e.createSourceQuestionTooltip=function(t){return'<span class="insight-tooltip">'+Object(a.a)().AnalyzeView_Insight_Tooltip_Template.format(t.QuestionOrder)+'<span class="insight-tooltip-text">'+Object(a.a)().Analyze_Insight_summary_Question_Title.format(t.QuestionOrder,Object(c.i)(t.Title))+"</span></span>"},n.registerTooltipMouseOverEventHandler=function(){var t=this,e=document.getElementsByClassName("insight-tooltip");s.forEach(e,(function(e){e.addEventListener("mouseover",t._n)}))},n.unregisterTooltipMouseOverEventHandler=function(){var t=this,e=document.getElementsByClassName("insight-tooltip");s.forEach(e,(function(e){e.removeEventListener("mouseover",t._n)}))},e.getRatingRange=function(t){var e=0;switch(t){default:case 2:case 3:e=0;break;case 4:case 5:case 6:case 7:e=1;break;case 8:case 9:e=2;break;case 10:e=3}return[[1,1+e],[t-e,t]]},n._n=function(t){var e=t.currentTarget,n=o.findDOMNode(this.refs["insight-content"]),i=e.firstElementChild,r=e.getBoundingClientRect(),s=n.getBoundingClientRect();r.right+125>s.right?i.style.left="-"+i.clientWidth+"px":r.left-125<s.left&&(i.style.left="0px"),r.top+125>s.bottom&&(i.style.top="-"+(i.clientHeight+15)+"px")},n.Gn=function(){Object(u.b)("DesignPage.Responses.ReleaseInsightView",{Duration:Date.now()-this.Bn,InsightType:this.props.Insight.Type}),this.Bn=Date.now()},e}(h.a)},function(t,e,n){"use strict";n.d(e,"g",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l})),n.d(e,"f",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"d",(function(){return d})),n.d(e,"e",(function(){return b})),n.d(e,"h",(function(){return m})),n.d(e,"i",(function(){return v}));var i,r=n(3),o=(n(10),n(154)),s=n(13),a=n(188);function c(t){var e=s.a.Schema,n=[];return t.forEach((function(t){switch(t){case"Settings":case e.Settings:n.push(e.SerializedSettings);break;case"Modified":case e.Modified:n.push(e.ModifiedDate);break;case"Created":case e.Created:n.push(e.CreatedDate);break;case"ResponsesCount":case e.ResponsesCount:n.push(e.RowCount);break;case"PredefinedResponses":case e.PredefinedResponses:n.push(e.SerializedPredefinedResponses);break;case"Theme":case e.Theme:n.push(e.Background,e.OtherInfo);break;default:h().covers(t)?n.push(e.OtherInfo):n.push(t)}})),r.uniq(n)}function u(){var t=s.a.Schema;return[t.Background,t.Description,t.Logo,t.LogoInfo,t.Questions,t.DescriptiveElements,t.Settings,t.SoftDeleted,t.Title,t.PrimaryCustomizedThemeColor,t.SecondaryCustomizedThemeColor,t.TertiaryCustomizedThemeColor,t.Theme,t.TrackingId,t.XlWorkbookId,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ReputationTier,t.MeetingId,t.FormsInsightsInfo,t.ProgressBarEnabled]}function l(){return u().concat([s.a.Schema.OwnerId,s.a.Schema.OwnerTenantId])}function h(){return i||(i=new o.a([s.a.Schema.PrimaryCustomizedThemeColor,s.a.Schema.SecondaryCustomizedThemeColor,s.a.Schema.TertiaryCustomizedThemeColor,s.a.Schema.Theme,s.a.Schema.LogoInfo,s.a.Schema.CreatedFromOneDrive,s.a.Schema.TemplateId])),i}function f(){var t=s.a.Schema;return[t.Title,t.ModifiedDate,t.CreatedDate,t.MeetingId,t.FormsInsightsInfo,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Permissions,t.ResponderPermissions,t.PermissionTokens,t.ResponsesCount,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.XlExportingTag,t.XlFileUnsynced,t.XlUnsyncedReason,t.Category,t.TrackingId,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.Flags,t.ReputationTier,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.LocalizedResources,t.ProgressBarEnabled,t.FormsProRTTitle,t.FormsProRTDescription]}function d(){var t=s.a.Schema;return[t.Title,t.ModifiedDate,t.Description,t.Settings,t.Theme,t.Questions,t.DescriptiveElements,t.Logo,t.LogoInfo,t.Background,t.Category,t.PredefinedResponses,t.ThankYouMessage,t.EmailReceiptEnabled,t.DataClassificationLabel,t.Type,t.DefaultLanguage,t.LocaleList,t.ReputationTier,t.ProgressBarEnabled,t.TenantSwitches,t.PrivacyUrl]}function b(){var t=s.a.Schema;return[t.Title,t.ModifiedDate,t.OwnerId,t.OwnerTenantId,t.Description,t.Questions,t.DescriptiveElements,t.Settings,t.Theme,t.Logo,t.LogoInfo,t.Background,t.XlWorkbookId,t.Category,t.Type,t.ProgressBarEnabled]}function m(t){var e;return t.InitialData&&((t.InitialData.SerializedSettings||t.InitialData.Settings)&&(e=e||{},t.InitialData.SerializedSettings?e.Settings=JSON.parse(t.InitialData.SerializedSettings):e.SerializedSettings=a.a.serialize(t.InitialData.Settings)),(t.InitialData.SerializedPredefinedResponses||t.InitialData.PredefinedResponses)&&(e=e||{},t.InitialData.SerializedPredefinedResponses?e.PredefinedResponses=JSON.parse(t.InitialData.SerializedPredefinedResponses):e.SerializedPredefinedResponses=v(t.InitialData.PredefinedResponses))),e&&((t=r.clone(t)).InitialData=r.extend({},t.InitialData,e)),t}function v(t){return t&&t.length>0?JSON.stringify(t):null}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c}));var i,r=n(7),o=n(52),s=n(28);function a(){if(i)return i;var t=Object(r.a)().serverSessionId;return i=t||Object(o.c)()}function c(){return new Promise((function(t){s.a.Resolve("IAWTLogger").flush(t)}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(3),s=n(9),a=n(10),c=n(18),u=n(8),l=n(43);function h(){return r.createElement("hr",{className:"menu-control-hr"})}var f=function(t){function e(e){var n=t.call(this,e)||this;return n.Vn=r.createRef(),n.zn=r.createRef(),n.Un=r.createRef(),n.$n=null,n.Wn=null,n.Kn=!1,n.Jn=null,n.Ze=o.uniqueId("menu"),n.Xn=!n.props.SubMenu,n.state={MenuExpanded:!1},n.Zn=n.Zn.bind(n),n.Yn=n.Yn.bind(n),n.ti=n.ti.bind(n),n.ei=n.ei.bind(n),n.ni=n.ni.bind(n),n.ii=n.ii.bind(n),n.ri=n.ri.bind(n),n.oi=n.oi.bind(n),n.si=n.si.bind(n),n.ai=n.ai.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillReceiveProps=function(t){t.Reset&&(this.setState({MenuExpanded:!1}),t.onMenuReset&&t.onMenuReset(),this.focus())},n.componentDidMount=function(){window.addEventListener("resize",this.ni)},n.componentDidUpdate=function(t,e){!this.state.MenuExpanded&&this.Kn&&(this.focus(),this.Kn=!1),!e.MenuExpanded&&this.state.MenuExpanded&&(this.props.DisableAdjustPopupPosition||this.ci(),this.ui(this.li()[0]),this.props.onMenuExpand&&this.props.onMenuExpand()),e.MenuExpanded&&!this.state.MenuExpanded&&(this.Jn=null,this.props.onMenuCollapse&&this.props.onMenuCollapse())},n.componentWillUnmount=function(){window.removeEventListener("resize",this.ni),this.$n&&window.clearTimeout(this.$n),this.Wn&&window.clearTimeout(this.Wn)},n.render=function(){var t,e=Object(s.b)(this.props.ClassNameForContainer,"menu-control-dropup");return this.props.SubMenu?((t=this.di()).className=Object(s.b)(t.className,e),t.ref=this.zn):t={className:e},r.createElement("div",Object(i.__assign)({},t),this.bi(),this.mi())},e.setReservedWidthToRight=function(t){e.reservedWidthToRight=t},n.ni=function(){var t=this;this.$n||(this.$n=window.setTimeout((function(){t.$n=null,t.ci()}),100))},n.focus=function(){var t=this.props.SubMenu?this.zn.current:this.Vn.current;t&&!this.state.MenuExpanded&&t.focus()},n.ui=function(t){t&&t.focus()},n.gi=function(t){this.Kn=this.state.MenuExpanded&&!!t,this.setState({MenuExpanded:!this.state.MenuExpanded})},n.ai=function(){this.setState({MenuExpanded:!1})},n.bi=function(){return this.props.SubMenu?this.props.HTMLAttributes.children:Object(l.b)({HTMLAttributes:this.di(),ButtonStyle:this.props.ButtonStyle,children:this.props.HTMLAttributes.children,ref:this.Vn})},n.oi=function(t){this.props.SubMenu&&this.props.setSelectedElement(t.currentTarget),this.props.onButtonFocus&&this.props.onButtonFocus()},n.di=function(){var t={tabIndex:this.props.SubMenu?-1:0,autoFocus:this.props.AutoFocused,"aria-expanded":this.state.MenuExpanded,"aria-haspopup":!0,"aria-disabled":this.props.Disabled,"aria-controls":this.state.MenuExpanded?this.Ze:void 0,className:"menu-control-trigger"};return this.props.Disabled||(t=o.extend(t,{onClick:this.si,onFocus:this.oi,onKeyDown:this.ti})),Object(s.g)(t,this.props.HTMLAttributes)},n.Oi=function(t){switch(t){case 0:return"menuitem";case 2:return"menuitemradio";case 1:default:return"menuitemcheckbox"}},n.Yn=function(t){var e=this;t.stopPropagation();var n=Object(s.d)(t);if(this.props.SubMenu){var i=this.props.Root.current;if(!i||!i.contains(n))return void(this.Wn=window.setTimeout((function(){e.Wn=null,e.props.collapseRootMenu()}),150))}var r=this.Un.current;r&&r.contains(n)||(this.Wn=window.setTimeout((function(){e.Wn=null,e.ai()}),150))},n.pi=function(t,e){var n=this,o=!!t.IsDisabled,a=function(){o||t.onExecute()},u={"aria-disabled":o,className:Object(s.b)("separator",o?"menu-item-disabled highContrast-text-disabled":"menu-item-active",t.Checked?"checked":""),key:t.Key,onFocus:this.ii,title:t.Title,role:this.Oi(this.props.MenuItemType),tabIndex:o?void 0:-1,onClick:function(){a(),n.gi()},onBlur:this.Yn,onKeyDown:function(t){return n.ji(t,a)}};0!==this.props.MenuItemType&&(u["aria-checked"]=t.Checked);var l=t.Checked?r.createElement(c.a,Object(i.__assign)({},{HTMLAttributes:{className:"forms-icon-size18x18 question-menu-check-icon"},IconName:"CheckMark"})):void 0;return r.createElement("li",Object(i.__assign)({},u),l,r.createElement("span",null,t.Description))},n.yi=function(){var t=this,e=[],n=this.props.UnorderListMenuItems,o=!1;n&&n.filter((function(t){return!!t})).forEach((function(n,i){e.push(t.pi(n,i)),o=o||n.Checked}));var a={className:Object(s.b)("menu-control-options-box",this.props.ClassName),id:this.Ze,ref:this.Un,role:"menu",tabIndex:-1,onBlur:this.Yn,onKeyDown:this.ei},c=Object(s.b)("menu-control-options-content","menu-control","border-no-radius",o?"checked":"");return r.createElement("div",Object(i.__assign)({},a),r.createElement("ul",{className:c},e))},n.wi=function(){var t=this.Si(),e={"aria-label":this.props.AriaLabel||"",className:Object(s.b)("menu-control-options-box",this.props.ClassName),id:this.Ze,ref:this.Un,role:"menu",tabIndex:-1,onKeyDown:this.ei,onBlur:this.Yn,style:this.Xn?{overflowY:"auto"}:void 0};return r.createElement("div",Object(i.__assign)({},e),r.createElement("div",{className:"menu-control-options-content"},t))},n.Si=function(){var t=this,n=r.Children.toArray(this.props.children).filter((function(t){return t.props.Active})).length,i=0;return r.Children.map(this.props.children,(function(c,u){c=r.Children.only(c);var l=o.clone(c.props);if(l.Active){var h=t.Oi(t.props.MenuItemType),f=o.extend({key:u.toString(),"aria-disabled":l.Disabled,"aria-posinset":++i,"aria-setsize":n,role:h},l.HTMLAttributes);return l.Disabled?f.className=Object(s.b)(f.className,"menu-item-disabled highContrast-text-disabled"):(f.tabIndex=-1,f.className=Object(s.b)(f.className,"menu-item-active")),l.SubMenu?(t.Xn=!1,r.createElement(e,{AriaLabel:t.props.AriaLabelForSubmenu,MenuItemType:t.props.MenuItemType,SubMenu:!0,Disabled:l.Disabled,setSelectedElement:t.ri,HTMLAttributes:f,collapseRootMenu:t.props.collapseRootMenu||t.ai,Root:t.props.Root||t.Un},l.children)):(l.Disabled||(f=o.extend(f,{onFocus:t.ii,onClick:function(e){e.stopPropagation(),e.preventDefault(),Object(a.c)((function(){return l.onClick()}),a.f),t.props.SubMenu?t.props.collapseRootMenu():t.gi()},onKeyDown:function(e){return t.ji(e,l.onClick)}})),l.HTMLAttributes=f,r.cloneElement(c,l))}return c}))},n.ri=function(t){this.Jn=t},n.Zn=function(){return this.Un},n.mi=function(){return this.state.MenuExpanded?this.props.UnorderListMenuItems?this.yi():this.wi():null},n.si=function(t){this.props.SubMenu&&(t.stopPropagation(),t.preventDefault()),this.gi()},n.ii=function(t){t.stopPropagation(),this.Jn=t.currentTarget},n.ei=function(t){switch(t.keyCode){case 36:t.stopPropagation(),t.preventDefault(),this.ui(this.li()[0]);break;case 35:t.stopPropagation(),t.preventDefault();var e=this.li();this.ui(e[e.length-1]);break;case 38:t.stopPropagation(),t.preventDefault(),this.ui(this.Ni());break;case 39:case 40:t.stopPropagation(),t.preventDefault(),this.ui(this.Ii());break;case 37:case 27:case 9:t.stopPropagation(),t.preventDefault(),this.gi(!0)}},n.li=function(){return this.Un.current.firstElementChild.querySelectorAll(".menu-item-active")},n.Ni=function(){var t=this,e=this.li();if(e.length>0){if(this.Jn&&this.Jn!==e[0]){var n=o.findIndex(e,(function(e){return t.Jn===e}));return e[--n]}return e[e.length-1]}},n.Ii=function(){var t=this,e=this.li();if(e.length>0){if(this.Jn&&this.Jn!==e[e.length-1]){var n=o.findIndex(e,(function(e){return t.Jn===e}));return e[++n]}return e[0]}},n.ti=function(t){switch(t.keyCode){case 40:this.props.SubMenu||(t.preventDefault(),this.gi());break;case 13:t.stopPropagation(),t.preventDefault(),this.gi();break;case 39:this.state.MenuExpanded||(t.stopPropagation(),t.preventDefault(),this.gi())}},n.ji=function(t,e){switch(t.keyCode){case 32:t.stopPropagation(),t.preventDefault(),e&&e(),1!==this.props.MenuItemType&&(this.props.SubMenu?this.props.collapseRootMenu():this.gi());break;case 13:t.stopPropagation(),t.preventDefault(),e&&e(),this.props.SubMenu?this.props.collapseRootMenu():this.gi()}},n.ci=function(){var t;t=this.props.SubMenu?this.zn.current:this.Vn.current&&this.Vn.current.getHtmlElement();var n=this.Un.current;if(t&&n){var i=n.offsetWidth,r=n.offsetHeight,o=n.offsetParent;if(!o)return;for(n.style.display="none";o;){var s=window.getComputedStyle(o,""),a=s.overflowX,c=s.overflowY;if(a&&"visible"!==a||c&&"visible"!==c||"BODY"===o.tagName)break;o=o.parentElement}var u,l=o.getBoundingClientRect(),h=t.getBoundingClientRect(),f=void 0;this.props.SubMenu?(f=o.clientWidth+l.left-h.right-i>0?h.width:-i,u=o.clientHeight+l.top-h.top-r>0?0:-r):(f=Math.min(o.clientWidth+l.left-h.left-i-e.reservedWidthToRight,0),u=Math.min(o.clientHeight+l.top-h.top-r-5,h.height)),n.style.display="block",n.style.left=f+"px",n.style.top=u+"px"}},e.reservedWidthToRight=0,e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return D})),n.d(e,"b",(function(){return M}));var i,r=n(2),o=n(3),s=n.n(o),a=n(12),c=n(69),u=n(28);var l=n(206),h=n(15),f=n(41),d=n(54),b=n(50),m=n(7),v=n(112);function g(t){for(var e={},n=0,i=t.getAllResponseHeaders().split(/\r?\n/);n<i.length;n++){var r=i[n];if(r){var o=r.indexOf(": "),s=r.substring(0,o),a=r.substring(o+2);e[s]=a}}return e}var O=n(46),p=n(33),j=(n(10),n(71)),y=n(96),w=n(202),S=n(141),N=n(37),I=n(23);var C,k=n(173),T=n(104);var x={},F={},P=null;function D(t,e){var n,i;void 0===e&&(e={});var o=t.qosEventName,c=-1!==(Object(d.a)("ThrottledQosEventNames")||[]).indexOf(o),u=!e.disableLog,g=-1;u&&!c||(P||(P=setInterval((function(){Object.keys(x).forEach((function(t){x[t]=!0}))}),6e5)),void 0===x[o]||x[o]?(u=!0,g=null!==(n=F[o])&&void 0!==n?n:0,x[o]=!1,F[o]=0):(u=!1,void 0!==F[o]?++F[o]:F[o]=1));if(u){i=new j.a(o);var D=s.a.clone(t.qosExtraData);g>=0&&(D=Object(r.__assign)({SkippedCount:g},D)),i.ExtraData=D,i.start(),t.headers["X-CorrelationId"]=i.CorrelationId,t.headers["X-UserSessionId"]=Object(y.b)()}e.disableXMsHeader||(t.headers["x-ms-form-request-source"]=function(){var t="ms-formweb";if(Object(I.n)()){var e=Object(I.a)();e&&(t="ms-"+e.toLowerCase()),Object(m.a)().isOembedSPO&&(t="forms-webpart")}return Object(m.a)().isSonarServer&&(t="ms-sonar"),Object(m.a)().isAntiPhishingTool&&(t="ms-antiphishingtool"),t}(),t.headers["x-ms-form-request-ring"]=(C||(Object(m.a)().ring&&!Object(h.w)()&&(C=Object(m.a)().ring.toLowerCase()),C="USGovGccProd"===Object(f.a)()?"gcc":Object(N.j)()||Object(b.d)()?"msa":Object(N.k)()||Object(b.e)()?"msft":Object(N.f)()||Object(b.f)()?"fastfood":"business"),C));var M=-1,R=new Promise((function(n,r){var o=function(){M++,function(t,e,n,i){void 0===i&&(i=!1);t.blobResponseType?L(t,e,i?n:r):A(t,e,i?n:r);function r(i){Object(l.a)(i)?Object(p.a)().AuthContext.refreshToken().then((function(){Object(v.e)().then((function(){t.headers.__RequestVerificationToken=Object(m.a)().antiForgeryToken,function(){if(Object(m.a)().userInfo.UserId)return Promise.resolve();return Object(v.g)().catch((function(){}))}().then((function(){return A(t,e,n)}))})).catch(O.d)})):n(i)}}(t,(function(t){n(t)}),(function(n){var s,c=t.isSensitiveUri?void 0:t.requestUri.toString(),u=Object(k.b)(c,n),l=parseInt(u.statusCode),h=u.innerCode,f=!1,d=0;if(0===l||502===l||503===l)s="Forms_Http_"+l,f=M<2;else if(6503===h||624===h||647===h)s="CDB_Http_"+h,f=M<2;else if(645===h||646===h){Object(p.a)().RetryingRecoverableError=!0,s="CDB_Http_"+h,f=M<10;var b=[2,16,32,64],m=M>=b.length?64:b[M];e.hasPrefetch&&(m*=2),d=1e3*Math.min(m,64)*(.8+.4*Math.random())}if(!f||Object(a.c)("DisableRetryOption")&&e.disableRetry)return r(n);i&&i.log({resultCode:s,extraData:{RetryCount:M,RetryInterval:d,ServiceError:u}}),setTimeout(o,d)}),e.skipExpiredTokenCheck)};o()}));return i?R.then((function(e){var n,r,o={resultCode:(null===(r=null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.response)||void 0===r?void 0:r.statusCode)||"",resultType:"Success"};if("Form.Create"===t.qosEventName){var a=Object(T.c)(e);o.extraData={FormId:a.id,Origin:Object(w.a)()||void 0,RetryCount:M||void 0,XLWorkbookId:a.xlWorkbookId||void 0},s.a.extend(o.extraData,t.qosExtraData)}return i.end(o),e})).catch((function(e){var n=t.isSensitiveUri?void 0:t.requestUri.toString(),r=Object(k.b)(n,e);throw i.end({resultCode:e&&e.response?e.response.statusCode:"",resultType:Object(S.b)(r)?"ExpectedFailure":"Failure",extraData:{ServiceError:r,RetryCount:M||void 0}}),e})):R}function M(t,e){return void 0===e&&(e={}),new Promise((function(e,n){L(t,e,n,!0)}))}function L(t,e,n,i){void 0===i&&(i=!1);var r=new XMLHttpRequest,o=t.requestUri;if(r.onreadystatechange=function(){if(null!=r&&4===r.readyState){var s=r.status,a=r.statusText;1223===s&&(s=204,a="No Content");var c=r.response;if(s>=200&&s<=299){if(i){var u=g(r);c={requestUri:o,statusCode:s,statusText:a,headers:u,body:c}}r=null,e(c)}else{u=g(r);r=null,n({message:"HTTP request failed",request:t,response:{requestUri:o,statusCode:s,statusText:a,headers:u,body:c}})}}},r.open(t.method||"GET",o,!0),r.responseType="blob",t.headers)for(var s in t.headers)r.setRequestHeader(s,t.headers[s]);r.send(t.body)}function A(t,e,n){(i||(i=Object(a.a)()?new Promise((function(t,e){Object(c.a)("aria-odata-v2").then(t,(function(t){u.a.Resolve("IErrorHandler").handleJavaScriptLoadError(t)}))})):Promise.resolve()),i).then((function(){return odatajs.oData.request(t,e,n)}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"c",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"f",(function(){return f})),n.d(e,"g",(function(){return d})),n.d(e,"h",(function(){return b}));var i=n(41),r=n(12),o=n(36);function s(t,e){void 0===e&&(e=!1);var n=Object(o.d)()[t];return""===n||(n?(Array.isArray(n)&&(n=n[0]),e?"false"!==n.toLowerCase():"true"===n.toLowerCase()):e)}function a(){return s("debug")}function c(){return s("d")}function u(){return s("oembedssotrial")&&Object(i.f)()||s("oembedsso")||s("powerappembed")}function l(){return c()&&!Object(i.f)()}function h(){if(s("pptcontentsso")){var t=Object(o.d)().hostplatform;if("PC"===t)return!0;if("OfficeOnline"===t&&Object(r.c)("PPTContentAddinSSO"))return!0}return!1}function f(){return s("pptintegration")}function d(){return s("runtimeautorefresh")}function b(){return s("streamsso")&&!Object(r.c)("DisableStreamSSO")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(3),r=n(6),o=function(){function t(t){this.Ci=t}var e=t.prototype;return t.supportMobileDesign=function(t){return!1},t.hasInvalidSettingOnMobile=function(t){return t.ShowSubtitle||!!t.ImageInfo.ResourceUrl||!!t.VideoInfo.Url},Object.defineProperty(e,"Master",{get:function(){return this.Ci},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Model",{get:function(){return this.Ci.Model},enumerable:!1,configurable:!0}),e.isEmpty=function(t){return!t},e.justifyNumberBoundaries=function(){throw Error("to be overridden")},e.supportsQuestionLevelBranching=function(){return!0},e.supportsChoiceLevelBranching=function(){return!1},e.getBranchedResult=function(t,e){var n=this.getBranchingResult(t);switch(n.Type){case"Next":n.TargetElement=e}return n},e.isNumberType=function(){return!1},e.getNumberValidationErrorMessage=function(t){throw Error("to be overridden")},e.getValidationErrorMessage=function(){throw Error("to be overridden")},e.getSnapshotWithoutBranchInfo=function(){var t=i.clone(this.Master.getSnapshot());return delete t.BranchInfo,delete t.BranchInfoForOtherChoice,t},e.resetBranchInfo=function(){this.getBranchInfoMaster(this.Model.BranchInfo).resetToDefault()},e.insertChoice=function(t,e){},e.getNormalizedAnswer=function(t){return t},e.hasAnswer=function(){return!0},e.hasCorrectAnswers=function(t){return!1},e.isCorrectAnswer=function(t){return!1},e.setAnswerKey=function(t,e){},e.createQuizResult=function(t){return null},e.autoGradeAnswer=function(t){var e=!this.Model.Point,n=null==t.Answer||""===t.Answer;(e||n)&&(t.Score=0,t.IsAutoGraded=!0)},e.autoGradeWithQuizResult=function(t,e){var n=this.Master.Parent;return(n&&n.Model||this.Model).Point||(null==t||""===t)?0:null},e.serializeAnswer=function(t){return t},e.deserializeAnswer=function(t){return t},e.justifyQuestionInfo=function(){},e.showAsDropdown=function(){},e.redressGradingBasis=function(){},e.getBranchInfoMaster=function(t){return r.a.getObjectMasterFromModel(t)},e.getBranchingResult=function(t){return this.getBranchInfoMaster(this.Model.BranchInfo).getBranchingResult()},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return S})),n.d(e,"b",(function(){return N}));var i=n(2),r=n(3),o=n(6),s=n(54),a=n(7),c=n(1),u=n(11),l=n(109),h=n(29),f=n(31),d=n(88),b=n(13),m=n(63),v=n(64),g=n(169),O=n(170),p=n(10),j=n(5),y=n(204),w=n(165),S=function(t){function e(){var e=t.call(this)||this;return e.createForm=e.createForm.bind(e),e.deleteForm=e.deleteForm.bind(e),e.restoreFromRecycleBin=e.restoreFromRecycleBin.bind(e),e.moveToRecycleBin=e.moveToRecycleBin.bind(e),e.changeFormOwner=e.changeFormOwner.bind(e),e}Object(i.__extends)(e,t);var n=e.prototype;return e.triggerReadProcess=function(t,n){var i=Object(u.b)().Model;if(i.FormId||i.CopyFormId){if(!i.FormMaster||i.FormMaster.isFieldReady(b.a.Schema.Id)&&i.FormMaster.Model.Id!==i.FormId)if(i.CopyFormId)w.a.copyFormBySharingLink(i.CopyFormId,i.SharingToken).then((function(t){Object(y.a)(t.ensureReadyToDesign().then((function(){t.Model.Title+=Object(c.a)().Tile_For_Duplicate_Form})),"DesignPage_GetDesignForm"),Object(u.b)().copyBySharingLinkFinished(t)})).catch((function(t){return Object(u.b)().Model.CriticalError=t}));else{var r={Id:i.FormId},o=w.a.updateOrCreateFormMaster(r);Object(y.a)(o.ensureReadyToDesign(),"DesignPage_GetDesignForm"),i.FormMaster=o}}else if(Object(p.c)((function(){"NotStarted"===i.FormListLoadState&&Object(y.a)(e.getAllForms(!t,n),"DesignPage_GetAllForms")}),p.f),t||Object(a.a)().userInfo.IsMsa||e.getGroupMruForms(),Object(a.a)().userInfo.IsMsa){var s=O.a.getInstance();s.ensureFieldsReady([s.Schema.SampleFormStates,s.Schema.TemplateGalleryToggleState])}},e.getInactiveUserByIdOrEmail=function(t){return h.a.getInstance().createDataProvider().getInactiveUserByIdOrEmail(t)},e.copyFormByAPI=function(t,n,i,r){var s,a=Object(u.b)();s=a.getUniqueFormName(t.Model.Title,n.IsGroupForm);var c={Modified:(new Date).toUTCString(),OwnerId:n.OwnerId,OwnerTenantId:n.OwnerTenantId,Title:s},l=Object(m.c)(c,n.IsGroupForm);return e.concatToFormList(l),Object(f.i)(t).copyForm(t.Model.Id,n.OwnerId,n.OwnerTenantId,n.IsGroupForm).then((function(i){Object(v.a)("CopyFormByAPI",t.Model.Id);var r=o.a.convertFromSourceData(i,b.a.Schema),c=Object(m.a)(r,n.IsGroupForm,!1);return c.Model.Title=s,a.bulkEdit((function(){e.deleteFromFormList(l),c&&e.concatToFormList(c)})),c}),(function(n){return e.deleteFromFormList(l),Object(v.d)("CopyFormByAPI",n,t.Model.Id),n}))},e.duplicateForm=function(t,n,i,r){return e.copyFormByAPI(t,n,i,r)},e.addDefaultHeader=function(t,e){Object(u.d)().addDefaultHeader(t,e)},e.concatToFormList=function(t){var e=Object(u.b)().Model;t.IsGroupForm?t.isFieldReady("Id")&&e.GroupMaster.addFormReference({instanceId:t.getInstanceId(),modifiedDate:t.Model.Modified,ownerId:t.Model.OwnerId,ownerTenantId:t.Model.OwnerTenantId,title:t.Model.Title,softDeleted:t.Model.SoftDeleted}):t.Model.OwnerId===Object(a.a)().userInfo.UserId&&o.a.Collection.addItems(e.FormList,[t])},e.deleteFromFormList=function(t){var e=Object(u.b)().Model;t.IsGroupForm?e.GroupMaster.removeFormReference(t.getInstanceId()):o.a.Collection.deleteItems(e.FormList,[t])},e.getFormSharedWithMe=function(){var t=Object(u.b)(),e=t.Model;return e.SharedWithMeFormListLoadState="Loading",Object(f.f)().catch((function(t){throw t})).then((function(n){t.bulkEdit((function(){var t=[];n&&(t=n.sort((function(t,e){return Date.parse(e.SharedDate)-Date.parse(t.SharedDate)})).map((function(t){var e=w.a.updateOrCreateFormMaster(t);return e.IsSharedForm=!0,e}))),Promise.all(t.map((function(t){return t.ensureFieldsReady([b.a.Schema.SharedFormOwnerName,b.a.Schema.SharedDate])}))).then((function(){Object(p.c)((function(){e.SharedWithMeFormListLoadState="Loaded",e.SharedWithMeFormList=r.uniq(o.a.Collection.addItems(e.SharedWithMeFormList,t))}),p.f),Object(j.b)("PortalPage.OtherForms.FormCount",{count:e.SharedWithMeFormList.length})}))}))}))},Object.defineProperty(n,"GroupMruDocumentManager",{get:function(){return e.GroupMruDocumentManager},enumerable:!1,configurable:!0}),n.createForm=function(t,n){var i=w.a.updateOrCreateFormMaster(t,n);return e.concatToFormList(i),i},n.designForm=function(t){Object(u.b)().designForm(t)},n.moveToRecycleBin=function(t,e){var n=this,i=t.formOwnedByMe();return t.moveToRecycleBin().then((function(){if(t.isSoftDeleted()){var e=Object(u.b)().Model;i&&(o.a.Collection.addItems(e.RecycleBin,[t]),e.FormList=r.without(e.FormList,t)),n.GroupMruDocumentManager.removeDocument(t.Model.Id)}}))},n.restoreFromRecycleBin=function(t){var e=this,n=t.formOwnedByMe();return t.Model.SoftDeleted=d.a.Normal,t.Synchronizer.flush().then((function(){var i=Object(u.b)().Model;n&&(i.RecycleBin=r.without(i.RecycleBin,t),o.a.Collection.addItems(i.FormList,[t])),e.GroupMruDocumentManager.removeDocument(t.Model.Id)}))},n.deleteForm=function(t){var e=this,n=t.formOwnedByMe();return t.IsSharedForm?(t.Model.DeleteCollaborationPermission=!0,Object(f.i)(t).deleteSharedWithMeLink(t.Model.Id).then((function(){t.Model.DeleteCollaborationPermission=!1;var e=Object(u.b)().Model;e.SharedWithMeFormList=r.without(e.SharedWithMeFormList,t)}))):(t.Deleted=!0,new Promise((function(i){t.Synchronizer.flush().then((function(){var o=Object(u.b)().Model;n&&(o.RecycleBin=r.without(o.RecycleBin,t)),t.IsGroupForm&&e.removeFromMRU(t),i()}))})))},n.changeFormOwner=function(t,e){var n=Object(f.i)(t);return t.Model.TransferInProgress=!0,n.moveForm(t.Model.Id,e.OwnerId,e.IsGroupForm).finally((function(){return t.Model.TransferInProgress=!1})).then((function(e){t.Synchronizer.onDeletedInDataSource();var n=Object(u.b)().Model;return n.FormList=r.without(n.FormList,t),e})).then((function(t){return{category:t.category,id:t.id,instanceId:void 0,modifiedDate:t.modifiedDate,ownerId:t.ownerId,ownerTenantId:t.ownerTenantId,softDeleted:t.softDeleted,title:t.title}})).catch((function(t){Object(u.b)().Model.CriticalError=t}))},n.removeFromMRU=function(t){var e=this;return Object(f.i)(t).removeRecentForm(t.Model.Id).then((function(){e.GroupMruDocumentManager.removeDocument(t.Model.Id)}))},Object.defineProperty(e,"GroupMruDocumentManager",{get:function(){return g.a.getInstance()},enumerable:!1,configurable:!0}),e.getAllForms=function(t,n){var i=Object(u.b)(),s=i.Model;s.FormListLoadState="Loading";var a=b.a.Schema,c=[a.Id,a.Title,a.Created,a.Modified,a.Settings,a.XlWorkbookId,a.OwnerId,a.OwnerTenantId,a.Category,a.Theme,a.SoftDeleted,a.Type,a.FileUploadFormInfo],h=Object(l.c)(),d=Object(f.d)(c,n,h),m=t?Object(f.e)():null;return d.catch((function(t){throw s.CriticalError=t,t})).then((function(t){var n=[];if(t&&(n=t.map((function(t){return w.a.updateOrCreateFormMaster(t)})),e.shouldFilterOutSurveys()&&(n=n.filter((function(t){return"survey"!==t.Model.Type})))),m){var c=m;n.forEach((function(t){var e=c.then((function(e){var n=[];return e&&(n=e.filter((function(e){return e.id===t.Model.Id}))),0===n.length?{rowCount:-1}:{rowCount:n[0].responseCount}}));t.Synchronizer.setFieldsQueryJob([t.Schema.RowCount],e)}))}Promise.all(n.map((function(t){return t.fieldsReady([a.Modified])}))).then((function(){i.bulkEdit((function(){s.FormList=r.uniq(o.a.Collection.addItems(s.FormList,n.filter((function(t){return t.isNotSoftDeleted()})))),s.RecycleBin=r.uniq(o.a.Collection.addItems(s.RecycleBin,n.filter((function(t){return t.isSoftDeleted()})))),s.FormListLoadState="Loaded",Object(j.b)("PortalPage.MyForms.FormCount",{count:s.FormList.length,softDeletedCount:s.RecycleBin.length})}))}))}))},e.getGroupMruForms=function(){var t=Object(u.b)().Model;"NotStarted"===t.GroupMruFormListLoadState&&(t.GroupMruFormListLoadState="Loading",e.GroupMruDocumentManager.initializeFormList().then((function(){return t.GroupMruFormListLoadState="Loaded"})))},e.shouldFilterOutSurveys=function(){var t=!0;return Object(p.c)((function(){var e=new Date(Object(s.a)("CustomerVoiceTransitionCompletionDate")),n=new Date;t=n>e}),p.f),t},e}(w.a);function N(t){t.Model.Title=Object(u.b)().getUniqueFormName(t.Model.Title),S.concatToFormList(t)}},function(t,e,n){"use strict";function i(t){var e=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(e)}function r(t){var e=(t||"").trim().replace(/[,]/g,"");return $.isNumeric(e)?parseFloat(e).toString():""}function o(t){return Math.floor(t)===t}n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o}))},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.Default=0]="Default",t[t.Shown=1]="Shown",t[t.Closed=2]="Closed"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"b",(function(){return m})),n.d(e,"c",(function(){return v})),n.d(e,"a",(function(){return g}));var i=n(46),r=n(14),o=n(33),s=n(220),a=n(173),c=n(23),u=n(12),l=n(7),h=n(36),f=n(92),d=n(5);function b(t,e,n){return 401===t.statusCode&&!Object(c.o)()&&(!(Object(u.c)("TeamsGuestUser")&&401===t.statusCode&&Object(c.q)()&&Object(c.p)())&&(function(t){if(t){var e=void 0;switch(t.innerCode){case 702:e="Auth.NotOnboardedTenant";break;case 703:e="Auth.DisabledByTenantAdmin";break;case 705:e="Auth.UserNeedMultiFactorAuth"}e&&Object(d.b)(e,{tenantId:Object(l.a)().userInfo.TenantId})}}(t),Object(h.d)().embed?(t.innerCode=10001,!1):(700===t.innerCode||701===t.innerCode)&&(!Object(f.f)()||701!==t.innerCode&&700!==t.innerCode?Object(r.C)()&&Object(r.q)()&&Object(r.l)()?(t.innerCode=15003,!1):(e(),!0):(n({innerCode:701===t.innerCode?10300:10301}),!1))))}function m(t){var e=Object(a.a)(t);if(function(t){return b(t,(function(){Object(o.a)().AuthContext.signIn().then(i.a)}),s.a)}(e))return new Promise((function(){}));throw e}function v(t){return g(t).value}function g(t){var e={status:0};if(null==t)e.value=t;else{var n=t["@odata.count"]&&parseInt(t["@odata.count"]);isNaN(n)||(e.count=n),e.value=Object(r.G)(void 0===t.value?t:t.value)}return e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(1),s=n(33),a=n(78);function c(t){return r.createElement(u,Object(i.__assign)({},t))}var u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ki=void 0,e.Ti=void 0,e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.setState({Alerting:!0});var e=this.props;e.Timeout>0&&(this.ki=window.setTimeout((function(){t.setState({Timeout:!0})}),e.Timeout)),this.Ti=window.setTimeout((function(){Object(s.a)().RetryingRecoverableError&&t.setState({Timeout:!0,DetailMessage:t.props.TimeoutMessage||Object(o.a)().RetryRecoverableErrorMessage_WorkingOn})}),1e4)},n.componentWillUnmount=function(){window.clearTimeout(this.ki),window.clearTimeout(this.Ti)},n.render=function(){var t,e;if(this.state.Timeout){var n=this.state.DetailMessage||Object(o.a)().LoadingPlaceholder_Timeout_Message;t=r.createElement("div",{className:"page-loading-message-timeout"},n)}this.state.Alerting&&(e=this.props.Message);var s={ClassName:"portalPage-content-spinner",Ignorable:!1,LoadingDescription:e},c=r.createElement(a.a,Object(i.__assign)({},s));return r.createElement("div",{"aria-live":"polite","aria-label":Object(o.a)().Common_Loading_Text,className:"page-loading-messagebox",tabIndex:0},c,t)},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(44),c=n(113),u=n(137),l=n(154),h=n(201),f=n(31),d=n(25),b=function(){function t(t){this.L=t,this.N=Object(f.i)(this.L.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.L.Form.SyncContext!==d.a.DesignTimeForm)return Promise.resolve();var n=this.L.QuestionId;if(n){var i=this.L.Form.getQuestionById(n).getChoiceByKey(this.L.Model.key||"");if(i)return i.Synchronizer.existingInDataSource().then((function(){var n=i.Model.Id.toString();e.L.Model.choiceId=n;var r={elementKey:"choiceid_"+n,elementValue:t.description,locale:e.L.LocaleId,questionId:e.L.QuestionId};return Object(h.a)(r,e.L.FormId).then((function(){return{choiceId:n,description:t.description}}))}))}return Promise.reject()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.L.Form.SyncContext!==d.a.DesignTimeForm)return Promise.resolve();if(t.choiceId||void 0===t.description)throw Error("No valid payload to update.");var n={elementKey:"choiceid_"+this.L.ChoiceId,elementValue:t.description,locale:this.L.LocaleId,questionId:this.L.QuestionId};return null!==e.ValuesBefore.description?this.N.updateLocaleItem(this.L.FormId,n):this.N.createLocaleItem(this.L.FormId,n)},t}(),m={choiceId:s.a.string({IsKeyField:!0}),description:s.a.string(),key:s.a.string({IsLocalField:!0})},v=function(t){function e(e){var n=t.call(this,e)||this;if(!n.Model.key){if(!n.Model.choiceId)throw Error("Current choice localized master doesn't has key and choiceId.");e.MasterTreeReady&&e.MasterTreeReady.then((function(){return n.Form.fieldsReady([n.Form.Schema.Questions])})).then((function(){var t=n.Form.getQuestionById(n.QuestionId).getChoiceById(Number(n.Model.choiceId));t&&(n.Model.key=t.Model.Key)}))}return n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"QuestionLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Form",{get:function(){return this.QuestionLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.QuestionLocalizedMaster.Model.questionId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"LocaleId",{get:function(){return this.QuestionLocalizedMaster.Model.localeId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ChoiceId",{get:function(){return this.Model.choiceId},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("ChoiceLocalizedItemMaster",m,(function(t){return new b(t)}))),g=n(80),O=function(){function t(t){this.L=t,this.N=Object(f.i)(this.L.Form)}var e=t.prototype;return e.add=function(t){var e=this;if(this.L.Form.SyncContext!==d.a.DesignTimeForm)return Promise.resolve();var n=this.L.QuestionId;if(n){var i=this.L.Form.getElementById(n);if(i)return i.Synchronizer.existingInDataSource().then((function(){var n,i=[];for(n in t)if(t.hasOwnProperty(n)){var o=Object(g.h)(r.pick(t,[n]));o.elementKey&&(o.locale=e.L.Model.localeId,o.questionId=e.L.QuestionId,i.push(Object(h.a)(o,e.L.FormId)))}return Promise.all(i).then((function(t){}))}))}return Promise.reject()},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){if(!e.ValuesBefore||this.L.Form.SyncContext!==d.a.DesignTimeForm)return Promise.resolve();var n,i=[];for(n in t)if(t.hasOwnProperty(n)){var o=null!==e.ValuesBefore[n],s=Object(g.h)(r.pick(t,[n]));s.locale=this.L.Model.localeId,s.questionId=this.L.QuestionId,i.push(o?this.N.updateLocaleItem(this.L.FormId,s):this.N.createLocaleItem(this.L.FormId,s))}return Promise.all(i).then((function(){}))},t}(),p={choices:s.a.collectionOf((function(){return v})),choicesV1:s.a.collectionOf({choiceId:s.a.string({IsLocalField:!0}),description:s.a.string({SourceFieldName:"Description"}),formsProDisplayRTText:s.a.string({SourceFieldName:"FormsProDisplayRTText"})},{IsLocalField:!0}),formsprortlocaleldescription:s.a.string(),formsprortlocalerdescription:s.a.string(),formsprortlocalesubtitle:s.a.string(),formsprortlocaletitle:s.a.string(),leftDescription:s.a.string(),localeId:s.a.string({IsKeyField:!0}),localeName:s.a.string(),option:s.a.string(),questionId:s.a.string({IsKeyField:!0}),rightDescription:s.a.string(),subtitle:s.a.string(),title:s.a.string()},j=function(t){function e(n){var i=this,r=new a.a;return(i=t.call(this,n,{MasterReady:r.promise(),Scheduler:new c.a(e.name)})||this).xi(n),r.resolve(),i}Object(i.__extends)(e,t);var n=e.prototype;return e.handleChoicesV1Deleted=function(t,e,n){t<0||r.forEach(n.Model.LocalizedResources,(function(n){r.filter(n.questionResources,(function(t){return t.questionId===e})).forEach((function(e){e.choicesV1.length>t&&o.a.Collection.itemsDeletedInSource(e.choicesV1,[e.choicesV1[t]])}))}))},e.handleChoicesV1Exchange=function(t,e,n,i){r.forEach(i.Model.LocalizedResources,(function(i){o.a.getCollectionMasterFromModel(i.questionResources).bulkEdit((function(i){r.filter(i,(function(t){return t.questionId===n})).forEach((function(n){var i,o,s=n.choicesV1;for(t>e?(i=e,o=t):(i=t,o=e);s.length<=o+1;)Object(g.b)(n);var a=r.map(s,(function(t){return t.description})),c=a.splice(t,1);a.splice(e,0,c[0]);for(var u=i;u<=o;++u)s[u].description=a[u]}))}))}))},Object.defineProperty(n,"Form",{get:function(){return this.FormLocalizedMaster.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormLocalizedMaster",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.Model.questionId},enumerable:!1,configurable:!0}),n.getChoiceLocalizedMaster=function(t){var e=this,n=r.find(this.Form.Model.Questions,(function(t){return t.Id===e.QuestionId}));if(n){var i=r.find(n.ChoiceGroup,(function(e){return e.Id.toString()===t}));if(i){var s=o.a.Collection.getItemWithKeyFields(this.Model.choices,{choiceId:t});return s?o.a.getObjectMasterFromModel(s):Object(g.a)(t,i.Key,this.Model)}}throw Error("Question or Chocie don't exist for localization.")},n.getChoiceV1LocalizedMaster=function(t){var e=this,n=r.find(this.Form.Model.Questions,(function(t){return t.Id===e.QuestionId}));if(n&&n.Choices.length>t){for(;this.Model.choicesV1.length<n.Choices.length;)Object(g.b)(this.Model);return o.a.getObjectMasterFromModel(this.Model.choicesV1[t])}return null},n.xi=function(t){e.Schema.option&&(this.Fi=new u.a(this,e.Schema.option,e.ChoicesV1FieldSet),t.InitialData&&this.isFieldReady(e.Schema.option)&&(t.ExistingInDataSource||t.InitialData.option?this.Fi.deserialize():this.Fi.serialize()))},Object.defineProperty(e,"ChoicesV1FieldSet",{get:function(){return e.choicesV1FieldSet||(e.choicesV1FieldSet=new l.a([e.Schema.choicesV1])),e.choicesV1FieldSet},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("QuestionLocalizedItemMaster",p,(function(t){return new O(t)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(2),r=n(0),o=n(18),s=n(8),a=n(110),c=n(114),u=/[-_[\]{}()<>!@%~&*+=?.,:;"'`\\^$|#]/g,l=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={ShowPhoto:!1},e.ce=!0,e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.props.Photo.then((function(t){return t.getUrl()})).then((function(e){t.ce&&t.setState({PhotoUrl:e,ShowPhoto:!0})})).catch((function(){}))},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){return r.createElement("div",{className:"fl-owner-container"},r.createElement("div",{className:"fl-facepile"},this.Pi(),this.Di(),this.Mi()),r.createElement("div",{className:"fl-displayname"},r.createElement("span",{className:"searchable"},this.props.HideName?"":this.props.DisplayText||this.props.DisplayName)))},n.Pi=function(){return 2!==this.props.PhotoType?null:r.createElement("div",{className:"author-notification-content"},r.createElement(o.a,{IconName:"Recent"}))},n.Di=function(){return 1!==this.props.PhotoType?null:this.state.ShowPhoto?this.Li(this.state.PhotoUrl):r.createElement("div",{className:"default-group-icon-container"},r.createElement(o.a,{IconName:"Group"}))},n.Mi=function(){return 0!==this.props.PhotoType?null:this.state.ShowPhoto?this.Li(this.state.PhotoUrl):this.Ai()},n.Li=function(t){return t&&"data:"!==t?r.createElement("img",{"aria-hidden":!this.props.HideName,className:"author-notification-content",src:t,title:this.props.DisplayName}):this.Ai()},n.Ai=function(){var t=this.props.DisplayName||"",e=t.replace(u,""),n={displayText:Object(c.a)(t,e.split(/\s+/)[0],e.split(/\s+/)[1]),name:t,tooltip:this.props.HideName?t:""};return r.createElement(a.a,Object(i.__assign)({},n))},e}(s.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3),r=function(){return function(){}}();!function(t){var e=function(){function t(t,e){void 0===e&&(e=0),this.Ri=t,this.Ei=e}var e=t.prototype;return e.callOnceLater=function(){var t=this;0!==this.Ei&&null!=this.Bi&&this.clear(),null==this.Bi&&(this.Bi=window.setTimeout((function(){t.callImmediately()}),this.Ei))},e.flush=function(){null!=this.Bi&&(this.clear(),this.Ri())},e.callImmediately=function(){null!=this.Bi&&this.clear(),this.Ri()},e.clear=function(){clearTimeout(this.Bi),this.Bi=void 0},t}();t.CallLater=e;var n=function(){function t(){this._i=[]}var e=t.prototype;return e.register=function(t){this._i.push(t)},e.unregister=function(t){this._i=i.without(this._i,t)},Object.defineProperty(e,"trigger",{get:function(){return this.Hi},enumerable:!1,configurable:!0}),e.clear=function(){this._i=[]},e.Hi=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._i.forEach((function(e){return e.apply(void 0,t)}))},t}();t.CallbackManager=n}(r||(r={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f}));var i=n(15),r=n(23),o=n(12),s=n(46),a=n(120);function c(t){return new Promise((function(e){var n=window.location.pathname,r=n.toLowerCase().startsWith(a.a.toLowerCase())||Object(i.p)();return!t!=!r?(n=t?a.a+n:n.substring(a.a.length),void Object(s.e)(n)):e()}))}function u(){return new Promise((function(t){if(!Object(o.c)("ProRedirectInWeb"))return t();var e=location.href.indexOf("experienceType=");if(e>=0){var n=l(location.search,"experienceType"),i=window.location.pathname,r=i.toLowerCase().startsWith(a.a.toLowerCase()),c=location.href.substring(e).toLowerCase().indexOf("pro")>=0;r&&c||!r&&!c?window.history.replaceState(null,null,i+n):(i=c?a.a+i:i.substring(a.a.length),Object(s.f)(location.origin+i+n))}}))}function l(t,e){var n=window.location.search.substring(1);return n&&(n=n.split("&").filter((function(t){return!t.startsWith(e+"=")})).join("&")),n?"?"+n:""}function h(t){return new Promise((function(e){if(!Object(o.c)("ProRedirectInWeb"))return c(t).then(e);var n=window.location.pathname,i=n.toLowerCase().startsWith(a.a.toLowerCase());if(!t==!i)return e();var r="";if(t?(n=a.a+n,r="experienceType=base"):(n=n.substring(a.a.length),r="experienceType=pro"),location.href.indexOf("experienceType=")>=0)Object(s.e)(n);else{r=0===location.search.length?"?"+r:"&"+r;var u=location.origin+n+location.search+r+location.hash;Object(s.f)(u)}}))}function f(){if(Object(r.n)())return{name:"type",operator:"ne",value:"'survey'"}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var i=n(2),r=n(0),o=n(68),s=n(18),a=function(t){function e(e){return t.call(this,e)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.Gi(),e=this.props.displayText?this.props.displayText.toLocaleUpperCase():Object(s.b)({HTMLAttributes:{className:"author-notification-icon"},IconName:"Contact"}),n={backgroundColor:t.backgroundColor,color:t.textColor},o={"aria-label":this.props.ariaLabel||this.props.tooltip,className:"author-notification-content",style:n,title:this.props.tooltip};return r.createElement("div",Object(i.__assign)({},o),r.createElement("span",{"aria-hidden":!0},e))},e.createColor=function(t){for(var n=0,i=t.length-1;i>=0;i--){var r=t.charCodeAt(i),o=i%8;n^=(r<<o)+(r>>8-o)}var s=n%e.COLOR_SWATCHES_LOOKUP.length;return e.COLOR_SWATCHES_LOOKUP[s]},n.Gi=function(){var t=this.props,n="",i="";t.backgroundColor&&(n=Object(o.b)(t.backgroundColor)),t.textColor&&(i=Object(o.b)(t.textColor));var r=t.email||t.name;return""!==i&&""!==n||!r||(n=n||e.createColor(r),i=i||Object(o.b)(Object(o.c)(Object(o.e)(n)))),{backgroundColor:n=n||e.defaultBackgroundColor,textColor:i=i||e.defaultTextColor}},e.COLOR_SWATCHES_LOOKUP=["#3765E4","#D83B01","#B91C49","#910A19","#E40089","#971497","#8150FD","#562685","#2C5797","#007B8A","#11723F","#6F292A","#A16412"],e.defaultBackgroundColor=e.COLOR_SWATCHES_LOOKUP[0],e.defaultTextColor="#FFFFFF",e}(n(8).a);function c(t){return r.createElement(a,t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"c",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"d",(function(){return f}));var i,r=n(29),o=n(23),s=n(50),a=n(7);function c(){return"https://go.microsoft.com/fwlink/?linkid=2121428"}function u(){return i||(i=new Promise((function(t){var e,n=Object(s.a)();if((null==n?void 0:n.isFieldReady(n.Schema.PrivacyUrl))&&n.Model.PrivacyUrl&&(e=n.Model.PrivacyUrl),e)t(e);else{var i=Object(s.c)();Object(r.b)().getPrivacySettings(i&&i.OrgId,Object(a.a)().userInfo.TenantId).then((function(e){return t(e&&e.privacyUrl)}),(function(e){return t(void 0)}))}}))),i}function l(){var t={ar:"ar-sa",bg:"bg-bg",ca:"es-es",cs:"cs-cz",da:"da-dk",de:"de-de",el:"el-gr",en_us:"en-us",es:"es-es",et:"et-ee",eu:"es-es",fi:"fi-fi",fr:"fr-fr",gl:"es-es",he:"he-il",hi:"hi-in",hr:"hr-hr",hu:"hu-hu",id:"id-id",it:"it-it",ja:"ja-jp",kk:"kk-kz",ko:"ko-kr",lt:"lt-lt",lv:"lv-lv",ms:"ms-my",nb_no:"nb-no",nl:"nl-nl",pl:"pl-pl",pt_br:"pt-br",pt_pt:"pt-pt",ro:"ro-ro",ru:"ru-ru",sk:"sk-sk",sl:"sl-si",sr_cyrl_rs:"sr-cyrl-rs",sr_latn_rs:"sr-latn-rs",sv:"sv-se",sy_latn_rs:"sy-latn-rs",th:"th-th",tr:"tr-tr",uk:"uk-ua",vi:"vi-vn",zh_cn:"zh-cn",zh_tw:"zh-tw"},e=Object(a.a)().cultureInfo.Name.toLowerCase(),n="en-us";for(var i in t)if(e===t[i]||e===i){n=t[i];break}return"http://o15.officeredir.microsoft.com/r/rlidOfficeWebHelp?p1=microsoftforms&clid="+n+"&ver=16&mode=Touch"}function h(t){var e=Object(a.a)().userInfo.IsMsa?1:2,n="https://www.office.com/launch/forms",i=Object(o.h)();if(i){var r;switch(i){case"appitems":r=n+"/"+i+"?auth="+e;break;case"groupitems":t&&(r=n+"/"+i+"?auth="+e+"&groupId="+t);break;case"officehome":r="https://www.office.com?auth="+e}window.location.assign(r||n+"?auth="+e)}}function f(){location.assign("/Pages/PortalPage.aspx")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"e",(function(){return h})),n.d(e,"g",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"h",(function(){return b})),n.d(e,"f",(function(){return m})),n.d(e,"d",(function(){return p}));var i=n(129);n(10);var r=n(5),o=n(71),s=n(96),a=n(15),c=n(7);function u(t){var e;return t&&(e="lang="+t),g(Object(c.a)().isHashResourceEnabled?"GetHashResourceStrings":"GetResourceStrings",e,void 0)}function l(){return u(Object(a.f)())}function h(){return g("GetRefreshedAntiForgeryToken",void 0,void 0).then((function(t){var e=Object(c.a)();e.antiForgeryToken=t,Object(c.b)(e)}))}function f(){return O("GetUserInfo",void 0,void 0,void 0).then((function(t){var e=Object(c.a)();e.userInfo=t,Object(c.b)(e)}))}function d(t){return O("GetThemes",void 0,JSON.stringify({name:t||""}),void 0)}function b(t){return O("GetUserInfo",void 0,void 0,v(t)).then((function(t){if(t){var e=Object(c.a)();e.userInfo=t,Object(c.b)(e)}}))}function m(t){return O("GetFlights",void 0,void 0,v(t)).then((function(t){if(t){var e=Object(c.a)();e.flights=t,Object(c.b)(e)}}))}function v(t){return{Accept:"application/json",Authorization:Object(i.a)(t)}}function g(t,e,n){return O(t,e,n,void 0)}function O(t,e,n,i){return new Promise((function(r,a){var c,u=new XMLHttpRequest;c="/"===window.location.pathname?"/Default.aspx/"+t:window.location.pathname+"/"+t,e&&(c+="?"+e),u.open("POST",c);var l=new o.a(function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t?t.replace(/{(\d+)}/g,(function(t,n){return void 0!==e[n]?e[n].toString():t})):t}("PageMethod.{0}",t));l.start(),u.setRequestHeader("content-type","application/json; charset=utf-8"),u.setRequestHeader("X-CorrelationId",l.CorrelationId),u.setRequestHeader("X-UserSessionId",Object(s.b)()||""),i&&Object.keys(i).forEach((function(t){u.setRequestHeader(t,i[t])})),n?u.send(n):u.send(),u.onreadystatechange=function(){if(u.readyState===XMLHttpRequest.DONE){var t=u.status;200===t||202===t||201===t?(l.end({resultType:"Success",extraData:{status:u.statusText}}),r(u.responseText&&JSON.parse(u.responseText).d)):(l.end({resultType:"Failure",extraData:{url:c,message:u.statusText}}),a(u.statusText))}}}))}function p(t,e,n,i){var o=i||Object(a.f)()||navigator.language,s="https://uhf.microsoft.com/"+o+"/shell/xml/OfficeForms";t&&(s+="?"+t),$.ajax({type:"GET",url:s,dataType:"xml",success:function(t){e&&e(t)},error:function(i){Object(r.b)("Error.UHF.UniversalHeaderAndFooterError",{error:i}),"en-us"!==o?p(t,e,n,"en-us"):n&&n(i)}})}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(44),r=n(92),o=function(){function t(t,e,n){var i=this;void 0===e&&(e=1e3),void 0===n&&(n=5e3),this.qi=Number.MAX_VALUE,e=null!=e?e:1e3,n=null!=n?n:5e3,Object(r.d)()?this.Qi=e:this.Qi=4*e,this.Vi=4*n,this.zi=function(){var t=i.Ui();t&&t.resolve()}}var e=t.prototype;return e.scheduleUpdate=function(){return this.$i&&console.warn("Calling scheduleUpdate() before the previous one is resolved."),this.$i=new i.a,this.Wi=window.setTimeout(this.zi,this.Qi),this.Ki=window.setTimeout(this.zi,this.Vi),this.$i.promise()},e.postponeUpdate=function(){this.$i||console.warn("Calling postponeUpdate() before update scheduled."),this.Wi&&window.clearTimeout(this.Wi),this.Wi=window.setTimeout(this.zi,this.Qi)},e.cancelUpdate=function(){var t;null===(t=this.Ui())||void 0===t||t.reject()},e.setMaxRetryTimesForUpdate=function(t){this.qi=t},e.Ui=function(){window.clearTimeout(this.Wi),this.Wi=void 0,window.clearTimeout(this.Ki),this.Ki=void 0;var t=this.$i;return this.$i=void 0,t},e.retryForCreation=function(t){return t<3?Promise.resolve():Promise.reject("Retry times exceeded.")},e.retryForUpdate=function(t){var e=this;if(t>=this.qi)return Promise.reject("times >= this.maxRetryTimesForUpdate");var n=a;t<c&&(n=s*Math.pow(2,t));var r=new i.a;return this.Ji=window.setTimeout((function(){e.Ji=void 0,r.resolve()}),n),r.promise()},e.cancelRetryForUpdate=function(){window.clearTimeout(this.Ji),this.Ji=void 0},t}(),s=2500,a=6e5,c=Math.log(a/s)/Math.log(2)},function(t,e,n){"use strict";n.d(e,"b",(function(){return b})),n.d(e,"a",(function(){return m}));var i=n(14),r=new RegExp("\\(([^)]*)\\)","gi"),o=new RegExp("(?:[\0-/:-@[-^`{--]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udbff](?![\udc00-\udfff])|(?:[^\ud800-\udbff]|^)[\udc00-\udfff]) ","gi"),s=new RegExp("\\s+","gi"),a=new RegExp("[--]"),c=new RegExp("[-|-|-|-|-]"),u=new RegExp("[---]|[\ud840-\ud868][\udc00-\udfff]|\ud869[\udc00-\uded6\udf00-\udfff]|[\ud86a-\ud86c][\udc00-\udfff]|\ud86d[\udc00-\udf34\udf40-\udfff]|\ud86e[\udc00-\udc1d]");function l(t,e){var n=t.replace(/\s/,"");return e?n[n.length-1]:n[0]}function h(t,e){var n=t.replace(/\s/,"");return n.length<=2?e?n[0]:n[n.length-1]:e?n.substr(0,2):n.substr(n.length-2,n.length)}function f(t,e){var n="",i=t.split(" ");return 2===i.length?(n+=i[0].charAt(0).toUpperCase(),n+=i[1].charAt(0).toUpperCase()):3===i.length?(n+=i[0].charAt(0).toUpperCase(),n+=i[2].charAt(0).toUpperCase()):0!==i.length&&(n+=i[0].charAt(0).toUpperCase()),e&&n.length>1?n.charAt(1)+n.charAt(0):n}function d(t){return t=(t=(t=(t=t.replace(r,"")).replace(o,"")).replace(s," ")).trim()}function b(t,e){return null==t?"":(arguments.length<2&&(e=Object(i.y)()),t=d(t),a.test(t)?l(t,!!e):c.test(t)||u.test(t)?h(t,!!e):f(t,!!e))}function m(t,e,n){return b(t?t.trim():((e||"")+" "+(n||"")).trim())}},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return d}));var i=n(2),r=n(19),o=n(1);var s=n(102),a=n(14),c=(n(10),n(100)),u=n(17),l=n(67);function h(t){return function(t,e){var n=null!=e?e:Object(o.a)();switch(t){case"Between":return n.NumberValidationBetween;case"Equal":return n.NumberValidationEqual;case"Greater":return n.NumberValidationGreater;case"GreaterOrEqual":return n.NumberValidationGreaterOrEqual;case"Less":return n.NumberValidationLess;case"LessOrEqual":return n.NumberValidationLessOrEqual;case"None":return n.NumberValidationNone;case"NotBetween":return n.NumberValidationNotBetween;case"NotEqual":return n.NumberValidationNotEqual;case"OnlyNumber":return n.NumberValidationOnlyNumber;case"RuleEnum_None":return n.NumberValidationRuleEnum_None;case"RuleError":return n.NumberValidationRuleError;case"_Between_Label":return n.NumberValidation_Between_Label;case"_Checkbox_Description":return n.NumberValidation_Checkbox_Description;case"_DropDown_Hint":return n.NumberValidation_DropDown_Hint;case"_ErrorMessage_Between":return n.NumberValidation_ErrorMessage_Between;case"_ErrorMessage_Equal":return n.NumberValidation_ErrorMessage_Equal;case"_ErrorMessage_Greater":return n.NumberValidation_ErrorMessage_Greater;case"_ErrorMessage_GreaterOrEqual":return n.NumberValidation_ErrorMessage_GreaterOrEqual;case"_ErrorMessage_Less":return n.NumberValidation_ErrorMessage_Less;case"_ErrorMessage_LessOrEqual":return n.NumberValidation_ErrorMessage_LessOrEqual;case"_ErrorMessage_None":return n.NumberValidation_ErrorMessage_None;case"_ErrorMessage_NotBetween":return n.NumberValidation_ErrorMessage_NotBetween;case"_ErrorMessage_NotEqual":return n.NumberValidation_ErrorMessage_NotEqual;case"_Rule_Description_Label":return n.NumberValidation_Rule_Description_Label;default:return""}}(u.b[t])}function f(t){return function(t,e){var n=null!=e?e:Object(o.a)();switch(t){case"Custom":return n.ValidationTypeCustom;case"Email":return n.ValidationTypeEmail;case"Number":return n.ValidationTypeNumber;default:return""}}(u.g[t])}var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.TextField"},e.createDefaultDefinition=function(){return e.createDefaultSingleLineDefinition()},e.createDefaultSingleLineDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(o.a)().Question_DefaultTitle,Multiline:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&!t.IsNumber},n.verify=function(t){var e=t;if(this.Model.IsMathQuiz&&e){var n=Object(a.G)(t);if((e=null==n.Answer?t:n.Answer).length>Object(r.B)())return u.e.MathLengthError}return this.Model.Required&&!e?u.e.RequiredError:e&&this.Model.IsNumber&&!this.Xi(e)?u.e.NumberValidationError:u.e.Success},n.getTypeDisplayName=function(){return this.Model.Multiline?Object(o.a)().QuestionType_MultiLineText:this.Model.IsNumber?Object(o.a)().Common_Number_Text:Object(o.a)().QuestionType_SingleLineText},n.isNumberType=function(){return!!this.Model.IsNumber},n.justifyNumberBoundaries=function(){var t=this;this.Master.bulkEdit((function(){var e=t.Master.Model,n=Object(s.a)(e.NumberMinBoundary)||"1",i=Object(s.a)(e.NumberMaxBoundary)||"10";switch(e.NumberValidationRule){case u.b.Greater:case u.b.GreaterOrEqual:case u.b.Equal:case u.b.NotEqual:i=null;break;case u.b.Less:case u.b.LessOrEqual:n=null;break;case u.b.Between:case u.b.NotBetween:if(parseFloat(n)>parseFloat(i)){var r=n;n=i,i=r}}e.NumberMinBoundary=n,e.NumberMaxBoundary=i}))},n.getValidationErrorMessage=function(t){},n.getNumberValidationErrorMessage=function(t){var e=this.Model.NumberValidationRule;if(null!=e){var n=function(t,e){var n=null!=e?e:Object(o.a)();switch(t){case"Between":return n.NumberValidation_ErrorMessage_Between;case"Equal":return n.NumberValidation_ErrorMessage_Equal;case"Greater":return n.NumberValidation_ErrorMessage_Greater;case"GreaterOrEqual":return n.NumberValidation_ErrorMessage_GreaterOrEqual;case"Less":return n.NumberValidation_ErrorMessage_Less;case"LessOrEqual":return n.NumberValidation_ErrorMessage_LessOrEqual;case"None":return n.NumberValidation_ErrorMessage_None;case"NotBetween":return n.NumberValidation_ErrorMessage_NotBetween;case"NotEqual":return n.NumberValidation_ErrorMessage_NotEqual;default:return""}}(u.b[e],t);return null==n?void 0:n.format(this.Model.NumberMinBoundary,this.Model.NumberMaxBoundary)}},n.hasCorrectAnswers=function(t){return!(!this.Model.IsQuiz||this.Model.Multiline)&&new l.a(t||this.Model).areAnyAnswersDefined()},n.isCorrectAnswer=function(e){return this.Model.IsQuiz&&!this.Model.Multiline?new l.a(this.Model).isCorrect(e):t.prototype.isCorrectAnswer.call(this,e)},n.createQuizResult=function(t){if(new l.a(this.Model).areAnyAnswersDefined()&&this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.autoGradeAnswer=function(e){if(this.Model.IsQuiz&&!this.Model.Multiline){var n=new l.a(this.Model);if(n.areAnyAnswersDefined()){var i=this.Model.Point?this.Model.Point:0;e.Score=n.isCorrect(e.Answer)?i:0,e.IsAutoGraded=!0}else t.prototype.autoGradeAnswer.call(this,e)}else t.prototype.autoGradeAnswer.call(this,e)},n.autoGradeWithQuizResult=function(e,n){return n?this.Model.IsQuiz&&!this.Model.Multiline?n.IsAnswerCorrect?this.Model.Point:0:t.prototype.autoGradeWithQuizResult.call(this,e,n):null},n.Zi=function(t,e){return void 0===t||""===t||!!e.test(t)},n.Xi=function(t){if(void 0===t||""===t)return!0;if(!Object(s.b)(t))return!1;var e=parseFloat(Object(s.a)(t)),n=parseFloat(this.Model.NumberMinBoundary),i=parseFloat(this.Model.NumberMaxBoundary);switch(this.Model.NumberValidationRule){case u.b.None:return!0;case u.b.Between:return e>=n&&e<=i;case u.b.NotBetween:return!(e>=n&&e<=i);case u.b.Greater:return e>n;case u.b.GreaterOrEqual:return e>=n;case u.b.Less:return e<i;case u.b.LessOrEqual:return e<=i;case u.b.Equal:return e===n;case u.b.NotEqual:return e!==n;default:return!0}},n.deserializeAnswer=function(t){if(this.Model.IsMathQuiz&&t&&""!=t){var e=Object(a.G)(t);return this.Model.IsAnswerPlainText=!e.IsMath,null==e.Answer?t:e.Answer}return t},e}(c.a)},function(t,e,n){"use strict";n.d(e,"f",(function(){return a})),n.d(e,"d",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"c",(function(){return h})),n.d(e,"a",(function(){return f}));var i=n(12),r=n(37),o={af:"Afrikaans","am-et":" ()",ar:"","as-in":" ()","az-latn-az":"Azrbaycan (Azrbaycan)",bg:"","bn-in":" ()","bs-latn-ba":"Bosanski (Bosna i Hercegovina)",ca:"Catal","ca-es-valencia":"Valenci (Espanya)",cs:"etina","cy-gb":"Cymraeg (Y Deyrnas Unedig)",da:"Dansk",de:"Deutsch",el:"","en-gb":"English (United Kingdom)","en-us":"English (United States)","es-ES":"Espaol (Espaa, alfabetizacin internacional)","es-mx":"Espaol (Mxico)",et:"Eesti",eu:"Euskara",fa:"",fi:"Suomi","fil-ph":"Filipino (Pilipinas)","fr-FR":"Franais (France)","fr-ca":"Franais (Canada)","ga-ie":"Gaeilge (ire)",gd:"Gidhlig",gl:"Galego",gu:"",he:"",hi:"",hr:"Hrvatski",hu:"Magyar",id:"Indonesia",is:"slenska",it:"Italiano",ja:"",ka:"",kk:" ","km-kh":" ()",kn:"",ko:"",kok:"","lb-lu":"Ltzebuergesch (Ltzebuerg)",lo:"",lt:"Lietuvi",lv:"Latvieu","mi-nz":"Te reo Mori (Aotearoa)",mk:"",ml:"",mr:"",ms:"Melayu","mt-mt":"Malti (Malta)","nb-no":"Norsk bokml (Norge)","ne-np":" ()",nl:"Nederlands","nn-no":"Nynorsk (Noreg)","or-in":" ()",pa:"",pl:"Polski","pt-br":"Portugus (Brasil)","pt-pt":"Portugus (Portugal)","quz-pe":"Runasimi (Per)",ro:"Romn",ru:"P",sk:"Slovenina",sl:"Slovenina",sq:"Shqip","sr-cyrl-ba":"C (  )","sr-cyrl-rs":"C ()","sr-latn-rs":"Srpski (Srbija)",sv:"Svenska",ta:"",te:"",th:"","tk-tm":"Trkmen dili (Trkmenistan)",tr:"Trke",tt:"",ug:"",uk:"Y",ur:"",vi:"Ting Vit","zh-Hans":"","zh-Hant":""},s=["ar","fa","he","prs-af","sd-arab-pk","ug","ur"];function a(t){return-1!==s.indexOf(t.toLowerCase())}function c(){return o}function u(){return"en-us"}function l(){return!Object(r.j)()&&Object(i.c)("MultiLingualMVP1")}function h(t){switch(t){case"uz-latn-uz":case"sw":case"si-lk":case"sd-arab-pk":case"prs-af":case"hy":case"ha-latn-ng":case"bn-bd":return"en-gb";case"mn":case"ky":case"be":return"ru";case"zh-hk":case"zh-Hant":return"zh-tw";case"es-ES":return"es";case"fr-FR":return"fr";case"zh-Hans":return"zh-cn";default:return t}}function f(t){switch(t){case"es-es":return"es-ES";case"fr-fr":return"fr-FR";case"zh-hans":case"zh-cn":return"zh-Hans";case"zh-hant":case"zh-tw":return"zh-Hant";default:return t}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(2),r=n(6),o=n(4),s=n(14),a=(n(10),n(17)),c={Answer:o.a.reference(),AnswerEntity:o.a.reference(),BranchedElement:o.a.reference(),BranchingType:o.a.string(),NextQuestionInOrder:o.a.reference(),NextQuestionInitialized:o.a.boolean(),QuizResult:o.a.reference(),Visible:o.a.reference(),FormsProOrdinal:o.a.reference(),FormsProRuntimeTitle:o.a.reference(),FormsProRuntimeSubtitle:o.a.reference(),InitialFormsProLocalizedRuntimeTitle:o.a.reference(),InitialFormsProLocalizedRuntimeSubtitle:o.a.reference(),SelectedChoice:o.a.reference(),CDSFileResponseId:o.a.reference(),CDSFileId:o.a.reference(),HasSensitiveInfo:o.a.boolean()},u=function(t){function e(e,n){var i=t.call(this)||this;return i.Yi=function(){return i.updateBranchedQuestion()},i.ot=e,i.ot.observe(i.Yi),i.er=n,i.addRule({Name:"UpdateBranchedQuestion",onChange:function(t){return i.updateBranchedQuestion()}}),i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Question",{get:function(){return this.ot},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestions",{get:function(){return this.Question.SubQuestionMasters},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestionRuntimeMasters",{get:function(){var t=this;return this.SubQuestions.map((function(e){return t.getSubQuestionRuntimeById(e.Model.Id)}))},enumerable:!1,configurable:!0}),n.getSubQuestionRuntimeById=function(t){return this.er?this.er.getOrCreateQuestionRuntimeById(t):null},n.verifyAnswer=function(){if(0===this.SubQuestionRuntimeMasters.length){if(this.Question.Model.IsMathQuiz){var t=Object(s.G)(this.Model.Answer||"{}"),e=null==t.Answer?this.Model.Answer:t.Answer;return this.Question.verify(e)===a.e.Success}return this.Question.verify(this.Model.Answer)===a.e.Success}return this.SubQuestionRuntimeMasters.every((function(t){return t.Question.verify(t.Model.Answer)===a.e.Success}))},n.release=function(){this.ot.unobserve(this.Yi)},n.getAnswerEntity=function(){return{Answer:this.Question.getNormalizedAnswer(this.Model.Answer),QuestionId:this.Question.Model.Id}},n.calculateQuizResultFromModel=function(){0===this.SubQuestionRuntimeMasters.length?this.Model.QuizResult=this.Question.createQuizResult(this.Model.Answer):this.Model.QuizResult={IsAnswerCorrect:!1}},n.getScore=function(){var t=this.Model.AnswerEntity,e=t&&t.Score;return null!=e?e:this.Question.autoGradeWithQuizResult(this.Model.Answer,this.Model.QuizResult)},n.updateBranchedQuestion=function(){if(!this.Question.Deleted){var t=this.Model,e=this.Question.getBranchedResult(t.Answer,t.NextQuestionInOrder);this.bulkEdit((function(t){t.BranchedElement=e.TargetElement,t.BranchingType=e.Type}))}},n.nr=function(){},e}(r.a.createObjectMasterClass("QuestionRuntime",c))},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return b}));var i=n(2),r=n(0),o=n(20),s=n(15),a=n(11),c=n(161),u=n(22),l=n(5);function h(t){return r.createElement(b,{Image:t.Image,ImageSettings:t.ImageSettings,ImageType:t.ImageType})}function f(t){return r.createElement("div",{className:"image-spinner",id:t&&d(t)},r.createElement("div",{className:"common-spinner-circle"}))}function d(t){return"imageSpinner-"+t.ResourceId}var b=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.Oe=function(){return e.forceUpdate()},e.ir=function(){return e.rr()},e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(a.f)().Schema,e=Object(a.g)().Schema;this.props.ImageSettings.observe(this.Oe),this.props.Image.observe(this.Oe,[t.ResourceUrl,t.ContentType,t.OriginalFileName]),this.props.ImageSettings.observe(this.ir,[e.ContainerHeight,e.ContainerWidth,e.Left,e.Top]),this.props.Image.observe(this.ir,[t.AltText]),this.or()},n.componentDidUpdate=function(){this.or()},n.componentWillUnmount=function(){this.ce=!1,this.props.ImageSettings.unobserve(this.Oe),this.props.Image.unobserve(this.Oe),this.props.ImageSettings.unobserve(this.ir),this.props.Image.unobserve(this.ir)},n.render=function(){var t=this,e=this.props.Image.Model,n=this.props.ImageSettings.validateImageSettings(!0),i=0;return r.createElement("img",{src:e.ResourceUrl,alt:e.AltText,height:n.ContainerHeight+"px",width:n.ContainerWidth+"px",style:{visibility:"hidden"},onLoad:function(){Object(l.b)("Image.ImageOnLoad.Success",{imageType:t.props.ImageType,location:"1"})},onError:function(n){if(i<3&&"Response"===Object(s.m)()){var r=o.findDOMNode(t);i++;var a=e.ResourceUrl+"?"+i;window.setTimeout((function(){$(r).attr("src",a)}),1e3)}else Object(l.b)("Image.ImageOnLoad.Failure",{imageSrc:e.ResourceUrl,imageType:t.props.ImageType,location:"1"})}})},n.or=function(){var t=this,e=this.props.Image&&this.props.Image.Model;if(e&&e.ResourceUrl&&!this.sr()){var n=o.findDOMNode(this),i=0;n&&this.props.ImageSettings&&(n.onload=function(){return t.rr()},n.onerror=function(r){if(i<3&&"Response"===Object(s.m)()){i++;var o=e.ResourceUrl+"?"+i;window.setTimeout((function(){$(n).attr("src",o)}),1e3)}else{Object(l.b)("Image.CanvasOnLoad.Failure",{imageSrc:n.src,imageType:t.props.ImageType,location:"1"});var a=document.getElementById(d(e));a&&$(a).css("display","none"),$(n).css("visibility","visible")}})}},n.rr=function(){if(this.ce){var t=this.props.Image&&this.props.Image.Model;if(t&&t.ResourceUrl&&!this.sr()){var e=o.findDOMNode(this);if($(e).siblings("canvas").remove(),e&&this.props.ImageSettings)try{var n=document.createElement("canvas"),i=this.props.ImageSettings.validateImageSettings(!0);n.tabIndex=-1;var r=1*i.NaturalWidth/i.ActualWidth,s=Math.abs(i.Left*r);s=Math.floor(Math.min(s,i.NaturalWidth));var a=Math.abs(i.Top*r);a=Math.floor(Math.min(a,i.NaturalHeight));var u=i.ContainerWidth*r||i.NaturalWidth;u=Math.floor(Math.min(u,i.NaturalWidth));var h=i.ContainerHeight*r||i.NaturalHeight;h=Math.floor(Math.min(h,i.NaturalHeight));try{var f=isNaN(window.devicePixelRatio)?1:window.devicePixelRatio;f=Math.ceil(Math.max(f,r)),n.width=Math.floor(i.ContainerWidth*f),n.height=Math.floor(i.ContainerHeight*f),n.getContext("2d").drawImage(e,s,a,u,h,0,0,n.width,n.height)}catch(t){$(e).css("visibility","visible");var b=t.message||void 0,m=t.stack||void 0;return void Object(l.b)("Image.CanvasRender.Failure",{imageSrc:e.src,imageType:this.props.ImageType,location:"1",error:b+" "+m,Exception:"DrawImageCanvas"})}var v=document.getElementById(d(t));v&&$(v).css("display","none"),$(e).css("display","none"),$(e).parent().append(n),Object(l.b)("Image.CanvasRender.Success",{imageType:this.props.ImageType,location:"1"}),Object(c.d)()}catch(t){b=t.message||void 0,m=t.stack||void 0;throw Object(l.b)("Image.CanvasRender.Failure",{imageSrc:e.src,imageType:this.props.ImageType,location:"1",error:b+" "+m,Exception:"CreateImageCanvas"}),t}}}},n.sr=function(){return this.props.Image.Model.ImageProcessingStatus!==u.c.Idle},e}(n(8).a)},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.NotStarted=1]="NotStarted",t[t.Opened=2]="Opened",t[t.Expired=3]="Expired",t[t.Closed=4]="Closed"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i="/FormsPro"},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(35),s=n(40),a=n(39);function c(t){var e=Object(a.a)(c,o.e);return r.createElement(s.a,null,r.createElement(e,Object(i.__assign)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(3),s=n(9),a=n(78),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=Object(s.b)(this.props.ClassName,"simple-data-control-container");this.props.Ignorable&&(t=Object(s.b)(t,"optional-cell"));var e=o.extend({},this.props.HTMLAttributes);return e.className=Object(s.b)(e.className,t),r.createElement("div",Object(i.__assign)({},e),this.cr(),this.lr(),r.createElement("div",Object(i.__assign)({className:"simple-data-control-description"},this.dr()),this.props.Description))},n.lr=function(){if(this.props.IsReady)return r.createElement("div",Object(i.__assign)({className:"simple-data-control-content office-form-theme-primary-foreground"},this.dr()),this.props.Data);return r.createElement(a.a,Object(i.__assign)({},{ClassName:"designPage-response-averageTime-spinner",Ignorable:!1}))},n.cr=function(){if(this.props.AccessibilityText)return r.createElement("a",{className:"screenReaderVisible",role:"presentation"},this.props.AccessibilityText)},n.dr=function(){if(this.props.AccessibilityText)return{"aria-hidden":!0,role:"presentation"}},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(2),r=n(0),o=n(3),s=n(9),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=o.extend({},this.props.HTMLAttributes);return this.props.ValidationStyle&&(t.className=Object(s.b)(t.className,this.props.ValidationStyle)),this.props.Hidden&&(t.style=t.style||{},t.style.display="none"),r.createElement.apply(r,Object(i.__spreadArrays)(["div",t],this.createReactNodes()))},n.createReactNodes=function(){throw Error("to be overridden.")},e}(r.Component)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(68),s=n(12),a=n(7),c=n(1),u=n(77),l=n(35),h=n(14),f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.br=new Image,e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.ThemeMaster;e&&(this.vr=function(e){e.NewValues.Name===Object(c.a)().Customized_Theme_Name&&e.NewValues.BackgroundImage!==t.state.ImageUrl?t.setState({ImageUrl:e.NewValues.BackgroundImage,IsBackgroundImgCached:!1}):t.forceUpdate()},e.observe(this.vr))},n.componentWillUnmount=function(){var t=this.props.ThemeMaster;this.ce=!1,t&&t.unobserve(this.vr)},n.render=function(){var t,n=this,i=this.props.ThemeMaster;if(!(t=Object(h.w)()&&Object(a.a)().themeInfo?e.getSPOTheme(Object(a.a)().themeInfo):i&&i.Model))return null;var o=t.Name,u=t.PrimaryColor,f=t.SecondaryColor,d=t.BackgroundColor,b=t.BackgroundImage;(b=Object(l.o)(b))&&b.match("url((.*))")&&(b=b.substring(4,b.length-1)),o===Object(c.a)().Customized_Theme_Name&&b&&(this.state.IsBackgroundImgCached||(this.br.src=b,this.br.onload=function(t){n.ce&&n.setState({ImageUrl:b,IsBackgroundImgCached:!0})},b+="_mo"));var m="";if(m+=".office-form-theme-primary-color { color:"+u+"; }",m+=".office-form-theme-secondary-color { color:"+f+"; }",m+=".office-form-theme-primary-background { background:"+u+"; color:#FFFFFF; }",m+=".office-form-theme-secondary-background { background:"+f+"; }",m+=".office-form-theme-primary-foreground, ",m+=".office-form-theme-primary-foreground a, ",m+=".office-form-theme-primary-foreground.rateit .rateit-selected, ",m+=".office-form-theme-primary-foreground.rateit .rateit-hover",m+="{ color:"+u+"; } ",m+=".office-form-theme-border-top { border-top-color:"+u+"; }",m+=".office-form-theme-border-bottom-for-mobile { border-bottom-color:"+u+"; }",m+=".office-form-theme-spinner { border-color:"+u+" #C7E0F4 #C7E0F4;}",m+=".office-form-theme-border { border-color:"+u+";}",m+=".office-form-theme-interactive-background.active { background-color:"+u+"; }",m+=".office-form-theme-interactive-background:hover { background-color:"+f+"; }",m+=".office-form-theme-interactive-background:focus { background-color:"+f+"; }",m+=".office-form-theme-interactive-background:active { background-color:"+f+"; }",m+=".office-form-theme-button-lightbackground { color:"+u+"; }",m+=".office-form-theme-button-lightbackground.active { background-color:"+f+"; }",m+=".office-form-theme-interactive-color { color:"+u+"; }",m+=".office-form-theme-interactive-color:hover { color:"+f+"; }",m+=".office-form-theme-interactive-color:focus { color:"+f+"; }",m+=".office-form-theme-interactive-color:active { color:"+f+"; }",m+=".office-form-theme-button { color: white; background:"+u+"; }",m+=".office-form-theme-button:hover { background:"+f+"; }",m+=".office-form-theme-button:focus { background:"+f+"; }",m+=".office-form-dark-theme-button {color:"+f+"}",m+=".office-form-dark-theme-button:hover { color:"+f+"; }",m+=".office-form-dark-theme-button:focus { color:"+f+"; }",m+=".office-form-theme-page-background-active.active { background :"+u+"; color: #FFFFFF; }",m+=".office-form-theme-page-foreground-active.active, ",m+=".office-form-theme-select-color.active *{ color: "+u+"; }",m+=".office-form-theme-toggle.active { background: "+u+"; border-color:"+u+"; }",m+=".office-form-theme-border { border-color:"+u+"; }",m+=".office-form-theme-outline { outline-color:"+u+"; }",m+=".office-form-theme-button-foreground.active,.office-form-theme-button-foreground.touch.active:hover { color: white; background: "+u+"; outline-color:"+u+"; }",m+=".office-form-theme-button-foreground.active:hover { background: "+f+"; outline-color:"+f+"; }",m+=".office-form-theme-quiz-point { color:"+f+"; }",m+=".office-form-theme-quiz-totalPoints-bar {color:"+u+"; }",m+=".office-form-theme-image-question-background, .office-form-theme-video-question-background { background-color: "+d+"; outline: 1px solid transparent; }",m+=".office-form-theme-image-container-border { border: 3px solid "+d+"; }",m+=".office-form-sortable-chosen .office-form-sort-item { background: "+u+"; color:white; }",m+=".office-form-theme-sort-item { color: white; background:"+u+"; }",m+=".office-form-theme-sort-item:hover { background:"+f+"; }",m+=".office-form-theme-focus-border .office-form-textfield-input:focus,.office-form-theme-focus-border .form-control:focus,.office-form-theme-focus-border .select-control:focus,.office-form-theme-focus-border .picker--focused .picker__holder:focus,.roosterjs-editor-box:focus { border-color: "+u+"; outline-color:"+u+"; }",m+=".office-form-theme-bgcolor-hover:hover { background:"+d+"; }",m+=".office-form-theme-button-color:hover *{ color:"+f+"; }",m+=".form-intelligence-question-row.office-form-intelligence-theme-li { outline: 1px solid "+f+"; background-color:"+d+";}.form-intelligence-question-row:hover {background-color:"+d+";}",m+=".form-intelligence-question-row.mobile-office-form-intelligence-theme-li { outline: 1px solid "+u+"; background-color:"+d+"; color:"+u+";}",m+=".office-form-insight-theme-control .simple-data-control-content { color : "+u+"; }",m+=".office-form-insight-theme-control .simple-data-control-description { color : "+u+"; }",m+=".office-form-insight-theme-control .simple-data-control-description:hover { color : "+f+"; }",m+=".office-form-insight-theme-control .simple-data-control-description:focus { color : "+f+"; }",m+=".office-form-insight-theme-control .simple-data-control-description:active { color : "+f+"; }",m+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link { color: "+u+"; }",m+=".office-form-info-container .office-form-info-children.office-form-theme-spo-link:hover{color:"+f+"; }",m+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link { color: "+u+"; }",m+=".office-form-spo-embed .office-form-footer-block .office-form-theme-spo-link:hover { color: "+f+"; }",m+=".office-form-theme-spo-link { color:"+u+"; }",m+=".office-form-theme-spo-link:hover { color:"+f+"; }",Object(s.c)("ProgressBarNew")&&u){var v=u;v.startsWith("#")&&(v=v.substring(1)),v.length>6&&(v=v.substring(0,6)),m+=".office-form-theme-progress-bar-background { background: #"+v+"0D; }"}return Object(h.w)()||(b?(m+=".thank-you-page-content { opacity:.97; }",m+=".introduction-for-responser-container { opacity:.97; }",Object(h.r)()?(m+=".office-form-theme-page-background { background-color:"+d+"; }",m+=".office-form-theme-footer { background: rgba(255,255,255,.4); }"):(m+=".office-form-theme-page-background { background-image: url("+b+"); }",m+=".office-form-theme-footer { background: rgba(244,244,244,.8); }"),m+=".preview-mobile-container.office-form-theme-page-background { background:"+d+"; }",m+=".preview-mobile-container .office-form-theme-footer { background: rgba(255,255,255,.4); }"):(m+=".office-form-theme-footer { background : rgba(255,255,255,.4); }",m+=".office-form-theme-page-background { background-color:"+d+"; }")),b&&o!==Object(c.a)().Customized_Theme_Name?m+=".office-form-theme-shadow { box-shadow : none; }":m+=".office-form-theme-shadow { box-shadow: 0 0 11px rgba(0,0,0,.12); }",o===Object(c.a)().Customized_Theme_Name&&(m+=".office-form-body { opacity: 0.97; }"),m+=Object(l.p)(t),r.createElement("style",null,m)},e.getSPOTheme=function(t){var e=Object(o.g)(t);return{BackgroundColor:Object(o.h)(e),BackgroundImage:null,Name:u.a,PrimaryColor:e,SecondaryColor:Object(o.i)(e),Thumbnail:null}},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return A})),n.d(e,"a",(function(){return R}));var i=n(2),r=n(0),o=n(15),s=n(12),a=n(7),c=n(1),u=n(35),l=n(11),h=n(10),f=n(5),d=n(18),b=n(20),m=n(3),v=n(9),g=n(8),O=n(24);var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){return this.gr()},n.gr=function(){var t=this,e={className:"image-picker-switch-button",onClick:function(){var e=b.findDOMNode(t.refs.fileInput);$(e).val(""),$(e).click()},ref:"ImageUploadButton"},n=Object(O.b)({HTMLAttributes:e,ButtonStyle:"LightBackground",Text:this.props.UploadButtonHint}),i=r.createElement("input",{type:"file",accept:"image/*",ref:"fileInput",onChange:function(e){return t.Or(e)},className:"design-question-image-reader"}),o=m.extend({},this.props.HTMLAttributes);return o.className=Object(v.b)(o.className,"design-question-image-picker"),r.createElement("div",o,n,i)},n.Or=function(t){var e=t.target.files[0];e&&(Object(f.b)("DesignPage.ImagePicker.AddImage",{source:"Local",size:e.size}),this.props.filePickedCallBack(e))},e}(g.a),j=n(38),y=n(19),w=function(){function t(t){this.pr=10,this.jr=t,this.yr=t/140,this.wr=t/200}var e=t.prototype;return Object.defineProperty(e,"Margin",{get:function(){return this.pr},set:function(t){this.pr=t},enumerable:!1,configurable:!0}),e.layoutContent=function(t){for(var e=[],n=t,i=0,r=n.length,o=[];i<r;i++){var s=this.Sr([].concat(o,n[i])),a=s.length;a<=0||(i<r-1&&S(s[a-1])<this.wr?(o=s[a-1],s.length=a-1):o=[],e=e.concat.apply(e,s))}return e},e.Sr=function(t){for(var e=this.Nr(t),n=function(t){var n=i.Ir(e[t]);if(1===e[t].length&&e[t][0].NaturalRatio>i.yr)return e[t][0].Height=n,e[t][0].Width=i.jr-i.pr,"continue";e[t].forEach((function(t){t.Height=n,t.Width=n*t.NaturalRatio}))},i=this,r=0;r<e.length;r++)n(r);return e},e.Nr=function(t){var e=t.filter((function(t){return 1===t.Type})),n=t.filter((function(t){return 0===t.Type}));if(e.length<=0)return this.Cr(n);var i=this.Cr(e),r=i[i.length-1],o=S(r);if(o<this.wr)for(var s=0;s<n.length&&s<5;s++){var a=n[s].NaturalRatio;if(o+a<this.wr)o+=a,r.push(n[s]),n.splice(s--,1);else if(o+a<this.yr){r.push(n[s]),n.splice(s,1);break}}return i.concat(this.Cr(n))},e.Cr=function(t){for(var e=[],n=[],i=0;i<t.length;i++){n.push([i]);for(var r=n.length-1,o=function(r){var o=t[i].NaturalRatio;o+=n[r].map((function(e){return t[e].NaturalRatio})).reduce((function(t,e){return t+e}),0);var a=n[r].slice(0);if(a.push(i),o<s.wr)n.push(a);else if(o>=s.wr&&o<=s.yr){e.push(a.map((function(e){return t[e]})));for(var c=n.length-1;c>=0;c--)n[c].some((function(t){return a.indexOf(t)>=0}))&&n.splice(c,1);return"break"}},s=this,a=0;a<r;a++){if("break"===o(a))break}}var c=n.filter((function(t){return 1===t.length})).map((function(e){return t[e[0]]})),u=[];for(i=0;i<c.length;i++)u.push(c[i]),S(u)>this.yr&&(e.push(u),u=[]);return u.length>0&&e.push(u),e},e.Ir=function(t){var e=S(t);return e>this.yr&&1===t.length?140:e<this.wr?200:(this.jr-t.length*this.pr)/e},t}();function S(t){return t.map((function(t){return t.NaturalRatio})).reduce((function(t,e){return t+e}))}var N=function(){function t(){}var e=t.prototype;return Object.defineProperty(e,"Type",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Width",{get:function(){return this.kr},set:function(t){this.kr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Height",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NaturalWidth",{get:function(){return this.xr},set:function(t){this.xr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NaturalHeight",{get:function(){return this.Fr},set:function(t){this.Fr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NaturalRatio",{get:function(){return this.xr&&this.Fr?this.xr/this.Fr:1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Src",{get:function(){return this.Pr},set:function(t){this.Pr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ThumbnailSrc",{get:function(){return this.Dr},set:function(t){this.Dr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Title",{get:function(){return this.Mr},set:function(t){this.Mr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Size",{get:function(){return this.Lr},set:function(t){this.Lr=t},enumerable:!1,configurable:!0}),t}(),I=function(){function t(){}var e=t.prototype;return Object.defineProperty(e,"Type",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NaturalHeight",{get:function(){return 175},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NaturalWidth",{get:function(){return 265},enumerable:!1,configurable:!0}),Object.defineProperty(e,"NaturalRatio",{get:function(){return this.NaturalWidth/this.NaturalHeight},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Height",{get:function(){return this.Tr},set:function(t){this.Tr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Width",{get:function(){return this.kr},set:function(t){this.kr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Title",{get:function(){return this.Mr},set:function(t){this.Mr=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"AlbumCount",{get:function(){return this.Ar},set:function(t){this.Ar=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ResourceId",{get:function(){return this.Rr},set:function(t){this.Rr=t},enumerable:!1,configurable:!0}),t}(),C=n(29),k=n(132),T=n(16),x=n(27),F=n(43);function P(t){return r.createElement(D,t)}var D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.Er=null,e.Br=10,e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t=this,e=m.extend({},this.props.HTMLAttributes);return e.id="imagePickerContentContainer",e.className="imagePickerContentContainer",e.onScroll=function(){t._r()},r.createElement("div",e,this.Hr(this.Gr()))},n._r=function(){var t=this;this.Er&&clearTimeout(this.Er),this.Er=window.setTimeout((function(){var e=document.getElementById("imagePickerContentContainer");e.scrollTop+e.clientHeight+t.Br>=e.scrollHeight&&t.props.onPaging()}),500)},n.Gr=function(){var t=m.clone(this.props.Nodes);return new w(this.props.ContainerWidth-50).layoutContent(t)},n.Hr=function(t){var e=this,n=0,i=[];return t.forEach((function(t){switch(t.Type){case 0:i.push(e.qr(t,n++));break;case 1:i.push(e.Qr(t,n++));break;default:throw Error("ImagePickerContentView.createImages: invaild node type {0}".format(t.Type))}})),i},n.qr=function(t,e){var n=this.props;this.Vr(t);var i=Object(d.b)({HTMLAttributes:{className:"imageCheckIcon forms-icon-size14x14"},IconName:"CheckMark"});return Object(F.b)({key:e,HTMLAttributes:{className:"imageContentPieceWrapper",style:{height:t.Height+"px",width:t.Width+"px",backgroundImage:"url('"+t.ThumbnailSrc+"')"},onClick:function(){return n.onSelectedImageChange(t)},onFocus:function(){return n.onSelectedImageChange(t)},onKeyUp:function(e){return n.onSelectedImageKeyUp(e.keyCode,t)},onDoubleClick:function(){return n.onSelectedImageDoubleClick(t)},title:t.Title},ButtonStyle:"LightBackground",ToggleActive:t===n.SelectedImage,children:[r.createElement("div",{className:"imageCheckBox",key:"imageCheckBox"},i,r.createElement("div",{className:"imageDescriptionLabel",key:"imageDescriptionLabel"},t.NaturalWidth+"x"+t.NaturalHeight))]})},n.Qr=function(t,e){var n=this,i=Object(d.b)({HTMLAttributes:{className:"folderImageIcon forms-icon-size26x26"},IconName:"FabricFolderFill"});return Object(F.b)({key:e,HTMLAttributes:{className:"folderContentPieceWrapper",style:{width:t.Width+"px",height:t.Height+"px"},onClick:function(){n.props.onFolderClick(t)}},ButtonStyle:"LightBackground",children:r.createElement("div",{className:"folderImage"},i,r.createElement("div",{className:"folderFooter"},r.createElement("div",{className:"folderBeak"}),r.createElement("div",{className:"folderBeakHighlight"}),r.createElement("div",{className:"folderTitle"},t.Title)))})},n.Vr=function(t){var e=this;if(!m.contains(this.props.LazeLayoutCollection,t)&&(0===t.NaturalHeight||0===t.NaturalWidth)){var n=new Image;n.onload=function(){t.NaturalHeight=n.height,t.NaturalWidth=n.width,e.ce&&e.setState({})},this.props.LazeLayoutCollection.push(t),n.src=t.ThumbnailSrc}},e}(g.a);var M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.state=e.getDefaultState(),e}Object(i.__extends)(e,t);var n=e.prototype;return n.getDefaultState=function(){return{UseShareLicense:!0,ShowSearchLicenseBar:!1,NodesData:[],OffSet:0,LastUrl:null,Total:null,SeletedImage:null}},n.componentDidMount=function(){this.state.ShowSearchLicenseBar||""===this.props.Value||this.setState({ShowSearchLicenseBar:!0}),this.zr()},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t=this,e=0===this.state.NodesData.length?void 0:P({ContainerWidth:this.props.ContainerWidth,Nodes:this.state.NodesData,SelectedImage:this.state.SeletedImage,onPaging:this.zr.bind(this),onSelectedImageChange:function(e){return t.setState({SeletedImage:e})},onSelectedImageDoubleClick:function(e){return t.setState({SeletedImage:e},t.Ur.bind(t))},onSelectedImageKeyUp:function(e,n){13===e&&t.Ur()}});return r.createElement("div",{className:"basicContentPageWrapper"},r.createElement("div",{className:"basicContentPageInnerWrapper"},this.$r(),this.props.IsPrivacyLinkEnable?this.Wr():void 0,this.Kr(),e))},e.filterImage=function(t){return t.filter((function(t){return t.Size<=Object(y.r)()}))},e.getBingSearchImages=function(t){var n=t.LicensesBarValue?"Share":"All";return C.a.getInstance().createDataProvider().searchImage(t.Query,n,Object(y.t)(),t.OffSet,t.LastUrl).then((function(n){return e.getFilteredImages(t,n)}))},e.getFilteredImages=function(t,e){var n=e.PartGroups.ImageParts,i=this.filterImage(n).map((function(t){var e=new N;return e.NaturalWidth=t.SourceUrl.Width,e.NaturalHeight=t.SourceUrl.Height,e.Src=t.SourceUrl.Url,e.ThumbnailSrc=t.ThumbnailUrl.Url,e.Title=t.Title,e.Size=t.Size,e}));return t.LastUrl=n.length?n[n.length-1].SourceUrl.Url:void 0,t.OffSet=Number(e.Offset),t.Total=Number(e.TotalResults),t.NodesData=t.NodesData.concat(i),t.NodesData.length>=Object(y.t)()||t.OffSet>t.Total||0===t.Total||0===t.OffSet?Promise.resolve(t):this.getBingSearchImages(t)},n.zr=function(){var t=this,n=this.state,i=this.props;if(!(n.OffSet>n.Total)&&i.Value){i.showLoading(!0);var r={UseShareLicense:i.LicensesBarValue,ShowSearchLicenseBar:n.ShowSearchLicenseBar,OffSet:n.OffSet,Total:n.Total,LastUrl:n.LastUrl,NodesData:[],Query:i.Value,LicensesBarValue:i.LicensesBarValue};e.getBingSearchImages(r).then((function(e){var r=n.NodesData.concat([e.NodesData]);i.showLoading(!1),t.ce&&t.setState({NodesData:r,OffSet:e.OffSet,Total:e.Total,LastUrl:e.LastUrl})}),(function(e){t.props.showError(0,e.innerCode||e.statusCode,!0)}))}},n.$r=function(){var t=this,e=Object(x.b)({Placeholder:Object(c.a)().ImagePicker_BingSearch_HintMessage,HTMLAttributes:{className:"bingSearchTextField",onKeyDown:function(e){13===e.keyCode&&(Object(f.b)("DesignPage.ImagePicker.Search"),t.Jr())}},Value:this.props.Value,TextFieldType:0,MinimalHeight:40,onValueChange:function(e){return t.props.onValueChange(e)}}),n=Object(T.a)({Icon:"Search",IconClassName:"forms-icon-size18x18",Text:Object(c.a)().ImagePicker_BingSearch_TipMessage,HTMLAttributes:{className:"bingSearchButton",onClick:function(){Object(f.b)("DesignPage.ImagePicker.Search"),t.Jr()}},ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly"}),i=Object(O.b)({HTMLAttributes:{className:"image-picker-add-button",disabled:!this.state.SeletedImage,onClick:this.Ur.bind(this)},Text:Object(c.a)().ImagePicker_Add_button,ButtonStyle:"LightBackground"}),o=Object(d.b)({HTMLAttributes:{className:"bingSearchIcon"},IconName:"BingLogo"});return r.createElement("div",{className:"bingSearchContainer"},o,r.createElement("div",{className:"bingSearchLabel"},Object(c.a)().ImagePicker_BingSearch_LogoName),e,n,i)},n.Ur=function(){var t=this.state.SeletedImage;this.props.addImageFromUrlHandler&&(Object(f.b)("DesignPage.ImagePicker.AddImage",{source:"BingSearch",size:this.state.SeletedImage.Size}),this.props.addImageFromUrlHandler(t.Src,t.Title,t.Size,t.NaturalWidth,t.NaturalHeight)),this.setState({SeletedImage:null})},n.Wr=function(){var t=this;return r.createElement("div",{className:"bingSearchResponsibleLinkContainer"},r.createElement("div",{className:"bingSearchResponsibleLinkContent"},r.createElement("span",{className:"bingSearchResponsibleWarning"},Object(c.a)().ImagePicker_Responsible_Warning),r.createElement("a",{className:"bingSearchResponsibleLink",href:"http://go.microsoft.com/fwlink/?LinkId=824927",target:"_blank"},Object(c.a)().ImagePicker_Responsible_Link)),Object(T.a)({Icon:"Cancel",IconClassName:"forms-icon-size14x14",Text:Object(c.a)().Common_Close_Text,HTMLAttributes:{className:"bingSearchResponsibleCloseButton",onClick:function(){t.props.onPrivacyLinkEnableChange(!1)},onKeyDown:!1},ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly"}))},n.Jr=function(){var t=this.getDefaultState();t.ShowSearchLicenseBar||""===this.props.Value?t.ShowSearchLicenseBar&&""===this.props.Value&&(t.ShowSearchLicenseBar=!1):t.ShowSearchLicenseBar=!0,this.setState(t,this.zr.bind(this))},n.Kr=function(){var t=this;if(this.state.ShowSearchLicenseBar)return r.createElement("div",{className:"bingSearchResponsibleLinkContainer"},Object(k.a)({HTMLAttributes:{className:"bingSerachLicensesCheckBox",title:Object(c.a)().ImagePicker_Creative_Commons_Licenses},Value:this.props.LicensesBarValue,Description:Object(c.a)().ImagePicker_Creative_Commons_Licenses,onValueChange:function(e){return t.Xr(e)},children:[r.createElement("a",{className:"bingSearchResponsibleLink BingSearchlicenseLink",href:"http://go.microsoft.com/fwlink/?LinkId=825104",target:"_blank"},Object(c.a)().ImagePicker_Responsible_Link)]}))},n.Xr=function(t){Object(f.b)("DesignPage.ImagePicker.BingSearchLicense",{useShareLicense:t}),this.props.onSearchLicenseSwitch(t);var e=this.getDefaultState();e.ShowSearchLicenseBar=this.state.ShowSearchLicenseBar,this.setState(e,this.zr.bind(this))},e}(g.a);var L=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e.state={NodesData:[],FolderNodes:[],ImageNodes:[],SkipToken:"",LoadingState:0,SeletedImage:null},e}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"OneDriveRoot",{get:function(){return"root"},enumerable:!1,configurable:!0}),n.componentWillMount=function(){this.Zr()},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t=this,e=Object(O.b)({HTMLAttributes:{className:"image-picker-add-button",disabled:!this.state.SeletedImage,onClick:this.Ur.bind(this)},Text:Object(c.a)().ImagePicker_Add_button,ButtonStyle:"LightBackground"}),n=Object(d.b)({HTMLAttributes:{className:"oneDriveIcon"},IconName:"OneDrive"});return r.createElement("div",{className:"basicContentPageWrapper"},r.createElement("div",{className:"basicContentPageInnerWrapper"},r.createElement("div",{className:"onDriveContainer"},n,r.createElement("div",{className:"oneDriveLabel"},Object(c.a)().ImagePicker_OneDrive_LogoName),e),this.Yr(),this.to(),P({ContainerWidth:this.props.ContainerWidth,Nodes:this.state.NodesData,SelectedImage:this.state.SeletedImage,onPaging:this.eo.bind(this),onFolderClick:function(e){return t.setState({SeletedImage:null},(function(){return t.no(e)}))},onSelectedImageChange:function(e){return t.setState({SeletedImage:e})},onSelectedImageDoubleClick:function(e){return t.setState({SeletedImage:e},t.Ur.bind(t))},onSelectedImageKeyUp:function(e,n){13===e&&t.Ur()},LazeLayoutCollection:[]})))},n.Ur=function(){var t=this.state;Object(f.b)("DesignPage.ImagePicker.AddImage",{source:"OneDrive",size:t.SeletedImage.Size}),this.props.addImageFromUrlHandler(t.SeletedImage.Src,t.SeletedImage.Title,t.SeletedImage.Size,t.SeletedImage.NaturalWidth,t.SeletedImage.NaturalHeight)},n.to=function(){return 0===this.state.NodesData.length&&2===this.state.LoadingState?r.createElement("div",{className:"image-picker-oneDrive-emptyFolder-message"},Object(c.a)().ImagePicker_OneDrive_EmptyFolderPromptMessage):void 0},n.no=function(t){var e=this,n=m.clone(this.props);1!==this.state.LoadingState&&this.setState({NodesData:[],FolderNodes:[],ImageNodes:[],SkipToken:""},(function(){var i=m.contains(n.OneDrivePath,t)?n.OneDrivePath.splice(0,m.indexOf(n.OneDrivePath,t)+1):n.OneDrivePath.concat(t);e.props.OnPathChange(i),e.Zr()}))},n.eo=function(){this.state.SkipToken&&this.Zr()},n.Zr=function(){var t=this;1!==this.state.LoadingState&&this.setState({LoadingState:1},(function(){t.props.showLoading(!0);var e=m.last(t.props.OneDrivePath);C.a.getInstance().createDataProvider().browseImage(e.ResourceId,Object(y.t)(),t.state.SkipToken).then((function(e){var n=t.state,i=e.PartGroups.FolderParts,r=e.PartGroups.ImageParts,o=i.map((function(t){var e=new I;return e.Title=t.Title,e.ResourceId=t.ResourceId,e.AlbumCount=t.AlbumCount,e})),s=r.map((function(t){var e=new N;return e.Src=t.SourceUrl.Url,e.ThumbnailSrc=t.SourceUrl.Url,e.NaturalHeight=t.SourceUrl.Height,e.NaturalWidth=t.SourceUrl.Width,e.Title=t.Title,e.Size=t.Size,e})),a=o.length<=0?n.FolderNodes:n.FolderNodes.concat([o]),c=s.length<=0?n.ImageNodes:n.ImageNodes.concat([s]);t.props.showLoading(!1),t.ce&&t.setState({FolderNodes:a,ImageNodes:c,NodesData:a.concat(c),SkipToken:e.Offset,LoadingState:2})}),(function(e){t.setState({LoadingState:3}),t.props.showError(1,e.innerCode||e.statusCode,!0)}))}))},n.Yr=function(){var t=this,e=this.props.OneDrivePath.map((function(e,n){return Object(F.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"imagePickerContentPageBreadcrumbWrapper",onClick:function(){t.setState({SeletedImage:null},(function(){return t.no(e)}))}},children:r.createElement("span",{},(e.ResourceId===t.OneDriveRoot?"":"> ")+e.Title),key:n})}));return r.createElement("div",{className:"imagePickerContentPageBreadcrumbContainer"},e)},e}(g.a);function A(){return E.pickImage()}function R(t){return r.createElement(E,t)}var E=function(t){function e(){var n=null!==t&&t.apply(this,arguments)||this;return n.io=Object(l.b)().Model.FormsTenantSettings,n.ce=!0,n.state={BingSearchKeyword:"",OneDrivePath:[{Title:Object(a.a)().userInfo.DisplayName+Object(c.a)().ImagePicker_OneDrive_PathRootSuffix,ResourceId:e.OneDriveRoot}],BingSearchPrivacyLinkEnable:!0,ImagePickerTypeState:n.oo()?0:1,BingSearchLicensesValue:!0},n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(e,"OneDriveRoot",{get:function(){return"root"},enumerable:!1,configurable:!0}),e.pickImage=function(){return e.imageReject&&e.imageReject(),new Promise((function(t,n){e.imageResolve=t,e.imageReject=n;var i=Object(l.b)().Model;i.FlexPane="ImagePicker",Object(j.f)("Flexpane-ImagePicker",(function(){i.FlexPane=Object(h.c)((function(){return"MediaSelect"}),h.f),e.rejectImagePicker(!0)}))}))},e.rejectImagePicker=function(t){e.imageReject&&(e.imageReject(t),e.imageReject=null,e.imageResolve=null)},e.collapeFlexPaneHandler=function(){var t=Object(l.b)().Model;"ImagePicker"===t.FlexPane&&(t.FlexPane="None")},n.componentWillUnmount=function(){this.ce=!1,e.rejectImagePicker()},n.rejectPickerDeferred=function(){e.rejectImagePicker(!0)},n.createPickerContent=function(){var t=this;if(!Object(u.c)())return null;var e,n=this.state;switch(n.ImagePickerTypeState){case 1:return e={ContainerWidth:this.props.ContainerWidth,showLoading:this.so.bind(this),showError:this.ao.bind(this),addImageFromUrlHandler:this.co.bind(this),OneDrivePath:n.OneDrivePath,OnPathChange:function(e){t.setState({OneDrivePath:e})}},r.createElement(L,e);case 0:default:return function(t){return r.createElement(M,t)}({ContainerWidth:this.props.ContainerWidth,showLoading:this.so.bind(this),showError:this.ao.bind(this),addImageFromUrlHandler:this.co.bind(this),Value:n.BingSearchKeyword,onValueChange:function(e){t.setState({BingSearchKeyword:e})},IsPrivacyLinkEnable:n.BingSearchPrivacyLinkEnable,onPrivacyLinkEnableChange:function(e){t.setState({BingSearchPrivacyLinkEnable:e})},LicensesBarValue:n.BingSearchLicensesValue,onSearchLicenseSwitch:function(e){t.setState({BingSearchLicensesValue:e})}})}},n.createErrorHandling=function(){var t=this.state,e=t.ImagePickerTypeState,n=t.ErrorState&&t.ErrorState.InnerCode;if(n&&t.ErrorState.Source===e){var i,o="";switch(e){case 0:o=Object(c.a)().Error_Message_5403;break;case 1:o=Object(c.a)().Error_Message_5401;break;default:throw Error("ImagePickerView.createErrorHandling:ImagePickerType.{0} shouldn't call this method".format(e))}switch(n){case 5400:i=Object(c.a)().Error_Message_5400;break;case 5401:i=Object(c.a)().Error_Message_5401;break;case 5402:i=Object(c.a)().Error_Message_5402;break;case 5403:i=Object(c.a)().Error_Message_5403;break;default:i=o}var s=Object(d.b)({HTMLAttributes:{className:"image-picker-error-icon forms-icon-size32x32"},IconName:"Sad"});return r.createElement("div",{className:"image-picker-error-hanlder-container"},s,r.createElement("div",{className:"image-picker-error-message"},i))}},n.createSwitchButtons=function(){var t,n=this,i=this.state.ImagePickerTypeState,o=Object(u.c)()&&this.oo()?this.createSwicherButton(Object(c.a)().ImagePicker_switcher_BingSearch,0===i,(function(){n.uo(0,"DesignPage.ImagePicker.UploadBingSearch")})):void 0,s=Object(u.c)()?this.createSwicherButton(Object(c.a)().ImagePicker_switcher_OD4B,1===i,(function(){n.uo(1,"DesignPage.ImagePicker.UploadOD4B")})):void 0,a=(t={ContainerClassName:Object(u.h)(),filePickedCallBack:function(t){Object(f.b)("DesignPage.ImagePicker.UploadLocal"),e.imageResolve&&e.imageResolve({File:t}),e.collapeFlexPaneHandler()},UploadButtonHint:Object(c.a)().ImagePicker_switcher_Upload,HTMLAttributes:{className:"image-picker-switch-button-wrapper"}},r.createElement(p,t));return r.createElement("div",{className:"image-picker-switch-button-container"},o,s,a)},n.ao=function(t,e,n){this.setState({ErrorState:n?{InnerCode:e,Source:t}:null,Loading:!1})},n.uo=function(t,e){var n,i=this,r=this.state;Object(f.b)(e),r.ErrorState&&r.ErrorState.Source===t&&(n=r.ErrorState&&r.ErrorState.Source===t?r.ErrorState:null),this.setState({ErrorState:n,Loading:!1},(function(){return i.setState({ImagePickerTypeState:t})}))},n.so=function(t){this.ce&&!this.state.Loading!=!t&&this.setState({Loading:t,ErrorState:null})},n.co=function(t,n,i,r,o){e.imageResolve&&e.imageResolve({FromUrl:{Url:t,Size:i,Width:r,Height:o}}),e.collapeFlexPaneHandler()},n.oo=function(){return!Object(o.w)()&&!(Object(s.c)("BingImageAdminControl")&&this.io&&!this.io.bingImageSearch)},e}(n(235).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(7),r=n(186),o=n(135),s=function(){function t(t,e,n,i){this.Qt=t+"intelligence/api/",this.ho=e&&n&&i?""+this.Qt+e+"/"+i+"/"+n+"/":""+this.Qt}var e=t.prototype;return t.createIntelligenceProvider=function(e,n,i){return new t(Object(r.a)(),n,i,3===e?"groups":"users")},e.getInsights=function(t,e,n){return Object(o.a)({method:"GET",qosEventName:"Intelligence.GetInsights",requestUri:this.ho+"forms('"+t+"')/getinsights("+e+","+n+")"})},e.getCachedInsights=function(t){return Object(o.a)({method:"GET",qosEventName:"Intelligence.GetCachedInsights",requestUri:this.ho+"forms('"+t+"')/getcachedinsights"})},e.getOrCalculateInteractiveInsights=function(t){return Object(o.a)({method:"GET",qosEventName:"Intelligence.GetInteractiveInsights",requestUri:this.ho+"forms('"+t+"')/getorcalculateinteractiveinsights"})},e.getOptionToOptionSuggestion=function(t,e,n){return Object(o.a)({body:JSON.stringify({existingOptions:t,variation:n}),method:"POST",qosEventName:"Ingelligence.GetOptionToOptionSuggestion",qosExtraData:{feature:e,variation:n},requestUri:this.ho+"getOptionToOptionSuggestion"})},e.getHistorySuggestion=function(t,e){var n=Object(i.a)().userInfo,r=n&&n.TenantId,s=n&&n.UserId,a=""+this.Qt+r+"/users/"+s+"/getHistoryFormSuggestion";return Object(o.a)({body:JSON.stringify({Text:t,FormId:e}),method:"POST",qosEventName:"Ingelligence.GetHistorySuggestion",requestUri:a})},e.predictResponseTime=function(t){var e=this.Qt+"PredictResponseTime";return Object(o.a)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.PredictResponseTime",requestUri:e})},e.textAnalyze=function(t){return this.textAnalyzeWithFeatures(256,t)},e.textAnalyzeWithFeatures=function(t,e){if(!e){return Promise.resolve({Features:0,Results:[]})}return Object(o.a)({body:JSON.stringify({Features:t,Text:e}),method:"POST",qosEventName:"Question.TextAnalysis",qosExtraData:{Features:t},requestUri:this.ho+"textanalysis3"})},e.logUserSignal=function(t){return Object(o.a)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.LogUserSignal",requestUri:this.Qt+"LogUserSignal"})},e.askSuggestion=function(t){return Object(o.a)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.AskSuggestion",requestUri:this.Qt+"ask"})},e.askSuggetions=function(t){return Object(o.a)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.AskSuggestions",requestUri:this.Qt+"askSuggestions"})},t}()},function(t,e,n){"use strict";var i;n.d(e,"a",(function(){return i})),function(t){t[t.DesignPage=0]="DesignPage",t[t.DesignPageRtl=1]="DesignPageRtl",t[t.ResponsePage=2]="ResponsePage",t[t.ResponsePageRtl=3]="ResponsePageRtl",t[t.MobileDesignPage=4]="MobileDesignPage",t[t.MobileDesignPageRtl=5]="MobileDesignPageRtl"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(3),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.LazyRendering&&window.setTimeout((function(){return t.setState({Mounted:!0})}))},n.render=function(){var t=o.clone(this.props.HTMLAttributes||{});switch(this.props.Role){case"Alert":t.role="alert";break;case"Log":t.role="log",t["aria-live"]=t["aria-live"]||"polite",t["aria-relevant"]=t["aria-relevant"]||"additions text";break;case"Marquee":t.role="marquee";break;case"Status":t.role="status"}return this.props.LazyRendering&&!this.state.Mounted?(t["aria-label"]=void 0,t.children=null,r.createElement("div",Object(i.__assign)({},t))):r.createElement("div",Object(i.__assign)({},t),this.props.children)},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"d",(function(){return I})),n.d(e,"b",(function(){return C})),n.d(e,"c",(function(){return k})),n.d(e,"a",(function(){return T}));var i,r,o,s=n(33),a=n(5),c=n(71),u=n(15),l=n(7),h=n(99),f=n(34),d=n(46),b=n(92),m=n(14),v=n(219),g=n(171),O=n(210),p=n(206),j=Object(l.a)().signInLinkSilent,y=Object(l.a)().signInLinkSilentMsa,w=0,S=null,N=!1;function I(){window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]);return Object(p.b)((function(){return Object(s.a)().AuthContext.hasUserLoggedIn()}),(function(){window.onbeforeunload=null,Object(s.a)().AuthContext.signIn().then(d.a)}))}function C(t,e){return new Promise((function(n,i){if(window.formsDetectUserLoggedInCallback)i();else{var r="Msa"===t,o=r?"Auth.DetectUserLoggedInMSA":"Auth.DetectUserLoggedInAAD",s=new c.a(o);s.start();var a=r?y:j;e&&(a=Object(f.d)(a,r?"username":"login_hint",encodeURIComponent(e)));var u=$("<iframe id='detect-user-loggedIn-frame' style='display: none' src='"+a+"' />");u.on("load",(function(){window.setTimeout((function(){window.formsDetectUserLoggedInCallback&&window.formsDetectUserLoggedInCallback(!1,!0)}),5e3)})),window.formsDetectUserLoggedInCallback=function(t,e){window.formsDetectUserLoggedInCallback=void 0,s.end({resultType:e?"ExpectedFailure":"Success"}),$("#detect-user-loggedIn-frame").remove(),n(t)},$(document.body).append(u)}}))}function k(t,e){if(Object(h.d)()||Object(h.e)()||Object(h.h)()){if(r||(r=new Promise((function(t){o=t})),N=!1),r.then((function(){return N=!0})),!Object(h.e)()&&!Object(h.h)()&&S&&S.isAccessTokenFromHostValid()){var n=S.getAccessToken();return e?Object(O.a)(n).then((function(){return o(n)})):o(S.getAccessToken()),r}return N||(r=new Promise((function(t){o=t})),N=!1),S=null,window.addEventListener("message",x,!1),window.parent.postMessage("GetAccessTokenFromHost","*"),w=0,P(),r}return Object(m.f)()?Object(v.a)().then(null,(function(){return F(t)})):Object(b.f)()?Object(b.c)():F(t)}function T(t){return t?(t.startsWith("t=")?"":"Bearer ")+t:""}function x(t){if(t.data&&"string"==typeof t.data&&t.data.startsWith("FormsAccessTokenFromHost:"))try{var e=t.data.indexOf("FormsAccessTokenFromHost:Bearer ");if(-1!==e){var n=t.data.substring(e+"FormsAccessTokenFromHost:Bearer ".length);S=new D(n)}}finally{window.removeEventListener("message",x,!1)}}function F(t){return Object(u.o)()?Promise.resolve(null):t.getCachedUser()?new Promise((function(e,n){t.acquireToken(Object(u.h)(),(function(r,o){if(!r&&o)return i=new Date,e(o);var s,c;if(!t.getCachedToken(Object(u.a)())){if(i){var l=(new Date).getTime()-i.getTime();Object(a.b)("Auth.AcquireTokenIdleTime",{error:r,idleTimeInMinutes:l/6e4})}return t.clearCache(),void Object(d.d)()}if(t.clearCache(),r.match("^AADSTS50079:"))return Object(a.c)("AADAcquireTokenMfaCheckFailure",r),(s=new Error).name="AADAcquireTokenMfaCheckError",s.message=r,n(s);if(!r.match("^AADSTS50058:"))return Object(a.c)("AADAcquireTokenFailure",r),(s=new Error).name="AADAcquireTokenError",s.message=r,n(s);if(Object(m.o)()||Object(m.m)()){var h=Object(g.a)();if(Object(a.c)("LoginIECrossZone",{useLegacyLoginDomain:!!h}),Object(g.a)())Object(g.c)(!1);else if(Object(g.b)())return Object(g.c)(!0),void Object(d.d)()}else Object(a.c)("AADAcquireTokenFailure",r);(c=r,new Promise((function(t){var e,n;e=function(e){Object(a.b)("Auth.ThirdPartyCookieSupport",{allow:e});var n=new Error(c);n.name=e?"LoginIECrossZoneError":"ThirdPartyCookieBlockedError",t(n)},n=function(t){switch(t.data){case"TPC:NotSupported":e(!1),window.removeEventListener("message",n);break;case"TPC:Supported":e(!0),window.removeEventListener("message",n)}},window.addEventListener("message",n,!1),$("body").append('<iframe id="detectThirdPartyCookieFrame" style="display:none;" src=https://controls.officeppe.com/thirdpartycookie/check.html><iframe>')}))).then(n)}))})):Promise.resolve(null)}function P(){if(null!=S){var t=S.getAccessToken();Object(O.a)(t).then((function(){return o(t)}))}else w<10?(w++,window.setTimeout(P,1e3)):(w=0,o(null))}var D=function(){function t(t){this.fo=t;this.do=(new Date).getTime()+33e5}var e=t.prototype;return e.getAccessToken=function(){return this.fo},e.isAccessTokenFromHostValid=function(){return!!this.fo&&(new Date).getTime()<this.do},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var i=n(82),r=["strong","em","u","sup","sub","a","i","b"],o=r.map((function(t){return"<"+t+">"})),s=r.map((function(t){return"</"+t+">"})),a=r.map((function(t){return"&lt;"+t+"&gt;"})),c=r.map((function(t){return"&lt;/"+t+"&gt;"}));function u(t){return function(t){var e=document.createElement("span");return e.innerHTML=t,t=e.innerHTML}(function(t){var e=Object(i.c)(t);return r.forEach((function(t,n){e=e.replaceAll(a[n],o[n]).replaceAll(c[n],s[n])})),e}(t))}function l(t){return o.forEach((function(e){t=t.replaceAll(e,"")})),s.forEach((function(e){t=t.replaceAll(e,"")})),t}},function(t,e,n){"use strict";n.d(e,"c",(function(){return s})),n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var i=n(23),r=n(9),o=n(75),s="WaitingForExport";function a(t){var e="RedirectToExcelPage.aspx?id="+encodeURIComponent(t)+"&forceReExport=false";Object(o.a)(e)}function c(t){var e="RedirectToExcelPage.aspx?id="+encodeURIComponent(t)+"&forceReExport=true";Object(i.q)()&&(e="TeamsRedirectToExcelPage.aspx?id="+encodeURIComponent(t)+"&forceReExport=true"),Object(r.f)(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(9),s=n(123),a=n(192);function c(t){return r.createElement(u,t)}var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t=this.props,e=t.RadioCheckbox?"radio":"checkbox",n=t.Options,i=n&&n.classNameForInnerDiv,s=Object(o.b)(e,n&&n.classNameForInnerLabel),c=t.Disabled,u=t.HelpText||void 0,l=Object(o.g)(n&&n.HTMLPropsForInnerElement,{checked:t.Value,disabled:c,type:e,onChange:this.xt.bind(this),className:this.props.ClassName,ref:this.props.CheckboxRef,autoFocus:t.CheckboxAutoFocus}),h=r.createElement("div",{className:s},r.createElement("label",{disabled:c},r.createElement("input",l),r.createElement("span",{className:this.props.SpanClassName},t.Description),t.ShowRequiredStar?r.createElement(a.a):void 0));return[r.createElement("div",{className:i,id:t.Id,disabled:c,title:u},h,t.children)]},n.xt=function(t){this.props.onValueChange(t.nativeEvent.target.checked)},e}(s.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return u}));var i=n(2),r=n(6),o=n(4),s={suggestions:o.a.collectionOf(o.a.string({IsLocalField:!0}))},a=function(t){function e(e){var n=t.call(this)||this;return n.bo=e,n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"SuggestId",{get:function(){return this.bo},enumerable:!1,configurable:!0}),e}(r.a.createObjectMasterClass("ThemeSuggestion",s)),c={};function u(t){if(!t)return null;var e=c[t];return e||(e=c[t]=new a(t)),e}},function(t,e,n){"use strict";n.d(e,"g",(function(){return c})),n.d(e,"d",(function(){return u})),n.d(e,"f",(function(){return l})),n.d(e,"a",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"e",(function(){return d})),n.d(e,"b",(function(){return b}));var i=n(3),r=n(6),o=n(15),s=n(164),a=n(31);function c(t,e){var n=i.map(e.Answers,(function(t){return{questionId:t.QuestionId,answer1:t.Answer}})),r={answers:JSON.stringify(n),startDate:e.StartDate instanceof Date?e.StartDate.toISOString():"",submitDate:e.SubmitDate instanceof Date?e.SubmitDate.toISOString():""};return r.emailReceiptConsent=e.EmailReceiptConsent,r.submitLanguage=e.SubmitLanguage,e.Responder&&(r.responder=e.Responder,r.responderName=e.ResponderName),Object(a.i)(t).submitFormResponse(t.Model.Id,r)}function u(t,e,n,i){return Object(a.i)(t).getFormResponses(t.Model.Id,i,e,n).then((function(t){return t.map(m)}))}function l(t){return Object(a.i)(t).getRuntimeResponses(t.Model.Id).then((function(t){return t.map(m)}))}function h(t){return Object(a.i)(t).deleteFormResponses(t.Model.Id)}function f(t,e){var n,i,r=null===(i=null===(n=window.FormPrefetchCache)||void 0===n?void 0:n.responseCache)||void 0===i?void 0:i.data;return("Response"===Object(o.m)()&&r?Promise.resolve(r.value):Object(a.i)(t).getRuntimeResponses(t.Model.Id,e)).then((function(t){return t.filter((function(t){return"0001-01-01T00:00:00Z"!==t.releaseDate})).map(m)}))}function d(t,e){return Object(a.i)(t).getRuntimeResponse(t.Model.Id,e).then(m)}function b(t,e){var n=Object(a.h)(t);return Promise.all(e.map((function(e){return n.deleteFormResponse(t,e)})))}function m(t){var e=r.a.convertFromSourceData(t,s.a.Schema);void 0!==e.StartDateAsString&&(e.StartDate=new Date(e.StartDateAsString)),void 0!==e.SubmitDateAsString&&(e.SubmitDate=new Date(e.SubmitDateAsString)),void 0!==e.ReleaseDateAsString&&(null===e.ReleaseDateAsString?e.ReleaseDate=new Date("0001-01-01T00:00:00Z"):e.ReleaseDate=new Date(e.ReleaseDateAsString));var n=[];if(e.AnswersAsString&&(n=JSON.parse(e.AnswersAsString).map((function(t){return{Answer:t.answer1,QuestionId:t.questionId}})),e.Answers=n),e.Comments){var o={},a=[];i.forEach(e.Comments,(function(t){var e=t.QuestionId||"___";o[e]&&a.push(o[e]),o[e]=t})),e.Comments=i.difference(e.Comments,a)}if(e.Comments){var c={};n.forEach((function(t){return c[t.QuestionId]=t})),i.forEach(e.Comments,(function(t){var i=t.QuestionId;if(i){var r=c[i];r||(r={Answer:null,QuestionId:i},n.push(r),c[i]=r),r.Feedback=t.Feedback,r.Score=t.Score}else e.Feedback=t.Feedback,e.TotalScore=t.Score}))}return e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(129),r=n(7),o=n(33),s=n(98),a=n(104);function c(t,e){return Object(o.a)().AuthContext.getFormApiToken().then((function(n){var o;return t.headers=$.extend(!0,t.headers,(o=n||"",{__RequestVerificationToken:Object(r.a)().antiForgeryToken,Accept:"application/json",Authorization:Object(i.a)(o),"Content-Type":"application/json"})),Object(s.a)(t,e).then((function(t){return t?Object(a.c)(t):Promise.reject("Data is null.")}),a.b)}))}},,function(t,e,n){"use strict";n.d(e,"a",(function(){return o})),n.d(e,"b",(function(){return a}));var i=n(6),r=0,o=function(){function t(t,e,n){this.L=t,this.mo=e,this.vo=n.FieldSchemas,this.Oo()}var e=t.prototype;return e.serialize=function(){var t=this.L.getSnapshot(this.vo),e=this.L.Schema,n={};this.vo.forEach((function(e){var r=i.a.getFieldSchemaInfo(e).Name;n[r]=i.a.convertToSourceData(t[r],e)}));var o=i.a.getFieldSchemaInfo(this.mo).Name,a=s(n,e,[]),c=a&&JSON.stringify(a),u=this.L.Model[o]!==c;(u||Math.random()<r)&&(u=!0,c=(a=s(n,e,null))&&JSON.stringify(a)),u&&(this.L.Model[o]=c)},e.deserialize=function(){var t=i.a.getFieldSchemaInfo(this.mo).Name,e=this.L.Model[t],n=e?JSON.parse(e):{},r={};this.vo.forEach((function(t){var e=i.a.getFieldSchemaInfo(t).Name;r[e]=i.a.convertFromSourceData(n[e],t)})),this.L.setData(r,this.vo)},e.Oo=function(){var t=this,e=i.a.getFieldSchemaInfo(this.mo).Name;this.L.addRule({Name:"Deserialize - "+e,InterestedFields:[this.mo],onChange:function(e){e.BeingDeleted||t.deserialize()}}),this.L.addRule({Name:"Serialize - "+e,InterestedFields:this.vo,onChange:function(e){e.BeingDeleted||t.serialize()}})},t}();function s(t,e,n){if(null==t)return null;if(Array.isArray(t)){if(t.length){var r=e[0];return t.map((function(t){return s(t,r,n)}))}return n}var o={},a=0;return i.a.getSubFieldSchemas(e).forEach((function(e){var r=i.a.getFieldSchemaInfo(e),c=r.Attributes.SourceFieldName||r.Name,u=t[c];r.IsLeaf||(u=s(u,e,n)),null!=u&&(++a,o[c]=u)})),a>0?o:null}function a(t){r=t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(15),r=n(11);function o(){return Object(i.u)()?Object(r.h)():Object(r.b)()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return N})),n.d(e,"b",(function(){return I})),n.d(e,"c",(function(){return C}));var i,r=n(158),o=n(1),s=n(37),a=(n(5),n(41)),c=n(69),u=n(7),l=n(57),h=n(26),f=n(10),d=n(71),b=n(96),m=n(2),v=function(){function t(){}return t.prototype.isActive=function(){return!0},t}(),g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.__extends)(e,t),e.prototype.getCampaignDefinition=function(){var t=Object(u.a)().userInfo.IsMsa;return{AdditionalDataRequested:Object(f.c)((function(){return t?["EmailAddress"]:[]}),f.f),CampaignId:Object(f.c)((function(){return"cafa0a7d-6a20-422a-a48b-ccd4cef6f8fe"}),f.f),EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{CooldownPeriod:{IntervalSeconds:7776e3,Type:0},NominationPeriod:{IntervalSeconds:2592e3,Type:0},PercentageDenominator:100,PercentageNumerator:Object(f.c)((function(){return t?50:25}),f.f),Type:0},Scope:{Type:0},StartTimeUtc:"2017-01-01T00:00:00Z",SurveyTemplate:{ActivationEvent:{Sequence:[{Activity:"AppUsageTime",Count:300,IsAggregate:!0,Type:0},{Activity:"AppResume",Count:1,IsAggregate:!1,Type:0}],Type:1},Type:0}}},e}(v),O=n(15),p=n(23),j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(m.__extends)(e,t);var n=e.prototype;return n.isActive=function(){return Object(O.u)()&&!Object(p.r)()},n.getCampaignDefinition=function(){return{AdditionalDataRequested:["EmailAddress"],CampaignId:"0d64410b-1a27-4ea2-939b-d969041e927d",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{CooldownPeriod:{IntervalSeconds:7776e3,Type:0},NominationPeriod:{IntervalSeconds:2592e3,Type:0},PercentageDenominator:100,PercentageNumerator:50,Type:0},Scope:{Type:0},StartTimeUtc:"2019-01-01T00:00:00Z",SurveyTemplate:{ActivationEvent:{Sequence:[{Activity:"MobileUsageTime",Count:60,IsAggregate:!1,Type:0}],Type:1},Content:{Prompt:{NoLabel:Object(o.a)().SuiteHeader_FPS_Prompt_NoLabel,Question:Object(o.a)().Mobile_FPS_Question_Title,Title:Object(o.a)().Mobile_FPS_Title,YesLabel:Object(o.a)().SuiteHeader_FPS_Prompt_YesLabel},Question:{Question:Object(o.a)().Mobile_FPS_Text_Question_Title},Rating:{Question:Object(o.a)().Mobile_FPS_Rating_Question_Title,RatingValuesAscending:[Object(o.a)().Mobile_FPS_Rating_Option1,Object(o.a)().Mobile_FPS_Rating_Option2,Object(o.a)().Mobile_FPS_Rating_Option3,Object(o.a)().Mobile_FPS_Rating_Option4,Object(o.a)().Mobile_FPS_Rating_Option5]}},Type:2}}},e}(v),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(m.__extends)(e,t),e.prototype.getCampaignDefinition=function(){return{AdditionalDataRequested:["EmailAddress"],CampaignId:"e181a191-8062-4bd0-bbb2-9cf586be3df5",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{CooldownPeriod:{IntervalSeconds:7776e3,Type:0},NominationPeriod:{IntervalSeconds:2592e3,Type:0},PercentageDenominator:100,PercentageNumerator:100,Type:0},Scope:{Type:0},StartTimeUtc:"2019-01-01T00:00:00Z",SurveyTemplate:{ActivationEvent:{Sequence:[{Activity:"MSATemplateClick",Count:2,IsAggregate:!1,Type:0}],Type:1},Content:{Prompt:{NoLabel:Object(o.a)().SuiteHeader_FPS_Prompt_NoLabel,Question:Object(o.a)().MSATemplate_FPS_Prompt_Question,Title:Object(o.a)().MSATemplate_FPS_Prompt_Title,YesLabel:Object(o.a)().SuiteHeader_FPS_Prompt_YesLabel},Question:{Question:Object(o.a)().MSATemplate_FPS_CommentQuestion},Rating:{Question:Object(o.a)().MSATemplate_FPS_RatingQuestion_Title,RatingValuesAscending:[Object(o.a)().MSATemplate_FPS_RatingQuestion_Option1,Object(o.a)().MSATemplate_FPS_RatingQuestion_Option2,Object(o.a)().MSATemplate_FPS_RatingQuestion_Option3,Object(o.a)().MSATemplate_FPS_RatingQuestion_Option4,Object(o.a)().MSATemplate_FPS_RatingQuestion_Option5]}},Type:2}}},e}(v),w=[];function S(t){t.isActive()&&w.push(t.getCampaignDefinition())}function N(t){if(!i){var e=Object(r.b)("strings",Object(o.d)());i=e.then(s.c).then((function(e){return function(t,e){var n,i,r=new d.a("OfficeNPS.load");r.start();var o=null===(i=null===(n=Object(u.a)())||void 0===n?void 0:n.userInfo)||void 0===i?void 0:i.TenantId;return Object(c.a)("OfficeBrowserFeedback").then((function(){var n={Host:e||"Desktop",TenantType:t};return OfficeBrowserFeedback.initOptions={appId:Object(f.c)((function(){return 2229}),f.f),applicationGroup:{appData:JSON.stringify(n)},cid:r.CorrelationId,environment:Object(a.f)()?0:1,intlUrl:Object(h.d)("/Scripts/Vendors/officebrowserfeedback/1.4.2/intl/"),locale:Object(u.a)().cultureInfo.Name||"en-us",primaryColour:"#008272",secondaryColour:"#004B50",sessionId:Object(b.b)(),stylesUrl:Object(h.c)("vendors/officebrowserfeedback/1.4.2/officebrowserfeedback.min.css",!1),telemetryGroup:{audienceGroup:Object(a.f)()?"Production":void 0,tenantId:o},userEmail:Object(u.a)().userInfo.Email},OfficeBrowserFeedback.floodgate.initOptions={campaignDefinitions:(w.length||(S(new g),S(new j),S(new y)),w)},window.OfficeBrowserFeedback.floodgate.initialize()})).then((function(){return OfficeBrowserFeedback.floodgate.start()})).then((function(){var t=$(window);t.focus((function(){OfficeBrowserFeedback.floodgate&&OfficeBrowserFeedback.floodgate.start()})),t.blur((function(){OfficeBrowserFeedback.floodgate&&OfficeBrowserFeedback.floodgate.stop()})),t.unload((function(){OfficeBrowserFeedback.floodgate&&(OfficeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivityStopTime("AppUsageTime"),OfficeBrowserFeedback.floodgate.stop())})),r.end({resultType:"Success"})})).catch((function(t){var e=t&&t.toString().indexOf("window.localStorage is not available")>=0&&!Object(l.d)();throw r.end({extraData:{ServiceError:t},resultType:e?"ExpectedFailure":"Failure"}),t}))}(e,t)}))}return i}function I(t,e,n){N(n).then((function(){OfficeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivity(t,e)}),(function(){}))}function C(t,e,n){N(n).then((function(){OfficeBrowserFeedback.floodgate.getEngine().getActivityListener().logActivityStartTime(t,e)}),(function(){}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"e",(function(){return l})),n.d(e,"d",(function(){return h})),n.d(e,"c",(function(){return f}));var i=n(2),r=n(29),o=n(187),s=function(t){function e(){var n=this;return e.instance?e.instance:((n=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userLicenseInfoCache)||this).init(),e.instance=n,n)}Object(i.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return new e},n.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;r.a.getInstance().createDataProvider().getUserInfo().then((function(e){return t.prefetchResolve(e)})).catch((function(e){return t.prefetchReject(e)}))},e}(o.a),a=function(t){function e(){var n=this;return e.instance?e.instance:((n=t.call(this,window.FormPrefetchCache&&window.FormPrefetchCache.userReputationTierCache)||this).init(),e.instance=n,n)}Object(i.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return new e},n.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;r.a.getInstance().createDataProvider().getUserReputationTier().then((function(e){return t.prefetchResolve(e)})).catch((function(e){return t.prefetchReject(e)}))},e}(o.a);function c(){return s.getInstance().getPromise()}function u(){return r.a.getInstance().createDataProvider().getUserFeatureSettings()}function l(t){return r.a.getInstance().createDataProvider().updateUserFeatureSettings(t)}function h(){return r.a.getInstance().createDataProvider().refreshUserInfo()}function f(){return a.getInstance().getPromise()}},function(t,e,n){"use strict";function i(t,e){return s(e,t&&t.type,t&&t.statusCode)}function r(t,e){return s(e,t&&t.failureType,t&&t.statusCode)}function o(t){var e=t;if(e&&e.statusCode)return JSON.stringify({correlationId:e.correlationId,innerCode:e.innerCode,innerMessage:e.innerMessage,isServerError:e.isServerError,statusCode:e.statusCode,statusText:e.statusText,type:e.type});var n=t;return n&&n.message?JSON.stringify({message:n.message,name:n.name,stack:n.stack}):JSON.stringify(t||"")}function s(t,e,n){switch(t){case"Information":case"FormsProInformation":return!0;case"Error":return!1;default:switch(e){case"Failure":return!1;case"ExpectedFailure":return!0;default:var i=parseInt(n);if(i>=0&&i<500)return!0}}return!1}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r})),n.d(e,"c",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l})),n.d(e,"c",(function(){return h}));var i=n(2),r=n(0),o=n(15),s=n(25),a=(n(10),n(8)),c="https://go.microsoft.com/fwlink/?linkid=866263",u=function(t){function e(e){var n=t.call(this,e)||this;return n.state={TermUrl:""},n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t;t||(t=h(),this.props.ForceUseCommercialTermsLink?t=l():this.props.FormMaster&&(t=function(t){if(t.SyncContext!==s.a.AdminPhishingReviewForm&&(t.SyncContext===s.a.SharedTimeForm||t.Model.Settings.IsAnonymous||t.Model.Settings.NotRecordIdentity))return c;return"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}(this.props.FormMaster))),this.setState({TermUrl:t})},n.render=function(){var t={href:this.state.TermUrl,target:"_blank"};return r.createElement("a",Object(i.__assign)({},t),this.props.LocalizedStrings.TermsLink)},e}(a.a);function l(){return Object(o.A)()?"https://portal.office.com/account/#subscriptions":Object(o.z)()?"https://portal.office365.us/account/#subscriptions":Object(o.y)()?"https://portal.apps.mil/account/#subscriptions":"http://go.microsoft.com/fwlink/p/?LinkId=2083423"}function h(){return c}},function(t,e,n){"use strict";n.d(e,"b",(function(){return p})),n.d(e,"a",(function(){return j}));var i=n(2),r=n(6),o=n(4),s=n(52),a=n(44),c=n(148),u=n(113),l=n(137),h=n(154),f=n(70),d=n(30),b=n(5),m=n(31),v=n(25),g=function(){function t(t,e){this.po=t,this.N=Object(m.i)(this.po.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.po.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"QuestionId",{get:function(){return this.po.QuestionId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ChoiceId",{get:function(){return this.po.Model.Id},enumerable:!1,configurable:!0}),e.add=function(t){if(this.po.Form.SyncContext===v.a.DesignTimeForm)return this.N.createQuestionChoice(this.FormId,this.QuestionId,t);Object(d.b)("Trying to create a choice out of design time.")},e.delete=function(t){if(this.po.Form.SyncContext===v.a.DesignTimeForm)return this.N.deleteQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId);Object(d.b)("Trying to delete a choice out of design time.")},e.query=function(t){return this.N.getQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId)},e.update=function(t,e){if(this.po.Form.SyncContext===v.a.DesignTimeForm){if(t)return this.N.updateQuestionChoice(this.FormId,this.QuestionId,this.ChoiceId,t);try{throw Error("patch choice body null error")}catch(t){Object(b.c)("DataSourceUpdatingChoiceNull",{stack:t.stack})}return Promise.resolve()}Object(d.b)("Trying to update a choice out of design time.")},t}(),O={Id:o.a.number({IsSourceGenerated:!0,IsKeyField:!0,SourceFieldName:"id"}),AnswerHint:o.a.string({SourceFieldName:"description"}),CustomProperties:o.a.string({SourceFieldName:"customProperties"}),Description:o.a.string({SourceFieldName:"displayText"}),FormsProDisplayRTText:o.a.string({IsLocalField:!0}),Order:o.a.number({SourceFieldName:"order"}),Key:o.a.string({SourceFieldName:"key"}),IsGenerated:o.a.boolean({IsLocalField:!0}),IsMathOption:o.a.boolean({IsLocalField:!0}),BranchInfo:o.a.fromMasterClass((function(){return c.a}),{IsLocalField:!0}),SavingState:o.a.reference({IsLocalField:!0})};function p(t){return r.a.getObjectMasterFromModel(t)}var j=function(t){function e(n){var i=this,r=new a.a;return i=t.call(this,n,{Scheduler:new u.a(e.name),MasterReady:r.promise()})||this,Object(f.b)(i),i.fieldsReady([i.Schema.Id,i.Schema.Key]).then((function(){i.Model.Key||(i.Model.Key=Object(s.c)())})),i.jo(n),r.resolve(),i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Question",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionId",{get:function(){return this.Question.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Form",{get:function(){return this.Question.Form},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),n.jo=function(t){this.yo=new l.a(this,e.Schema.CustomProperties,e.CustomPropertiesFieldSet),t.InitialData&&this.isFieldReady(e.Schema.CustomProperties)&&(t.ExistingInDataSource||t.InitialData.CustomProperties?this.yo.deserialize():this.yo.serialize())},Object.defineProperty(e,"CustomPropertiesFieldSet",{get:function(){return e.customPropertiesFieldSet||(e.customPropertiesFieldSet=new h.a([e.Schema.BranchInfo,e.Schema.IsGenerated,e.Schema.IsMathOption,e.Schema.FormsProDisplayRTText])),e.customPropertiesFieldSet},enumerable:!1,configurable:!0}),e}(r.a.createObjectMasterClass("ChoiceV2Master",O,(function(t,e){return new g(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(50),r=n(28);var o=n(5),s=n(54);function a(t){Object(i.d)()||r.a.Resolve("IThirdPartyLinkify").then((function(){return function(t){t.linkify();var e=/^[a-z0-9]\.|\.xxx/i,n=Object(s.a)("LinkifyEscapeRegex");n&&(e=new RegExp(n,"i"));t.find("a.linkified").each((function(t,n){$(n).text().match(e)&&$(n).contents().unwrap()})),t.find("a.linkified").length&&Object(o.b)("NeedLinkify")}(t)}))}},function(t,e,n){"use strict";function i(){return n.e(11).then(n.t.bind(null,256,3)).then((function(t){return t.default}))}function r(){return n.e(9).then(n.t.bind(null,366,3)).then((function(t){return t.default}))}function o(){return n.e(7).then(n.t.bind(null,367,3)).then((function(t){return t.default}))}function s(){return n.e(8).then(n.t.bind(null,369,3)).then((function(t){return t.default}))}n.d(e,"a",(function(){return i})),n.d(e,"c",(function(){return r})),n.d(e,"b",(function(){return o})),n.d(e,"d",(function(){return s}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(2),r=n(1),o=n(100),s=n(17),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.DateTime"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(r.a)().Question_DefaultTitle,Date:!0,Time:!1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)},n.verify=function(t){return this.Model.Required&&!t?s.e.RequiredError:s.e.Success},n.getTypeDisplayName=function(){return Object(r.a)().QuestionType_DateTime},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(2),r=n(1),o=n(100),s=n(17),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.Rating"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(r.a)().Question_DefaultTitle,Length:5,RatingShape:s.f.Star,LeftDescription:"",RightDescription:"",MinRating:1,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.supportMobileDesign=function(t){return!e.hasInvalidSettingOnMobile(t)&&!t.ShowRatingLabel},n.verify=function(t){return this.Model.Required&&!t?s.e.RequiredError:s.e.Success},n.getTypeDisplayName=function(){return Object(r.a)().QuestionType_Rating},n.isNumberType=function(){return!0},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),r=n(6),o=n(4),s=n(12),a=n(28),c=n(58),u=n(51),l=n(17),h={TargetQuestionId:o.a.string(),ToTheEnd:o.a.boolean()},f=function(t){function e(n){var i=t.call(this,n)||this;return i.wo=!1,i.So=!1,i.No="",i.Io=function(t){return i.Co()},n.MasterTreeReady.then((function(){i.Deleted||(e.normalize(i,{},!1),i.addRule({Name:"normalize",onChange:function(t){e.normalize(i,t.OldValues,!0)}}),i.observe((function(t){i.Deleted||i.To()})))})),i}Object(i.__extends)(e,t);var n=e.prototype;return n.getElementMaster=function(){var t=this.Parent;do{if(t instanceof l.d||t instanceof c.a)return t}while(t=t.Parent);return null},n.getTargetElementMaster=function(){if(this.Deleted)return null;var t=this.getElementMaster().Form.FormElementManager;if(!this.Model.TargetQuestionId)return null;var e=t.getElementMasterById(this.Model.TargetQuestionId);return e&&e.Deleted?null:e?(u.a.isSection(e.Model.Type)||t.findContainerSection(this.getElementMaster())===t.findContainerSection(e))&&e:e},n.resetToDefault=function(){var t=this;this.wo=!1,this.bulkEdit((function(){t.Model.ToTheEnd=null,t.Model.TargetQuestionId=null}))},n.isDefault=function(){return!this.Model.ToTheEnd&&!this.Model.TargetQuestionId},n.getBranchingResult=function(){var t=this.Model;return this.isValid()?t.ToTheEnd?{Type:"End"}:{Type:"Specified",TargetElement:this.getTargetElementMaster()}:{Type:"Next"}},n.hasSectionBranching=function(){var t=this.getElementMaster(),e=this.getTargetElementMaster();return u.a.isSection(t.Model.Type)||e&&u.a.isSection(e.Model.Type)},e.normalize=function(t,e,n){var i=t.Model;i.ToTheEnd?e.ToTheEnd&&i.TargetQuestionId||(i.TargetQuestionId=null):i.ToTheEnd=null,n&&t.xo()},n.isValid=function(){return this.wo&&this.No===this.Model.TargetQuestionId||(this.xo(),this.To()),this.So},n.xo=function(){this.wo=!0,this.No=this.Model.TargetQuestionId,this.So=!(!this.Model.ToTheEnd&&!this.getTargetElementMaster());var t=this.Model.TargetQuestionId;!this.So&&t&&Object(s.d)()&&(this.So=a.a.Resolve("IIncrementalLoadStrategy").has(t))},n.To=function(){var t=this.getTargetElementMaster(),e=this.Fo;t!==e&&((e instanceof l.d||e instanceof c.a)&&e.unobserve(this.Io),this.Fo=t,(t instanceof l.d||t instanceof c.a)&&t.observe(this.Io))},n.Co=function(){if(this.Fo.Deleted)this.Model.TargetQuestionId=null;else if(this.Fo instanceof l.d){var t=this.getElementMaster().Form.FormElementManager;t.findContainerSection(this.getElementMaster())!==t.findContainerSection(this.Fo)&&(this.Model.TargetQuestionId=null)}},e}(r.a.createObjectMasterClass("BranchInfoMaster",h))},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(1);function r(t,e){var n=null!=e?e:Object(i.a)();switch(t){case"1001":return n.Error_Message_1001;case"10203":return n.Error_Message_10203;case"10204":return n.Error_Message_10204;case"10205":return n.Error_Message_10205;case"10206":return n.Error_Message_10206;case"10207":return n.Error_Message_10207;case"10208":return n.Error_Message_10208;case"10300":return n.Error_Message_10300;case"10301":return n.Error_Message_10301;case"1204":return n.Error_Message_1204;case"15001":return n.Error_Message_15001;case"15003":return n.Error_Message_15003;case"15429":return n.Error_Message_15429;case"1624":return n.Error_Message_1624;case"20000":return n.Error_Message_20000;case"20001":return n.Error_Message_20001;case"5001":return n.Error_Message_5001;case"5002":return n.Error_Message_5002;case"5003":return n.Error_Message_5003;case"5004":return n.Error_Message_5004;case"5005":return n.Error_Message_5005;case"5006":return n.Error_Message_5006;case"5109":return n.Error_Message_5109;case"5114":return n.Error_Message_5114;case"5117":return n.Error_Message_5117;case"5203":return n.Error_Message_5203;case"5204":return n.Error_Message_5204;case"5205":return n.Error_Message_5205;case"5206":return n.Error_Message_5206;case"5207":return n.Error_Message_5207;case"5208":return n.Error_Message_5208;case"5209":return n.Error_Message_5209;case"5302":return n.Error_Message_5302;case"532":return n.Error_Message_532;case"533":return n.Error_Message_533;case"534":return n.Error_Message_534;case"535":return n.Error_Message_535;case"536":return n.Error_Message_536;case"537":return n.Error_Message_537;case"5400":return n.Error_Message_5400;case"5401":return n.Error_Message_5401;case"5402":return n.Error_Message_5402;case"5403":return n.Error_Message_5403;case"5501":return n.Error_Message_5501;case"5503":return n.Error_Message_5503;case"5504":return n.Error_Message_5504;case"5510":return n.Error_Message_5510;case"5550":return n.Error_Message_5550;case"5551":return n.Error_Message_5551;case"5552":return n.Error_Message_5552;case"5553":return n.Error_Message_5553;case"5554":return n.Error_Message_5554;case"5556":return n.Error_Message_5556;case"5557":return n.Error_Message_5557;case"5558":return n.Error_Message_5558;case"5559":return n.Error_Message_5559;case"5560":return n.Error_Message_5560;case"600":return n.Error_Message_600;case"601":return n.Error_Message_601;case"602":return n.Error_Message_602;case"603":return n.Error_Message_603;case"604":return n.Error_Message_604;case"605":return n.Error_Message_605;case"606":return n.Error_Message_606;case"607":return n.Error_Message_607;case"608":return n.Error_Message_608;case"609":return n.Error_Message_609;case"610":return n.Error_Message_610;case"6100":return n.Error_Message_6100;case"6102":return n.Error_Message_6102;case"6103":return n.Error_Message_6103;case"6105":return n.Error_Message_6105;case"611":return n.Error_Message_611;case"613":return n.Error_Message_613;case"614":return n.Error_Message_614;case"615":return n.Error_Message_615;case"620":return n.Error_Message_620;case"624":return n.Error_Message_624;case"625":return n.Error_Message_625;case"6252":return n.Error_Message_6252;case"6254":return n.Error_Message_6254;case"636":return n.Error_Message_636;case"642":return n.Error_Message_642;case"645":return n.Error_Message_645;case"649":return n.Error_Message_649;case"650":return n.Error_Message_650;case"651":return n.Error_Message_651;case"652":return n.Error_Message_652;case"653":return n.Error_Message_653;case"654":return n.Error_Message_654;case"655":return n.Error_Message_655;case"656":return n.Error_Message_656;case"657":return n.Error_Message_657;case"658":return n.Error_Message_658;case"659":return n.Error_Message_659;case"6611":return n.Error_Message_6611;case"6612":return n.Error_Message_6612;case"6613":return n.Error_Message_6613;case"6614":return n.Error_Message_6614;case"6700":return n.Error_Message_6700;case"6701":return n.Error_Message_6701;case"6702":return n.Error_Message_6702;case"6705":return n.Error_Message_6705;case"674":return n.Error_Message_674;case"700":return n.Error_Message_700;case"701":return n.Error_Message_701;case"702":return n.Error_Message_702;case"703":return n.Error_Message_703;case"704":return n.Error_Message_704;case"705":return n.Error_Message_705;case"707":return n.Error_Message_707;case"709":return n.Error_Message_709;case"710":return n.Error_Message_710;case"711":return n.Error_Message_711;case"712":return n.Error_Message_712;case"714":return n.Error_Message_714;case"715":return n.Error_Message_715;case"717":return n.Error_Message_717;case"751":return n.Error_Message_751;case"752":return n.Error_Message_752;case"754":return n.Error_Message_754;case"755":return n.Error_Message_755;case"756":return n.Error_Message_756;case"812":return n.Error_Message_812;case"824":return n.Error_Message_824;default:return""}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return K}));var i=n(0),r=n(2),o=n(40),s=n(39);function a(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(113).then(n.bind(null,1123))];case 1:return[2,{default:t.sent().DateTimeRenderer}]}}))}))}function c(t){var e=Object(s.a)(c,a);return i.createElement(o.a,null,i.createElement(e,Object(r.__assign)({},t)))}function u(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(114).then(n.bind(null,1134))];case 1:return[2,{default:t.sent().FileUploadRenderer}]}}))}))}function l(t){var e=Object(s.a)(l,u);return i.createElement(o.a,null,i.createElement(e,Object(r.__assign)({},t)))}function h(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(115).then(n.bind(null,1137))];case 1:return[2,{default:t.sent().LikertRenderer}]}}))}))}function f(t){var e=Object(s.a)(f,h);return i.createElement(o.a,null,i.createElement(e,Object(r.__assign)({},t)))}function d(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(116).then(n.bind(null,1122))];case 1:return[2,{default:t.sent().NPSRenderer}]}}))}))}function b(t){var e=Object(s.a)(b,d);return i.createElement(o.a,null,i.createElement(e,Object(r.__assign)({},t)))}function m(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(117).then(n.bind(null,1121))];case 1:return[2,{default:t.sent().RankingRenderer}]}}))}))}function v(t){var e=Object(s.a)(v,m);return i.createElement(o.a,null,i.createElement(e,Object(r.__assign)({},t)))}function g(){return Object(r.__awaiter)(this,void 0,void 0,(function(){return Object(r.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(118).then(n.bind(null,1120))];case 1:return[2,{default:t.sent().RatingRenderer}]}}))}))}function O(t){var e=Object(s.a)(O,g);return i.createElement(o.a,null,i.createElement(e,Object(r.__assign)({},t)))}var p=n(3),j=n(6),y=n(72),w=n(12),S=n(19),N=n(35),I=n(52),C=n(9),k=n(14),T=n(55),x=n(79),F=n(17),P=n(106),D=n(117),M=n(10),L=n(56),A=n(62),R=n(27),E=n(48),B=n(18),_=function(t){function e(e){var n=t.call(this,e)||this;return n.Po=n.Po.bind(n),n}Object(r.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.props.Choice,e=this.props.ContainerClassName;this.props.IsChecked&&this.props.IsMobile&&(e=Object(C.b)(e,"active"));var n=Object(C.b)("office-form-question-choice-row",this.props.ClassNameForLabel),o=Object(M.c)((function(){return t.Description}),M.f);return i.createElement("div",{className:e},i.createElement("div",{className:this.props.IsSingleChoice?"radio":"checkbox"},i.createElement("label",{className:n},i.createElement("input",Object(r.__assign)({"aria-checked":this.props.IsChecked,"aria-label":o,checked:this.props.IsChecked,disabled:this.props.Disabled,onChange:this.Po,type:this.props.IsSingleChoice?"radio":"checkbox",value:t.Description},this.props.HTMLPropsForInput)),this.props.children,this.Do())),this.Mo())},n.Do=function(){var t,e;switch(this.props.AnswerType){case"Correct":e="CheckMark",t=this.props.IsMobile&&this.props.IsChecked?"image-button-checked-answerkey-mobile office-form-answerkey":"image-button-answerkey office-form-answerkey";break;case"Wrong":t=this.props.IsMobile?"image-button-checked-wrong-answer-mobile office-form-answerkey":"",e=this.props.IsMobile?"Cancel":""}if(e)return Object(B.b)({HTMLAttributes:{className:Object(C.b)(t,"forms-icon-size20x20"),role:"tooltip",title:this.props.ToolTipForAnswer},IconName:e})},n.Mo=function(){if(this.props.AnswerHint){var t=void 0;return t="Correct"===this.props.AnswerType?this.props.IsMobile?"validation-success-mobile":"validation-success":this.props.IsMobile?"validation-error-mobile":"validation-error",t=Object(C.b)("office-form-answerhint",t),i.createElement("div",{className:t},this.props.AnswerHint)}},n.Po=function(){this.props.onChange(this.props.Choice.Description)},e}(n(8).a),H=n(211),G="6c660282-db72-436c-87bb-8272cba504d3",q=function(t){function e(e){var n=t.call(this,e)||this;n.Lo=i.createRef(),n.Ao=Object(I.c)();var r=n.Ro(),o=n.Eo(),s=n.Bo();return n.state={ChoiceOptions:o,IsOtherOptionSelected:!!r.OtherAnswer,LocalizedOptions:n.questionLocalizedItemMaster&&n.questionLocalizedItemMaster.Model.option,OptionsOrder:s,OrderedChoices:p.map(s,(function(t){return o[t]})),OtherOptionText:r.OtherAnswer,ReachMaxLengthLimit:!1,SelectedOptions:r.SelectedOptions},n.xt=n.xt.bind(n),n._o=n._o.bind(n),n.Ho=n.Ho.bind(n),n.Go=n.Go.bind(n),n.qo=n.qo.bind(n),n.Qo=n.Qo.bind(n),n}Object(r.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this),this.props.Master.Question.observe(this.Ho),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.observe(this.qo,[D.a.Schema.Answer]),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.Go,[P.a.Schema.choicesV1]);var e=[];e=Object(N.b)(e),this.props.Master.Question.Form.observe(this.update,e)},n.componentWillUnmount=function(){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.Go),this.props.Master.Question.Form.unobserve(this.update),this.props.Master.Question.unobserve(this.Ho),(this.props.ShowQuizResult||this.props.IncrementalLoadFormsEnabled)&&this.props.Master.unobserve(this.qo,[D.a.Schema.Answer]),t.prototype.componentWillUnmount.call(this)},n.componentWillReceiveProps=function(e){this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.Go),t.prototype.componentWillReceiveProps.call(this,e),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.Go,[P.a.Schema.choicesV1])},n.shouldComponentUpdate=function(t,e){var n=!p.isEqual(t,this.props),i=!p.isEqual(e,this.state);return n||i},n.createReactNodes=function(){var t=this.props.Master.Question,e=t.Model,n=e.ChoiceType===F.a.SingleChoice;return this.props.IsPrintViewDesignTime||this.props.ExpandAll||!t.showAsDropdown()||e.IsQuiz&&this.props.ShowQuizResult?[this.Vo(n),this.zo()]:[this.Uo()]},n.getFormattedDataForImmersiveReader=function(){var e=t.prototype.getFormattedDataForImmersiveReader.call(this),n=null,i=document.createElement("ul");return p.forEach(this.state.OrderedChoices,(function(t){var e=document.createElement("li"),r=null;if(t.IsMathOption&&"undefined"!=typeof MathJax){n=n||MathJax.Hub.getAllJax(null);var o=p.find(n,(function(e){return e.originalText===t.Description}));if(o){var s=o.root&&o.root.toMathML&&o.root.toMathML();s&&(s=s.replace(/\n\s*/g,""),r="\x3c!--[if mathML]&#62;"+Object(C.c)(s,!0)+"&#60;![endif]--\x3e")}}e.innerHTML=r||Object(C.c)(t.Description,!0),i.appendChild(e)})),i.appendChild(document.createElement("br")),e.splice(e.length-1,0,{content:i.outerHTML,mimeType:"text/html"}),e},n.qo=function(){var t=this.Ro(),e=!!t.OtherAnswer;this.props.Master.Question.Model.ChoiceType===F.a.SingleChoice&&(e=!!t.OtherAnswer||0===t.SelectedOptions.length),this.setState({IsOtherOptionSelected:e,OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.$o=function(t){},n.Wo=function(){var t,e=this,n=[],i=this.props.Master.Question.Model.ChoiceType===F.a.SingleChoice,r=this.state.SelectedOptions;r&&r.forEach((function(t){return n.push(t)}));var o=this.state.OtherOptionText;if(Object(M.c)((function(){e.state.IsOtherOptionSelected&&o&&-1===n.indexOf(o)&&n.push(o)}),M.f),i)t=n[0];else if(n.length){var s=this.Ko(n);t=JSON.stringify(s)}this.props.Master.Model.Answer=t},n.Vo=function(t){var n=this,o=this.props.Master.Question.Model,s=this.state.OrderedChoices.length+(o.AllowOtherAnswer?1:0),a=this.props.Master.Question.Form,c=Object(y.a)(a,"ResponsePage.PollView"),u=Object(C.b)(this.props.IsMobile&&!c?"office-form-question-choice-mobile office-form-theme-page-background-active":"office-form-question-choice"),l=this.state.OrderedChoices.map((function(r,o){var a,c=-1!==n.state.SelectedOptions.indexOf(r.Description),l=n.props.Master.Question.Model.IsQuiz?"office-form-question-choice-quiz-row":"";if(n.props.Master.Question.Model.IsMathQuiz&&r.IsMathOption){var h=Object(T.c)({DisableLinebreaks:n.props.DisableFormulaLinebreak,Formula:r.Description,onRenderComplete:n.props.onHeightChange}),f="office-form-question-choice-formula";Object(k.z)()&&(f+=" formula-renderer-container-safari9"),a=i.createElement("div",{className:f},h)}else{l=Object(C.b)(l,"office-form-question-choice-text-row");var d=n.questionLocalizedItemMaster,b=void 0;if(d){var m=d.getChoiceV1LocalizedMaster(n.state.OptionsOrder[o]);b=m&&m.Model.description,Object(w.g)()&&(b=m&&m.Model.formsProDisplayRTText||r.FormsProDisplayRTText||b)}else b=Object(w.g)()&&r.FormsProDisplayRTText;var v=b||r.Description,g={Text:v=Object(N.m)(v,!1)};Object(w.g)()&&(g.ContainsHtml=!0,g.RenderMode="RichText"),a=i.createElement("span",{className:"office-form-question-choice-text-span"},Object(E.b)(g))}var O,j=e.getAnswerKeyMark(n.props,r,c);switch(j){case"Correct":O=n.props.LocalizedStrings.Quiz_CorrectAnswer;break;case"Wrong":O=n.props.LocalizedStrings.Quiz_WrongAnswer}var y={name:n.Ao};return t&&p.extend(y,{"aria-posinset":o+1,"aria-setsize":s}),i.createElement(_,{AnswerHint:e.getAnswerHintLabel(n.props,r,c),AnswerType:j,ToolTipForAnswer:O,Choice:r,ClassNameForLabel:l,ContainerClassName:u,Disabled:n.props.Disabled,HTMLPropsForInput:y,IsChecked:c,IsMobile:n.props.IsMobile,IsSingleChoice:t,key:o,LocalizedStrings:n.props.LocalizedStrings,onChange:n.xt},a)})),h=this.getElementProps({key:"choicequestion-choices",role:t?"radiogroup":"group"});return i.createElement("div",Object(r.__assign)({},h),l,this.Jo(t))},n.Jo=function(t){var e=this.props.Master.Question.Form,n=Object(y.a)(e,"ResponsePage.PollView");if(this.props.Master.Question.Model.AllowOtherAnswer){var o={className:this.props.IsMobile&&!n?"office-form-other-answer-mobile":"office-form-other-answer",key:"other-answer"};return i.createElement("div",Object(r.__assign)({},o),i.createElement("div",{className:"radio"},i.createElement("label",null,this.Xo(t),this.Zo())))}},n.Xo=function(t){var e=this.state.ChoiceOptions,n={"aria-label":this.props.LocalizedStrings.Response_Page_OtherAnswerTitle,checked:this.state.IsOtherOptionSelected,disabled:this.props.Disabled,name:t?this.Ao:void 0,onChange:this._o,ref:"otherAnswerInput",role:"checkbox",type:"checkbox",value:this.state.OtherOptionText||""};return t&&(n.role="radio",n.type="radio",n["aria-posinset"]=e.length+1,n["aria-setsize"]=e.length+1),i.createElement("input",Object(r.__assign)({},n))},n._o=function(){var t=this,e=this.state.IsOtherOptionSelected,n=p.clone(this.state.SelectedOptions);if(!e){this.props.Master.Question.Model.ChoiceType===F.a.SingleChoice&&(n=[]);var i=this.Lo.current;i&&i.focus()}this.setState({IsOtherOptionSelected:!e,SelectedOptions:n},(function(){return t.Wo()}))},n.Zo=function(){var t={"aria-label":this.props.LocalizedStrings.Designer_OtherAnswer,className:"office-form-other-answer-textbox"},e=this.props.IsPrintViewDesignTime?"":this.props.LocalizedStrings.Designer_OtherAnswer,n={AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"inline-display office-form-other-answer-margin-left-mobile"},MaxLength:Object(S.D)(),onValueChange:this.Qo,Options:{HTMLPropsForInnerElement:t},Placeholder:e,ref:this.Lo,Value:this.state.OtherOptionText||""},r=this.props.IsPrintViewDesignTime&&i.createElement("div",{className:"print-choice-other-answer-hint"},this.props.LocalizedStrings.Designer_OtherAnswer);return i.createElement("div",{className:"office-form-other-answer-inline"},Object(R.b)(n),r)},n.Qo=function(t){var e=this,n=this.state.SelectedOptions;this.props.Master.Question.Model.ChoiceType===F.a.SingleChoice&&(n=[]),this.setState({IsOtherOptionSelected:!!t,OtherOptionText:t,SelectedOptions:n},(function(){return e.Wo()}))},n.Ho=function(){var t=this.Ro();this.setState({ChoiceOptions:this.Eo(),OptionsOrder:this.Bo(),OrderedChoices:this.Yo(),OtherOptionText:t.OtherAnswer,SelectedOptions:t.SelectedOptions})},n.Go=function(){this.setState({LocalizedOptions:this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.Model.option})},n.xt=function(t){var e=this,n=p.clone(this.state.SelectedOptions),i=this.props.Master.Question.Model.ChoiceType===F.a.SingleChoice,r=this.state.IsOtherOptionSelected,o=!1;if(i){if(t===n[0])return;r=!1,n=[t]}else{var s=n.indexOf(t);-1===s?n.push(t):n.splice(s,1),o=JSON.stringify(n).length>x.a.MaxAnswerLength}this.setState({IsOtherOptionSelected:r,ReachMaxLengthLimit:o,SelectedOptions:n,OtherOptionText:i?"":this.state.OtherOptionText},(function(){return e.Wo()}))},n.zo=function(){if(this.state.ReachMaxLengthLimit)return Object(L.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:this.props.LocalizedStrings.Error_Message_Question_Reach_Limit})},n.Uo=function(){var t,e,n=this,r=this.props.Master,o=r.Question.Model,s=this.state.OrderedChoices.map((function(t,e){var i,r=n.questionLocalizedItemMaster;if(r){var o=r.getChoiceV1LocalizedMaster(n.state.OptionsOrder[e]);i=o&&o.Model.description}return{DisplayName:i||t.Description,Key:j.a.getObjectMasterFromModel(t).getInstanceId(),Value:t.Description}})),a=r.Model.Answer;o.AllowOtherAnswer&&s.push(this.ts()),this.state.IsOtherOptionSelected&&(a=G),!this.props.ShowDesignInfo&&this.state.IsOtherOptionSelected&&(t=this.ns()),e=function(t){return n.rs(t)};var c=Object(A.b)({AllowWrap:!0,HTMLAttributes:this.getElementProps({className:"office-form-question-dropdown",disabled:this.props.Disabled,title:o.Hint||this.props.LocalizedStrings.Dropdown_DefaultHint}),key:"choicequestion-dropdown",onValueChange:e,Placeholder:o.Hint||this.props.LocalizedStrings.Dropdown_DefaultHint,SelectOptions:s,Value:a,NeedScroll:this.props.IsMobile});return i.createElement("div",{className:this.getValidationStyle()},c,t)},n.rs=function(t){var e=this,n=t===G,i=n?[]:[t];Object(M.c)((function(){e.setState({IsOtherOptionSelected:n,SelectedOptions:i},(function(){return e.Wo()}))}),M.f)},n.ts=function(){return{DisplayName:this.props.LocalizedStrings.Designer_OtherAnswer,Key:G,Value:G}},n.ns=function(){var t=this,e={"aria-label":this.props.LocalizedStrings.TextField_DefaultPlaceholder,className:"office-form-other-answer-textbox"},n={AutoFocus:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"office-form-other-answer office-form-dropdown-other-answer"},onValueChange:function(e){t.setState({OtherOptionText:e,SelectedOptions:[]},(function(){return t.Wo()}))},Options:{HTMLPropsForInnerElement:e},Placeholder:this.props.LocalizedStrings.TextField_DefaultPlaceholder,ref:this.Lo,Value:this.state.OtherOptionText};return Object(R.b)(n)},n.Ko=function(t){var e=this.props.Master.Question.Model.Choices,n=p.map(e,(function(t){return t.Description}));return t.sort((function(t,e){return n.indexOf(t)-n.indexOf(e)}))},e.isQuizResultAnswerKey=function(t,e){if(!t||!t.IsAnswerKeys)return!1;var n=t.Choices;return!!n&&t.IsAnswerKeys[n.indexOf(e.Description)]},e.getAnswerKeyMark=function(t,n,i){var r=t.Master,o=r.Model.QuizResult,s=r.Question,a=e.isQuizResultAnswerKey(o,n);return n.IsAnswerKey&&t.ShowDesignInfo&&s.Model.IsQuiz||a?"Correct":i&&o&&o.IsAnswerKeys&&o.IsAnswerKeys.some((function(t){return t}))&&!a?"Wrong":"Normal"},e.getAnswerHintLabel=function(t,e,n){var i=t.Master.Model.QuizResult;if(!t.ShowDesignInfo&&n&&i){var r=i.Choices,o=r?r.indexOf(e.Description):-1;return i.AnswerHints&&i.AnswerHints[o]}},n.Eo=function(){var t=this.props.Master.Question.Model;return this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.getChoiceV1LocalizedMaster(t.Choices.length-1),j.a.convertToArray(t.Choices)},n.Yo=function(){var t=this;return p.map(this.state.OptionsOrder,(function(e){return t.state.ChoiceOptions[e]}))},n.Bo=function(){for(var t=this.props.Master.Question.Model,e=[],n=0;n<t.Choices.length;n++)e[n]=n;return this.props.ShowQuizResult||!t.ShuffleOptions||this.props.DisableShuffle?e:p.shuffle(e)},n.Ro=function(){var t,e=this.props.Master,n=e.Model,i=e.Question.Model,r=i.ChoiceType===F.a.SingleChoice,o=[],s=Object(x.b)(n.Answer,i).SelectedOptions;s.length>0&&(r?[n.Answer]:s).forEach((function(e){-1!==p.findIndex(i.Choices,(function(t){return t.Description===e}))?o.push(e):i.AllowOtherAnswer&&(t=e)}));return{OtherAnswer:t,SelectedOptions:o}},e}(H.a),Q=n(102);var V=n(67),z=n(5),U=n(16),$=F.e,W=function(t){function e(e){var n=t.call(this,e)||this;return n.os="presentation",n.state={ShowWarningMessage:!1},n.us=n.us.bind(n),n.ls=n.ls.bind(n),n.hs=n.hs.bind(n),n.fs=n.fs.bind(n),n.ds(),n}Object(r.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t,e,n,r=this,o=this.props.Master.Model,s=this.props.Master.Question,a=s.Model,c=s.Form.SettingMaster.Model.IsAnonymous,u=this.zo();if(this.props.PrintView)t=i.createElement("div",{className:"textbox-printview",key:"printView"},o.Answer);else{var l=void 0,h=void 0,f=void 0;if(a.IsMathQuiz&&!a.Multiline){var d=this.bs(!0),b=a.InputSwitcherDisabled||!a.IsMathInputDefault,m=this.props.Disabled||b?void 0:this.vs(),v=void 0,g=void 0;if(o.AnswerEntity)v=o.AnswerEntity.IsMathAnswer,g=o.AnswerEntity.Answer;else v=!a.IsAnswerPlainText,g=Object(k.G)(o.Answer||"{}").Answer||"";if(v){this.props.IsPrintViewDesignTime?(f=" ",n=a.InputSwitcherDisabled&&i.createElement("div",{className:"print-restriction-tip"},this.props.LocalizedStrings.TextField_EnterMathAnswer)):f=a.InputSwitcherDisabled?this.props.LocalizedStrings.TextField_EnterMathAnswer:this.props.LocalizedStrings.TextField_DefaultPlaceholder;var O={onBlur:this.fs},p=i.createElement(T.a,{Disabled:this.props.Disabled,HTMLAttributes:O,key:"textmathquestion-mathfield",Location:"TextField.Response",onValueChange:this.us,Placeholder:f,QuestionId:a.Id,Value:g},m);h=i.createElement("div",{className:"office-form-response-question-math-container"},p,d)}else{var j=Object(R.b)({AutoSelection:!0,Disabled:this.props.Disabled,HTMLAttributes:{className:"design-question-math-plaintext-text",onBlur:this.fs},key:"textmathquestion-textfield",Label:void 0,MaxLength:Object(S.c)(),MinimalHeight:this.props.IsPrintViewDesignTime&&a.Multiline?void 0:40,onValueChange:this.us,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"design-question-math-plaintext-text"})},Placeholder:f||this.props.LocalizedStrings.TextField_DefaultPlaceholder||"",Rows:a.Multiline&&this.props.IsPrintViewDesignTime&&10,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:g});h=i.createElement("div",{className:"office-form-response-question-math-textfield"},j,m,d)}e=i.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},h)}else{this.props.IsPrintViewDesignTime?(f=" ",n=a.IsNumber&&i.createElement("div",{className:"print-restriction-tip"},s.getNumberValidationErrorMessage(this.props.LocalizedStrings))):f=Object(M.c)((function(){return a.IsNumber?s.getNumberValidationErrorMessage(r.props.LocalizedStrings):a.Placeholder||r.props.LocalizedStrings.TextField_DefaultPlaceholder}),M.f),l=Object(R.b)({Disabled:this.props.Disabled,HTMLAttributes:{onBlur:this.fs},key:"textquestion-textfield",Label:void 0,MaxLength:Object(S.c)(),onValueChange:this.ls,Options:{HTMLPropsForInnerElement:this.getElementProps({className:"office-form-question-textbox"})},Placeholder:f,Rows:a.Multiline&&this.props.IsPrintViewDesignTime&&10,TextFieldType:a.Multiline?2:0,Theme:this.props.Theme,ValidationStyle:this.getValidationStyle(),Value:o.Answer});d=this.bs();e=i.createElement("div",{className:"student-feedback-view-short-text-field-with-correctness",key:"normalView"},l,d,this.gs(c))}}return[t,e,n,this.Os(),u]},n.gs=function(t){return this.state.ShowWarningMessage&&Object(w.c)("SensitiveInfoCheckInResponsePage")&&(Object(w.c)("SensitiveInfoCheckForAllForms")||t)?i.createElement("div",{className:"warning-message-container",key:"warningMessage"},this.props.LocalizedStrings.Response_Page_SensitiveInfo_QuestionWarning):null},n.vs=function(){var t,e,n,i,r=this.props.Master.Question.Model,o="design-question-choice-to-math-button";return this.props.IsMobile&&(o=Object(C.b)(o,"isMobile")),r.IsAnswerPlainText?(t={className:o,onClick:this.hs()},e="NumberField",n=this.props.LocalizedStrings.Designer_Question_Equation_Button,i=this.props.LocalizedStrings.Designer_Question_Equation_Button_Tooltip):(t={className:o,onClick:this.hs()},e="TextField",n=this.props.LocalizedStrings.Designer_Question_EquationToText_Button,i=this.props.LocalizedStrings.Designer_Question_EquationToText_Button_Tooltip),Object(U.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,Icon:e,IconClassName:"design-question-choice-to-math-button-icon",Text:n,Tooltip:i})},n.hs=function(){var t=this;return function(e){var n=t.props.Master.Question.Model,i=t.props.Master.Model,r=Object(k.G)(i.Answer||"{}");n.IsAnswerPlainText=!n.IsAnswerPlainText;var o={Answer:r.Answer,IsMath:!n.IsAnswerPlainText};i.Answer=JSON.stringify(o),Object(z.b)(n.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:"TextField.Response",questionId:n.Id}),t.forceUpdate()}},n.ds=function(){var t=this.props.Master.Question.Model,e=this.props.Master;this.props.Master.Question.ensureFieldsReady([F.d.Schema.Id]).then((function(){if(t.IsMathQuiz){if(e.Model.Answer){var n=Object(k.G)(e.Model.Answer||"{}");if(void 0!==n.IsMath)return void(t.IsAnswerPlainText=!n.IsMath)}t.IsAnswerPlainText=!t.IsMathInputDefault}else t.IsAnswerPlainText=!0}))},n.ls=function(t){var e=this.props.Master.Model,n=Object(k.j)(t);e.Answer=n},n.us=function(t){var e=this.props.Master.Model,n={Answer:Object(k.j)(t),IsMath:!this.props.Master.Question.Model.IsAnswerPlainText};e.Answer=JSON.stringify(n)},n.ps=function(t){var e=this.props.Master.Model,n=function(t){return void 0!==t&&(!/[^\u0000-\u007F]+/.test(t)&&(!!/(4\d{3})(-?|\040*)(\d{4}(-?|\040*?)){3}/.test(t)||(!!/(?!000|666)[0-8][0-9]{2}[- ](?!00)[0-9]{2}[- ](?!0000)[0-9]{4}/.test(t)||!!/^[^\s]{8,16}$/.test(t)&&(!!/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/.test(t)||(!!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/.test(t)||!!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/.test(t))))))}(t);this.setState({ShowWarningMessage:n}),e.HasSensitiveInfo=n},n.fs=function(){var t=this.props.Master.Model,e=this.props.Master.Question;if(e.Model.IsNumber){var n=t.Answer;e.verify(n)!==$.Success||e.Model.IsMathQuiz||Object(M.c)((function(){return t.Answer=Object(Q.a)(n)}),M.f)}this.ps(t.Answer)},n.zo=function(){var t=this.props.Master.Model,e=this.props.Master.Question,n=e.verify(t.Answer);if(t.Answer&&n!==$.Success){var i;switch(n){case $.NumberValidationError:case $.RegExValidationError:i=e.getNumberValidationErrorMessage(this.props.LocalizedStrings);break;case $.MathLengthError:i=this.props.LocalizedStrings.Math_Answer_LengthLimit_Message;break;default:return}return Object(L.a)({Alert:!0,HTMLAttributes:{className:"validation-error-message-label",role:"alert"},key:"textquestion-errorlabel",Label:i})}},n.bs=function(t){var n=this.props.Master,o=this.props.Master.Question,s=o.Model;if(this.props.ShowQuizResult&&!s.Multiline&&s.IsQuiz){var a=e.isAnswerCorrect(n);if(null!==a&&(a||this.props.IsMobile)){var c=t?"student-feedback-view-short-text-math-correctness-icon-container":"student-feedback-view-short-text-correctness-icon-container";this.props.IsMobile&&(c=Object(C.b)(c,"isMobile"));var u,l=a?this.props.LocalizedStrings.Quiz_CorrectAnswer:this.props.LocalizedStrings.Quiz_WrongAnswer,h={HTMLAttributes:{className:Object(C.b)("student-feedback-view-short-text-correctness-icon forms-icon-size14x14",a?"image-button-answerkey":"image-button-checked-wrong-answer"),title:l},IconName:a?"CheckMark":"Cancel"},f=n.Model.Answer;if(u=f,!f||Object(I.a)(f))u=s.Placeholder||this.props.LocalizedStrings.TextField_DefaultPlaceholder;else if(o.Model.IsMathQuiz){var d=Object(k.G)(f||"{}");u=d.IsMath?Object(T.c)({Formula:null==d.Answer?f:d.Answer}):null==d.Answer?f:d.Answer}var b={"aria-hidden":!0,className:"student-feedback-view-short-text-hidden-text-to-position-correctness-icon",role:this.os};return i.createElement("div",{className:c},i.createElement("span",Object(r.__assign)({},b),u),Object(B.b)(h))}}},e.isAnswerCorrect=function(t){var e=t.Model;return null!=e.QuizResult?e.QuizResult.IsAnswerCorrect:new V.a(t.Question.Model).areAnyAnswersDefined()?t.Question.isCorrectAnswer(e.Answer):null},n.Os=function(){var t=this.props.Master.Question.Model,e=this.props.Master.Model.QuizResult;if(this.ys()){var n=null!=e?e:t,r=new V.a(n);if(r.areAnyAnswersDefined()){var o,s=r.getAnswers();if(s.some((function(t){return t.isMath}))){for(var a=[],c=0,u=s;c<u.length;c++){var l=u[c];if(l.isMath){var h=Object(T.c)({Formula:l.answer});a.push(i.createElement("div",{className:"correct-answer-list-formula-element"},h))}else a.push(l.answer);a.push(this.props.LocalizedStrings.VariousLocations_ItemList_Separator)}a.pop(),o=i.createElement("div",{className:"correct-answer-list-formula-container"},a)}else o=p.map(s,(function(t){return t.answer})).join(this.props.LocalizedStrings.VariousLocations_ItemList_Separator);var f={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey various-short-text-correct-answer-list-correctness-icon",role:this.os},IconName:""};return i.createElement("div",{className:"various-short-text-correct-answer-list",key:"answerList"},Object(B.b)(f),i.createElement("b",null,this.props.LocalizedStrings.VariousLocations_CorrectAnswerList_Label," "),o)}}},n.ys=function(){var t=this.props.Master.Model,e=this.props.Master.Question.Model,n=this.props.Master.Model.QuizResult;return!(e.Multiline||!e.IsQuiz)&&(!(!this.props.ShowDesignInfo&&null==n)&&((null==n||!n.IsAnswerCorrect)&&!(null==n&&this.props.Master.Question.isCorrectAnswer(t.Answer))))},e}(H.a);function K(t){var e,n=t.Master.Question.Model.Type;switch(n){case"Question.Choice":e=q;break;case"Question.TextField":e=W;break;case"Question.Rating":return O(t);case"Question.Ranking":return v(t);case"Question.NPS":return b(t);case"Question.MatrixChoiceGroup":return f(t);case"Question.FileUpload":return l(t);case"Question.DateTime":return c(t)}if(e)return i.createElement(e,t);throw Error('Type "'+n+'" has not been found.')}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"c",(function(){return o})),n.d(e,"b",(function(){return s}));var i=n(176),r=function(){function t(t,e,n,i){this.Ut=t,this.ws=e,this.Ss=n,this.Ns=i}var e=t.prototype;return Object.defineProperty(e,"Id",{get:function(){return this.Ut},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DisplayName",{get:function(){return this.ws},enumerable:!1,configurable:!0}),Object.defineProperty(e,"UserPrincipalName",{get:function(){return this.Ss},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Mail",{get:function(){return this.Ns},enumerable:!1,configurable:!0}),t}();function o(t,e){return function(t,e){var n=a[e];if(!n){var o="User"===t?Object(i.d)(e):Object(i.c)(e);n=Promise.resolve(o).then((function(t){return new r(e,t.displayName,t.userPrincipalName,t.mail)})),a[e]=n}return n}(t,e)}function s(t){a[t.Id]||(a[t.Id]=Promise.resolve(t))}var a={}},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var i=n(2),r=n(0),o=n(3),s=n(15),a=n(1),c=n(26),u=n(9),l=n(14),h=n(10),f=n(43),d=n(18),b=n(78),m=n(128),v=function(t){function e(e){var n=t.call(this,e)||this;return n.cardButtonRef=r.createRef(),n.Is=o.uniqueId("FormCard."),n.Dn=n.Is+".description",n.onClick=n.onClick.bind(n),n.onKeyDown=n.onKeyDown.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){if(this.props.CreateNew)return r.createElement("div",null,this.createFormCreatingCardByMode());var t=this.getCardDescription(),e=this.getCardTitle(),n={"aria-describedby":t?this.Dn:void 0,"aria-disabled":this.state.ContentCovered,"aria-label":e||Object(a.a)().Unnamed_Survey_Title,className:"fl-content",onClick:this.onClick,onKeyDown:this.onKeyDown},o={ButtonStyle:"LightBackground",children:[this.createThemeContent(),this.createTitleContent(),this.createCardOwnerContent(),this.createCardWarning(),this.createCardTypeContent(),r.createElement("div",{className:"new-form-card-middle-line",key:"mid-line"}),this.createFooterContent()],HTMLAttributes:n,key:"card-content",ref:this.cardButtonRef},s=r.createElement(f.a,Object(i.__assign)({},o)),c=t?r.createElement("span",{className:"screenReaderReference",id:this.Dn,key:"description"},t):void 0,u=Object(h.c)((function(){return"fl-history-tile fl-tile"}),h.f),l=r.createElement("div",{className:u},this.createSpinner(),s,c,this.createOtherContent(),this.Cs());return Object(h.c)((function(){return l}),h.f)},n.getCardDescription=function(){return this.state.ShowCardResponseCount&&this.state.IsResponseCountReady?Object(a.a)().PortalView_FormCard_Responses.format(this.getCardResponseCount()):null},n.shouldHideDialogTriggerButton=function(){var t=this;return Object(h.c)((function(){return"survey"===t.getCardType()&&Object(s.q)()}),h.f)},n.createFormCreatingCardByMode=function(){return null},n.onClick=function(){},n.onKeyDown=function(t){},n.shouldShowSpinner=function(){return!1},n.getStatusMessage=function(){return null},n.createThemeContent=function(){if(!this.state.ShowCardTheme)return null;if(!this.state.IsThemeReady)return r.createElement("div",{className:"portal-tiles-theme-spinner-overlay",key:"theme-spiner"},r.createElement("div",{className:"common-spinner-circle portal-tiles-theme-spinner-history"}));var t=this.getCardThemeBackgroupUrl(),e=this.getCardThemeName(),n=this.getCardThemePrimaryColor();if(t){var i=t.match(/url\((.*)\)$/);t=i?i[1]:"url("+t+")"}else t=this.getBackgroundImageURL(this.getCardTitle());var o="Customized Theme"===e?"new-form-card-image-customized":"new-form-card-image",s={backgroundColor:n||"#008272",backgroundImage:t};return r.createElement("div",{className:o,key:"theme",style:s})},n.createTitleContent=function(){if(!this.state.ShowCardTitle)return null;if(!this.state.IsTitleReady)return r.createElement("div",{className:"spinner-tile-animation",key:"title-spinner",style:{fontSize:"6px"}});var t=this.getCardTitle(),e={className:"fl-title searchable",key:"title"};if(t){var n=t.length;e.className=n<=19?Object(u.b)(e.className,"large-size"):n>19&&n<=43?Object(u.b)(e.className,"middle-size"):Object(u.b)(e.className,"small-size")}return r.createElement("div",Object(i.__assign)({},e),r.createElement("span",null,t))},n.createFooterContent=function(){if(!this.state.ShowCardResponseCount)return null;var t,e;if(this.state.IsResponseCountReady){t=r.createElement("div",{className:"fl-response-count",key:"response-count"},this.getCardResponseCount()+" "+Object(a.a)().Common_Responses_Text);var n=this.showFormStatus();n&&(e=r.createElement("div",{className:"fl-form-closed",key:"form-closed"},n))}else{var o={ClassName:"portal-view-card-resCount-spinner",Ignorable:!1,LoadingDescription:Object(a.a)().Common_Responses_Text};t=r.createElement("div",{className:"fl-response-count",key:"rcount-spinner"},r.createElement(b.a,Object(i.__assign)({},o)))}return r.createElement("div",{className:"fl-form-detail-container"},t,e)},n.createOtherContent=function(){return null},n.getErrorMessage=function(){return null},n.showFormStatus=function(){return null},n.createSpinner=function(){var t,e=this.getStatusMessage(),n=e&&r.createElement(m.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log"},e);return t=r.createElement(b.a,Object(i.__assign)({},{ClassName:"portal-view-card-base-image-spinner",Ignorable:!1})),this.shouldShowSpinner()?r.createElement("div",{className:"portal-tiles-spinner-overlay"},t,n):null},n.getBackgroundImageURL=function(t){var e=t||"",n=Math.abs(Object(l.k)(e))%9+1;return"url("+Object(c.b)("/Images/Theme/default-"+n+".png")+")"},n.Cs=function(){var t=this.getErrorMessage();if(t){var e=Object(d.b)({HTMLAttributes:{className:"forms-icon-size18x18 fl-error-icon"},IconName:"Error"});return r.createElement("div",{className:"fl-error-message-bar"},e,r.createElement("span",{className:"fl-error-message"},t))}},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return d})),n.d(e,"b",(function(){return b}));var i=n(2),r=n(0),o=n(3),s=n(12),a=n(1),c=n(52),u=n(9),l=n(10),h=n(8),f=n(48),d=function(t){function e(n){var i=t.call(this,n)||this;return i.ks=r.createRef(),i.Ts=Object(c.c)(),i.xs=o.uniqueId(),i.Fs=e.createNPSOptions(),i.Ps=function(t){var e=i.props.onValueChange;e&&e(parseInt(t.currentTarget.value,10))},i.Ds=function(t){i.setState({FocusValue:parseInt(t.currentTarget.value,10)})},i.Ms=function(){i.setState({FocusValue:void 0})},i.Ls=function(t){return i.As(t)},i.Rs=function(){return i.Es=!0},i.Bs=function(t){i.Es=!1,i.setState({Touch:-1})},i._s=function(t){return i.Hs(t)},i}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t="nps-control clearfix unselectable-text",e="nps-control-table reset",n=this.xs;this.props.Disabled||(e=Object(u.b)(e,"enabled"));var s=this.props.HTMLAttributes,a={};return s&&(t=Object(u.b)(t,s.className),n=Object(u.b)(s["aria-labelledby"],n),o.extend(a,s)),a.className=e,a["aria-labelledby"]=n,r.createElement("div",{className:t},this.Gs(),r.createElement("table",Object(i.__assign)({},a),this.Qs(),this.Vs()),this.props.LeftLabel||this.props.RightLabel?this.zs():void 0)},n.Gs=function(){var t=this.state.Touch,e=Object(u.b)(void 0!==t&&-1!==t?"nps-pop-up show":"nps-pop-up",this.props.ClassNameForInnerLabel,t===this.props.Value?"active":"");return r.createElement("div",{className:e,ref:this.ks},r.createElement("span",{className:"nps-pop-up-text"},this.state.Touch))},n.zs=function(){var t=this;return Object(l.c)((function(){var e={className:"nps-control-label-container clearfix",id:t.xs,"aria-label":t.Us()};return r.createElement("div",Object(i.__assign)({},e),r.createElement("div",{className:"left-label"},r.createElement("span",null,Object(f.b)({Text:t.props.LeftLabel,RenderMode:Object(s.g)()?"RichText":void 0,ContainsHtml:!0}))),r.createElement("div",{className:"right-label"},r.createElement("span",null,Object(f.b)({Text:t.props.RightLabel,RenderMode:Object(s.g)()?"RichText":void 0,ContainsHtml:!0}))))}),l.f)},n.Us=function(){var t=this.Fs[0].Value.toString(),e=this.props.LeftLabel,n=this.Fs[this.Fs.length-1].Value.toString(),i=this.props.RightLabel;return". "+(e?t+": "+e+". ":"")+(i?n+": "+i+". ":"")},e.createNPSOptions=function(){for(var t=[],e=0;e<11;e++)t.push({DisplayName:b(e),Key:e,Value:e});return t},n.Qs=function(){return r.createElement("thead",null,r.createElement("tr",{className:"nps-head-row"},this.Fs.map((function(t){return r.createElement("th",{className:"nps-head-column",key:t.Key},t.Value)}))))},n.Vs=function(){var t=this,e=this.Fs.map((function(e,n){return t.$s(e,n)}));return r.createElement("tbody",null,r.createElement("tr",null,e))},n.$s=function(t,e){var n=this.props.Value,s=this.props.Disabled;o.isString(n)&&(n=parseInt(n,10));var a=n===t.Value,c="nps-"+this.Ts+"-"+t.Value,l={"aria-label":t.Value.toString(),"aria-posinset":e+1,"aria-setsize":this.Fs.length,checked:a,disabled:this.props.Disabled,id:c,name:"nps-"+this.Ts,type:"radio",value:t.Value},h={htmlFor:c};return s||(o.extend(l,{onBlur:-1===this.state.Touch?void 0:this.Ms,onChange:this.Ps,onFocus:-1===this.state.Touch?void 0:this.Ds}),o.extend(h,{htmlFor:c,onTouchCancel:this.Bs,onTouchEnd:this._s,onTouchMove:this.Rs,onTouchStart:this.Ls})),h.className=Object(u.b)("answer-label",void 0!==this.state.Touch?"touch":"",this.props.ClassNameForInnerLabel,a?"active":"",this.state.FocusValue===t.Value?"focus":""),r.createElement("td",{key:t.Key,className:"radio-button-item"},r.createElement("div",{className:"radio-button"},r.createElement("input",Object(i.__assign)({},l)),r.createElement("label",Object(i.__assign)({},h),r.createElement("span",{"data-text":t.Value,className:"radio-button-display"}))))},n.As=function(t){var e=t.currentTarget,n=this.ks.current,i=n.parentElement.getBoundingClientRect(),r=e.getBoundingClientRect(),o=r.width/2,s=r.height/2;n.style.left=r.left-i.left-o/2+"px",n.style.top=r.top-i.top-s/2+"px",n.style.width=r.width+o+"px",n.style.height=r.height+s+"px";var a=e.firstElementChild;this.setState({Touch:parseInt(a.dataset.text,10)})},n.Hs=function(t){var e=this;if(this.Es)this.Es=!1,this.setState({Touch:-1});else{var n=this.state.Touch;this.setState({Touch:-1},(function(){var t=e.props.onValueChange;t&&t(n)}))}t.preventDefault()},e}(h.a);function b(t){return t<7?Object(a.a)().NPS_Detractors:t>8?Object(a.a)().NPS_Promoters:Object(a.a)().NPS_Passives}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(3),r=n(6),o=n(162),s=function(){function t(t){this.Ws=t.concat(),this.Ks=t.map((function(t){return r.a.getFieldSchemaInfo(t).Name}))}var e=t.prototype;return Object.defineProperty(e,"FieldSchemas",{get:function(){return this.Ws.concat()},enumerable:!1,configurable:!0}),e.covers=function(t){return Object(o.b)(t)?i.contains(this.Ks,t):i.contains(this.Ws,t)},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return g}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(12),c=n(11),u=n(102),l=n(108),h=n(10),f=n(13),d=n(226);function b(t){var e=new d.a(Object(a.d)());return e.formRuntimeMaster=t,e}var m=n(117),v={QuestionRuntimeMasters:s.a.collectionOf(s.a.reference()),RuntimeSectionId:s.a.string(),UploadingFileCount:s.a.number(),BranchChangeVersion:s.a.number()},g=function(t){function e(e,n){var i=t.call(this)||this;return i.Js={},i.Xs=new l.a.CallbackManager,i.Zs=function(){return i.Xs.trigger()},i.Ys=function(t){return i.replaceAnswerTagsWithValue(t.Master)},i.ea=function(t){return i.na(t)},i.ia=function(){return i.na()},i.ra=function(){return i.oa.callOnceLater()},i.oa=new l.a.CallLater((function(){return i.aa()}),0),i.ua=e,i.la=b(i),n=n||{},i.ha=n.disableShuffle,i.ba=n.disableBranching,i.na(),i.oa.callImmediately(),i.Model.UploadingFileCount=0,o.a.getCollectionMasterFromModel(e.Model.Questions).observe(i.ea),e.observe(i.ia,[f.a.Schema.HasValidBranching,f.a.Schema.Settings.ShuffleQuestionOrder]),i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.ua},enumerable:!1,configurable:!0}),n.ElementManager=function(){return this.la},Object.defineProperty(n,"IsDisableBranching",{get:function(){return this.ba},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Answers",{get:function(){return o.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return t.Question.hasAnswer()})).map((function(t){return t.getAnswerEntity()}))},set:function(t){var e=this,n={};r.forEach(t,(function(t){return n[t.QuestionId]=t.Answer})),this.bulkEdit((function(){e.ua.FormElementManager.QuestionMasters.map((function(t){return e.getOrCreateQuestionRuntime(t)})).forEach((function(t){t.Model.Answer=n[t.Question.Model.Id]}))})),this.oa.flush()},enumerable:!1,configurable:!0}),n.TopQuestionRuntimeMasters=function(){return o.a.convertToArray(this.Model.QuestionRuntimeMasters).filter((function(t){return!t.Question.Model.GroupId}))},n.CurrentRuleManager=function(){return!1},n.isDefaultAnswer=function(){var t=this.ua.getDefaultResponse();return o.a.convertToArray(this.Model.QuestionRuntimeMasters).every((function(e){var n=e.Question.Model.Id;return t[n]===e.Model.Answer}))},n.updateWithResponse=function(t){var e=this,n={};t&&t.Answers&&r.forEach(t.Answers,(function(t){return n[t.QuestionId]=t})),this.bulkEdit((function(){e.ua.FormElementManager.QuestionMasters.map((function(t){return e.getOrCreateQuestionRuntime(t)})).forEach((function(t){var e=t.Question.Model.Id,i=n[e];t.bulkEdit((function(){t.Model.Answer=i&&i.Answer,t.Model.AnswerEntity=i}))}))})),this.na()},n.setQuizResults=function(t){var e=this;t.forEach((function(t){var n=e.Js[t.id];n&&(n.Model.QuizResult={IsAnswerCorrect:t.isAnswerCorrect,AnswerHints:t.answerHints,IsAnswerKeys:t.answerKeys,Choices:r.map(n.Question.Model.Choices,(function(t){return t.Description})),GradingBasis:t.gradingBasis})}))},n.clearQuizResult=function(){for(var t in this.Js)this.Js[t].Model.QuizResult=void 0},n.resetQuestions=function(){},n.getQuestionResponseFromQueryString=function(){},n.calculateQuizResultFromModel=function(){o.a.convertToArray(this.Model.QuestionRuntimeMasters).forEach((function(t){return t.calculateQuizResultFromModel()}))},n.formsProQuestionVisiblityCheck=function(t){0},n.getQuestionsWithWrongAnswer=function(t){if(t.length<=0)return[];var e=this.TopQuestionRuntimeMasters(),n=r.findIndex(e,(function(e){return e.Question.Model.Id===t[0].Question.Model.Id}))+1;return t.map((function(t,e){return t.verifyAnswer()?-1:e+n})).filter((function(t){return t>0}))},n.getOrCreateQuestionRuntimeById=function(t){var e=this.ua.getQuestionById(t);return e&&this.getOrCreateQuestionRuntime(e)},n.observeAnswerChange=function(t){this.Xs.register(t)},n.unobserveAnswerChange=function(t){this.Xs.unregister(t)},n.release=function(){var t=function(t){var n=e.Js[t];n.unobserve(e.ra),n.unobserve(e.Zs),n.release()},e=this;for(var n in this.Js)t(n);o.a.getCollectionMasterFromModel(this.ua.Model.Questions).unobserve(this.ea),this.ua.unobserve(this.ia)},n.getOrCreateQuestionRuntime=function(t){var e=t.Model.Id;return this.Js[e]||(this.Js[e]=this.ma(t)),this.Js[e]},n.ma=function(t){var e=new m.a(t,this);return e.observe(this.ra,[m.a.Schema.BranchedElement,m.a.Schema.BranchingType]),e.observe(this.Zs,[m.a.Schema.Answer]),e},n.na=function(t){var e,n=this,o=this.ua.Model.Settings,s=this.ua.FormElementManager;this.va=s.TopQuestionMasters;var a=this.Form.hasSection();if(!a&&!this.ha&&!this.ua.Model.HasValidBranching&&o.ShuffleQuestionOrder)if(o.ShuffleAllQuestions||null==o.ShuffleAllQuestions)this.va=r.shuffle(this.va);else if(Object(u.c)(o.LockGivenQuestionsStartDisplayOrder)&&Object(u.c)(o.LockGivenQuestionsEndDisplayOrder)){var c=o.LockGivenQuestionsStartDisplayOrder-1,l=o.LockGivenQuestionsEndDisplayOrder-1,h=this.va.splice(c,l-c+1);this.va=r.shuffle(this.va),(e=this.va).splice.apply(e,Object(i.__spreadArrays)([c,0],h))}a?s.getSectionNodes().forEach((function(t){return n.ga(t.TopQuestionMasters)})):this.ga(this.va),t&&(t.AddedModels.length||t.RemovedModels.length)&&this.oa.callOnceLater()},n.ga=function(t){var e=this;t.forEach((function(n,i){var r=e.getOrCreateQuestionRuntime(n);r.bulkEdit((function(e){e.NextQuestionInOrder=t[i+1],e.NextQuestionInitialized=!0})),"Specified"===r.Model.BranchingType&&!r.Model.BranchedElement&&Object(a.d)()&&r.updateBranchedQuestion(),n.SubQuestionMasters.forEach((function(t){return e.getOrCreateQuestionRuntime(t)}))}))},n.ensureProRuleManager=function(){var t=this,e=this.ua;return this.Oa?Promise.resolve(""):h.a.getFormsProBranching(e,Object(c.b)().Model,!0,!0).then((function(e){return t.Oa=FormsPro.getRuleManager(t.ua,t.Model.QuestionRuntimeMasters,t),e}))},n.ya=function(t,e,n){},n.aa=function(){this.la.calculateQuestionRuntimeList(this.va)},n.replaceAnswerTagsWithValue=function(t){},n.clearFileUploadAnswers=function(){this.Model.UploadingFileCount=0;var t=this.Model.QuestionRuntimeMasters;o.a.convertToArray(t).filter((function(t){return"Question.FileUpload"===t.Question.Model.Type})).forEach((function(t){return t.Model.Answer=void 0}))},e}(o.a.createObjectMasterClass("FormRuntime",v))},function(t,e,n){"use strict";n.d(e,"c",(function(){return d})),n.d(e,"d",(function(){return b})),n.d(e,"e",(function(){return m})),n.d(e,"f",(function(){return v})),n.d(e,"a",(function(){return g})),n.d(e,"b",(function(){return O}));var i=n(2),r=n(0),o=n(40),s=n(39);function a(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,191))];case 1:return[2,{default:t.sent().UserInteractionSuggestionCard}]}}))}))}function c(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,370))];case 1:return[2,{default:t.sent().UserInteractionSuggestionCardV2}]}}))}))}function u(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,371))];case 1:return[2,{default:t.sent().UserInteractionQuestionSuggestion}]}}))}))}function l(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,372))];case 1:return[2,{default:t.sent().UserInteractionQuestionSuggestionV2}]}}))}))}function h(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,373))];case 1:return[2,{default:t.sent().ShareAssistantCard}]}}))}))}function f(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(5).then(n.bind(null,374))];case 1:return[2,{default:t.sent().ThemeSuggestionCard}]}}))}))}function d(t){var e=Object(s.a)(d,a);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function b(t){var e=Object(s.a)(b,c);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function m(t){var e=Object(s.a)(m,u);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function v(t){var e=Object(s.a)(v,l);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function g(t){var e=Object(s.a)(g,h);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}function O(t){var e=Object(s.a)(O,f);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return j})),n.d(e,"b",(function(){return y}));var i=n(2),r=n(6),o=n(4),s=n(3),a=n(88),c=n(63),u=n(167),l=n(13),h=function(){function t(){}var e=t.prototype;return e.add=function(){throw Error("No scenario to call this method currently.")},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.update=function(){throw Error("No scenario to call this method currently.")},e.query=function(t,e){var n=r.a.getFieldSchemaInfo(d.Schema.id).Name;if(!s.isEqual(t,[n]))throw Error("No scenario to call this method currently.");var i=e.Master.FormMaster;return i.ensureFieldsReady([i.Schema.Id]).then((function(){return{id:i.Model.Id}}))},t}(),f={category:o.a.string(),id:o.a.string({IsKeyField:!0,IsSourceGenerated:!0}),instanceId:o.a.string({IsLocalField:!0}),modifiedDate:o.a.string(),movingToRecycleBin:o.a.boolean({IsLocalField:!0}),ownerId:o.a.string(),ownerTenantId:o.a.string(),ready:o.a.boolean({IsLocalField:!0}),softDeleted:o.a.enumeration((function(){return a.a}),{IsNumberTypeInDataSource:!0}),title:o.a.string(),BusinessCdsId:o.a.string(),BusinessCdsRegion:o.a.string(),CustomCssFileName:o.a.string(),FormsProBranchRules:o.a.string(),formsProEmbedCode:o.a.string(),formsProRTDescription:o.a.string(),formsProRTTitle:o.a.string(),inviteExpiryDays:o.a.string(),IsDefaultCds:o.a.string(),LastEmbedConfig:o.a.string(),MfpBranchingData:o.a.string(),ownerUserType:o.a.string(),PipesDetails:o.a.string(),progressBarEnabled:o.a.string(),responseThresholdCount:o.a.string(),ProjectId:o.a.string(),surveyFont:o.a.string(),headerFont:o.a.string(),alias:o.a.string(),shortUrl:o.a.string(),InitialFormId:o.a.string(),InitialFormOwnerId:o.a.string(),projectName:o.a.string(),projectGroupId:o.a.string(),fileUploadStorage:o.a.string(),surveyPermanentId:o.a.string(),emailTemplatesMapping:o.a.string()},d=function(t){function e(n){var i=t.call(this,e.normalizeContext(n))||this;return i.ua=Object(c.g)(i.Model.instanceId),i.ua.fieldsReady([l.a.Schema.Id]).then((function(){i.Synchronizer.onSourceDataReceived({id:i.ua.Model.Id})})),i.ua.fieldsReady([l.a.Schema.Modified]).then((function(){i.Model.ready=!0})),i.ua.observe((function(t){if(!t.BeingDeleted){var e=t.NewValues;i.bulkEdit((function(){i.Synchronizer.onSourceDataReceived({modifiedDate:e.ModifiedDate,softDeleted:e.SoftDeleted,title:e.Title,BusinessCdsId:e.BusinessCdsId,BusinessCdsRegion:e.BusinessCdsRegion,CustomCssFileName:e.CustomCssFileName,FormsProBranchRules:e.FormsProBranchRules,formsProEmbedCode:e.FormsProEmbedCode,formsProRTDescription:e.FormsProRTDescription,formsProRTTitle:e.FormsProRTTitle,inviteExpiryDays:e.InviteExpiryDays,IsDefaultCds:e.IsDefaultCds,LastEmbedConfig:e.LastEmbedConfig,MfpBranchingData:e.MfpBranchingData,ownerUserType:e.OwnerUserType,PipesDetails:e.PipesDetails,progressBarEnabled:e.ProgressBarEnabled,responseThresholdCount:e.ResponseThresholdCount,ProjectId:e.ProjectId,surveyFont:e.SurveyFont,headerFont:e.HeaderFont,alias:e.Alias,shortUrl:e.ShortUrl,InitialFormId:e.InitialFormId,InitialFormOwnerId:e.InitialFormOwnerId,projectName:e.ProjectName,projectGroupId:e.ProjectGroupId,fileUploadStorage:e.FileUploadStorage,surveyPermanentId:e.SurveyPermanentId,emailTemplatesMapping:e.EmailTemplatesMapping}),i.Model.movingToRecycleBin=e.MovingToRecycleBin}))}}),[l.a.Schema.MovingToRecycleBin,l.a.Schema.ModifiedDate,l.a.Schema.SoftDeleted,l.a.Schema.Title,l.a.Schema.OwnerUserType,l.a.Schema.BusinessCdsId,l.a.Schema.BusinessCdsRegion,l.a.Schema.IsDefaultCds,l.a.Schema.LastEmbedConfig,l.a.Schema.PipesDetails,l.a.Schema.FormsProRTDescription,l.a.Schema.FormsProRTTitle,l.a.Schema.FormsProBranchRules,l.a.Schema.MfpBranchingData,l.a.Schema.CustomCssFileName,l.a.Schema.ResponseThresholdCount,l.a.Schema.InviteExpiryDays,l.a.Schema.ProgressBarEnabled,l.a.Schema.ProjectId,l.a.Schema.SurveyFont,l.a.Schema.HeaderFont,l.a.Schema.Alias,l.a.Schema.ShortUrl,l.a.Schema.InitialFormId,l.a.Schema.InitialFormOwnerId,l.a.Schema.ProjectName,l.a.Schema.ProjectGroupId,l.a.Schema.FileUploadStorage,l.a.Schema.SurveyPermanentId,l.a.Schema.EmailTemplatesMapping]),i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"FormMaster",{get:function(){return this.ua},enumerable:!1,configurable:!0}),e.normalizeContext=function(t){if(t.InitialData&&!t.InitialData.instanceId&&((t=s.clone(t)).InitialData=s.clone(t.InitialData),t.InitialData)){var e=Object(c.b)({Id:t.InitialData.id});e.Synchronizer.onSourceDataReceived(t.InitialData),t.InitialData.instanceId=e.getInstanceId()}return t},e}(r.a.createObjectMasterClass("FormReferenceMaster",f,(function(){d.prototype;return new h}))),b=n(29),m=function(){function t(t){this.wa=t,this.N=Object(b.c)(this.wa.Model.id)}var e=t.prototype;return e.add=function(t){throw Error("No scenario to call this method currently.")},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){return new Promise((function(){}))},e.query=function(t){var e=[],n=g.Schema,o=r.a.getFieldSchemaInfo(n.formReferences).Name,a=r.a.getFieldSchemaInfo(n.members).Name,c=r.a.getFieldSchemaInfo(n.owners).Name,u=r.a.getFieldSchemaInfo(n.classification).Name,l=r.a.getFieldSchemaInfo(n.visibility).Name,h=r.a.getFieldSchemaInfo(n.emailAddress).Name;if(t.indexOf(o)<0&&t.indexOf(a)<0&&t.indexOf(c)<0&&t.indexOf(u)<0&&t.indexOf(l)<0&&t.indexOf(h)<0)throw Error("No scenario to call this method currently.");if(t.indexOf(o)>-1){var f=this.N.getForms(["id","title","modifiedDate","ownerId","ownerTenantId","softDeleted","category"]).then((function(t){return{formReferences:t}}));e.push(f)}if(t.indexOf(a)>-1){f=this.N.getGroupMembers(this.wa.Model.id).then((function(t){return{members:t}}));e.push(f)}if(t.indexOf(c)>-1){f=this.N.getGroupOwners(this.wa.Model.id).then((function(t){return{owners:t}}));e.push(f)}if(t.indexOf(u)>-1||t.indexOf(h)>-1||t.indexOf(l)>-1){f=this.N.getGroup(this.wa.Model.id).then((function(t){return{classification:t&&t.classification,emailAddress:t&&t.emailAddress,visibility:t&&t.visibility}}));e.push(f)}return Promise.all(e).then((function(t){return s.extend.apply(s,Object(i.__spreadArrays)([{}],t))}))},t}(),v={classification:o.a.string(),displayName:o.a.string(),emailAddress:o.a.string(),formReferences:o.a.collectionOf(d),id:o.a.string({IsKeyField:!0}),members:o.a.collectionOf({displayName:o.a.string(),id:o.a.string()}),owners:o.a.collectionOf({displayName:o.a.string(),id:o.a.string()}),visibility:o.a.string()},g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Photo",{get:function(){return Object(u.c)(this.Model.id)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormMasters",{get:function(){return this.isFieldReady(this.Schema.formReferences)?r.a.convertToArray(this.Model.formReferences).map((function(t){return Object(c.g)(t.instanceId)})):[]},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormMasterExceptSoftDeleted",{get:function(){return this.FormMasters.filter((function(t){return t.isFieldReady(t.Schema.SoftDeleted)&&(t.Model.MovingToRecycleBin||t.Model.SoftDeleted!==a.a.SoftDeleted)}))},enumerable:!1,configurable:!0}),n.getFormMasterSoftDeteledForms=function(){return this.FormMasters.filter((function(t){return t.isFieldReady(t.Schema.SoftDeleted)&&t.Model.SoftDeleted===a.a.SoftDeleted&&!t.Model.MovingToRecycleBin}))},n.addFormReference=function(t){this.isFieldReady(e.Schema.formReferences)&&r.a.Collection.itemsAddedInSource(this.Model.formReferences,[t])},n.removeFormReference=function(t){this.isFieldReady(e.Schema.formReferences)&&r.a.Collection.itemsDeletedInSource(this.Model.formReferences,s.filter(this.Model.formReferences,(function(e){return e.instanceId===t})))},n.getMemberPhoto=function(t){return Promise.resolve(Object(u.b)(this.Model.id,t))},e}(r.a.createObjectMasterClass("Group",v,(function(t){return new m(t)}))),O=function(){function t(t){this.N=Object(b.b)()}var e=t.prototype;return e.add=function(t){throw Error("No scenario to call this method currently.")},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){var e=r.a.getFieldSchemaInfo(j.Schema.groups).Name;if(1!==t.length||t[0]!==e)throw Error("The fields didn't exist.");return this.N.getGroups().then((function(t){var e=g.Schema,n=[e.classification,e.displayName,e.emailAddress,e.id,e.visibility].map((function(t){return r.a.getFieldSchemaInfo(t).Name}));return{groups:t=t.map((function(t){return s.pick(t,n)}))}}))},t}(),p={groups:o.a.collectionOf((function(){return g}))},j=function(t){function e(){return t.call(this,{ExistingInDataSource:!0})||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},Object.defineProperty(n,"Groups",{get:function(){return this.isFieldReady(this.Schema.groups)?r.a.convertToArray(this.Model.groups).map((function(t){return r.a.getObjectMasterFromModel(t)})):[]},enumerable:!1,configurable:!0}),e}(r.a.createObjectMasterClass("MyGroups",p,(function(t){return new O(t)})));function y(){return j.getInstance()}},function(t,e,n){"use strict";n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l}));var i=n(5),r=n(7),o=Date.now(),s={},a={},c=function(){try{var t="FormsVersion"+window.location.pathname,e=window.localStorage.getItem(t),n=Object(r.a)().version;return e===n||(window.localStorage.setItem(t,n),!1)}catch(t){return!1}}();function u(t,e){var n=Date.now(),i={sa:n-o};return s[t]=i,e.then((function(t){return i.d=Date.now()-n,t})).catch((function(t){throw i.d=Date.now()-n,i.f=1,t}))}function l(){var t=window.NavKeyPoints;Object(i.b)("Forms.PerformanceAnalysis",{checkPoints:a,requests:s,requestsAll:Date.now()-o,scriptCached:c,scriptDownload:t&&t.PageStartTime&&o-t.PageStartTime,version:1})}},function(t,e,n){"use strict";n.d(e,"a",(function(){return v}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(81),c=n(52),u=n(126),l=n(28),h=n(5),f=n(178),d={SuggestionId:s.a.string(),IsReady:s.a.boolean(),IsLoading:s.a.boolean()};var b=function(t){function e(e){var n=t.call(this,{InitialData:{SuggestionId:"None",IsReady:!1,IsLoading:!1}})||this;return n.Sa=1e3,n.Na=.6,n.Ia=6,n.ua=e,n.Ca=[],n.Ta=[],n.xa=[],n.Fa=[],n.Pa=[],n.Da=n.Da.bind(n),n.Ma=n.Ma.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.registerObservers=function(){this.ua&&this.ua.observe(this.Ma,[this.ua.Schema.Title,this.ua.Schema.Theme,this.ua.Schema.Questions])},n.unregisterObservers=function(){this.ua&&this.ua.unobserve(this.Ma)},n.registerTargetElement=function(t){t&&(-1===r.findIndex(this.Ta,(function(e){var n,i;switch(typeof e){case"string":return e===t;default:return(null===(n=e.Model)||void 0===n?void 0:n.Id)===(null===(i=t.Model)||void 0===i?void 0:i.Id)}}))&&this.Ta.push(t))},n.unregisterTargetElement=function(t){if(t){var e=r.findIndex(this.Ta,(function(e){var n,i;switch(typeof e){case"string":return e===t;default:return(null===(n=e.Model)||void 0===n?void 0:n.Id)===(null===(i=t.Model)||void 0===i?void 0:i.Id)}}));e>-1&&this.Ta.splice(e,1)}},Object.defineProperty(n,"RemainingQuestionSuggestions",{get:function(){return this.Pa},set:function(t){this.Pa=t},enumerable:!1,configurable:!0}),Object.defineProperty(n,"MaxSuggestionCount",{get:function(){return this.Ia},set:function(t){this.Ia=t},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubQuestionCollection",{get:function(){return this.La},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Suggestions",{get:function(){return this.Ca},enumerable:!1,configurable:!0}),Object.defineProperty(n,"TopSuggestion",{get:function(){var t=this;if(this.Ca.length>0){var e=this.Ca.filter((function(e){return e.Confidence>t.Na&&t.xa.indexOf(e.Feature)<0}));return r.sortBy(e,(function(t){return t.Confidence})).reverse()[0]}return null},enumerable:!1,configurable:!0}),n.getSuggestion=function(t){var e=this.Ca.filter((function(e){return e.Feature===t}));return e.length>0?e[0]:null},n.AddCurrentSuggestion=function(t){this.Fa.indexOf(t)<0&&this.Fa.push(t),this.RemoveDismissedSuggestion(t)},n.RemoveCurrentSuggestion=function(t){var e=this.Fa.indexOf(t);e>-1&&(this.Fa.splice(e,1),this.Model.SuggestionId=Object(c.c)())},n.AddDismissedSuggestion=function(t){this.xa.indexOf(t)<0&&this.xa.push(t),this.RemoveCurrentSuggestion(t)},n.RemoveDismissedSuggestion=function(t){var e=this.xa.indexOf(t);e>-1&&this.xa.splice(e,1)},n.ShouldPopUpSuggestion=function(t){var e,n,i,r=0===this.Fa.length;return this.Fa.indexOf(t)>-1||!(this.xa.indexOf(t)>-1)&&(!!r&&("TitleSuggestsQuestion"===t?"TitleSuggestsQuestion"===(null===(e=this.TopSuggestion)||void 0===e?void 0:e.Feature)||"HistoryFormSuggestion"===(null===(n=this.TopSuggestion)||void 0===n?void 0:n.Feature):(null===(i=this.TopSuggestion)||void 0===i?void 0:i.Feature)===t))},n.Ma=function(){this.Aa&&window.clearTimeout(this.Aa),this.Aa=window.setTimeout(this.Da,this.Sa)},n.Da=function(){var t=this;this.ua&&this.ua.ensureFieldsReady([this.ua.Schema.Id]).then((function(){if(t.Ra()){var e=t.ua.Model,n=o.a.convertToArray(t.ua.Model.Questions).map((function(e){var n=t.Ta.findIndex((function(t){var n;switch(typeof t){case"string":return!1;default:return(null===(n=t.Model)||void 0===n?void 0:n.Id)===e.Id}}));return{Options:o.a.convertToArray(e.Choices).map((function(t){return t.Description})),QuestionTagForIntelligence:e.QuestionTagForIntelligence,QuestionType:e.Type,Title:e.Title,IsTarget:n>-1}})),i={Data:{Id:e.Id,Questions:n,Title:e.Title},Feature:"TitleSuggestsQuestion"};t.Ea=t.Ba();var r=l.a.Resolve("ITemplateQuestions");t.Model.IsLoading=!0,Promise.all([r,Object(f.c)()]).then((function(e){var n=e[0],r=e[1],o=n.Item_1;t.La=n.Item_2,t.IntelligenceProvider.askSuggetions(i).then((function(e){var n=e.Suggestion.filter((function(t){return"TitleSuggestsQuestion"===t.Feature}));n.length>0&&(n[0].Suggestion=n[0].Suggestion.map((function(t){return o[t]?o[t]:null})).filter((function(t){return null!==t})));var i=e.Suggestion.filter((function(t){return"TitleSuggestsTheme"===t.Feature}));i.length>0&&(i[0].Suggestion=Object(f.a)(i[0].Suggestion,r)),t.bulkEdit((function(){t.Ca=e.Suggestion,t.Model.SuggestionId=e.SuggestionId,t.Model.IsReady=!0,t.Model.IsLoading=!1,t.Aa=null})),t._a(e.ExtraData)})).catch((function(){t.bulkEdit((function(){t.Model.IsReady=!0,t.Model.IsLoading=!1,t.Aa=null}))}))}))}}))},n.Ra=function(){return!this.Model.IsLoading&&this.Ea!==this.Ba()},n.Ba=function(){var t,e=this.ua.Model.Title.length,n=o.a.convertToArray(this.ua.Model.Questions),i=r.reduce(n,(function(t,e){return t.QuestionCount++,t.OptionCount+=e.Choices.length,t}),{QuestionCount:0,TitleLength:0,OptionCount:0}),s=null===(t=this.ua.Model.Theme)||void 0===t?void 0:t.Name;return e+"_"+i.QuestionCount+"_"+i.TitleLength+"_"+i.OptionCount+"_"+s},Object.defineProperty(n,"IntelligenceProvider",{get:function(){if(!this.Ha){var t=Object(a.a)(this.ua.Model.Id),e=t.IsGroupOwner?3:2;this.Ha=u.a.createIntelligenceProvider(e,t.OrgId,t.OwnerId)}return this.Ha},enumerable:!1,configurable:!0}),n._a=function(t){var e=this.getSuggestion("TitleSuggestsQuestion"),n=!!e&&!!e.Suggestion&&e.Suggestion.length>0;Object(h.b)("Intelligence.Suggestions.Get",{ActionSubCategory:"Get",HasHistorySuggestion:!!this.getSuggestion("HistoryFormSuggestion"),HasQuestionSuggestion:n,HasThemeSuggestion:!!this.getSuggestion("TitleSuggestsTheme"),HasEstimatedTimeSuggestion:!!this.getSuggestion("PredictResponseTime")}),Object(h.b)("IntelligenceStatistic.Suggestions.Get",{ActionSubCategory:"Get",SuggestionId:this.Model.SuggestionId,ExtraData:t})},e}(o.a.createObjectMasterClass("IntelligenceSuggestions",d)),m={};function v(t){if(!t)return null;var e=t.getInstanceId(),n=m[e];return n||(n=m[e]=new b(t)),n}},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return d}));var i,r=n(2),o=n(3),s=n(6),a=n(4),c=n(12),u=n(81),l=n(126),h=n(5),f={InsightCount:a.a.number(),IsReady:a.a.boolean()};!function(t){t[t.SummaryInsight=0]="SummaryInsight",t[t.CorrelationInsight=1]="CorrelationInsight",t[t.ExplainDiffInsight=2]="ExplainDiffInsight",t[t.Outstanding=3]="Outstanding",t[t.OutstandingCollection=4]="OutstandingCollection",t[t.AssociationRuleInsight=5]="AssociationRuleInsight",t[t.FunctionalDependency=6]="FunctionalDependency",t[t.IntraclassInsight=7]="IntraclassInsight",t[t.RatingKeywordsInsight=8]="RatingKeywordsInsight",t[t.LikertAssociationRuleInsight=9]="LikertAssociationRuleInsight",t[t.PartialOrderInsight=10]="PartialOrderInsight",t[t.NPSKeywordsInsight=11]="NPSKeywordsInsight",t[t.ResponseSentimentInsight=12]="ResponseSentimentInsight",t[t.KeywordSentimentInsight=13]="KeywordSentimentInsight",t[t.KeyPhrasesInsight=14]="KeyPhrasesInsight",t[t.SummaryDistribution=15]="SummaryDistribution",t[t.SummaryDistributionCollection=16]="SummaryDistributionCollection",t[t.CorrelationInsightCollection=17]="CorrelationInsightCollection",t[t.ResponseSentimentInsightCollection=18]="ResponseSentimentInsightCollection",t[t.RatingDistributionAnalysisInsight=21]="RatingDistributionAnalysisInsight",t[t.AllHandsSummaryInsight=22]="AllHandsSummaryInsight",t[t.RatingDistributionInsight=25]="RatingDistributionInsight",t[t.RatingImpactInsight=26]="RatingImpactInsight",t[t.TextClusterInsight=28]="TextClusterInsight",t[t.TimeDistributionInsight=29]="TimeDistributionInsight",t[t.LikertImpactAnalysisInsightCollection=30]="LikertImpactAnalysisInsightCollection",t[t.DrivingFactorAnalysisInsightCollection=31]="DrivingFactorAnalysisInsightCollection"}(i||(i={}));var d=function(t){function e(e){var n=t.call(this,{InitialData:{InsightCount:0,IsReady:!1}})||this;return n.ua=e,n.Ga=[],n}Object(r.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Insights",{get:function(){return this.Ga},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormMaster",{get:function(){return this.ua},enumerable:!1,configurable:!0}),n.loadInsight=function(t){switch(t){case"Insights":this.qa();break;case"CachedInsights":this.Qa()}},n.isValidFormScenario=function(){return o.any(this.ua.Model.Questions,(function(t){var e=t.QuestionTagForIntelligence;return!!e&&e.indexOf("ScenarioTag")>=0}))},n.hasPinnedInsightOnForm=function(){if(this.Model.IsReady&&this.ua.Model.FormsInsightsInfo){var t=JSON.parse(this.ua.Model.FormsInsightsInfo);if(t.PinedInsights&&t.PinedInsights.length>0&&o.find(this.Insights,(function(e){return o.includes(t.PinedInsights,e.InsightId)})))return!0}return!1},n.logSeen=function(){Object(h.b)("Intelligence.Insights.Seen",{AssociationRuleInsightCount:this.Ga.filter((function(t){return t.Type===i.AssociationRuleInsight})).length,RatingDistributionInsightCount:this.Ga.filter((function(t){return t.Type===i.RatingDistributionInsight})).length,SentimentInsightCount:this.Ga.filter((function(t){return t.Type===i.ResponseSentimentInsight})).length})},n.logEngage=function(t,e,n){void 0===e&&(e=null),void 0===n&&(n=0);var i=o.find(this.Insights,(function(t){return t.InsightId===e}));Object(h.b)("Intelligence.Insights.Engage",{Duration:n,InsightType:null==i?void 0:i.Type,SubActionType:t})},n.Va=function(){var t=this.ua.Model.FormsInsightsInfo;if(t){var e=JSON.parse(t);if(e.PinedInsights&&e.PinedInsights.length>0)return!0}var n=s.a.convertToArray(this.ua.Model.Questions);return o.any(n,(function(t){if(t.InsightsInfo&&"None"!==t.InsightsInfo){var e=JSON.parse(t.InsightsInfo);if(e.PinedInsights&&e.PinedInsights.length>0)return!0}}))},n.Qa=function(){var t=this;this.ua.ensureReadyToDesign().then((function(){var e=t.ua.Model;(Object(c.c)("GetInteractiveInsights")&&t.Va()?t.IntelligenceProvider.getOrCalculateInteractiveInsights(e.Id):t.IntelligenceProvider.getCachedInsights(e.Id)).then((function(e){var n=e.filter((function(t){switch(t.Type){case i.AssociationRuleInsight:case i.ResponseSentimentInsight:case i.RatingDistributionAnalysisInsight:return!0;default:return!1}}));n.length>0&&t.logSeen(),t.bulkEdit((function(){t.Ga=t.Ga.concat(n),t.Model.InsightCount+=n.length,t.Model.IsReady=!0}))})).catch((function(){t.Model.IsReady=!0}))}))},n.qa=function(){var t=this;this.ua.ensureReadyToDesign().then((function(){var e=t.ua.Model;t.IntelligenceProvider.getInsights(e.Id,e.ResponsesCount,e.Questions.length).then((function(e){var n=e.filter((function(t){switch(t.Type){case i.AssociationRuleInsight:case i.ResponseSentimentInsightCollection:case i.AllHandsSummaryInsight:case i.TextClusterInsight:case i.DrivingFactorAnalysisInsightCollection:case i.LikertImpactAnalysisInsightCollection:return!0;default:return!1}}));t.bulkEdit((function(){t.Ga=t.Ga.concat(n),t.Model.InsightCount+=n.length,t.Model.IsReady=!0}))})).catch((function(){t.Model.IsReady=!0}))}))},Object.defineProperty(n,"IntelligenceProvider",{get:function(){if(!this.Ha){var t=Object(u.a)(this.ua.Model.Id),e=t.IsGroupOwner?3:2;this.Ha=l.a.createIntelligenceProvider(e,t.OrgId,t.OwnerId)}return this.Ha},enumerable:!1,configurable:!0}),e}(s.a.createObjectMasterClass("FormInsight",f))},function(t,e,n){"use strict";n.d(e,"d",(function(){return o})),n.d(e,"a",(function(){return s})),n.d(e,"c",(function(){return a})),n.d(e,"b",(function(){return u})),n.d(e,"e",(function(){return f}));var i=n(7),r=n(36);function o(){if(Object(i.a)().isOembedSPO){var t=Object(r.a)(".office-form.office-form-theme-shadow"),e=Object(r.a)(".office-form-footer-container");if(t&&e)c("ResponsePage",t+e+80+Object(r.a)(".office-form-new-bottom-bar"))}}function s(){if(Object(i.a)().isOembedSPO&&$(".analysis-page-content").height()){c("AnalysisPage",$(".analysis-page-content").height()+50)}}function a(t){Object(i.a)().isOembedSPO&&c("ResponsePage",t)}function c(t,e){var n=Object(r.d)().hostId;if(n)parent.postMessage("FormsPageHeight:"+n+":"+e.toString(),"*");else{var i=Object(r.d)().id;parent.postMessage(t+"Height:"+i+":"+e.toString(),"*")}}function u(t){if(Object(i.a)().isOembedSPO){var e=t.Model.Title?t.Model.Title:"",n=t.Model.Description?t.Model.Description:"",o=Object(r.d)().hostId;parent.postMessage("FormsInfo:"+o+":"+encodeURIComponent(e)+":"+encodeURIComponent(n),"*")}}function l(t){if(Object(i.a)().isOembedSPO){var e=t&&(t.innerCode||t.message||""),n=Object(r.d)().hostId;parent.postMessage("FormsError:"+n+":"+encodeURIComponent(e),"*")}}var h=window.onerror;function f(t,e){Object(i.a)().isOembedSPO&&(t&&e&&function(t){if(t){var e=Object(r.a)(".form-content"),n=t+200;n>e&&(n=e),a(n)}}(Object(r.a)(t)+Object(r.a)(e)))}window.onerror=function(t,e,n,i,r){l(r),h&&h.apply(this,arguments)}},function(t,e,n){"use strict";function i(t){return"number"==typeof t}function r(t){return"string"==typeof t}n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return r}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var i=n(0),r=n(15),o=n(54),s=n(1),a=n(13),c=n(10);function u(t){return t.isFieldReady(a.a.Schema.Type)&&"survey"===t.Model.Type?i.createElement("div",{className:"fl-type-label fl-type-survey",key:"type-label",title:Object(s.a)().Survey_FormCard_TypeLabel}):null}function l(t){return Object(c.c)((function(){if(t.isFieldReady(a.a.Schema.Type)&&"survey"===t.Model.Type&&Object(r.q)()){var e=Object(o.a)("CustomerVoiceTransitionCompletionDate");return i.createElement("div",{className:"fl-warning-label fl-warning-survey",key:"warning-label",title:Object(s.a)().CustomerVoiceSurveyWarning.format(e)})}return null}),(function(){return null}))}},function(t,e,n){"use strict";n.d(e,"c",(function(){return w})),n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return N}));var i=n(2),r=n(70),o=n(6),s=n(4),a=n(44),c=n(30),u=n(25),l=n(31),h=function(){function t(t,e){this.za=t,this.Ua=e,this.N=Object(l.i)(this.za.Form)}var e=t.prototype;return e.$a=function(){return this.za.FormId},e.Wa=function(){return this.za.ResponseId},e.add=function(t){return Object(c.b)("No scenario to call this method currently.")},e.delete=function(t){return this.N.deleteFormResponse(this.$a(),t.id)},e.query=function(t){return Object(c.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=t.releaseDate,i=this.za.Form.SyncContext;return i!==u.a.DesignTimeForm&&i!==u.a.AnalysisTimeForm?new Promise((function(){})):void 0!==n?this.N.setResponseReleaseDate(this.$a(),this.Wa(),n):Promise.resolve()},t}(),f=n(134),d=n(113),b=n(5),m=n(12),v=n(53),g=function(){function t(t,e){this.Ka=t,this.N=Object(l.i)(this.Ka.Response.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.Ka.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(e,"ResponseId",{get:function(){return this.Ka.ResponseId},enumerable:!1,configurable:!0}),e.Ja=function(){var e=this;return new Promise((function(n,i){t.responsePromiseObjCacheMap.set(e.ResponseId,{resolve:n,reject:i});void 0===t.timerID&&0!==t.comments.length&&(t.timerID=window.setTimeout((function(){if(t.timerID=void 0,1===t.comments.length){var r=t.comments[0];t.comments=[],e.N.addFormResponseComment(e.FormId,e.ResponseId,r).then((function(t){n(t)}),i)}else{var o=t.comments.map((function(t){return t}));t.comments=[],e.N.addFormResponseComments(e.FormId,o).then((function(e){for(var n=0,i=e;n<i.length;n++){var r=i[n],o=t.responsePromiseObjCacheMap.get(r.responseId);t.responsePromiseObjCacheMap.delete(r.responseId),o.resolve(r)}}),(function(e){t.responsePromiseObjCacheMap.forEach((function(t,n,i){t.reject(e)}))}))}}),500))}))},e.add=function(e,n,i){return!Object(v.o)()&&Object(m.c)("EnableBatchCommentAPI")?(n.Snapshot.responseId=this.ResponseId,t.comments.push(n.Snapshot),this.Ja()):this.N.addFormResponseComment(this.FormId,this.ResponseId,n.Snapshot)},e.delete=function(t){return new Promise((function(){}))},e.query=function(t){return Object(c.b)("No scenario to call this method currently.")},e.update=function(t,e){var n=this.Ka.Response.Form.SyncContext;return n!==u.a.DesignTimeForm&&n!==u.a.AnalysisTimeForm?new Promise((function(){})):this.add(t,e,!0)},t.comments=new Array,t.responsePromiseObjCacheMap=new Map,t}(),O={QuestionId:s.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Id:s.a.number({SourceFieldName:"id"}),Feedback:s.a.string({SourceFieldName:"feedback"}),Score:s.a.number({SourceFieldName:"score"}),SavingState:s.a.reference({IsLocalField:!0})};var p=function(t){function e(n){var i=t.call(this,n,{Scheduler:new d.a(e.name)})||this;return Object(r.b)(i),i.observe(j),i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Response",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Response.FormId},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.Response.ResponseId},enumerable:!1,configurable:!0}),e}(o.a.createObjectMasterClass("Comment",O,(function(t,e){return new g(t,e)})));function j(t){if(t.BeingDeleted&&t.Master.Synchronizer.Model.UpdateScheduled)try{throw Error("DeletingComment")}catch(t){Object(b.c)("ModelError",t.stack)}}var y={Id:s.a.number({IsKeyField:!0,SourceFieldName:"id"}),Comments:s.a.collectionOf((function(){return p}),{SourceFieldName:"comments"}),AnswersAsString:s.a.string({SourceFieldName:"answers"}),StartDateAsString:s.a.string({SourceFieldName:"startDate"}),SubmitDateAsString:s.a.string({SourceFieldName:"submitDate"}),Responder:s.a.string({SourceFieldName:"responder"}),ResponderName:s.a.string({SourceFieldName:"responderName"}),QuizResult:s.a.string({SourceFieldName:"quizResult"}),ReleaseDateAsString:s.a.string({SourceFieldName:"releaseDate"}),Answers:s.a.collectionOf({QuestionId:s.a.string({IsKeyField:!0,SourceFieldName:"questionId"}),Answer:s.a.reference({SourceFieldName:"answer1"}),Feedback:s.a.string({IsLocalField:!0}),Score:s.a.number({IsLocalField:!0}),IsAutoGraded:s.a.boolean({IsLocalField:!0}),IsMathAnswer:s.a.boolean({IsLocalField:!0})},{IsLocalField:!0}),StartDate:s.a.reference({IsLocalField:!0}),SubmitDate:s.a.reference({IsLocalField:!0}),ReleaseDate:s.a.reference({IsLocalField:!0}),Feedback:s.a.string({IsLocalField:!0}),TotalScore:s.a.number({IsLocalField:!0}),IntegratedSavingState:s.a.reference({IsLocalField:!0}),SavingState:s.a.reference({IsLocalField:!0}),EmailReceiptConsent:s.a.boolean({SourceFieldName:"emailReceiptConsent"}),SubmitLanguage:s.a.string({SourceFieldName:"submitLanguage"}),MSRewardsData:s.a.reference({SourceFieldName:"msRewardsData"})};y.Answers[0];function w(t){return o.a.getObjectMasterFromModel(t)}function S(t,e){return Object(f.b)(t.Model.Id,e)}var N=function(t){function e(n){var i=this,r=new a.a;return(i=t.call(this,n,{Scheduler:new d.a(e.name),MasterReady:r.promise()})||this).Xa(),e.Rules.forEach((function(t){return i.addRule(t)})),r.resolve(),i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"ResponseId",{get:function(){return this.Model.Id},enumerable:!1,configurable:!0}),Object.defineProperty(n,"Comment",{get:function(){return this.getCommentByQuestionId(null)},enumerable:!1,configurable:!0}),n.updateWithNormalizedResponse=function(t){var n=this;this.bulkEdit((function(){n.Synchronizer.onSourceDataReceived(o.a.convertToSourceData(t,e.Schema)),n.setData(t)}))},n.getAnswerByQuestionId=function(t){var e=o.a.Collection.getItemWithKeyFields(this.Model.Answers,{QuestionId:t});return e&&o.a.getObjectMasterFromModel(e)},n.getCommentByQuestionId=function(t){var e=o.a.Collection.getItemWithKeyFields(this.Model.Comments,{QuestionId:t});return e&&function(t){return o.a.getObjectMasterFromModel(t)}(e)},n.setAnswerGrading=function(t,e,n){var i=this.Form.getQuestionById(t);if(i){var r=i.SubQuestionMasters;r.length>0&&(t=r[r.length-1].Model.Id);var s=this.getCommentByQuestionId(t);if(s)s.bulkEdit((function(){void 0!==e&&(s.Model.Score=e),void 0!==n&&(s.Model.Feedback=n)}));else{var a=this.getAnswerByQuestionId(t);e=null!=e?e:a.Model.Score;var c={QuestionId:t,Feedback:n,Score:e};try{o.a.Collection.addItems(this.Model.Comments,[c])}catch(i){this.getCommentByQuestionId(t)&&this.setAnswerGrading(t,e,n)}}}},n.Xa=function(){var t=this;this.Za="Idle";var e=o.a.getCollectionMasterFromModel(this.Model.Comments);Object(r.c)(e,e.Schema[0].SavingState,(function(e){t.Za=e,t.le()})),Object(r.b)(this),this.le()},n.Ya=function(t){var e=this.getAnswerByQuestionId(t);if(e)return e;var n=o.a.Collection.addItems(this.Model.Answers,[{QuestionId:t}])[0];return o.a.getObjectMasterFromModel(n)},n.le=function(){this.Model.IntegratedSavingState=Object(r.a)([this.Model.SavingState,this.Za])},Object.defineProperty(e,"Rules",{get:function(){if(!e.rules){var t=e.Schema;e.rules=[{Name:"ResponseComment",InterestedFields:[t.Feedback,t.TotalScore],onChange:function(t){var e=t.Master,n=e.getCommentByQuestionId(null);n?n.bulkEdit((function(){n.Model.Feedback=e.Model.Feedback,n.Model.Score=e.Model.TotalScore})):o.a.Collection.addItems(e.Model.Comments,[{QuestionId:null,Feedback:e.Model.Feedback,Score:e.Model.TotalScore}])}},{Name:"AnswerComment",InterestedFields:[t.Answers[0].Feedback,t.Answers[0].Score,t.Answers[0].IsAutoGraded],onChange:function(t){var e=t.Master,n=e.Model.Answers,i=function(t){t.IsAutoGraded||e.setAnswerGrading(t.QuestionId,t.Score,t.Feedback)};t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){t.AddedModels.forEach(i),t.SubChanges.forEach((function(t){return i(t.Master.Model)}))}))}},{Name:"ApplyCommentChange",InterestedFields:[t.Comments],onChange:function(t){var e=t.Master,n=e.Model.Comments,i=function(t){var n=t.QuestionId;if(n){var i=e.Ya(n);i.bulkEdit((function(){i.Model.Feedback=t.Feedback,i.Model.Score=t.Score,i.Model.IsAutoGraded=!1}))}else e.bulkEdit((function(){e.Model.Feedback=t.Feedback,e.Model.TotalScore=t.Score}))};t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){t.AddedModels.forEach(i),t.SubChanges.forEach((function(t){return i(t.Master.Model)}))}))}}],e.rules=e.rules.concat(e.getRulesForSyncBetweenDateFields(t.StartDate,t.StartDateAsString),e.getRulesForSyncBetweenDateFields(t.SubmitDate,t.SubmitDateAsString),e.getRulesForSyncBetweenDateFields(t.ReleaseDate,t.ReleaseDateAsString))}return e.rules},enumerable:!1,configurable:!0}),e.getRulesForSyncBetweenDateFields=function(t,e){var n=o.a.getFieldSchemaInfo(t).Name,i=o.a.getFieldSchemaInfo(e).Name;return[{Name:"update "+n,InterestedFields:[e],onChange:function(t){var e=t.Master.Model;e[n]=new Date(e[i])}},{Name:"update "+i,InterestedFields:[t],onChange:function(t){var e=t.Master.Model;e[i]=e[n].toISOString()}}]},e}(o.a.createObjectMasterClass("Response",y,(function(t,e){return new h(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));n(20);var i,r=n(3),o=n(23),s=n(12),a=n(7),c=n(11),u=n(109),l=n(29),h=n(13),f=n(5),d=/^({?)((\d|[a-fA-F]){8}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){4}-(\d|[a-fA-F]){12})(}?)$/,b=/^([a-fA-F\d]{8})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{4})([a-fA-F\d]{12})$/,m=function(){function t(e,n){if(void 0===n&&(n=!1),n)this.guid=e;else{var i=t._formatGuidString(e);if(!i)throw new Error(e+" is not a valid Guid value.");this.guid=i}Object.freeze(this)}t.prototype;return t.externalGuid=function(e){return e?"{"+e.guid.toUpperCase()+"}":t.EMPTYSTRING},t.fromExternalGuid=function(e){return e?new t(e.replace(/[\{\}]/gi,"")):t.EMPTY},t.validate=function(t){return null!=t&&null!==d.exec(t)},t.toString=function(t){return t?t.guid:null},t.tryParse=function(e){return t.tryParseOrNull(e)||t.EMPTY},t.tryParseOrNull=function(e){var n=t._formatGuidString(e);return n?new t(n,!0):null},t.parse=function(e){return new t(e)},t._formatGuidString=function(t){if(!t)return null;t=t.toLowerCase();var e=d.exec(t);if(e)return e[1].length!==e[8].length?null:e[2];var n=b.exec(t);return n?n.filter((function(t,e){return e>0})).join("-"):null},t.equals=function(e,n){return null==e||null==n?e===n:t.toString(e)===t.toString(n)},t.isNullOrEmpty=function(e){return!e||t.equals(e,t.EMPTY)},t.newGuid=function(){for(var e="",n=0;n<36;n++)if(14===n)e+="4";else if(8===n||13===n||18===n||23===n)e+="-";else if(19===n){var i=Math.floor(16*Math.random());e+="0123456789abcdef".substr(3&i|8,1)}else e+="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return new t(e,!0)},t.EMPTYGUIDSTRING="00000000-0000-0000-0000-000000000000",t.EMPTY=new t(t.EMPTYGUIDSTRING,!0),t.EMPTYSTRING="",t}();FormsPro.getCdsManager=function(){return i||(i=new v)};var v=function(){function t(){var t=this;this.tc=["NA","SAM","CAN","EMEA","APAC","OCE","JPN","IND","GCC","TIP","GBR","FRA"];var e=Object(c.b)(),n=e.Model,i=!0;n.DefaultCdsId="",n.DefaultCdsUrl="",n.DefaultCdsInfoLoadState="Loading";var l=Object(s.c)("FormsProCdsInfoInUrl");if(l&&null==n.FormId){var d=Object(o.d)(),b=Object(o.e)();m.isNullOrEmpty(m.tryParse(d))&&(d=null),b&&!r.contains(this.tc,b.toUpperCase())&&(b=null),d&&b&&(n.CdsInfoAvailableInUrl=!0,Object(a.a)().lastUsedEnv&&!r.isEmpty(Object(a.a)().lastUsedEnv)&&(n.LastUsedEnv=Object(a.a)().lastUsedEnv),this.setCurrentCds(d,b),i=!1);var v=Object(u.e)(location.search,"cdsId");window.history.replaceState(null,null,window.location.pathname+v);var g=Object(u.e)(location.search,"cdsRegion");window.history.replaceState(null,null,window.location.pathname+g)}l&&n.CdsInfoAvailableInUrl||null==n.FormId&&Object(a.a)().lastUsedEnv&&Object(a.a)().lastUsedEnv.CdsId&&(this.setCurrentCds(Object(a.a)().lastUsedEnv.CdsId,Object(a.a)().lastUsedEnv.Region),i=!1),Object(f.e)({type:"MFPUI_GetDefaultCdsInfoStarted",eventInfo:{tenantId:Object(a.a)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),FormsPro.MFPDataProviderAdapter.GetDefaultCdsInfo().then((function(r){if(n.DefaultCdsInfoLoadState="Loaded",null!=r){Object(f.e)({type:"MFPUI_GetDefaultCdsInfoCompleted",eventInfo:{tenantId:Object(a.a)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),n.DefaultCdsId=r.cdsId,n.DefaultCdsUrl=r.cdsUrl,n.TenantCountryCode=r.TenantCountryCode;var o={cdsName:"Default",cdsUniqueName:"Default",cdsUrl:n.DefaultCdsUrl,cdsId:n.DefaultCdsId,regionName:t.mapRegionFromSuffix(n.DefaultCdsUrl),environmentId:"",environmentName:"Default"};if(0==n.CdsList.filter((function(t){return t.cdsId===n.DefaultCdsId})).length&&(n.CdsList=n.CdsList.concat(o)),n.CdsList=n.CdsList.sort((function(t,e){return t.environmentName.toLowerCase().localeCompare(e.environmentName.toLowerCase())})),null==n.FormId)i&&t.switchToDefaultCds(r.CDSProvisioningState,r.CDSProvisionigFailureReason);else{var s=e.Model.FormMaster;s.ensureFieldsReady([h.a.Schema.BusinessCdsId,h.a.Schema.BusinessCdsRegion]).then((function(){t.setCurrentCds(s.Model.BusinessCdsId,s.Model.BusinessCdsRegion)})).catch((function(){t.switchToDefaultCds(r.CDSProvisioningState,r.CDSProvisionigFailureReason)}))}}})).catch((function(t){Object(f.e)({type:"MFPUI_GetDefaultCdsInfoFailed",eventInfo:{tenantId:Object(a.a)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager",type:"unexpected"}}),n.DefaultCdsInfoLoadState="Loaded",n.ValidationChecked="UnknownError",n.CriticalError=t}))}var e=t.prototype;return e.getFormList=function(){return Object(c.b)().Model.FormList},e.populateCdsList=function(){var t=Object(c.b)(),e=t.Model;return e.EnvironmentListLoadState="Loading",FormsPro.MFPDataProviderAdapter.GetEnvironmentList().then((function(e){t.bulkEdit((function(t){if(null!=e){t.EnvironmentListLoadState="Loaded";var n=[].concat(t.CdsList);t.CdsList=e.environmentInstances,r.forEach(n,(function(e){0==t.CdsList.filter((function(t){return t.cdsId===e.cdsId})).length&&(t.CdsList=t.CdsList.concat(e))})),t.CdsList=t.CdsList.sort((function(t,e){if(null!=t.environmentName)return t.environmentName.toLowerCase().localeCompare(e.environmentName.toLowerCase())}))}else t.EnvironmentListLoadState="Failed"}))})).catch((function(t){return console.log("Fetch environment list failed due to some error."),e.EnvironmentListLoadState="Failed",t}))},e.setCurrentCds=function(t,e){var n=this,i=Object(c.b)();if(i.Model.SelectedCdsId!==t&&(i.Model.CriticalError=void 0,i.bulkEdit((function(i){i.ValidationChecked="Pending",i.FormList=[],i.FormListLoadState="Loading",console.log("SetCurrentCDS States F{0},D{1},A{2},V{3},SID{4},DID{5}",i.FormListLoadState,i.DefaultCdsInfoLoadState,i.AllFormListLoadState,i.ValidationChecked,i.SelectedCdsId,i.DefaultCdsId),i.SelectedCdsId=t,i.SelectedCdsRegion=e,i.SelectedCdsUrl=n.getCurrentCdsUrl(),null==i.SelectedCdsId||""==i.SelectedCdsId||i.SelectedCdsId===i.DefaultCdsId?i.IsDefaultCds=!0:i.IsDefaultCds=!1,Object(a.a)().lastUsedEnv&&i.SelectedCdsId==Object(a.a)().lastUsedEnv.CdsId&&(i.IsDefaultCds=Object(a.a)().lastUsedEnv.IsDefaultCDS);var r=i.CdsValidationMap[i.SelectedCdsId];null==r?FormsPro.MFPDataProviderAdapter.isValidMfpUser(i.IsDefaultCds,i.SelectedCdsId,i.SelectedCdsUrl,!0,i.SelectedCdsRegion).then((function(t){i.CdsValidationMap[i.SelectedCdsId]=i.ValidationChecked,("ValidationPassed"===(r=i.ValidationChecked)||i.IsDefaultCds)&&FormsPro.MFPDataProviderAdapter.filterFormsMultiCds()})):(i.ValidationChecked=r,("ValidationPassed"===r||i.IsDefaultCds)&&FormsPro.MFPDataProviderAdapter.filterFormsMultiCds())})),Object(a.a)().lastUsedEnv.CdsId!=t)){var r=this.getCurrentEnvName();r?this.ec(t,e,r,t===i.Model.DefaultCdsId):i.observe((function(){n.ec(t,e,n.getCurrentEnvName(),t===i.Model.DefaultCdsId)}),[i.Schema.CdsList])}},e.resetLastUsedEnv=function(){var t=this,e=Object(c.b)();if(e.Model.LastUsedEnv&&!r.isEmpty(e.Model.LastUsedEnv)){l.a.getInstance().createDataProvider().updateLastUsedEnv(Object(a.a)().userInfo.TenantId,Object(a.a)().userInfo.UserId,JSON.stringify(e.Model.LastUsedEnv))}else{var n=e.Model.DefaultCdsId,i=e.Model.DefaultCdsUrl;n&&i?this.ic(n,i,!0):e.observe((function(){t.ic(e.Model.DefaultCdsId,e.Model.DefaultCdsUrl,!0)}),[e.Schema.DefaultCdsId,e.Schema.DefaultCdsUrl])}},e.ic=function(t,e,n){if(t&&e){var i=this.getCurrentRegion(t,e),r=this.getCurrentEnvName(t);if(i){var o={CdsId:t,Region:i,EnvironmentName:r,IsDefaultCDS:n};l.a.getInstance().createDataProvider().updateLastUsedEnv(Object(a.a)().userInfo.TenantId,Object(a.a)().userInfo.UserId,JSON.stringify(o))}}},e.ec=function(t,e,n,i){var r={CdsId:t,Region:e||this.getCurrentRegion(),EnvironmentName:n,IsDefaultCDS:i};l.a.getInstance().createDataProvider().updateLastUsedEnv(Object(a.a)().userInfo.TenantId,Object(a.a)().userInfo.UserId,JSON.stringify(r)).then((function(){var t=Object(a.a)();t.lastUsedEnv=r,Object(a.b)(t)}))},e.getCurrentCdsId=function(){var t=Object(c.b)().Model;return t.SelectedCdsId?t.SelectedCdsId:""},e.getIsDefaultCds=function(){return Object(c.b)().Model.IsDefaultCds},e.getCurrentCdsUrl=function(){var t=Object(c.b)().Model;if(!(t.CdsList.length>0))return t.SelectedCdsUrl;var e=t.CdsList.filter((function(e){return e.cdsId===t.SelectedCdsId}));return e.length>0?e[0].cdsUrl:void 0},e.getCurrentCdsUniqueName=function(){var t=Object(c.b)().Model;if(!(t.CdsList.length>0))return"";var e=t.CdsList.filter((function(e){return e.cdsId===t.SelectedCdsId}));return e.length>0?e[0].cdsUniqueName:void 0},e.getCurrentEnvironmentId=function(){var t=Object(c.b)().Model;if(!(t.CdsList.length>0))return"";var e=t.CdsList.filter((function(e){return e.cdsId===t.SelectedCdsId}));return e.length>0?e[0].environmentId:void 0},e.getCurrentRegion=function(t,e){var n=Object(c.b)().Model,i=null!=t?t:n.SelectedCdsId;if(!(n.CdsList.length>0)){var r=null!=e?e:this.getCurrentCdsUrl();return this.mapRegionFromSuffix(r)}var o=n.CdsList.filter((function(t){return t.cdsId===i}));if(o.length>0)return o[0].regionName},e.getCurrentEnvName=function(t){var e=Object(c.b)().Model,n=null!=t?t:e.SelectedCdsId;if(!(e.CdsList.length>0))return"";var i=e.CdsList.filter((function(t){return t.cdsId===n}));return i.length>0?i[0].environmentName:void 0},e.mapRegionFromSuffix=function(t){if(!t)return t;var e=t.split("."),n="";if(e.length>=4)switch(e[1].toUpperCase()){case"CRM":n="NA";break;case"CRM2":n="SAM";break;case"CRM3":n="CAN";break;case"CRM4":n="EMEA";break;case"CRM5":n="APAC";break;case"CRM6":n="OCE";break;case"CRM7":n="JPN";break;case"CRM8":n="IND";break;case"CRM9":n="NA";break;case"CRM10":n="TIP";break;case"CRM11":n="GBR";break;case"CRM12":n="FRA";break;case"CRM15":n="UAE"}return n},e.getCdsList=function(){return Object(c.b)().Model.CdsList},e.isProvisioningFailed=function(t,e){var n=Object(c.b)().Model,i=t.toLowerCase(),r=e.toLowerCase();return"failedprovisioning"==i&&"none"!=r&&("cds1exception"==r?(n.ValidationChecked="CDS10Failure",!0):"AADApplicationDisabled"==r?(n.ValidationChecked="AADApplicationDisabled",!0):(n.ValidationChecked="UnknownError",!0))},e.switchToDefaultCds=function(t,e){var n=this,i=Object(c.b)();i.Model.IsDefaultCds=!0,i.bulkEdit((function(i){i.FormListLoadState="Loading",i.ValidationChecked="Pending",console.log("switchToDefaultCds States F{0},D{1},A{2},V{3},SID{4},DID{5}",i.FormListLoadState,i.DefaultCdsInfoLoadState,i.AllFormListLoadState,i.ValidationChecked,i.SelectedCdsId,i.DefaultCdsId),i.SelectedCdsId=i.DefaultCdsId,i.SelectedCdsUrl=i.DefaultCdsUrl,FormsPro.MFPDataProviderAdapter.filterFormsMultiCds(),n.isProvisioningFailed(t,e)||(Object(f.e)({type:"MFPUI_IsValidMFPUserStarted",eventInfo:{tenantId:Object(a.a)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),FormsPro.MFPDataProviderAdapter.isValidMfpUser(i.IsDefaultCds,i.SelectedCdsId,i.SelectedCdsUrl,!0).then((function(t){t&&Object(f.e)({type:"MFPUI_IsValidMFPUserCompleted",eventInfo:{tenantId:Object(a.a)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager"}}),i.CdsValidationMap[i.SelectedCdsId]=i.ValidationChecked,"ValidationPassed"===i.ValidationChecked&&FormsPro.MFPDataProviderAdapter.filterFormsMultiCds()}),(function(){Object(f.e)({type:"MFPUI_IsValidMFPUserFailed",eventInfo:{tenantId:Object(a.a)().userInfo.TenantId,Geo:null!=document.getElementById("Geo")?document.getElementById("Geo").value:"",Component:"CdsManager",type:"unexpected"}})})))})),this.ec(i.Model.DefaultCdsId,this.getCurrentRegion(),this.getCurrentEnvName(),!0)},e.getCDSProvisioningStatus=function(){return FormsPro.MFPDataProviderAdapter.fetchProvisioningStatus().then((function(t){return t.then((function(t){return t}))}))},t}(),g=n(6),O=n(2),p=function(t){function e(e){var n=t.call(this,window.FormPrefetchCache.tenantSettingsCache)||this;return n.N=e,n.init(),n}Object(O.__extends)(e,t);var n=e.prototype;return n.onPrefetchSucceed=function(){try{var t=JSON.parse(this.cache.data);this.prefetchResolve(t)}catch(t){this.fallBackToNormalBoot()}},n.onPrefetchFaied=function(){this.fallBackToNormalBoot()},n.fallBackToNormalBoot=function(){var t=this;this.N.getFormsTenantSettings().then((function(e){return t.prefetchResolve(e)})).catch((function(e){return t.prefetchReject(e)}))},e}(n(187).a),j=n(131),y=n(81),w=n(14),S=n(63),N=n(138),I=n(10),C=function(){function t(){this.createForm=this.createForm.bind(this)}var e=t.prototype;return t.getFormsTenantSettings=function(t){var e=l.a.getInstance().createDataProvider();return(!t&&Object(a.a)().prefetchEnabled&&window.FormPrefetchCache?new p(e).getPromise():e.getFormsTenantSettings()).then((function(t){Object(N.a)().Model.FormsTenantSettings=t}),(function(t){Object(f.c)("TenentSettingsGetFailure",t)}))},t.copyFormBySharingLink=function(t,e){var n=Object(y.a)(t);return l.a.getInstance().createDataProvider(2,n.OrgId,n.OwnerId).copyFormBySharingLink(t,e).then((function(t){var e={Id:t.id};return Object(S.a)(e,!1,!1)}))},t.updateOrCreateFormMaster=function(t,e,n){void 0===e&&(e=!1),void 0===n&&(n=!1);var i=t.Id&&Object(S.f)(t.Id);if(i){var s=g.a.convertToSourceData(t,h.a.Schema);return i.Synchronizer.onSourceDataReceived(s),i}return t.Id||(t=r.clone(t),Object(w.u)(t.ProgressBarEnabled)&&(t.ProgressBarEnabled=Object(I.c)((function(){return"false"}),I.f)),e?(t.XlWorkbookId=t.XlWorkbookId||j.c,t.OwnerId=t.OwnerId||Object(o.f)(),t.OwnerTenantId=t.OwnerTenantId||Object(o.i)()):(t.OwnerId=t.OwnerId||Object(a.a)().userInfo.UserId,t.OwnerTenantId=Object(a.a)().userInfo.TenantId)),Object(S.a)(t,e,n)},e.createForm=function(e,n){return t.updateOrCreateFormMaster(e,n)},t}()},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"a",(function(){return b}));var i=n(2),r=n(6),o=n(4),s=n(30),a=n(25),c=n(31),u=function(){function t(t,e){this.rc=t,this.N=Object(c.i)(this.rc.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.rc.FormId},enumerable:!1,configurable:!0}),e.add=function(t){return this.rc.Form.SyncContext===a.a.AdminPhishingReviewForm?this.N.createAdminPhishingReviewPermissionLink(this.FormId,t):this.N.createPermissionLink(this.FormId,t)},e.delete=function(t){return this.N.deletePermissionLink(this.FormId,t.principalId)},e.query=function(t){return Object(s.b)("No scenario to call this method currently.")},e.update=function(t,e){if("OrgLink"===e.Snapshot.type||"Link"===e.Snapshot.type||"ShareToPeople"===e.Snapshot.type){var n={permissionSet:e.Snapshot.permissionSet,type:e.Snapshot.type};return this.rc.Form.SyncContext===a.a.AdminPhishingReviewForm?this.N.createAdminPhishingReviewPermissionLink(this.FormId,n):this.N.createPermissionLink(this.FormId,n)}return Object(s.b)("No scenario to call this method currently.")},t}(),l=n(70),h={PrincipalId:o.a.string({SourceFieldName:"principalId"}),PermissionSet:o.a.string({SourceFieldName:"permissionSet"}),Type:o.a.reference({SourceFieldName:"type"}),FormId:o.a.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.a.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.a.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.a.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.a.reference({IsLocalField:!0})};function f(t){return{PermissionSet:"Read, Write, Share",Type:t}}function d(t){return r.a.getObjectMasterFromModel(t)}var b=function(t){function e(e){var n=t.call(this,e)||this;return Object(l.b)(n),n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),e}(r.a.createObjectMasterClass("Permission",h,(function(t,e){return new u(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s})),n.d(e,"b",(function(){return g})),n.d(e,"c",(function(){return y.b})),n.d(e,"e",(function(){return d})),n.d(e,"d",(function(){return S.b}));var i=n(2),r=n(85),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);e.prototype;return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e}(r.a);function s(){return Promise.resolve(o.getInstance())}var a=n(3),c=n(6),u=n(29),l=function(){function t(t){this.L=t,this.N=Object(u.b)()}var e=t.prototype;return Object.defineProperty(e,"Master",{get:function(){return this.L},enumerable:!1,configurable:!0}),Object.defineProperty(e,"DataProvider",{get:function(){return this.N},enumerable:!1,configurable:!0}),e.add=function(t){throw Error("PhotoDataSource.add - No scenario to call this method currently.")},e.delete=function(t){throw Error("PhotoDataSource.delete - No scenario to call this method currently.")},e.query=function(t){var e=[],n=c.a.getFieldSchemaInfo(this.L.Schema.value).Name;return a.contains(t,n)&&(e.push(this.queryValue()),t=a.without(t,n)),t.length&&e.push(this.queryDefinition()),Promise.all(e).then((function(t){return a.extend.apply(a,Object(i.__spreadArrays)([{}],t))}))},e.update=function(t){throw Error("PhotoDataSource.update - No scenario to call this method currently.")},t}(),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.queryValue=function(){return this.DataProvider.getCurrentUserPhotoValue().then((function(t){return{value:t}}))},n.queryDefinition=function(){throw new Error("NotSupportQueryOfCurrentUserPhotoDefinition")},e}(l);Object(r.b)((function(t){return t instanceof o?new h(t):null}));var f=n(13);function d(t){return new Promise((function(e,n){t.ensureFieldsReady([f.a.Schema.Id,f.a.Schema.OwnerId]).then((function(){var n=t.Model.OwnerId,i=m[n];i||(i=m[n]=new b(t.Model.Id)),e(i)}),n)}))}var b=function(t){function e(e){var n=t.call(this)||this;return n.oc=e,n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"TypicalFormId",{get:function(){return this.oc},enumerable:!1,configurable:!0}),e}(r.a),m={},v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.queryValue=function(){return this.DataProvider.getFormCreatorPhotoValue(this.Master.TypicalFormId).then((function(t){return{value:t}}))},n.queryDefinition=function(){return this.DataProvider.getFormCreatorPhotoDefinition(this.Master.TypicalFormId)},e}(l);function g(t,e){var n=t+"_"+e,i=p[n];return i||(i=p[n]=new O(t,e)),i}Object(r.b)((function(t){return t instanceof b?new v(t):null}));var O=function(t){function e(e,n){var i=t.call(this)||this;return i.sc=e,i.ac=n,i}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"GroupId",{get:function(){return this.sc},enumerable:!1,configurable:!0}),Object.defineProperty(n,"MemberId",{get:function(){return this.ac},enumerable:!1,configurable:!0}),e}(r.a),p={},j=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.queryValue=function(){return this.DataProvider.getGroupMemberPhotoValue(this.Master.GroupId,this.Master.MemberId).then((function(t){return{value:t}}))},n.queryDefinition=function(){return this.DataProvider.getGroupMemberPhotoDefinition(this.Master.GroupId,this.Master.MemberId)},e}(l);Object(r.b)((function(t){return t instanceof O?new j(t):null}));var y=n(184),w=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.queryValue=function(){return this.DataProvider.getGroupPhotoValue(this.Master.GroupId).then((function(t){return{value:t}}))},n.queryDefinition=function(){return this.DataProvider.getGroupPhotoDefinition(this.Master.GroupId)},e}(l);Object(r.b)((function(t){return t instanceof y.a?new w(t):null}));var S=n(185),N=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.queryDefinition=function(){throw new Error("Method not implemented.")},n.queryValue=function(){return this.DataProvider.getUserPhotoValue(this.Master.UserId).then((function(t){return{value:t}}))},e}(l);Object(r.b)((function(t){return t instanceof S.a?new N(t):null}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(12),c=n(1),u={};function l(){return u[t="l"]||(u[t]=1),t+u[t]++;var t}var h=n(9),f=n(14),d=n(215),b=n(28),m=n(5),v=n(123),g=n(233);function O(t){return r.createElement(p,t)}var p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cc=r.createRef(),e.uc=e.lc(),e.jr=0,e.hc=!1,e.fc=!Object(a.b)(),e}Object(i.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t=this.props,e={className:"rateit margin-left office-form-theme-primary-foreground","data-rateit-icon":"","data-rateit-iconforempty":"","data-rateit-mode":"font","data-rateit-marginleft":this.uc.MarginLeft,"data-rateit-marginright":this.uc.MarginRight,"data-rateit-starwidth":this.uc.FontSize,"data-rateit-max":t.Length,"data-rateit-value":t.Value,"data-rateit-step":1,"data-rateit-resetable":!1,"data-rateit-ispreset":!0,style:{fontSize:this.uc.FontSize},ref:"rateit",key:"rateit"},n=r.createElement("div",e,this.dc());return t.ShowRatingLabel?Object(g.a)(0,this.cc,t.LeftDescription,t.RightDescription,t.LeftDescriptionTitle,t.RightDescriptionTitle,n,t.Length,10,this.bc,Object(a.g)()&&t.FormsProRTLeftDescription,Object(a.g)()&&t.FormsProRTRightDescription):[r.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:this.cc},n)]},n.componentWillMount=function(){this.bc=l(),this.mc=this.mc.bind(this)},n.componentDidMount=function(){var t=this;this.vc=Object(d.a)(),this.vc.then((function(){t.fc||(t.fc=!0,t.forceUpdate()),t.gc()})),window.addEventListener("resize",this.mc),this.Oc(null)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.mc)},n.componentDidUpdate=function(t){this.Oc(t)},n.dc=function(){if(!this.fc)return b.a.Resolve("IRatingStarsFactory").createRatingStar({NumStar:this.props.Length,Config:this.uc})},n.Oc=function(t){var e=this;this.pc()?this.forceUpdate():this.vc.then((function(){return e.jc(t)}))},n.pc=function(){var t=this.cc.current;if(t&&t.clientWidth>0){this.jr=t.clientWidth;var e=this.lc();if(!s.isEqual(e,this.uc))return this.uc=e,this.hc=!0,!0}return!1},n.gc=function(){var t=this,e=this.props,n=$(o.findDOMNode(this.refs.rateit));n.rateit(),n.on("rated",(function(){var t=n.rateit("value");t>=0&&t<=e.Length&&e.onValueChange(t)})),n.on("over",(function(e,n){return t.yc(n)}));var i=n.find(".rateit-range");if(i&&e.Options&&e.Options.HTMLPropsForInnerElement)for(var r in i.removeAttr("aria-label"),e.Options.HTMLPropsForInnerElement)i.attr(r,e.Options.HTMLPropsForInnerElement[r]);if(i){var s=i.attr("aria-labelledby");s&&(s=Object(h.b)(s,this.bc),i.attr("aria-labelledby",s))}},n.mc=function(){var t=this;this.$n||(this.$n=window.setTimeout((function(){t.$n=null,t.pc()&&t.forceUpdate()}),100))},n.jc=function(t){if(this.props.Value>this.props.Length)Object(m.b)("DesignPage.Questions.RatingValueOutOfBounds",{operation:"RatingValueOutOfBounds"});else{var e=$(o.findDOMNode(this.refs.rateit));if(!this.hc&&t&&this.props.Disabled==t.Disabled&&this.props.Value===t.Value&&this.props.Length===t.Length||(this.hc=!1,e.rateit("batchUpdate",{value:this.props.Value,max:this.props.Length,readonly:this.props.Disabled,starwidth:this.uc.FontSize,marginleft:this.uc.MarginLeft,marginright:this.uc.MarginRight}),this.yc()),this.props.NoTabFocus){var n=e.find(".rateit-range");n&&n.removeAttr("tabindex")}e.children(".rateit-range").removeAttr("aria-readonly")}},n.yc=function(t){t=t||this.props.Value||0;var e=$(o.findDOMNode(this.refs.rateit)),n=Object(c.a)().Renderer_RatingControlText.format(t);e.attr("title",n)},n.lc=function(){var t=this.props.IsRtlLanguage,e={MarginLeft:4,MarginRight:4,FontSize:24,IsRtlLanguage:t};if(this.jr>0)if(this.wc()){e.MarginLeft=4;var n=this.props.Length,i=n>6?24:28;e.FontSize=i,e.MarginRight=n<4?27:(this.jr-e.MarginLeft*(n+1)-i*n)/(n-1)}else if(this.jr>380)return{MarginLeft:5,MarginRight:5,FontSize:this.props.Compact?24:28,IsRtlLanguage:t};return e},n.wc=function(){return this.props.IsMobile||Object(f.r)()},e}(v.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return i})),n.d(e,"a",(function(){return m}));var i,r=n(2),o=n(3),s=n(6),a=n(4),c=n(13),u=n(63),l=n(29),h=function(){function t(t){this.Sc=t}var e=t.prototype;return e.add=function(t){throw Error("No scenario to call this method currently.")},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.query=function(t){var e,n=Object(l.b)();switch(this.Sc.Model.Extension){case i.Form:e="User";break;case i.GroupForm:e="Group";break;default:e=null}return n.getRecentForms(e).then((function(t){return{documents:t}}))},e.update=function(t,e){return new Promise((function(){}))},t}(),f={App:a.a.string({SourceFieldName:"app"}),Category:a.a.string({SourceFieldName:"category"}),Extension:a.a.string({SourceFieldName:"extension"}),FormCategory:a.a.string({SourceFieldName:"formCategory"}),FormType:a.a.string({SourceFieldName:"formType"}),IsPinned:a.a.boolean({SourceFieldName:"isPinned"}),MruId:a.a.string({SourceFieldName:"mruId"}),NotExist:a.a.boolean({IsLocalField:!0}),OwnerId:a.a.string({SourceFieldName:"ownerId"}),OwnerName:a.a.string({SourceFieldName:"ownerName"}),OwnerTenantId:a.a.string({SourceFieldName:"ownerTenantId"}),OwnerType:a.a.reference({SourceFieldName:"ownerType"}),ServerDocId:a.a.string({SourceFieldName:"serverDocId"}),Timestamp:a.a.string({SourceFieldName:"timestamp"}),Title:a.a.string({SourceFieldName:"title"}),Type:a.a.string({SourceFieldName:"type"}),Url:a.a.string({SourceFieldName:"url"})},d=function(t){function e(e){var n=t.call(this,e)||this;return n.Model.NotExist=!1,n}Object(r.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"FormMaster",{get:function(){return this.ua||(this.ua=Object(u.b)({Id:this.Model.ServerDocId})),this.ua},enumerable:!1,configurable:!0}),n.matchSearchStrings=function(t){var e=(this.Model.Title+" "+(this.Model.OwnerName||"")).toLowerCase();return o.all(t,(function(t){return e.indexOf(t)>=0}))},e}(s.a.createObjectMasterClass("MruDocument",f)),b={Extension:a.a.enumeration((function(){return i}),{IsLocalField:!0}),Knowledge:a.a.string({IsSourceGenerated:!0,SourceFieldName:"knowledge"}),MruDocuments:a.a.collectionOf((function(){return d}),{SourceFieldName:"documents"}),ResponseCode:a.a.string({IsSourceGenerated:!0,SourceFieldName:"responseCode"})};!function(t){t[t.Form=0]="Form",t[t.GroupForm=1]="GroupForm",t[t.Unspecified=2]="Unspecified"}(i||(i={}));var m=function(t){function e(){var e=t.call(this,{ExistingInDataSource:!0,InitialData:{Extension:i.GroupForm,Knowledge:""}})||this;return e.Nc=[],e}Object(r.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},Object.defineProperty(n,"Documents",{get:function(){return this.isFieldReady(this.Schema.MruDocuments)?s.a.convertToArray(this.Model.MruDocuments).sort((function(t,e){return Date.parse(e.Timestamp)-Date.parse(t.Timestamp)})).map((function(t){return s.a.getObjectMasterFromModel(t)})):[]},enumerable:!1,configurable:!0}),n.removeDocument=function(t){this.isFieldReady(this.Schema.MruDocuments)&&s.a.Collection.deleteItems(this.Model.MruDocuments,o.filter(this.Model.MruDocuments,(function(e){return e.ServerDocId===t})))},n.initializeFormList=function(){var t=this,n=e.Schema;return this.ensureFieldsReady([n.Knowledge,n.MruDocuments]).then((function(){o.forEach(t.Model.MruDocuments,(function(t){var e=Object(u.e)({Id:t.ServerDocId},!1);e.fieldsReady([c.a.Schema.Title]).then((function(){e.observe((function(n){n.BeingDeleted||(t.Title=e.Model.Title)}),[c.a.Schema.Title]),t.Title=e.Model.Title}))}))}),(function(){}))},n.observeListChange=function(t){if(this.Ic(t)<0){var e=function(e){(e.AddedModels.length||e.RemovedModels.length)&&t()};this.Nc.push({originCallback:t,registeredCallback:e}),this.Cc().then((function(t){return t.observe(e)}))}},n.unobserveListChange=function(t){var e=this.Ic(t);if(e>=0){var n=this.Nc[e];this.Nc.splice(e,1),this.Cc().then((function(t){return t.unobserve(n.registeredCallback)}))}},n.Cc=function(){var t=this;return this.fieldsReady([this.Schema.MruDocuments]).then((function(){return s.a.getCollectionMasterFromModel(t.Model.MruDocuments)}))},n.Ic=function(t){return o.findIndex(this.Nc,(function(e){return e.originCallback===t}))},e}(s.a.createObjectMasterClass("MruDocumentCollection",b,(function(t){return new h(t)})));Forms.Mru.MruDocumentCollectionMaster=m},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(2),r=n(6),o=n(4),s=n(14),a=n(29),c=function(){function t(t){this.N=Object(a.b)()}var e=t.prototype;return e.add=function(t){throw Error("No scenario to call this method currently.")},e.delete=function(t){throw Error("No scenario to call this method currently.")},e.update=function(t,e){return this.N.updateUserSettings(JSON.stringify(e.Snapshot))},e.query=function(t){return this.N.getUserSettings().then(s.G)},t}(),u={SampleFormStates:{PartyInvite:o.a.string()},TemplateGalleryToggleState:o.a.boolean()},l=function(t){function e(){return t.call(this,{ExistingInDataSource:!0})||this}Object(i.__extends)(e,t);e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},e}(r.a.createObjectMasterClass("UserSettings",u,(function(t){return new c(t)})))},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o})),n.d(e,"c",(function(){return s}));var i=n(57);function r(){return Object(i.d)()}function o(){return!!a("officeforms.uselegacylogindomain")}function s(t){c("officeforms.uselegacylogindomain",t?"1":null)}function a(t){return Object(i.b)().getItem(t)}function c(t,e){e?Object(i.b)().setItem(t,e):Object(i.b)().removeItem("officeforms.uselegacylogindomain")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i,r=n(7),o={};!function(t){t[t.ApiFacadeEndPoint=0]="ApiFacadeEndPoint",t[t.FormsProUIHost=1]="FormsProUIHost",t[t.FormsHomeUrl=2]="FormsHomeUrl",t[t.FormsSingleSignOnHomeUrl=3]="FormsSingleSignOnHomeUrl",t[t.FormsProCdnHomeUrl=4]="FormsProCdnHomeUrl",t[t.PreviewSettingsDefaultDate=5]="PreviewSettingsDefaultDate",t[t.FormsProGeo=6]="FormsProGeo",t[t.FormsProLicensingServiceEndPoint=7]="FormsProLicensingServiceEndPoint",t[t.FormsProSampleFormTenantId=8]="FormsProSampleFormTenantId",t[t.FormsProMSRewardsAvailableCountryCodes=9]="FormsProMSRewardsAvailableCountryCodes",t[t.FormsProCSATEndpoint=10]="FormsProCSATEndpoint",t[t.FormsProCSATTenant=11]="FormsProCSATTenant",t[t.FormsProResponseLimit=12]="FormsProResponseLimit",t[t.UIFacadeEndPoint=13]="UIFacadeEndPoint",t[t.ChatDistributionEndpoint=14]="ChatDistributionEndpoint",t[t.ProjectUIServiceEndpoint=15]="ProjectUIServiceEndpoint",t[t.FormsProResponseGridLimit=16]="FormsProResponseGridLimit",t[t.OrchestrationServiceEndpoint=17]="OrchestrationServiceEndpoint",t[t.FormsProRespondentGridMaxLimit=18]="FormsProRespondentGridMaxLimit",t[t.FormsProRespondentGridPageSize=19]="FormsProRespondentGridPageSize",t[t.SatisfactionMetricTrendAndAggregateDataUrl=20]="SatisfactionMetricTrendAndAggregateDataUrl",t[t.SatisfactionMetricMaxLimit=21]="SatisfactionMetricMaxLimit",t[t.CustomerVoiceProjectShareServiceEndpoint=22]="CustomerVoiceProjectShareServiceEndpoint",t[t.ExportCsvServiceEndpoint=23]="ExportCsvServiceEndpoint",t[t.CustomerVoiceSurveyUIServiceEndpoint=24]="CustomerVoiceSurveyUIServiceEndpoint",t[t.CurrentFlowEndpoint=25]="CurrentFlowEndpoint",t[t.CVFlowUIServiceEndPoint=26]="CVFlowUIServiceEndPoint",t[t.CVHomeVideoLinks=27]="CVHomeVideoLinks",t[t.CVDynamicsLink=28]="CVDynamicsLink",t[t.ProjectAlertServiceEndPoint=29]="ProjectAlertServiceEndPoint",t[t.CVReportingLimit=30]="CVReportingLimit",t[t.CustomerVoiceProjectShareServiceV2Endpoint=31]="CustomerVoiceProjectShareServiceV2Endpoint",t[t.CVCIServiceEndpoint=32]="CVCIServiceEndpoint"}(i||(i={})),o[i.ApiFacadeEndPoint]="https://mfpapifacadefaint.azurewebsites.net/",o[i.UIFacadeEndPoint]="https://cvsurveyuiserviceint.azurewebsites.net",o[i.FormsProUIHost]="https://mfpuiwebappint.azurewebsites.net",o[i.FormsHomeUrl]="https://forms.office-int.com",o[i.FormsSingleSignOnHomeUrl]="https://forms.office-int.com/formspro",o[i.FormsProCdnHomeUrl]="https://mfpembedcdnint.azureedge.net/mfpembedcontint/",o[i.PreviewSettingsDefaultDate]="2019-02-08",o[i.FormsProGeo]="INT",o[i.FormsProLicensingServiceEndPoint]="https://mfplicensingservicefaint.azurewebsites.net/",o[i.FormsProSampleFormTenantId]="558a6a52-809d-4de8-8b01-01a51502c93f",o[i.FormsProMSRewardsAvailableCountryCodes]="US",o[i.FormsProCSATEndpoint]="https://nps.onyx.azure.net",o[i.FormsProCSATTenant]="formspro",o[i.FormsProResponseLimit]="50000",o[i.ChatDistributionEndpoint]="https://mfpuifacadeint.projectsshimlaint.com/",o[i.ProjectUIServiceEndpoint]="https://cvuiserviceatmint.projectsshimlaint.com/",o[i.ProjectAlertServiceEndPoint]="https://mfplooptaskfadev.azurewebsites.net/",o[i.FormsProResponseGridLimit]="5000",o[i.OrchestrationServiceEndpoint]="https://cvtemplateorchfaint.azurewebsites.net/",o[i.FormsProRespondentGridMaxLimit]="500",o[i.FormsProRespondentGridPageSize]="50",o[i.SatisfactionMetricTrendAndAggregateDataUrl]="https://mfpsatisfactionmetricsapisfaint.azurewebsites.net/",o[i.SatisfactionMetricMaxLimit]="10",o[i.CustomerVoiceProjectShareServiceEndpoint]="https://cvuishareserviceint.projectsshimlaint.com/",o[i.ExportCsvServiceEndpoint]="https://mfpuasfaint.azurewebsites.net/",o[i.CustomerVoiceSurveyUIServiceEndpoint]="https://cvsurveyuiserviceint.azurewebsites.net/",o[i.CurrentFlowEndpoint]="https://us.tip1.flow.microsoft.com/",o[i.CVFlowUIServiceEndPoint]="https://cvflowfaint.azurewebsites.net/",o[i.CVHomeVideoLinks]="https://youtu.be/Mctc8pc6q_A,https://youtu.be/se5fCA9IptI,https://youtu.be/jLdw_TSqolA",o[i.CVDynamicsLink]="https://dynamics.microsoft.com/en-us/customer-voice/overview/",o[i.CVReportingLimit]="500000",o[i.CustomerVoiceProjectShareServiceV2Endpoint]="https://cvuisharev2faint.azurewebsites.net/",o[i.CVCIServiceEndpoint]="https://cvcifaint.azurewebsites.net/";var s=function(){function t(){}t.prototype;return t.getSetting=function(e){var n=t.webSettingsMap[i[e].toString()];if(!n){var r=o[e];n=r||t.defaultValue}return n},t.webSettingsJson=decodeURI(Object(r.a)().webSettings||"{}"),t.webSettingsMap=JSON.parse(t.webSettingsJson),t.defaultValue="",t}();function a(){return s.getSetting(i.FormsProCdnHomeUrl)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return s}));var i=n(36);function r(t){var e,n,r,s,a,c;try{c=(null===(e=t.response)||void 0===e?void 0:e.body)&&JSON.parse(t.response.body)}catch(e){c={error:{code:"15001",message:null===(n=t.response)||void 0===n?void 0:n.body}}}var u=(null===(r=c.error)||void 0===r?void 0:r.code)&&parseInt(c.error.code),l=t&&t.response&&t.response.statusCode;if(isNaN(u))switch(l){case 0:u=15001;break;case 429:u=15429}return{correlationId:Object(i.c)(null===(s=null==t?void 0:t.response)||void 0===s?void 0:s.headers,"X-CorrelationId"),headers:null===(a=null==t?void 0:t.response)||void 0===a?void 0:a.headers,statusCode:t&&t.response&&t.response.statusCode,statusText:t&&t.response&&t.response.statusText,innerMessage:c.error&&c.error.message,type:o(l,c),customizedMessage:c.error&&c.error["@ms.form.error.customizedMessage"],isServerError:!0,innerCode:u}}function o(t,e){var n=e.error&&e.error["@ms.form.error.type"];if(!n){n=t>=0&&t<500?"ExpectedFailure":"Failure"}return n}function s(t,e){var n,o,s,a=r(e),c={statusCode:e&&e.response?e.response.statusCode:"",correlationId:Object(i.c)(null===(n=null==e?void 0:e.response)||void 0===n?void 0:n.headers,"X-CorrelationId"),statusText:e&&e.response?e.response.statusText:"",innerCode:a?a.innerCode:-1,innerMessage:a?a.innerMessage:"",failureReason:Object(i.c)(null===(o=null==e?void 0:e.response)||void 0===o?void 0:o.headers,"X-FailureReason"),failureType:a?a.type:void 0,afdRef:Object(i.c)(null===(s=null==e?void 0:e.response)||void 0===s?void 0:s.headers,"X-MSEdge-Ref")};return t&&(c.sourceUrl=t),c}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(29),r=n(33),o=n(5),s=new(function(){function t(){}var e=t.prototype;return e.initialize=function(){return c()?(t.variations||(this.kc=Object(i.b)(),t.variations=this.kc.experimentationGetVariations().then((function(t){return Object(o.b)("Experiment.Initialize",{Variations:t}),t}))),t.variations):Promise.resolve(void 0)},e.activate=function(t){var e=this;return c()?s.initialize().then((function(n){var i=n&&n[t];return e.kc.experimentationActivate(t).then((function(e){Object(o.b)("Experiment.Activate",{ExperimentKey:t,Variation:i,VariationMismatch:e!==i?e:void 0})})),i})):Promise.resolve(null)},e.track=function(t,e){var n=this;c()&&s.initialize().then((function(i){n.kc.experimentationTrack(t,e).then((function(){var e=i&&i[t];Object(o.b)("Experiment.Track",{ExperimentKey:t,Variation:e})}))}))},t}());function a(){return s}function c(){return Object(r.a)().Flighting.isEnabled_Deprecated("EnableExperimentation")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=""},function(t,e,n){"use strict";n.d(e,"d",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return u})),n.d(e,"b",(function(){return l}));var i=n(15),r=n(207),o=n(14),s=n(98);function a(t){return h(Object(i.j)()+"/users/"+t)}function c(t){return h(Object(i.j)()+"/groups/"+t)}function u(t){return h(Object(i.j)()+"/me/checkMemberGroups","POST",'{"groupIds": ["'+t+'"] }')}function l(t){return h(Object(i.j)()+"/directory/deletedItems/"+t)}function h(t,e,n){return void 0===e&&(e="GET"),void 0===n&&(n=null),Object(r.b)((function(i){var r={body:n,headers:{Authorization:i,"Content-Type":"application/json"},method:e,requestUri:t};return Object(s.a)(r,{disableLog:!0,disableXMsHeader:!0,skipExpiredTokenCheck:!0})})).then(o.G)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(9);function s(t){return r.createElement(a,t)}var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){return[this.Tc(),this.kt()].concat(this.props.children)},n.kt=function(){var t=this.props.Options,e=t&&t.classNameForInnerLabel;return this.props.Disabled&&(e=Object(o.b)(e,"disabled")),this.props.Label&&!this.props.HideText?r.createElement("span",{className:e},this.props.Label):void 0},n.Tc=function(){var t=this.props,e=t.Options,n=Object(o.b)(e&&e.classNameForInnerDiv,t.Disabled?"toggle-button disabled":"toggle-button",t.Value?"office-form-theme-toggle active":void 0);return r.createElement("div",{className:n,tabIndex:t.Disabled?-1:0,role:"button","aria-label":t.Label,"aria-pressed":!!t.Value,onClick:t.Disabled?function(){}:function(){t.onValueChange(!t.Value)},onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||t.onValueChange(!t.Value)}})},e}(n(123).a)},function(t,e,n){"use strict";n.d(e,"c",(function(){return c})),n.d(e,"b",(function(){return u})),n.d(e,"a",(function(){return l}));var i,r=n(3),o=n(6),s=n(77),a=n(133);function c(){return i||(i=Object(s.f)().then((function(t){var e={};for(var n in t)n&&-1!==n.indexOf("Suggest")&&(e[n]=t[n]);return e}))),i}function u(t){var e,n=Object(a.b)(t);return n&&n.Model?(e=o.a.convertToArray(n.Model.suggestions),c().then((function(t){return l(e,t)})).catch((function(t){return[]}))):Promise.resolve([])}function l(t,e){if(!e||!t||0===t.length)return[];for(var n=[],i=[],o=0,a=t;o<a.length;o++){var c=a[o];for(var u in e)if(e[u].Tag){if(n.length>=10)break;var l=Object(s.e)(e[u]);l.Tag.High.indexOf(c)>=0?n.push(l):l.Tag.General.indexOf(c)>=0&&i.push(l)}}for(var h=n.length,f=0;f<i.length&&!(h>=10);h++,f++)n.push(i[f]);return r.unique(n,(function(t){return t.Name}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(2),r=n(0),o=n(1),s=n(87),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t={ButtonsProps:[{ClassName:"design-question-delete-continue-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:this.props.clickCancelButton,Text:Object(o.a)().Common_Cancel_Text,Title:Object(o.a)().Designer_Cancel_Text},{ClassName:"design-question-delete-continue-button",GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.props.clickDeleteQuestion,Text:Object(o.a)().Common_Yes_Text,Title:Object(o.a)().Designer_Continue_Text}],ClassName:this.props.ClassName?this.props.ClassName:"design-question-button-container",Description:this.props.Description?this.props.Description:Object(o.a)().Designer_DeleteQuestion_Warning_Text,key:"deleteConfirmDialog",ShowDialog:!0};return r.createElement("div",{className:"design-question-confirm-dialog"},Object(s.b)(t))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return a})),n.d(e,"c",(function(){return c})),n.d(e,"a",(function(){return u}));var i=n(41),r=n(15),o=n(7),s=n(47);function a(){var t=Object(o.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(i.b)())}function c(){var t=Object(o.a)().userInfo.TenantId;return!(!t||t.toLowerCase()!==Object(r.k)())}function u(){var t=Object(o.a)().userLicenseInfo;return Object(s.r)((null==t?void 0:t.licenses)||[],!!(null==t?void 0:t.isPaidUser)),Object(s.e)()}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i,r=n(5),o=n(127),s=n(7),a=n(26);function c(t){return function(t){return new Promise((function(e,n){void 0===i&&(i={DesignPage:Object(a.c)(Object(s.a)().scriptName+".min.css",!0),DesignPageRtl:Object(a.c)(Object(s.a)().scriptName+".rtl.min.css",!0),MobileDesignPage:Object(a.c)(Object(s.a)().scriptName+".min.css",!0),MobileDesignPageRtl:Object(a.c)(Object(s.a)().scriptName+".rtl.min.css",!0),ResponsePage:Object(a.c)(Object(s.a)().responsePageCssName+"min.css",!0),ResponsePageRtl:Object(a.c)(Object(s.a)().responsePageCssName+"rtl.min.css",!0)});var c=i[o.a[t]];if(!c)throw Error("No path for "+o.a[t]);var u=document.getElementsByTagName("head")[0];if(!u)return n(Error("No head element found!"));var l=document.createElement("link");l.rel="stylesheet",l.href=c;var h=document.getElementById("form-page-css"),f=$(h).attr("href");if(f&&c.toLowerCase()===f.toLowerCase())return e();u.removeChild(h),l.id="form-page-css",l.onload=function(t){return e()},l.onerror=function(){u.removeChild(l),Object(r.b)("Error.CssLoadingError.FailedToLoadCss",{name:o.a[t],url:c}),n(Error("Failed to load css file: "+c))},u.appendChild(l),u.appendChild(l)}))}(t)}},function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"c",(function(){return f})),n.d(e,"a",(function(){return d}));var i=n(2),r=n(6),o=n(4),s=n(30),a=n(31),c=function(){function t(t,e){this.rc=t,this.N=Object(a.i)(this.rc.Form)}var e=t.prototype;return Object.defineProperty(e,"FormId",{get:function(){return this.rc.FormId},enumerable:!1,configurable:!0}),e.add=function(t){return this.N.createResponderPermissionLink(this.FormId,t)},e.delete=function(t){return this.N.deleteResponderPermissionLink(this.FormId,t.principalId)},e.query=function(t){return Object(s.b)("No scenario to call this method currently.")},e.update=function(t,e){return Object(s.b)("No scenario to call this method currently.")},t}(),u=n(70),l={PrincipalId:o.a.string({SourceFieldName:"principalId"}),PermissionSet:o.a.string({SourceFieldName:"permissionSet"}),Type:o.a.reference({SourceFieldName:"type"}),FormId:o.a.string({IsSourceGenerated:!0,SourceFieldName:"formId"}),IsOwner:o.a.boolean({IsSourceGenerated:!0,SourceFieldName:"isOwner"}),PrincipalEmailAddress:o.a.string({IsSourceGenerated:!0,SourceFieldName:"principalEmailAddress"}),PrincipalName:o.a.string({IsSourceGenerated:!0,SourceFieldName:"principalName"}),SavingState:o.a.reference({IsLocalField:!0})};function h(t){return{PermissionSet:"DataCreator",Type:t}}function f(t){return r.a.getObjectMasterFromModel(t)}var d=function(t){function e(e){var n=t.call(this,e)||this;return Object(u.b)(n),n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent.Parent},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormId",{get:function(){return this.Form.Model.Id},enumerable:!1,configurable:!0}),e}(r.a.createObjectMasterClass("ResponderPermission",l,(function(t,e){return new c(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return j}));var i=n(2),r=n(0),o=n(15),s=n(12),a=n(35),c=n(9),u=n(92),l=n(14),h=n(10),f=n(60),d=n(8),b=n(7),m=n(111),v=n(28),g=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!1,n.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839"},n.xc=n.xc.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.ce=!0,v.a.Resolve("IBootEvent").addBootCompleteListener((function(){return t.xc()}))},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t={className:Object(l.w)()?"office-form-theme-spo-link":void 0,href:this.state.PrivacyUrl,target:"_blank"},e="MSFT"!==Object(b.a)().ring||this.props.IsAnonymous?this.state.PrivacyUrl?this.props.LocalizedStrings.Form_Footer_PrivacyStatement:this.props.LocalizedStrings.Form_Footer_AnonymousPrivacyStatement:this.props.LocalizedStrings.Form_Footer_DataPrivacyNotice;return r.createElement("div",{className:this.props.Multiline?"office-form-footer-block":"office-form-footer-inline"},this.state.PrivacyUrl?r.createElement("a",Object(i.__assign)({},t),e):e)},n.xc=function(){var t=this;Object(m.c)().then((function(e){t.ce&&t.setState({PrivacyUrl:e||""})}))},e}(d.a),O=n(224),p=n(142),j=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Fc=!1,e}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props.TopExtraContent&&r.createElement("div",{className:"office-form-footer-block"},this.props.TopExtraContent),n=Object(c.b)("office-form-footer-container office-form-padding-align",this.props.HTMLAttributes&&this.props.HTMLAttributes.className),i=this.props.FooterText;i=Object(a.m)(i,!1);this.Fc&&Object(s.c)("FormsProCustomFooter"),this.Fc&&Object(s.c)("FormsProCustomFooter");return r.createElement(f.a.Consumer,null,(function(i){var o=i.LocalizedStrings;return r.createElement("div",{className:"office-form-footer office-form-theme-footer",role:"contentinfo"},r.createElement("div",{className:n},e,Object(h.c)((function(){return function(t,e,n){switch(n){case"ShowStatement":return r.createElement("div",{className:"office-form-footer-block"},Object(a.g)(t));case"ShowStatementWithNotice":return r.createElement("div",{className:"office-form-footer-block"},Object(a.g)(e));default:return null}}(o.Response_Page_Footer_Statement_2,o.Response_Page_Footer_Statement,t.props.FooterType)||!1}),h.f),Object(h.c)((function(){return t.Pc(o)}),h.f),function(){if(Object(s.d)())return r.createElement("div",{id:"form-bottom-sentinel",className:"office-form-bottom-sentinel"})}()))}))},n.Pc=function(t){if(!Object(u.e)()){return r.createElement("div",{className:"office-form-footer-block"},(e=t.Form_Footer_Powered,Object(l.w)()?(s=e,a={className:Object(l.w)()?"office-form-theme-spo-link":void 0,href:window.location.origin,target:"_blank"},r.createElement("div",{className:"office-form-footer-inline-without-margin"},r.createElement("a",Object(i.__assign)({},a),s))):(n=e,r.createElement("div",{className:"office-form-footer-inline-without-margin"},n)))," | ",r.createElement(g,{LocalizedStrings:t,IsAnonymous:this.props.FormMaster?this.props.FormMaster.Model.Settings.IsAnonymous:null})," | ",r.createElement(p.a,{FormMaster:this.props.FormMaster,LocalizedStrings:t,ForceUseCommercialTermsLink:this.props.ForceUseCommercialTermsLink}),Object(o.t)(this.props.LocaleId)&&" | ",Object(o.t)(this.props.LocaleId)&&r.createElement(O.a,{LocalizedStrings:t}))}var e,n,s,a},n.Dc=function(t){},e}(d.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var i=n(2);function r(t){return Promise.resolve(function(t){var e=s[t];e||(e=s[t]=new o(t));return e}(t))}var o=function(t){function e(e){var n=t.call(this)||this;return n.sc=e,n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"GroupId",{get:function(){return this.sc},enumerable:!1,configurable:!0}),e}(n(85).a);var s={}},function(t,e,n){"use strict";n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}));var i=n(2);function r(t){return Promise.resolve(function(t){var e=s[t];e||(e=s[t]=new o(t));return e}(t))}var o=function(t){function e(e){var n=t.call(this)||this;return n.ac=e,n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"UserId",{get:function(){return this.ac},enumerable:!1,configurable:!0}),e}(n(85).a);var s={}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(41),r=n(10),o=n(15);function s(){if(!Object(i.d)())return"https://forms.office-int.com/";var t;switch(Object(i.a)()){case"USDoDProd":t="https://forms.osi.apps.mil/";break;case"USGovProd":t="https://forms.osi.office365.us/";break;case"USGovGccProd":t=Object(i.c)()?"https://forms.microsoft.com/":Object(o.r)()?"https://customervoice.microsoft.us/":"https://forms.office.com/";break;case"WWProd":t=Object(r.c)((function(){return"https://forms.office.com/"}),r.f);break;case"MSProd":t="https://forms.microsoft.com/";break;case"ProTip":t="https://tip.forms.office.com/";break;case"CVProd":t="https://customervoice.microsoft.com/";break;case"CVTip":t="https://tip.customervoice.microsoft.com/";break;case"CVFastfood":t="https://msit2.customervoice.microsoft.com/";break;default:t="https://"+window.location.host+"/"}return t}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){function t(t){var e=this;this.prefetchPromise=new Promise((function(t,n){e.prefetchResolve=t,e.prefetchReject=n})),this.cache=t}var e=t.prototype;return e.init=function(){if(this.cache)switch(this.cache.state){case 3:this.onPrefetchSucceed();break;case 4:this.onPrefetchFaied();break;case 2:this.cache.successCallback=this.onPrefetchSucceed.bind(this),this.cache.errorCallback=this.onPrefetchFaied.bind(this);break;default:this.fallBackToNormalBoot()}else this.fallBackToNormalBoot()},e.getPromise=function(){return this.prefetchPromise},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var i=n(2),r=n(6),o=n(4),s=n(1),a=n(31),c=n(119),u={LockGivenQuestionsEndDisplayOrder:o.a.number(),LockGivenQuestionsStartDisplayOrder:o.a.number(),FormClosed:o.a.boolean(),FormClosedMessage:o.a.string(),FormClosedMessageChanged:o.a.boolean(),TimerEnabled:o.a.boolean(),TimerEnabledStart:o.a.boolean(),TimerEnabledEnd:o.a.boolean(),StartTime:o.a.string(),EndTime:o.a.string(),RequiresUniqueResponse:o.a.boolean(),IsAnonymous:o.a.boolean(),NotRecordIdentity:o.a.boolean(),ShuffleAllQuestions:o.a.boolean(),ShuffleQuestionOrder:o.a.boolean(),ShowGradedResults:o.a.boolean(),RespondInAppOnly:o.a.boolean(),AllowCopy:o.a.boolean(),ShareToken:o.a.string(),ManualGradingEnabled:o.a.boolean(),IsQuizMode:o.a.boolean(),EmailNotification:o.a.boolean(),AllowResponderGetAllResponses:o.a.boolean(),ShowQuestionNumbers:o.a.boolean(),IsEmailableEntityCreationEnabled:o.a.boolean(),CDSSyncQuestionResponses:o.a.boolean(),OverSurveySettingEnabled:o.a.boolean(),InvitesCoolingPeriod:o.a.number(),EmailableEntity:o.a.string(),HideLanguageDropdown:o.a.boolean()},l=function(t){function e(n){var i=t.call(this,n)||this;return i.addRule({Name:"updateClosedMessage",InterestedFields:[i.Schema.FormClosed],onChange:e.updateClosedMessage}),i.addRule({Name:"updateAllowCopy",InterestedFields:[i.Schema.ShareToken],onChange:e.updateAllowCopy}),i}Object(i.__extends)(e,t);var n=e.prototype;return e.serialize=function(t){var e=r.a.convertToSourceData(t,this.Schema),n=0;return Object.keys(e).forEach((function(t){null==e[t]?delete e[t]:++n})),n>0?JSON.stringify(e):null},n.getFormStatus=function(){var t=this.Model;if(t.FormClosed)return c.a.Closed;if(t.TimerEnabled){var e=Date.now();if(null!=t.StartTime&&Date.parse(t.StartTime)>e)return c.a.NotStarted;if(null!=t.EndTime&&Date.parse(t.EndTime)<e)return c.a.Expired}return c.a.Opened},n.getFormClosedMessage=function(){var t=this.Model;switch(this.getFormStatus()){case c.a.Closed:return t.FormClosedMessage;case c.a.NotStarted:return Object(s.a)().FormSetting_NotStartForm_DefaultMessage.format(new Date(t.StartTime).toLocaleString());case c.a.Expired:return Object(s.a)().FormSetting_ExpiredForm_DefaultMessage;default:return}},n.setSharingStatus=function(t,e){var n=this,i=this.Parent,r=Object(a.i)(i);return i.existingOnServerSide().then((function(){return r.changeSharingStatus(i.Model.Id,e)})).then((function(t){n.Model.ShareToken=t}))},e.updateClosedMessage=function(t){if(-1===t.FieldSchemas.indexOf(e.Schema.FormClosedMessage)){var n=t.Master.Model;n.FormClosed?null!=n.FormClosedMessage&&Object(s.d)().then((function(t){return n.FormClosedMessage=t.FormSetting_ClosedForm_DefaultMessage})):n.FormClosedMessage=null}},e.updateAllowCopy=function(t){var e=t.Master.Model;e.AllowCopy=!!e.ShareToken},e}(r.a.createObjectMasterClass("FormSettingsMaster",u))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(2),r=n(1),o=n(100),s=n(17),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.MatrixChoiceGroup"},e.createDefaultDefinition=function(){var t=[{Description:Object(r.a)().Designer_Choices_DefaultDescription.format(1),IsGenerated:!0,Id:1,Order:1},{Description:Object(r.a)().Designer_Choices_DefaultDescription.format(2),IsGenerated:!0,Id:2,Order:2},{Description:Object(r.a)().Designer_Choices_DefaultDescription.format(3),IsGenerated:!0,Id:3,Order:3},{Description:Object(r.a)().Designer_Choices_DefaultDescription.format(4),IsGenerated:!0,Id:4,Order:4},{Description:Object(r.a)().Designer_Choices_DefaultDescription.format(5),IsGenerated:!0,Id:5,Order:5}];return{Type:e.getElementTypeName(),Title:Object(r.a)().Question_DefaultTitle,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},e.createSubQuestionsDefinition=function(){return[{Title:Object(r.a)().Desinger_Likert_DefaultDescription.format(1),Type:"Question.MatrixChoice"},{Title:Object(r.a)().Desinger_Likert_DefaultDescription.format(2),Type:"Question.MatrixChoice"}]},n.verify=function(t){return s.e.Success},n.getTypeDisplayName=function(){return Object(r.a)().QuestionType_Likert},n.hasAnswer=function(){return!1},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(3);function r(t,e,n){for(var r=t,o=function(t){var e=t+" ",n=1,i=t.lastIndexOf("(");t&&")"===t.slice(-1)&&i>=0&&parseInt(t.slice(i+1,t.length-1))&&(n=parseInt(t.slice(i+1,t.length-1)),e=t.slice(0,i));return{BaseName:e,Count:n}}(t);i.contains(n,r);)r=e.format(o.BaseName,++o.Count);return r}},function(t,e,n){"use strict";n.r(e),n.d(e,"getIoCQuestionSuggestionClass",(function(){return j})),n.d(e,"UserInteractionSuggestionCard",(function(){return y})),n.d(e,"logQuestionSuggestionSeen",(function(){return w}));var i,r=n(2),o=n(0),s=n(3),a=n(1),c=n(11),u=n(156),l=n(28),h=n(13),f=n(5),d=n(248),b=n(16),m=n(249),v=n(24),g=n(61),O=n(8),p=n(208);!function(t){t[t.QuestionBank=0]="QuestionBank",t[t.HistorySuggestion=1]="HistorySuggestion",t[t.Default=2]="Default"}(i||(i={}));function j(){return l.a.Resolve("IIntelligenceQuestionSuggestion")}var y=function(t){function e(e){var n=t.call(this,e)||this;return n.Mc=6,n.Lc=3,n.Ac=Object(c.b)(),n.Rc=j(),n.Ec=n.Ec.bind(n),n.Bc=n.Bc.bind(n),n._c=n._c.bind(n),n.Hc=n.Hc.bind(n),n.Gc=n.Gc.bind(n),n.qc=n.qc.bind(n),n.Qc=n.Qc.bind(n),n.Vc=n.Vc.bind(n),n.zc=n.zc.bind(n),n.Uc=n.Uc.bind(n),n.$c=n.$c.bind(n),n.Wc=n.Wc.bind(n),n.Kc=n.Kc.bind(n),n.Jc=n.Jc.bind(n),n.Xc=n.Xc.bind(n),n.Oe=n.Oe.bind(n),n.Zc=n.Zc.bind(n),n.state={ShowSuggestionLoading:!1,ShowToast:!1},n}Object(r.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(r.__generator)(this,(function(e){switch(e.label){case 0:switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"InSessionHistoryAndBank":this.Ac.Model.IntelligeceQuestionSuggestionStatus="ShowHistoryAndBank";break;case"InSessionBankAndHistory":this.Ac.Model.IntelligeceQuestionSuggestionStatus="ShowBankAndHistory";break;case"InSessionBank":this.Ac.Model.IntelligeceQuestionSuggestionStatus="ShowBank";break;case"InSessionHistry":this.Ac.Model.IntelligeceQuestionSuggestionStatus="ShowHistory";break;default:this.Xc()}switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"Default":return[3,1];case"ShowHistoryAndBank":case"ShowHistory":return[3,3];case"ShowBankAndHistory":case"ShowBank":return[3,4]}return[3,5];case 1:return[4,this.Yc().then((function(){t.tu()})).catch((function(t){console.error(t)}))];case 2:return e.sent(),[3,6];case 3:return[3,6];case 4:return this.tu(),[3,6];case 5:return[3,6];case 6:return this.props.Form.observe(this.Xc,[h.a.Schema.Title]),this.Ac.observe(this.Oe,[this.Ac.Schema.IntelligeceQuestionSuggestionStatus,this.Ac.Schema.CollapseIntelligenceSuggestionCard]),[2]}}))}))},n.componentWillUnmount=function(){window.clearTimeout(this.nu),window.clearTimeout(this.iu),this.props.Form.unobserve(this.Xc),this.Ac.unobserve(this.Oe)},n.render=function(){switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowHistory":case"ShowHistoryAndBank":case"ShowBank":case"ShowBankAndHistory":return this.Ac.Model.CollapseIntelligenceSuggestionCard?this.Vc():o.createElement("div",{className:"form-intelligence-container office-form-theme-focus-border office-form-theme-border-top",key:"formIntelligenceCardContainer",id:"form-intelligence-question-suggestion-card",tabIndex:-1},this.ou(),this.su(),!!this.Rc.MoreSuggestion.length&&this.zc(),this.au());default:return null}},n.Oe=function(){this.forceUpdate()},n.ou=function(){var t="",e=null;switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowHistoryAndBank":case"ShowHistory":t=Object(a.a)().Designer_Intelligence_History_Suggest_Relevant.format(this.Rc.HistoryFormTitle),e=this.Gc();break;case"ShowBankAndHistory":case"ShowBank":t=Object(a.a)().Intelligence_Question_Suggestion_Title}var n=o.createElement("div",{className:"question-suggestion-header-text-container"},o.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),o.createElement("div",{className:"question-suggestion-header-text"},t),null);return o.createElement("div",{className:"question-suggestion-header-container"},n,o.createElement("div",{className:"question-suggestion-header-button-container"},o.createElement("div",{className:"form-intelligence-header-buttons"},e,this.qc())))},n.Gc=function(){return Object(v.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"question-suggestion-header-button-add-all",onClick:this.Bc},Text:Object(a.a)().Designer_Intelligence_AddAll})},n.qc=function(){return Object(b.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this.$c},Icon:"Cancel",IconClassName:"forms-icon-size14x14"})},n.su=function(){var t=this,e=this.props.Form.FormElementManager,n=null,i=null;switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowHistory":case"ShowHistoryAndBank":i=null,n=this.Rc.HistorySuggestion.filter((function(t){return!e.QuestionMasters.find((function(e){return e.Model.Title===t.Title}))})).map((function(e,n){return Object(u.e)({addQuestion:t.Ec,Index:n,key:e.Id,Question:e})}));break;case"ShowBank":case"ShowBankAndHistory":n=null,i=this.Rc.BankSuggestion.filter((function(t){return!e.QuestionMasters.find((function(e){return e.Model.Title===t.Title}))})).map((function(e,n){return Object(u.e)({addQuestion:t.Ec,Index:n,key:e.Id,Question:e})}))}return o.createElement("div",{className:"form-intelligence-user-interaction-question-group",key:"formIntelligenceGroup",role:"group"},n,i,this.state.ShowSuggestionLoading&&this.Qc(),this.state.ShowToast&&this.Uc())},n.zc=function(){switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowBank":case"ShowBankAndHistory":return Object(v.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"form-intelligence-question-suggestion-more",onClick:this.Jc},Text:Object(a.a)().Intelligence_Question_Suggestion_More});default:return null}},n.Qc=function(){var t=this.Rc.BankSuggestion.length>=this.Mc?"form-intelligence-question-suggestion-loading-cover":"form-intelligence-question-suggestion-loading";return this.Rc.MoreSuggestion.length&&(t="form-intelligence-question-suggestion-loading-cover-with-more"),Object(d.a)({ClassName:t})},n.Uc=function(){var t=Object(a.a)().Intelligence_Question_Suggestion_Toast_Message,e={ClassName:this.Rc.MoreSuggestion.length?"form-intelligence-question-suggestion-toast":null,closeToast:this.Wc,Message:t,TimerInMs:3500,ToastStyle:"Dark"};return o.createElement(m.a,Object(r.__assign)({},e))},n.Vc=function(){var t=Object(b.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-expand-button-icon",onClick:this.Hc},Icon:"LightningBolt",IconClassName:"forms-icon-size16x16"});return o.createElement("div",{className:"form-intelligence-header-expand-button",onClick:this.Hc},t)},n.Kc=function(){var t=$(".form-intelligence-user-interaction-question-group")[0];t?t.scrollHeight-t.offsetHeight-t.scrollTop>28&&this.setState({ShowToast:!0}):this.Rc.BankSuggestion.length>this.Mc&&this.setState({ShowToast:!0})},n.Wc=function(){this.setState({ShowToast:!1})},n.$c=function(){switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowHistory":case"ShowHistoryAndBank":this.Ac.Model.IntelligeceQuestionSuggestionStatus="Default",this.forceUpdate();break;case"ShowBank":case"ShowBankAndHistory":this._c()}},n._c=function(){this.Ac.Model.CollapseIntelligenceSuggestionCard=!0,this.Xc(),this.tu()},n.Hc=function(){this.Ac.Model.CollapseIntelligenceSuggestionCard=!1},n.tu=function(){var t=this;switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowBank":case"ShowBankAndHistory":case"ShowHistoryAndBank":this.setState({ShowSuggestionLoading:!0},(function(){t.Rc.askSuggestion(t.props.Form,t.props.InsertAfter).then((function(){t.setState({ShowSuggestionLoading:!1},(function(){t.Kc()}))}))}));break;default:this.Rc.askSuggestion(this.props.Form,this.props.InsertAfter).then((function(){t.Oe()}))}},n.Jc=function(){var t=this;if(this.Rc.MoreSuggestion.length){var e=this.Rc.MoreSuggestion.slice(0,this.Lc),n=s.union(this.Rc.BankSuggestion,e);window.clearTimeout(this.nu),w(n,this.Rc.IntelligenceQuestionBankOutput),this.setState({ShowSuggestionLoading:!0},(function(){t.nu=window.setTimeout((function(){t.Rc.BankSuggestion=n,t.Rc.MoreSuggestion=t.Rc.MoreSuggestion.slice(t.Lc,t.Rc.MoreSuggestion.length),t.setState({ShowSuggestionLoading:!1,ShowToast:!0})}),1e3)}))}},n.Ec=function(t,n){var r,o=this.props.Form.FormElementManager;if("Question.MatrixChoiceGroup"===(t=s.clone(t)).Type){var a=[];switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowHistory":case"ShowHistoryAndBank":a=this.Rc.HistorySuggestion;break;case"ShowBank":case"ShowBankAndHistory":a=this.Rc.SubQuestionCollection}r=a.filter((function(e){return e.GroupId===t.Id})).map((function(t){var e=s.clone(t);return delete e.Id,e}))}var c=function(t){switch(t){case"InSessionHistoryAndBank":case"InSessionHistry":case"ShowHistoryAndBank":case"ShowHistory":return i.HistorySuggestion;case"InSessionBankAndHistory":case"InSessionBank":case"ShowBankAndHistory":case"ShowBank":return i.QuestionBank;default:return i.Default}}(this.Ac.Model.IntelligeceQuestionSuggestionStatus);if(c===i.QuestionBank?S(t,n,this.Rc.IntelligenceQuestionBankOutput):c===i.HistorySuggestion&&S(t,n,this.Rc.IntelligenceHistoryOutPut),delete t.Id,null!==this.props.InsertAfter){var u="Title"===this.props.InsertAfter?null:this.props.InsertAfter,l=o.insertElementAfter(t,u,r);switch(this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowHistoryAndBank":this.Ac.Model.IntelligeceQuestionSuggestionStatus="InSessionHistoryAndBank";break;case"ShowBankAndHistory":this.Ac.Model.IntelligeceQuestionSuggestionStatus="InSessionBankAndHistory";break;case"ShowHistory":this.Ac.Model.IntelligeceQuestionSuggestionStatus="InSessionHistry";break;case"ShowBank":this.Ac.Model.IntelligeceQuestionSuggestionStatus="InSessionBank"}this.props.designElement(l)}else switch(o.appendElement(t,r),e.autoScrollDown(),this.Ac.Model.IntelligeceQuestionSuggestionStatus){case"ShowBank":case"ShowBankAndHistory":this.tu()}c===i.HistorySuggestion?(this.Rc.HistorySuggestion=this.Rc.HistorySuggestion.filter((function(e){return e.Title!==t.Title})),this.Rc.HistorySuggestion.length||(this.Ac.Model.IntelligeceQuestionSuggestionStatus="Default")):c===i.QuestionBank&&(g.a.logUserSignal({AdoptQuestions:[t.QuestionTagForIntelligence],FormId:this.props.Form.Model.Id,UserSignalType:2}),this.Rc.BankSuggestion=this.Rc.BankSuggestion.filter((function(e){return e.QuestionTagForIntelligence!==t.QuestionTagForIntelligence})),this.Rc.BankSuggestion.length||(this.Ac.Model.IntelligeceQuestionSuggestionStatus="Default"))},n.Bc=function(){var t=this,e=this.props.Form.FormElementManager;this.Rc.HistorySuggestion.forEach((function(n,i){S(n=s.clone(n),i,t.Rc.IntelligenceHistoryOutPut),delete n.Id,e.appendElement(n,void 0)})),this.Rc.HistorySuggestion=[],this.Ac.Model.IntelligeceQuestionSuggestionStatus="Default",this.forceUpdate(),this.props.designElement(null)},n.Xc=function(){this.Rc.Initialize(),this.forceUpdate()},n.Yc=function(){return Object(r.__awaiter)(this,void 0,void 0,(function(){var t,e=this;return Object(r.__generator)(this,(function(n){t=l.a.Resolve("ITemplateQuestions");try{t.then((function(t){e.Rc.TemplateQuestions=t.Item_1,e.Rc.SubQuestionCollection=t.Item_2,Promise.resolve()}))}catch(t){return[2,Promise.reject(t)]}return[2]}))}))},e.autoScrollDown=function(){var t=document.getElementById("body-scrollable-content");t.scrollTop=t.scrollHeight},n.au=function(){var t=this.Ac.Model.IntelligeceQuestionSuggestionStatus;if("ShowBankAndHistory"===t||"ShowHistoryAndBank"===t)return o.createElement("div",{className:"question-suggestion-card-gallery"},o.createElement("div",{className:"question-suggestion-card-gallery-dots-container"},o.createElement(p.a,{changeGalleryDot:this.Zc,Index:0,key:0,Selected:"ShowHistoryAndBank"===t}),o.createElement(p.a,{changeGalleryDot:this.Zc,Index:1,key:1,Selected:"ShowBankAndHistory"===t})))},n.Zc=function(t){0===t?this.Ac.Model.IntelligeceQuestionSuggestionStatus="ShowHistoryAndBank":1===t&&(this.Ac.Model.IntelligeceQuestionSuggestionStatus="ShowBankAndHistory")},e}(O.a);function w(t,e){if(t&&t.length>0&&e){Object(f.b)("Intelligence."+e.Feature+".Seen",{ActionSubCategory:"Show",DetectedLanguage:e.DetectedLang,Feature:e.Feature,ModelName:e.ModelName,Variation:e.Variation});var n=[];n.push(t.map((function(t){return t.Id})));var i=e.ExtraData;i&&i.Scores&&(i.Scores=[]),Object(f.b)("IntelligenceStatistic."+e.Feature+".Seen",{ActionSubCategory:"Show",DetectedLanguage:e.DetectedLang,ExtraData:i,Feature:e.Feature,ModelName:e.ModelName,QuestionIds:n,SuggestionId:e.SuggestionId,Variation:e.Variation},null,!0)}}function S(t,e,n){if(t&&n){Object(f.b)("Intelligence."+n.Feature+".Kept",{ActionSubCategory:"Choose",DetectedLanguage:n.DetectedLang,Feature:n.Feature,ModelName:n.ModelName,Variation:n.Variation});var i=n.ExtraData;i&&i.Scores&&(i.Scores=[]),Object(f.b)("IntelligenceStatistic."+n.Feature+".Kept",{ActionSubCategory:"Choose",DetectedLanguage:n.DetectedLang,ExtraData:n.ExtraData,Feature:n.Feature,Index:e,ModelName:n.ModelName,QuestionId:t.Id,SuggestionId:n.SuggestionId,Variation:n.Variation},null,!0)}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(2),r=n(0),o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){return r.createElement("span",{className:"required-star"})},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(0),r=n(18);function o(t){var e=i.createRef(),n=i.createRef(),o=t.IsMobile,s=t.VideoUrl,a=o?"mobile-youtube":"pc-youtube";return a=t.InDesignMode?"design-question-title-youtube-placeholder "+a:"office-form-title-youtube-placeholder "+a,i.createElement("div",{className:a},i.createElement("div",{className:"question-title-youtube-title"},i.createElement("a",{className:"question-title-youtube-link",href:s,target:"_blank"},s)),i.createElement("div",{className:"question-title-youtube-tip"},i.createElement("span",{className:"question-title-youtube-tip-text"},t.LocalizedStrings.DesignPage_Youtube_Disabled_Launch_Tip),!o&&i.createElement(r.a,{HTMLAttributes:{className:"forms-icon-size12x12 question-title-youtube-tip-icon",onMouseOver:function(){var t=$(e.current&&e.current.getHtmlElement()),i=$(n.current);t&&i&&i.css({left:t.offset().left+t.width()/2,top:t.offset().top+t.width()/2})}},IconName:"Info",ref:e}),i.createElement("span",{className:"question-title-youtube-hover-tip ms-Icon",ref:n},t.LocalizedStrings.DesignPage_Youtube_Disabled_Hover_Tip)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(2),r=n(0),o=n(9),s=n(14),a=n(37),c=n(13),u=function(t){function e(e){var n=t.call(this,e)||this;return n.state={LabelDetailLoaded:!1,LabelsLoaded:!1},n.cu=function(){return n.forceUpdate()},n.props.FormMaster.observe(n.cu,[n.props.FormMaster.Schema.DataClassificationLabel]),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.props.DesignTimeView&&Object(a.b)().then((function(e){t.uu=Object(s.G)(e),t.setState({LabelsLoaded:!0})})),!this.props.DesignTimeView&&this.props.FormMaster.isFieldReady(c.a.Schema.DataClassificationLabel)&&Object(a.a)(this.props.FormMaster.Model.OwnerTenantId,this.props.FormMaster.Model.DataClassificationLabel).then((function(e){t.lu=e,t.setState({LabelDetailLoaded:!0})}))},n.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.cu,[this.props.FormMaster.Schema.DataClassificationLabel])},n.render=function(){if(!this.props.FormMaster.isFieldReady(c.a.Schema.DataClassificationLabel)||!this.props.FormMaster.Model.DataClassificationLabel||this.props.DesignTimeView&&!this.state.LabelsLoaded||!this.props.DesignTimeView&&(!this.state.LabelDetailLoaded||!this.lu))return null;var t=this.props.FormMaster.Model.DataClassificationLabel;if(this.props.DesignTimeView)for(var e=0,n=this.uu;e<n.length;e++){var i=n[e];if(i.level===t&&!i.showInFormContent)return null}var s=Object(o.b)(this.props.HTMLAttributes&&this.props.HTMLAttributes.className,"__data-classification-label__");return r.createElement("div",{className:s},t)},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(19),s=n(11),a=n(22),c=n(5),u=n(78),l=n(8),h=n(229),f=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ImageLoadStatus:0,RetryCount:0},n.fu=n.fu.bind(n),n.du=n.du.bind(n),n.bu=n.bu.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(s.f)().Schema;this.props.ImageInfoMaster.observe(this.bu,[t.AltText,t.ResourceId,t.ResourceUrl])},n.componentWillUnmount=function(){this.mu&&window.clearTimeout(this.mu),this.props.ImageInfoMaster.unobserve(this.bu)},n.render=function(){var t,n;this.props.FullFilled?(t="100%",n="auto"):(t=this.props.ImageWidth||Object(o.v)(),n=this.props.ImageHeight||Object(o.u)());var i,s,a=this.state.RetryCount,c=this.props.ImageInfoMaster.Model,u=c.ResourceUrl;2===this.state.ImageLoadStatus&&a>0&&(u+="?"+a),this.vu()?s=e.createSpinner():1===this.state.ImageLoadStatus&&(i="visiable");var l=c.AltText||"";return r.createElement("div",{className:"office-form-title-image-box"},r.createElement("img",{alt:l,className:i,height:n,onError:this.du,onLoad:this.fu,src:u,width:t}),s,r.createElement(h.a,null,this.props.ImageInfoMaster.Model.AltText))},n.vu=function(){var t=this.props.ImageInfoMaster.Model;return 1!==this.state.ImageLoadStatus||t.ImageProcessingStatus!==a.c.Idle},e.createSpinner=function(){var t=r.createElement(u.a,Object(i.__assign)({},{ClassName:"designPage-question-titleLoadImage-spinner",Ignorable:!1}));return r.createElement("div",{className:"image-spinner"},t)},n.fu=function(){Object(c.b)("Image.ImageOnLoad.Success",{imageType:this.props.ImageType,location:"1"}),this.setState({ImageLoadStatus:1})},n.du=function(){var t=this,e=this.state.RetryCount;e<3?this.mu=window.setTimeout((function(){return t.setState({RetryCount:++e})}),1e3):(Object(c.b)("Image.ImageOnLoad.Failure",{imageSrc:this.props.ImageInfoMaster.Model.ResourceUrl,imageType:this.props.ImageType,location:"1"}),this.setState({ImageLoadStatus:2}))},n.bu=function(){this.forceUpdate()},e}(l.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var i=n(2),r=n(0),o=n(3),s=n(15),a=n(12),c=n(144),u=n(1),l=n(9),h=n(14),f=n(29),d=n(231),b=n(10),m=n(48),v=n(8),g=n(86),O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ou=r.createRef(),e.pu=400,e.ju=o.uniqueId("st"),e.yu=function(){var t=[];t.push({content:e.props.Title}),t.push({content:"\n"}),t.push({content:e.props.SubTitle});var n={chunks:t,title:""},i={uiLang:Object(s.f)()||navigator.language};Object(f.b)().getImmersiveReaderToken().then((function(t){t&&ImmersiveReader&&ImmersiveReader.launchAsync(t,null,n,i)}))},e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return Object(c.a)($(this.Ou.current)),[2]}))}))},n.componentDidUpdate=function(){Object(c.a)($(this.Ou.current))},n.render=function(){var t=o.extend({"aria-describedby":this.props.SubTitle?this.ju:null},this.props.HTMLAttributes);return t.className=Object(l.b)(t.className,"office-form-title-container"),r.createElement("div",Object(i.__assign)({},t),this.He(),this.wu(),"Bottom"===this.props.MediaLayout?this.props.children:void 0,this.Su())},n.He=function(t){var e,n="office-form-title-box";return"Bottom"!==this.props.MediaLayout&&(n=n+" "+this.props.MediaLayout.toLowerCase(),e=this.props.children),r.createElement("div",{className:n},e,this.Nu())},n.Nu=function(){var t=this,e=o.extend({},this.props.HTMLPropsForInnerElement);e.className=Object(l.b)("office-form-title",e.className,"heading-"+(this.props.Heading||1),2===this.props.Heading&&"office-form-theme-secondary-color",!this.props.Title&&"empty-title");var n=!0;return e.className.indexOf("heading-2")>0&&(n=!1),Object(b.c)((function(){var o={RenderMode:Object(a.c)("TextFormat")?"RichText":void 0,Text:t.props.Title,ContainsHtml:!0};return r.createElement("div",Object(i.__assign)({},e),Object(m.b)(o),t.Iu(n),e.children)}),b.f)},n.Su=function(){return Object(a.c)("ImmersiveReaderMobileToggle")?this.props.Heading>1?null:Object(d.a)({ImmersiveReaderToggleProps:Object(i.__assign)({},this.props.ImmersiveReaderToggleProps)}):null},n.Iu=function(t){var e;return!Object(h.o)()&&Object(a.c)("ImmersiveReaderInForms")&&(null===(e=this.props.ImmersiveReaderToggleProps)||void 0===e?void 0:e.ShouldShowImmersiveReaderButtons)?r.createElement("button",{className:"immersive-reader-button-form","data-locale":Object(s.f)()||navigator.language,"aria-label":Object(u.a)().ImmersiveReaderButton_Label,onClick:o.debounce(this.yu,this.pu,!0)},r.createElement(g.a,{src:t?"/Images/IR_white.svg":"/Images/immersive-reader-icon.svg",alt:Object(u.a)().ImmersiveReaderButton_Hint,title:Object(u.a)().ImmersiveReaderButton_Hint,style:{verticalAlign:"middle"}})):null},n.wu=function(){if(this.props.SubTitle){if(Object(a.g)()){var t=this.props.SubTitle,e={Id:this.ju,RenderMode:"RichText",Text:t,ContainsHtml:!0};return r.createElement("div",{className:"office-form-subtitle heading-"+(this.props.Heading||1),ref:this.Ou},Object(m.b)(e))}t=this.props.SubTitle;var n={id:this.ju};return r.createElement("div",{className:"office-form-subtitle heading-"+(this.props.Heading||1),ref:this.Ou},r.createElement("span",Object(i.__assign)({},n),t))}},e}(v.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return C}));var i=n(2),r=n(0),o=n(3),s=n(12),a=n(19),c=n(7),u=n(35),l=n(9),h=n(11),f=n(14),d=n(89),b=n(42),m=n(58),v=n(13),g=n(22),O=n(45),p=n(66),j=n(232),y=n(110),w=n(114),S=n(8),N=n(196),I=n(195),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.Cu(this.props)},n.componentWillReceiveProps=function(t){this.Cu(t)},n.componentDidMount=function(){var t=this;this.Oe=function(){return t.forceUpdate()};var e=this.props.Master,n=m.a.Schema;e.observe(this.Oe,[n.Title,n.Subtitle,n.VideoInfo,n.CoAuthors]);var i=[v.a.Schema.HasQuestionMedia];i=Object(u.a)(i),e.Form.observe(this.Oe,i);var r=Object(h.g)().Schema;e.ImageSettingsMaster.observe(this.Oe,[r.NaturalWidth,r.NaturalHeight,r.ContainerWidth,r.ContainerHeight,r.Size,r.Layout]);var o=Object(h.f)().Schema;e.ImageInfoMaster.observe(this.Oe,[o.ImageProcessingStatus,o.UploadParameters]),this.ku=Object(h.b)(),this.ku.observe(this.Oe,[this.ku.Schema.FormsTenantSettings])},n.componentWillUnmount=function(){var t=this.props.Master;t.unobserve(this.Oe),t.ImageInfoMaster.unobserve(this.Oe),t.ImageSettingsMaster.unobserve(this.Oe),this.ku.unobserve(this.Oe)},n.render=function(){var t,e=this.props.Master,n="Right",i=e.Model.VideoInfo,s=e.ImageInfoMaster,a=e.ImageSettingsMaster,c=s.Model;if(!this.props.HideMedia)if(c.ErrorType||c.ImageProcessingStatus===g.c.Idle&&!Object(g.g)(c))e.hasValidVideoUrl()&&(n="Bottom",t=r.createElement(j.a,{ClassNameForIFrame:"design-question-title-video-frame",HTMLAttributes:{className:"design-question-image-title-big-horizontal"},key:"video",Url:i.Url,IsMobile:Object(f.r)(),ShowVideoUrl:Object(d.d)(i.Url,e.Form),LocalizedStrings:this.props.LocalizedStrings}));else{var u=this.Tu(a.Model);n=u.ImageLayout,t=r.createElement(I.a,{FullFilled:"Bottom"===n,ImageWidth:u.Width,ImageHeight:u.Height,ImageInfoMaster:s,ImageSettingMaster:a,ImageType:"Section",key:"image"})}var h=o.extend({},this.props.HTMLAttributes);h.className=Object(l.b)(h.className,"__section-title__ office-form-section-title",this.props.Master.Form.Model.HasQuestionMedia&&"office-form-theme-image-question-background with-image");var b=this.xu().title,m=this.xu().subtitle;if(this.props.IsRuntime&&this.Fu(b,m))return null;var v=r.createElement(N.a,{Heading:2,HTMLAttributes:h,HTMLPropsForInnerElement:{className:"office-form-theme-primary-color"},MediaLayout:n,ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.props.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:null},SubTitle:m,Title:b},t,this.De());return this.props.IsRuntime&&(v=r.createElement("div",{className:"form-renderer-section-title"},v)),v},n.xu=function(){var t,n,i=Object(s.g)(),r=this.props.Master;if(this.Pu){var o=this.Pu.Model;t=i&&o.formsprortlocaletitle||o.title||"",n=i&&o.formsprortlocalesubtitle||o.subtitle||""}return i?(t=Object(b.c)(e.getRTTitle(r).title),n=Object(b.c)(e.getRTTitle(r).subtitle)):(t=t||r.Model.Title,n=n||r.Model.Subtitle),{title:Object(u.m)(t,!0),subtitle:Object(u.m)(n,!0)}},n.Fu=function(t,e){var n=this.props.Master.Model;return!(t||e||n.ImageInfo.ResourceUrl||n.VideoInfo.Url)},e.getRTTitle=function(t){var e,n,i=m.a.Schema,r=t.Model;return t.isFieldReady(i.FormsProRTSubtitle)&&(n=n||r.FormsProRTSubtitle||r.Subtitle),t.isFieldReady(i.FormsProRTQuestionTitle)&&(e=e||r.FormsProRTQuestionTitle||r.Title),{title:e,subtitle:n}},n.Cu=function(t){var e=t.Master,n=e.Form,i=t.LocaleId;this.Pu=i?p.a.getQuestionResourceMaster(i,e.Model.Id,n):void 0},n.De=function(){var t=this,e=this.props.Master.Model.CoAuthors;if(e&&e.length>0&&e[e.length-1].userId!==Object(c.a)().userInfo.UserId)return r.createElement("div",{className:"question-coAuthor-notification-container-design-mode",key:"coAuthor"},o.map(e,(function(e){return t.Be(e)})))},n.Be=function(t){if(t.userId!==Object(c.a)().userInfo.UserId){var e=this.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return r.createElement(y.a,{ariaLabel:e,displayText:Object(w.a)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.Tu=function(t){return this.props.IsMobile||Object(f.A)()||t.Layout===O.a.Horizontal&&t.Size===O.c.Large?{ImageLayout:"Bottom"}:{Height:t.ContainerHeight||Object(a.u)(),ImageLayout:"Right",Width:t.ContainerWidth||Object(a.v)()}},e}(S.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(1);function r(t,e){var n=null!=e?e:Object(i.a)();switch(t){case"Astronomy":return n.Theme_Name_Astronomy;case"Bright_Blue":return n.Theme_Name_Bright_Blue;case"Bright_Green":return n.Theme_Name_Bright_Green;case"CV_Black":return n.Theme_Name_CV_Black;case"CV_Blue":return n.Theme_Name_CV_Blue;case"CV_Dark_Blue":return n.Theme_Name_CV_Dark_Blue;case"CV_Dark_Green":return n.Theme_Name_CV_Dark_Green;case"CV_Dark_Grey":return n.Theme_Name_CV_Dark_Grey;case"CV_Dark_Orange":return n.Theme_Name_CV_Dark_Orange;case"CV_Dark_Purple":return n.Theme_Name_CV_Dark_Purple;case"CV_Dark_Teal":return n.Theme_Name_CV_Dark_Teal;case"CV_Green":return n.Theme_Name_CV_Green;case"CV_Light_Blue":return n.Theme_Name_CV_Light_Blue;case"CV_Light_Orange":return n.Theme_Name_CV_Light_Orange;case"CV_Orange":return n.Theme_Name_CV_Orange;case"CV_Purple":return n.Theme_Name_CV_Purple;case"CV_Sapphire":return n.Theme_Name_CV_Sapphire;case"CV_Teal":return n.Theme_Name_CV_Teal;case"CV_Yellow":return n.Theme_Name_CV_Yellow;case"Chemistry":return n.Theme_Name_Chemistry;case"City01":return n.Theme_Name_City01;case"City02":return n.Theme_Name_City02;case"Dark_Orange":return n.Theme_Name_Dark_Orange;case"Medium_Dark_Blue":return n.Theme_Name_Medium_Dark_Blue;case"Meeting":return n.Theme_Name_Meeting;case"Ocean":return n.Theme_Name_Ocean;case"Office":return n.Theme_Name_Office;case"Office2":return n.Theme_Name_Office2;case"Orange":return n.Theme_Name_Orange;case"Pink":return n.Theme_Name_Pink;case"Pomegranate":return n.Theme_Name_Pomegranate;case"Raspberry":return n.Theme_Name_Raspberry;case"Ski":return n.Theme_Name_Ski;case"Sky":return n.Theme_Name_Sky;case"Suggest_Abstract_Art":return n.Theme_Name_Suggest_Abstract_Art;case"Suggest_Adult_Group":return n.Theme_Name_Suggest_Adult_Group;case"Suggest_Adult_Man":return n.Theme_Name_Suggest_Adult_Man;case"Suggest_Adult_Woman":return n.Theme_Name_Suggest_Adult_Woman;case"Suggest_Airplane":return n.Theme_Name_Suggest_Airplane;case"Suggest_Application_Shopping":return n.Theme_Name_Suggest_Application_Shopping;case"Suggest_Balloon_Cloud":return n.Theme_Name_Suggest_Balloon_Cloud;case"Suggest_Balloon_Fun":return n.Theme_Name_Suggest_Balloon_Fun;case"Suggest_Banana_Blue":return n.Theme_Name_Suggest_Banana_Blue;case"Suggest_Basketball":return n.Theme_Name_Suggest_Basketball;case"Suggest_Beach_Sand":return n.Theme_Name_Suggest_Beach_Sand;case"Suggest_Beach_Water":return n.Theme_Name_Suggest_Beach_Water;case"Suggest_Birthday_Celebration":return n.Theme_Name_Suggest_Birthday_Celebration;case"Suggest_Birthday_Party":return n.Theme_Name_Suggest_Birthday_Party;case"Suggest_Blur_Education":return n.Theme_Name_Suggest_Blur_Education;case"Suggest_Blur_Man":return n.Theme_Name_Suggest_Blur_Man;case"Suggest_Book_Stack":return n.Theme_Name_Suggest_Book_Stack;case"Suggest_Breakfast_Fruit":return n.Theme_Name_Suggest_Breakfast_Fruit;case"Suggest_Brush_Paper":return n.Theme_Name_Suggest_Brush_Paper;case"Suggest_Business_Office":return n.Theme_Name_Suggest_Business_Office;case"Suggest_Business_People0":return n.Theme_Name_Suggest_Business_People0;case"Suggest_Business_Text0":return n.Theme_Name_Suggest_Business_Text0;case"Suggest_Cake_Candle":return n.Theme_Name_Suggest_Cake_Candle;case"Suggest_Cake_Hand":return n.Theme_Name_Suggest_Cake_Hand;case"Suggest_Candle_Birthday":return n.Theme_Name_Suggest_Candle_Birthday;case"Suggest_Candle_Flame":return n.Theme_Name_Suggest_Candle_Flame;case"Suggest_Car_Key":return n.Theme_Name_Suggest_Car_Key;case"Suggest_Car_Road":return n.Theme_Name_Suggest_Car_Road;case"Suggest_Car_Roadtrip":return n.Theme_Name_Suggest_Car_Roadtrip;case"Suggest_Car_Run":return n.Theme_Name_Suggest_Car_Run;case"Suggest_Celebration_Decoration":return n.Theme_Name_Suggest_Celebration_Decoration;case"Suggest_Celebration_Light":return n.Theme_Name_Suggest_Celebration_Light;case"Suggest_Chair_Seat":return n.Theme_Name_Suggest_Chair_Seat;case"Suggest_Chalk_Chalkboard":return n.Theme_Name_Suggest_Chalk_Chalkboard;case"Suggest_Chalkboard_Chalk":return n.Theme_Name_Suggest_Chalkboard_Chalk;case"Suggest_Chalkboard_Mathematics":return n.Theme_Name_Suggest_Chalkboard_Mathematics;case"Suggest_Chart_Man":return n.Theme_Name_Suggest_Chart_Man;case"Suggest_Child_Education":return n.Theme_Name_Suggest_Child_Education;case"Suggest_Child_People":return n.Theme_Name_Suggest_Child_People;case"Suggest_Child_Son":return n.Theme_Name_Suggest_Child_Son;case"Suggest_Child_Togetherness":return n.Theme_Name_Suggest_Child_Togetherness;case"Suggest_Children_Activity":return n.Theme_Name_Suggest_Children_Activity;case"Suggest_Children_Grass":return n.Theme_Name_Suggest_Children_Grass;case"Suggest_Children_Portrait":return n.Theme_Name_Suggest_Children_Portrait;case"Suggest_Christmas_Blur":return n.Theme_Name_Suggest_Christmas_Blur;case"Suggest_Christmas_Bow":return n.Theme_Name_Suggest_Christmas_Bow;case"Suggest_Christmas_Food0":return n.Theme_Name_Suggest_Christmas_Food0;case"Suggest_Christmas_Traditional":return n.Theme_Name_Suggest_Christmas_Traditional;case"Suggest_Citrus_Fruit":return n.Theme_Name_Suggest_Citrus_Fruit;case"Suggest_City_Map":return n.Theme_Name_Suggest_City_Map;case"Suggest_Classroom_Student":return n.Theme_Name_Suggest_Classroom_Student;case"Suggest_Classroom_Teacher":return n.Theme_Name_Suggest_Classroom_Teacher;case"Suggest_Climbing_Forest":return n.Theme_Name_Suggest_Climbing_Forest;case"Suggest_Climbing_Team":return n.Theme_Name_Suggest_Climbing_Team;case"Suggest_Clothes_Accessory":return n.Theme_Name_Suggest_Clothes_Accessory;case"Suggest_Clown_Party":return n.Theme_Name_Suggest_Clown_Party;case"Suggest_Coffee_Woman":return n.Theme_Name_Suggest_Coffee_Woman;case"Suggest_Color_Ball":return n.Theme_Name_Suggest_Color_Ball;case"Suggest_Colorful_Pencil":return n.Theme_Name_Suggest_Colorful_Pencil;case"Suggest_Competition_Athlete":return n.Theme_Name_Suggest_Competition_Athlete;case"Suggest_Composition_Business":return n.Theme_Name_Suggest_Composition_Business;case"Suggest_Composition_Paper1":return n.Theme_Name_Suggest_Composition_Paper1;case"Suggest_Composition_Paper2":return n.Theme_Name_Suggest_Composition_Paper2;case"Suggest_Computer_Calendar":return n.Theme_Name_Suggest_Computer_Calendar;case"Suggest_Computer_Table":return n.Theme_Name_Suggest_Computer_Table;case"Suggest_Concert_Music":return n.Theme_Name_Suggest_Concert_Music;case"Suggest_Cone_Group":return n.Theme_Name_Suggest_Cone_Group;case"Suggest_Cup_Indoors":return n.Theme_Name_Suggest_Cup_Indoors;case"Suggest_Cupcake_Candle":return n.Theme_Name_Suggest_Cupcake_Candle;case"Suggest_Cupcake_Unicorn":return n.Theme_Name_Suggest_Cupcake_Unicorn;case"Suggest_Curtain_Velvet":return n.Theme_Name_Suggest_Curtain_Velvet;case"Suggest_Desktop_Art":return n.Theme_Name_Suggest_Desktop_Art;case"Suggest_Desktop_Asphalt":return n.Theme_Name_Suggest_Desktop_Asphalt;case"Suggest_Diagram_Paper":return n.Theme_Name_Suggest_Diagram_Paper;case"Suggest_Donut":return n.Theme_Name_Suggest_Donut;case"Suggest_Education_Classroom1":return n.Theme_Name_Suggest_Education_Classroom1;case"Suggest_Education_Indoors":return n.Theme_Name_Suggest_Education_Indoors;case"Suggest_Education_School":return n.Theme_Name_Suggest_Education_School;case"Suggest_Family_Park":return n.Theme_Name_Suggest_Family_Park;case"Suggest_Family_Play":return n.Theme_Name_Suggest_Family_Play;case"Suggest_Fashion_Design":return n.Theme_Name_Suggest_Fashion_Design;case"Suggest_Father_Children":return n.Theme_Name_Suggest_Father_Children;case"Suggest_Festival_Flame":return n.Theme_Name_Suggest_Festival_Flame;case"Suggest_Flower_Plant":return n.Theme_Name_Suggest_Flower_Plant;case"Suggest_Food_Bag":return n.Theme_Name_Suggest_Food_Bag;case"Suggest_Food_Baking":return n.Theme_Name_Suggest_Food_Baking;case"Suggest_Food_Cheese":return n.Theme_Name_Suggest_Food_Cheese;case"Suggest_Food_Dough":return n.Theme_Name_Suggest_Food_Dough;case"Suggest_Food_Drink":return n.Theme_Name_Suggest_Food_Drink;case"Suggest_Food_Leaf0":return n.Theme_Name_Suggest_Food_Leaf0;case"Suggest_Food_Meal":return n.Theme_Name_Suggest_Food_Meal;case"Suggest_Food_Wood":return n.Theme_Name_Suggest_Food_Wood;case"Suggest_Food_Wood0":return n.Theme_Name_Suggest_Food_Wood0;case"Suggest_Foot":return n.Theme_Name_Suggest_Foot;case"Suggest_Fruit_Vegetable":return n.Theme_Name_Suggest_Fruit_Vegetable;case"Suggest_Fun_Color":return n.Theme_Name_Suggest_Fun_Color;case"Suggest_Gift1":return n.Theme_Name_Suggest_Gift1;case"Suggest_Gift_Balloon":return n.Theme_Name_Suggest_Gift_Balloon;case"Suggest_Gift_Color":return n.Theme_Name_Suggest_Gift_Color;case"Suggest_Gift_Pink":return n.Theme_Name_Suggest_Gift_Pink;case"Suggest_Gift_Purple":return n.Theme_Name_Suggest_Gift_Purple;case"Suggest_Glass_Tropical0":return n.Theme_Name_Suggest_Glass_Tropical0;case"Suggest_Graduation_Accomplishment1":return n.Theme_Name_Suggest_Graduation_Accomplishment1;case"Suggest_Graduation_Accomplishment2":return n.Theme_Name_Suggest_Graduation_Accomplishment2;case"Suggest_Graphic_Design_Architecture":return n.Theme_Name_Suggest_Graphic_Design_Architecture;case"Suggest_Grass_People":return n.Theme_Name_Suggest_Grass_People;case"Suggest_Hamburger_Food":return n.Theme_Name_Suggest_Hamburger_Food;case"Suggest_Hand_Woman":return n.Theme_Name_Suggest_Hand_Woman;case"Suggest_Hot_Air_Balloon1":return n.Theme_Name_Suggest_Hot_Air_Balloon1;case"Suggest_Hot_Air_Balloon2":return n.Theme_Name_Suggest_Hot_Air_Balloon2;case"Suggest_House_Architecture":return n.Theme_Name_Suggest_House_Architecture;case"Suggest_Hydrogen_Balloon":return n.Theme_Name_Suggest_Hydrogen_Balloon;case"Suggest_Indoors_Adult":return n.Theme_Name_Suggest_Indoors_Adult;case"Suggest_Indoors_Room":return n.Theme_Name_Suggest_Indoors_Room;case"Suggest_Indoors_Woman":return n.Theme_Name_Suggest_Indoors_Woman;case"Suggest_Kid_Park":return n.Theme_Name_Suggest_Kid_Park;case"Suggest_Laptop_Desktop":return n.Theme_Name_Suggest_Laptop_Desktop;case"Suggest_Library_College":return n.Theme_Name_Suggest_Library_College;case"Suggest_Literature_Knowledge":return n.Theme_Name_Suggest_Literature_Knowledge;case"Suggest_Love_Flower":return n.Theme_Name_Suggest_Love_Flower;case"Suggest_Man_Adult":return n.Theme_Name_Suggest_Man_Adult;case"Suggest_Man_Indoors":return n.Theme_Name_Suggest_Man_Indoors;case"Suggest_Man_People":return n.Theme_Name_Suggest_Man_People;case"Suggest_Many_Pencils":return n.Theme_Name_Suggest_Many_Pencils;case"Suggest_Meal_Food":return n.Theme_Name_Suggest_Meal_Food;case"Suggest_Medal":return n.Theme_Name_Suggest_Medal;case"Suggest_Moon_Sky":return n.Theme_Name_Suggest_Moon_Sky;case"Suggest_Mountain_Run":return n.Theme_Name_Suggest_Mountain_Run;case"Suggest_Movie_Show":return n.Theme_Name_Suggest_Movie_Show;case"Suggest_Music_Drum":return n.Theme_Name_Suggest_Music_Drum;case"Suggest_Music_People":return n.Theme_Name_Suggest_Music_People;case"Suggest_Music_Performance":return n.Theme_Name_Suggest_Music_Performance;case"Suggest_Nature_Grass":return n.Theme_Name_Suggest_Nature_Grass;case"Suggest_Neon_Food":return n.Theme_Name_Suggest_Neon_Food;case"Suggest_Note_Pen":return n.Theme_Name_Suggest_Note_Pen;case"Suggest_Orange_Desk":return n.Theme_Name_Suggest_Orange_Desk;case"Suggest_Outdoors_Nature":return n.Theme_Name_Suggest_Outdoors_Nature;case"Suggest_Package_Parachute":return n.Theme_Name_Suggest_Package_Parachute;case"Suggest_Paper_Indoors0":return n.Theme_Name_Suggest_Paper_Indoors0;case"Suggest_Paper_Plane":return n.Theme_Name_Suggest_Paper_Plane;case"Suggest_Parent_Boat":return n.Theme_Name_Suggest_Parent_Boat;case"Suggest_Parent_Wall":return n.Theme_Name_Suggest_Parent_Wall;case"Suggest_Party_Supply":return n.Theme_Name_Suggest_Party_Supply;case"Suggest_Pencil1":return n.Theme_Name_Suggest_Pencil1;case"Suggest_Pencil2":return n.Theme_Name_Suggest_Pencil2;case"Suggest_People_Adult0":return n.Theme_Name_Suggest_People_Adult0;case"Suggest_People_Adult1":return n.Theme_Name_Suggest_People_Adult1;case"Suggest_People_Airplane":return n.Theme_Name_Suggest_People_Airplane;case"Suggest_People_Boy":return n.Theme_Name_Suggest_People_Boy;case"Suggest_People_Group":return n.Theme_Name_Suggest_People_Group;case"Suggest_People_Idea":return n.Theme_Name_Suggest_People_Idea;case"Suggest_People_Indoors":return n.Theme_Name_Suggest_People_Indoors;case"Suggest_People_Portrait":return n.Theme_Name_Suggest_People_Portrait;case"Suggest_People_Sand":return n.Theme_Name_Suggest_People_Sand;case"Suggest_People_Silhouette":return n.Theme_Name_Suggest_People_Silhouette;case"Suggest_People_Walk":return n.Theme_Name_Suggest_People_Walk;case"Suggest_Piano_Keyboard":return n.Theme_Name_Suggest_Piano_Keyboard;case"Suggest_Pizza_Flavor":return n.Theme_Name_Suggest_Pizza_Flavor;case"Suggest_Pizza_Food":return n.Theme_Name_Suggest_Pizza_Food;case"Suggest_Pizza_Pepper":return n.Theme_Name_Suggest_Pizza_Pepper;case"Suggest_Pizza_Slice":return n.Theme_Name_Suggest_Pizza_Slice;case"Suggest_Pool_Ring":return n.Theme_Name_Suggest_Pool_Ring;case"Suggest_Popcorn_Movie":return n.Theme_Name_Suggest_Popcorn_Movie;case"Suggest_Product_Manufacture":return n.Theme_Name_Suggest_Product_Manufacture;case"Suggest_Pumpkin_Halloween":return n.Theme_Name_Suggest_Pumpkin_Halloween;case"Suggest_Rating_Phone":return n.Theme_Name_Suggest_Rating_Phone;case"Suggest_Red_Carpet":return n.Theme_Name_Suggest_Red_Carpet;case"Suggest_Red_Pepper":return n.Theme_Name_Suggest_Red_Pepper;case"Suggest_Room_Ball":return n.Theme_Name_Suggest_Room_Ball;case"Suggest_Room_Desktop":return n.Theme_Name_Suggest_Room_Desktop;case"Suggest_Room_Desktop2":return n.Theme_Name_Suggest_Room_Desktop2;case"Suggest_Room_People":return n.Theme_Name_Suggest_Room_People;case"Suggest_Rose_Flower":return n.Theme_Name_Suggest_Rose_Flower;case"Suggest_Rose_Line":return n.Theme_Name_Suggest_Rose_Line;case"Suggest_Round_Out_Color":return n.Theme_Name_Suggest_Round_Out_Color;case"Suggest_Seat_Chair":return n.Theme_Name_Suggest_Seat_Chair;case"Suggest_Shirt_Color":return n.Theme_Name_Suggest_Shirt_Color;case"Suggest_Shopping_Basket":return n.Theme_Name_Suggest_Shopping_Basket;case"Suggest_Shopping_Cart":return n.Theme_Name_Suggest_Shopping_Cart;case"Suggest_Shopping_Clothes":return n.Theme_Name_Suggest_Shopping_Clothes;case"Suggest_Skill_People":return n.Theme_Name_Suggest_Skill_People;case"Suggest_Sky_Balloon":return n.Theme_Name_Suggest_Sky_Balloon;case"Suggest_Smile_Rating":return n.Theme_Name_Suggest_Smile_Rating;case"Suggest_Soccer":return n.Theme_Name_Suggest_Soccer;case"Suggest_Spoon_Forks":return n.Theme_Name_Suggest_Spoon_Forks;case"Suggest_Sport_Chair":return n.Theme_Name_Suggest_Sport_Chair;case"Suggest_Sprinkles_Cake":return n.Theme_Name_Suggest_Sprinkles_Cake;case"Suggest_Stadium":return n.Theme_Name_Suggest_Stadium;case"Suggest_Street_Woman0":return n.Theme_Name_Suggest_Street_Woman0;case"Suggest_Street_Woman1":return n.Theme_Name_Suggest_Street_Woman1;case"Suggest_Student_School":return n.Theme_Name_Suggest_Student_School;case"Suggest_Studio_Table":return n.Theme_Name_Suggest_Studio_Table;case"Suggest_Study_Book":return n.Theme_Name_Suggest_Study_Book;case"Suggest_Study_Table":return n.Theme_Name_Suggest_Study_Table;case"Suggest_Sun_Sky":return n.Theme_Name_Suggest_Sun_Sky;case"Suggest_Swimming_Flamingo":return n.Theme_Name_Suggest_Swimming_Flamingo;case"Suggest_Symbol_Image":return n.Theme_Name_Suggest_Symbol_Image;case"Suggest_T_Shirt_Color":return n.Theme_Name_Suggest_T_Shirt_Color;case"Suggest_Table_Meeting":return n.Theme_Name_Suggest_Table_Meeting;case"Suggest_Table_Note":return n.Theme_Name_Suggest_Table_Note;case"Suggest_Table_Wedding":return n.Theme_Name_Suggest_Table_Wedding;case"Suggest_Table_Work":return n.Theme_Name_Suggest_Table_Work;case"Suggest_Table_Work2":return n.Theme_Name_Suggest_Table_Work2;case"Suggest_Tape_Weight":return n.Theme_Name_Suggest_Tape_Weight;case"Suggest_Team_Moral":return n.Theme_Name_Suggest_Team_Moral;case"Suggest_Team_Work":return n.Theme_Name_Suggest_Team_Work;case"Suggest_Tennis_Sport":return n.Theme_Name_Suggest_Tennis_Sport;case"Suggest_Time_Calendar0":return n.Theme_Name_Suggest_Time_Calendar0;case"Suggest_Traffic_Road":return n.Theme_Name_Suggest_Traffic_Road;case"Suggest_Travel_Landscape":return n.Theme_Name_Suggest_Travel_Landscape;case"Suggest_Travel_Mountain":return n.Theme_Name_Suggest_Travel_Mountain;case"Suggest_Vegetable_Green":return n.Theme_Name_Suggest_Vegetable_Green;case"Suggest_Velvet_Seat":return n.Theme_Name_Suggest_Velvet_Seat;case"Suggest_Vote_Hand":return n.Theme_Name_Suggest_Vote_Hand;case"Suggest_Water_Nature":return n.Theme_Name_Suggest_Water_Nature;case"Suggest_Water_Sea":return n.Theme_Name_Suggest_Water_Sea;case"Suggest_Water_Travel":return n.Theme_Name_Suggest_Water_Travel;case"Suggest_Wedding_Flower":return n.Theme_Name_Suggest_Wedding_Flower;case"Suggest_Wedding_Groom":return n.Theme_Name_Suggest_Wedding_Groom;case"Suggest_Winner_Stairs":return n.Theme_Name_Suggest_Winner_Stairs;case"Suggest_Woman_Adult":return n.Theme_Name_Suggest_Woman_Adult;case"Suggest_Woman_Indoors":return n.Theme_Name_Suggest_Woman_Indoors;case"Suggest_Woman_Indoors0":return n.Theme_Name_Suggest_Woman_Indoors0;case"Suggest_Woman_Indoors1":return n.Theme_Name_Suggest_Woman_Indoors1;case"Suggest_Woman_Lobby":return n.Theme_Name_Suggest_Woman_Lobby;case"Suggest_Woman_Man":return n.Theme_Name_Suggest_Woman_Man;case"Suggest_Woman_People0":return n.Theme_Name_Suggest_Woman_People0;case"Suggest_Woman_People2":return n.Theme_Name_Suggest_Woman_People2;case"Suggest_Woman_People3":return n.Theme_Name_Suggest_Woman_People3;case"Suggest_Wood_Desktop":return n.Theme_Name_Suggest_Wood_Desktop;case"Suggest_Wood_Flower":return n.Theme_Name_Suggest_Wood_Flower;case"Suggest_Wood_Food":return n.Theme_Name_Suggest_Wood_Food;case"Suggest_Wood_People":return n.Theme_Name_Suggest_Wood_People;case"Suggest_Zen_Balance":return n.Theme_Name_Suggest_Zen_Balance;case"Teal":return n.Theme_Name_Teal;default:return""}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return m})),n.d(e,"b",(function(){return v}));var i=n(2),r=n(0),o=n(15),s=n(1),a=n(35),c=n(11),u=n(5),l=n(18),h=n(8),f=n(38),d=n(125),b=n(236);function m(t){return r.createElement(O,t)}function v(){return O.selectMedia().then((function(t){switch(t){case 1:return Object(d.b)().then((function(t){return{Image:t}}),g);case 2:return Object(b.b)().then((function(t){return{Video:t}}),g);default:return Promise.reject(!0)}}))}function g(t){if(t)return v()}var O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={HoverOption:0},e}Object(i.__extends)(e,t);var n=e.prototype;return e.selectMedia=function(){return e.promiseReject&&e.promiseReject(),new Promise((function(t,n){e.promiseResolve=t,e.promiseReject=n,Object(c.b)().Model.FlexPane="MediaSelect",Object(f.f)("Flexpane-MediaSelect",(function(){return t(0)}))}))},n.render=function(){return r.createElement("div",{className:"media-select-container"},r.createElement("span",{className:"media-select-label"},Object(s.a)().ImagePicker_Insert_Mdeia_button),Object(a.j)(),this.Du(1),!Object(o.w)()&&this.Du(2))},n.Du=function(t){var e=this,n=1===t,i={role:"button",className:"flex-pane-content-title flex-pane-media-content",onClick:function(){e.Mu(t)},onKeyUp:function(n){13!==n.keyCode&&32!==n.keyCode||e.Mu(t)},onMouseEnter:function(){n?e.setState({HoverOption:1}):e.setState({HoverOption:2})},onMouseLeave:function(){e.setState({HoverOption:0})},tabIndex:0};return r.createElement("div",i,r.createElement("span",{className:"flex-pane-icon-container"},Object(l.b)({HTMLAttributes:{className:"flex-pane-icon forms-icon-size20x20"},IconName:n?"Camera":"Video"})),n?Object(s.a)().ImagePicker_Type_Image:Object(s.a)().ImagePicker_Type_Video)},n.Mu=function(t){var n=1===t?"DesignPage.MediaPicker.ChooseImage":"DesignPage.MediaPicker.ChooseVideo";Object(u.b)(n),e.promiseResolve&&e.promiseResolve(t)},e}(h.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return f})),n.d(e,"a",(function(){return d}));var i=n(2),r=n(3),o=n(6),s=n(4),a=n(19),c=n(7),u=n(14),l=n(216),h=(s.a.reference(),s.a.string(),s.a.string(),s.a.number(),s.a.string(),s.a.string(),s.a.string(),s.a.string(),s.a.string(),{Answers:s.a.collectionOf(s.a.reference()),Questions:s.a.collectionOf(s.a.reference()),TopLevelQuestions:s.a.collectionOf(s.a.reference()),PagingSize:s.a.number(),IsPagingReady:s.a.boolean()}),f=300,d=function(t){function e(e,n){var i=t.call(this,n)||this;i.ua=e,i.Model.PagingSize=f;var o=[];return r.forEach(e.Model.Questions,(function(t){o.push({Id:t.Id,GroupId:t.GroupId,Type:t.Type,Title:t.Title})})),i.Model.Questions=o,i.Model.TopLevelQuestions=r.filter(o,(function(t){return!t.GroupId})),i}Object(i.__extends)(e,t);var n=e.prototype;return n.getQuestionAnswers=function(t){var e=this;return t?r.filter(this.Model.Answers,(function(n){return e.Lu(t,n)})):[]},n.getQuestionsAnswers=function(t){var e=[];return r.forEach(this.ua.Model.BufferResponses,(function(n){var i=!1,o=t.map((function(t){var e=r.find(n.Answers,(function(e){return e.QuestionId===t}));return e&&e.Answer?(i=!0,e.Answer.displayText):""}));if(i){var s=!!n.SubmitLanguage&&JSON.parse(n.SubmitLanguage).localeName;e.push({Answer:o,ResponderName:n.ResponderName?n.ResponderName:n.Responder,Language:s||""})}})),e},n.Lu=function(t,e){return"Question.Ranking"!==this.getQuestionType(t)?null!=t&&e.QuestionId===t&&null!=e.Answer&&""!==e.Answer:e.QuestionId===t&&e.Answer&&!/^\[(("",)*""|)\]$/.test(e.Answer)},n.getAnswersCount=function(){return this.ua.Model.ResponsesCount},n.getPagingRegion=function(t){return{Start:isNaN(t)?0:t*f+1,End:isNaN(t)?0:Math.min((t+1)*f,this.ua.Model.ResponsesCount)}},n.SyncPreviousPageData=function(){isNaN(this.Au)||this.syncData(this.Au-1)},n.SyncNextPageData=function(){isNaN(this.Au)||this.syncData(this.Au+1)},n.syncData=function(t){var e=this,n=this.ua.Model.ResponsesCount,i=t*f;t>=0&&i<n&&(this.Au=t,this.Model.IsPagingReady=!1,this.ua.syncFormResponsesByPaging(Math.min(n-i,f),i).then((function(){if(t==e.Au){var n=[];r.forEach(e.ua.Model.BufferResponses,(function(t){var i=!!t.SubmitLanguage&&JSON.parse(t.SubmitLanguage).localeName;r.forEach(t.Answers,(function(r){n.push({Answer:e.Ru(r.QuestionId,r.Answer),QuestionId:r.QuestionId.replace(/-/g,""),ResponderName:t.ResponderName?t.ResponderName:t.Responder,ResponseId:t.Id,Language:i||""})}))})),e.Model.Answers=n,e.Model.IsPagingReady=!0}})))},n.getQuestionType=function(t){return this.ua.getQuestionById(t).Model.Type},n.getAnswerColumnCount=function(t){var e=this.ua.getQuestionById(t);switch(e.Model.Type){case"Question.Ranking":return Math.max(1,e.Model.ChoiceGroup.length);case"Question.MatrixChoiceGroup":return r.filter(this.Model.Questions,(function(e){return e.GroupId===t})).length;case"Question.NPS":return 2;default:return 1}},n.getFileUploadFolder=function(t){var e=this.ua.getQuestionById(t).Model.FileUploadSPOInfo;return e&&e.folderId?new l.a(this.ua).getFileFolder(e.folderId):Promise.reject(new Error("Folder id is null"))},n.Ru=function(t,e){var n=this.ua.getQuestionById(t);if(n){if(e&&"Question.DateTime"===n.Model.Type){var i=Object(c.a)().cultureInfo;return Date.parseDate(e,Object(a.f)(),i).toDateShortString(i)}if(e&&n.isNumberType())return Object(u.G)(e);if("Question.Ranking"===n.Model.Type){var o={};r.forEach(n.Model.ChoiceGroup,(function(t){o[t.Id]=t.Description}));var s=e?r.sortBy(r.filter(e,(function(t){return void 0!==o[t.id]})),(function(t){return t.answerOrder})):[],l=r.size(o)?r.size(o)-s.length:1,h=r.map(Array.apply(null,Array(l)),String.prototype.valueOf,"");return JSON.stringify(r.map(s,(function(t){return o[t.id]})).concat(h))}}return e},e}(o.a.createObjectMasterClass("ResponsesDetailMaster",h))},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(31),r=n(63),o=function(){function t(t,e){this.Eu=[],this.Bu=t,e=e||{},this._u=e.deferredTimeInMs||100,this.Hu=e.maxCount||10}var e=t.prototype;return e.insert=function(t){var e=this,n=new Promise((function(n,i){e.Eu.push({Arguments:t,Resolve:n,Reject:i})}));return this.Eu.length>=this.Hu?this.Gu():void 0===this.qu&&(this.qu=window.setTimeout((function(){return e.Gu()}),this._u)),n},e.Gu=function(){var t=this.Eu;this.Eu=[],void 0!==this.qu&&(window.clearTimeout(this.qu),this.qu=void 0),0!==t.length&&this.Bu(t.map((function(t){return t.Arguments}))).then((function(e){if(t.length!==e.length)throw Error("All the elements needs to be listed in result array.");e.forEach((function(e,n){e.Succeeded?t[n].Resolve(e.Value):t[n].Reject(e.Error)}))})).catch((function(e){t.forEach((function(t){t.Reject(e)}))}))},t}(),s={};function a(t,e){return s.hasOwnProperty(e)||(s[e]=new o((function(t){return function(t,e){var n=t.length,o=Object(r.f)(e);if(o)return Object(i.i)(o).copyLocaleResources(e,t).then((function(){for(var t=[],e=0;e<n;++e)t.push({Succeeded:!0,Value:void 0});return t}),(function(t){for(var e=[],i=0;i<n;++i)e.push({Error:t,Succeeded:!1});return e}));return Promise.resolve(null)}(t,e)}))),s[e].insert(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(23),r=n(99),o=n(36);function s(){var t;if(t=Object(i.a)())return t;var e="origin",n=Object(o.d)()[e];return n||(e="oembedsso",Object(o.d)()[e]?"Forms WebPart":Object(r.f)()?"PowerPoint":null)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r})),n.d(e,"b",(function(){return o}));var i=n(175);function r(t){if(t.IsMathQuiz&&t.Subtitle){var e=t.Title||"";t.CombinedTitle=e+i.a+t.Subtitle}else t.CombinedTitle=t.Title}function o(t){var e=t.CombinedTitle;e&&(e=e.split(i.a)[0]),t.Title=e}},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(5);function r(t,e){var n=Date.now(),r=window.setTimeout((function(){Object(i.b)("PageLoadingTimeout."+e,{actualDuration:Date.now()-n,timeoutLimit:15e3})}),15e3);t.finally((function(){window.clearTimeout(r)}))}},function(t,e,n){"use strict";n.d(e,"b",(function(){return l})),n.d(e,"a",(function(){return h}));var i=n(2),r=n(6),o=n(4),s=n(30),a=n(31),c=function(){function t(t,e){this.Qu=t,this.N=Object(a.i)(this.Qu.getForm())}var e=t.prototype;return e.$a=function(){return this.Qu.getFormId()},e.add=function(t){return this.N.createPermissionToken(this.$a(),t)},e.delete=function(t){return this.N.deletePermissionToken(this.$a(),t.principalId)},e.query=function(t){return Object(s.b)("No scenario to call this method currently.")},e.update=function(t,e){return Object(s.b)("No scenario to call this method currently.")},t}(),u={PrincipalId:o.a.string({IsSourceGenerated:!0,SourceFieldName:"principalId"}),Type:o.a.reference({SourceFieldName:"type"}),Name:o.a.string({SourceFieldName:"name"})};function l(t){return r.a.getObjectMasterFromModel(t)}var h=function(t){function e(e){return t.call(this,e)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.getForm=function(){return this.Parent.Parent},n.getFormId=function(){return this.getForm().Model.Id},e}(r.a.createObjectMasterClass("PermissionToken",u,(function(t,e){return new c(t,e)})))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c})),n.d(e,"b",(function(){return u}));var i=n(71),r=n(15),o=n(7),s=n(36),a=n(14);function c(t){var e=t&&t.response&&t.response.statusCode;if(Object(r.o)()&&401===e){if(t&&t.response&&"Expired"===Object(s.c)(t.response.headers,"X-FailureReason"))return!0;var n=t&&t.response&&Object(a.G)(t.response.body);if(711===(n&&n.error&&parseInt(n.error.code)))return!0}return!1}function u(t,e){var n=Object(o.a)().signInLinkSilent,r=Object(o.a)().signInLinkSilentMsa;return new Promise((function(s){if(window.formsRefreshAuthTokenCallbacks||(window.formsRefreshAuthTokenCallbacks=[]),window.formsRefreshAuthTokenCallbacks.push((function(t,n){!n&&t?s():e()})),!window.formsRefreshAuthTokenCallback){var a=new i.a("Auth.RefreshToken");a.start();var c=function(t,e){try{a.end({extraData:{loggedIn:t},resultType:e?"ExpectedFailure":"Success"});var n=document.querySelector("#refreshAuthTokenFrame");n&&n.parentNode.removeChild(n);var i=window.formsRefreshAuthTokenCallbacks;i&&(e?i&&i.length>0&&i[0](t,e):i.forEach((function(n){return n(t,e)})))}finally{window.formsRefreshAuthTokenCallback=void 0,window.formsRefreshAuthTokenCallbacks=void 0}};if(t()){var u=Object(o.a)().userInfo.IsMsa?r:n,l=document.createElement("iframe");l.id="refreshAuthTokenFrame",l.setAttribute("style","display: none;"),l.setAttribute("src",u);var h=function(){window.formsRefreshAuthTokenCallback&&window.formsRefreshAuthTokenCallback(!1,!0)};l.onload=function(){window.setTimeout(h,5e3)},window.setTimeout(h,5e3),window.formsRefreshAuthTokenCallback=c,document.body.appendChild(l)}else c(!1,!0)}}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var i,r=n(29),o=n(44);function s(){i=new o.c(Object(r.b)().getOD4BToken())}function a(){return i&&i.states()===o.b.Rejected||s(),i.promise()}function c(t){return a().then(t).catch((function(e){if(e&&e.response&&401===e.response.statusCode)return(i&&i.states()===o.b.Pending||s(),i.promise()).then(t);throw e}))}FormsPro.sendRequestWithToken=c},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(9),s=n(5),a=n(8),c=function(t){function e(e){var n=t.call(this,e)||this;return n.Vu=n.Vu.bind(n),n.zu=n.zu.bind(n),n.Uu=n.Uu.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t="question-suggestion-card-gallery-dot",e={className:t=Object(o.b)(t,"office-form-theme-border","office-form-theme-interactive-background",this.props.Selected?"active":"inactive"),key:"gallery-dot"+this.props.Index,onClick:this.Vu,onKeyDown:this.zu,tabIndex:0};return r.createElement("div",Object(i.__assign)({},e))},n.Vu=function(){this.Uu(),this.props.changeGalleryDot(this.props.Index)},n.zu=function(t){switch(t.keyCode){case 13:case 32:this.Uu(),this.props.changeGalleryDot(this.props.Index)}},n.Uu=function(){Object(s.b)("Intelligence.QuestionSuggestion.Index",{Index:this.props.Index})},e}(a.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return h})),n.d(e,"d",(function(){return f})),n.d(e,"c",(function(){return d})),n.d(e,"b",(function(){return b})),n.d(e,"e",(function(){return m}));var i=n(15),r=n(7),o=n(1),s=n(29),a=n(190),c=n(101),u=n(88),l=n(63);function h(t,e){var n=function(t,e){var n=e.FormMasters,s=Object(a.a)(t?Object(o.a)().Designer_DefaultQuizTitle:Object(o.a)().Designer_DefaultFormTitle,Object(o.a)().Designer_Title_autoRenameFormat,n.filter((function(t){return!t.Deleted})).map((function(t){return t.Model.Title}))),c={IsAnonymous:Object(r.a)().userInfo.IsMsa,IsQuizMode:t,RequiresUniqueResponse:t&&!Object(r.a)().userInfo.IsMsa};t&&(c.ShowGradedResults=!0,c.ManualGradingEnabled=!1);return{Settings:c,Title:s,XlWorkbookId:t||Object(i.s)()?void 0:"WaitingForExport"}}(t,e);return n.OwnerId=e.Model.id,function(t,e){var n=Object(l.b)(t);return e.addFormReference({instanceId:n.getInstanceId(),modifiedDate:n.Model.Modified,ownerId:n.Model.OwnerId,ownerTenantId:n.Model.OwnerTenantId,title:n.Model.Title,softDeleted:n.Model.SoftDeleted}),n}(n,e)}function f(t,e){c.a.duplicateForm(t,{IsGroupForm:t.IsGroupForm,OwnerId:t.Model.OwnerId,OwnerTenantId:t.Model.OwnerTenantId})}function d(t,e){t.Deleted=!0,t.Synchronizer.flush().then((function(){e.FormMasters.indexOf(t)>-1&&e.removeFormReference(t.getInstanceId())}))}function b(t,e,n){var i=function(){e.FormMasters.indexOf(t)>-1&&e.removeFormReference(t.getInstanceId()),n&&n()};s.a.getInstance().createDataProvider().deleteForm(t.Model.Id).then(i,(function(t){674===t.innerCode&&i()}))}function m(t,e){t.Model.SoftDeleted=u.a.Normal}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i,r,o=n(33),s=n(5),a=n(7),c=n(112);function u(t){return Promise.all([l(t),h(t)]).then((function(){return!0}),(function(){Object(s.b)("AddinPage.Auth.RefreshInfoFailed")}))}function l(t){return i&&!f||(f=!1,i=Object(c.h)(t).then((function(){Object(s.b)("AddinPage.PageMethod.GetAddinUserInfoSuccess")})).catch((function(t){throw Object(s.b)("AddinPage.PageMethod.GetAddinUserInfoFailed",{error:t}),f=!0,t}))),i}function h(t){return r&&!d||(d=!1,r=Object(c.f)(t).then((function(){Object(s.b)("AddinPage.PageMethod.GetFlightsSuccess")})).catch((function(t){throw Object(s.b)("AddinPage.PageMethod.GetFlightsFailed",{error:t}),d=!0,t})).finally((function(){return Object(o.a)().Flighting.setFlights(Object(a.a)().flights)}))),r}var f=!1,d=!1},function(t,e,n){"use strict";n.d(e,"a",(function(){return q}));var i=n(2),r=n(0),o=n(3),s=n(72),a=n(15),c=n(12),u=n(19),l=n(144),h=n(7),f=n(1),d=n(35),b=n(9),m=n(11),v=n(14),g=n(89),O=n(29),p=n(55),j=n(13),y=n(17),w=n(22),S=n(45),N=n(66),I=n(106),C=n(138),k=n(10),T=n(118),x=n(18),F=n(79),P=n(227);function D(t){var e=t.Master.Question.Model,n=t.Master.SubQuestionRuntimeMasters,i=n[n.length-1];if(t.IsStudentViewMode){if(!(c=(i||t.Master).getScore())&&!e.Point)return;var o=e.Point?e.Point:"-",s=null!=c?c:"-",a=Object(f.a)().RuntimeView_TotalPoints_Content.format(s,o);return r.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(f.a)().Quiz_Points_BracketsText.format(a))}if(e.IsQuiz&&!t.HiddenPoint){if(!e.Point)return;if(!t.ShowDesignInfo&&t.ShowQuizResult){var c;s=null!=(c=(i||t.Master).getScore())?c:"-",a=Object(f.a)().RuntimeView_TotalPoints_Content.format(s,e.Point);return r.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(f.a)().Quiz_Points_BracketsText.format(a))}return r.createElement("span",{className:"office-form-theme-quiz-point",key:"quizPointLabel"},Object(P.a)(e.Point))}}function M(t){var e=t.Master.Model,n=t.Master.Question.Model,i=n.Type===F.a.getElementTypeName(),r="Question.TextField"===n.Type&&!n.Multiline,o="Question.Ranking"===n.Type,s=i||r||o;return!!(n.IsQuiz&&t.ShowQuizResult&&s&&e.QuizResult)&&!e.QuizResult.IsAnswerCorrect}var L=n(56),A=n(228),R=n(110),E=n(114),B=n(8),_=n(193),H=n(86),G=n(229),q=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.be=r.createRef(),e.$u=9,e.Wu=16,e.Ku=o.uniqueId("question"),e.pu=400,e.yu=function(){var t={chunks:e.getFormattedDataForImmersiveReader(),title:""},n={uiLang:Object(a.f)()||navigator.language};Object(O.b)().getImmersiveReaderToken().then((function(e){e&&ImmersiveReader&&ImmersiveReader.launchAsync(e,null,t,n)}))},e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.update=function(){return t.forceUpdate((function(){var e=t.props.onHeightChange;e&&e()}))};var e=this.props.Master,n=[j.a.Schema.HasQuestionMedia];n=Object(d.b)(n),e.Question.Form.observe(this.update,n),e.observe(this.update),e.Question.observe(this.update),this.ku=Object(C.a)(),this.ku.observe(this.update,[this.ku.Schema.FormsTenantSettings]);var i=Object(m.f)().Schema;e.Question.ImageInfoMaster.observe(this.update,[i.ResourceUrl,i.ContentType,i.OriginalFileName]),e.Question.ImageSettingsMaster.observe(this.update),this.Ju(this.props)},n.componentWillReceiveProps=function(t){this.Ju(t)},n.componentWillUnmount=function(){var t=this.props.Master;t.Question.ImageSettingsMaster.unobserve(this.update),t.Question.ImageInfoMaster.unobserve(this.update),t.Question.unobserve(this.update),t.unobserve(this.update),t.Question.Form.unobserve(this.update),this.ku.unobserve(this.update),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.unobserve(this.update)},n.componentDidMount=function(){this.Xu()},n.componentDidUpdate=function(t,e){this.Xu()},n.render=function(){var t={className:"__question__ office-form-question",ref:this.be};if("has-error"===this.getValidationStyle()||M(this.props)){var e=this.props.IsMobile?"office-form-error-question-mobile":"office-form-error-question";t.className=Object(b.b)(t.className,e)}var n=this.Zu(),o=null;return void 0!==n&&(t.className=Object(b.b)(t.className,"office-form-studentview-question"),o=r.createElement("div",{className:"office-form-feedback-marginbottom-box"})),r.createElement("div",Object(i.__assign)({},t),this.Yu(),this.createQuestionContent(),n,o)},n.createWrongResultLabel=function(){return function(t){if(!t.IsMobile){var e=[];if(M(t)){var n=Object(x.b)({Accessible:!0,HTMLAttributes:{"aria-label":Object(f.a)().Response_Preview_WrongReponseIcon.format(t.Ordinal),className:"validation-error-message-wrong-Icon office-form-answerkey"},IconName:"Cancel"});e=[r.createElement("div",{className:"validation-error-circle-big"}),r.createElement("div",{className:"validation-error-circle-small"}),n]}return r.createElement.apply(r,Object(i.__spreadArrays)(["div",{"aria-live":"assertive",role:"alert"}],e))}}(this.props)},n.createReactNodes=function(){throw Error("to be overridden.")},n.createQuestionContent=function(){var t={className:"office-form-question-content office-form-theme-focus-border"},e=this.props.HTMLAttributes;e&&(t=Object(b.g)(e,t));var n=Object(b.b)("office-form-question-element",this.tl()?"with-image":""),o=null;return this.isRequiredQuestionError()&&(o=Object(L.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:this.props.LocalizedStrings.Required_Question_Error_Message})),r.createElement("div",Object(i.__assign)({},t),this.createWrongResultLabel(),this.He(),r.createElement("div",{className:n},this.createReactNodes()),o)},n.isRequiredQuestionError=function(){if(!this.props.ShowValidationStyle)return!1;var t=this.props.Master,e=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===y.e.RequiredError&&(e=y.e.RequiredError)})),e===y.e.RequiredError},n.getValidationStyle=function(){if(!this.props.ShowValidationStyle)return"";var t=this.props.Master,e=t.Question.verify(t.Model.Answer);return t.SubQuestionRuntimeMasters.forEach((function(t){t.Question.verify(t.Model.Answer)===y.e.RequiredError&&(e=y.e.RequiredError)})),e===y.e.Success?"has-success":"has-error"},n.getQuestionId=function(){return this.Ku},n.getRequiredId=function(){return this.props.Master.Question.Model.Required?this.Ku+"-required":void 0},n.getQuestionTypeId=function(){return this.Ku+"-questiontype"},n.getElementProps=function(t){var e={"aria-describedby":this.il(),"aria-labelledby":Object(b.b)(this.rl(),this.ol(),this.getRequiredId(),this.getQuestionTypeId())};return t?Object(b.g)(t,e):e},n.getFormattedDataForImmersiveReader=function(){var t=this.props.Master.Question.Model,e=[];if(e.push({content:this.props.Ordinal+". "+t.Title+(t.Required?" *":"")+"\n"}),t.Point){var n=D(this.props);e.push({content:n.props.children.toString()+"\n\n"})}else e.push({content:"\n"});if(t.Subtitle){var i=t.Subtitle;if("undefined"!=typeof MathJax){var r=MathJax.Hub.getAllJax(null),s=o.find(r,(function(e){return e.originalText===t.Subtitle}));if(s){var a=s.root&&s.root.toMathML&&s.root.toMathML();a&&(a=a.replace(/\n\s*/g,""),i="\x3c!--[if mathML]&#62;"+Object(b.c)(a,!0)+"&#60;![endif]--\x3e")}}e.push({content:""+i,mimeType:"text/html"}),e.push({content:"\n\n"})}var c=document.createElement("i");return c.textContent=Object(b.c)(this.props.LocalizedStrings.ImmersiveReader_InputAnswer,!0),e.push({content:c.outerHTML,mimeType:"text/html"}),e},n.Ju=function(t){var e=t.Master,n=t.LocaleId;this.questionLocalizedItemMaster&&(this.questionLocalizedItemMaster.unobserve(this.update),this.questionLocalizedItemMaster=void 0),n&&(this.questionLocalizedItemMaster=N.a.getQuestionResourceMaster(n,e.Question.Model.Id,e.Question.Form),this.questionLocalizedItemMaster&&this.questionLocalizedItemMaster.observe(this.update,[I.a.Schema.title,I.a.Schema.subtitle]))},n.Zu=function(){var t=this.props.Master.SubQuestionRuntimeMasters,e=t[t.length-1],n=(e&&e.Model||this.props.Master.Model).AnswerEntity,i=n&&n.Feedback;if(this.props.IsStudentViewMode&&i){var o={HTMLAttributes:{className:Object(b.b)("feedback-icon forms-icon-size16x16",Object(v.m)()?"edge":void 0,Object(v.o)()?"ie":void 0),role:"presentation"},IconName:"Chat"};return r.createElement("div",{className:"office-form-feedback-box"},Object(x.b)(o),r.createElement("div",{className:"office-form-feedback-content"},Object(A.a)({content:i})))}},n.al=function(){var t=this,e=this.props.Master.Question.Model,n=this.questionLocalizedItemMaster,i=n&&n.Model,o=this.props.Master.Question.Form.Model.HasQuestionMedia,a=i&&i.title||Object(c.g)()&&e.FormsProRTQuestionTitle||e.Title,u=!1,l="";1!==e.SuspiciousEvidence&&3!==e.SuspiciousEvidence||(u=!0,l=Object(f.a)().Phishing_Question_Level_Message_Suspicous);var h=Object(k.c)((function(){return a}),k.f);h=Object(d.m)(h,!1);var b=!this.props.HideMedia&&(e.ImageInfo&&e.ImageInfo.ResourceUrl||o)?"office-form-question-title with-image":"office-form-question-title",m=this.props.Master.Question.Form,v=Object(s.a)(m,"ResponsePage.PollView"),g=Object(k.c)((function(){return!(t.tl()||v)}),k.f),O={className:b,id:this.ol()},p=e.Required?this.props.LocalizedStrings.Accessibility_RequiredAnswer:void 0,j=null;p&&(j=r.createElement("div",{key:"accessibilityNode"},r.createElement("span",{className:"accessibility-reader-no-display",id:this.getRequiredId()},p)));var y=this.Iu(),w=this.cl(),S=null;w&&(S=r.createElement("div",{key:"questionTypeNode"},r.createElement("span",{className:"accessibility-reader-no-display",id:this.getQuestionTypeId()},w)));var N={children:[y,j,S,D(this.props)],HTMLAttributes:O,key:this.getQuestionId().toString(),Label:h,Ordinal:this.props.Ordinal,ShowOrdinal:g,ShowRequiredStar:e.Required,ShowWarningIcon:u,Theme:this.props.Theme,WarningIconTooltip:l,HtmlContent:!0};return this.getLabel(N)},n.getLabel=function(t){return Object(L.a)(t)},n.cl=function(){var t=this.props.Master.Question.Model,e="";switch(t.Type){case"Question.Choice":e=t.ChoiceType===y.a.MultiChoice?this.props.LocalizedStrings.QuestionType_MultiChoice:this.props.LocalizedStrings.QuestionType_SingleChoice;break;case"Question.DateTime":e=this.props.LocalizedStrings.QuestionType_DateTime;break;case"Question.Rating":e=this.props.LocalizedStrings.QuestionType_Rating;break;case"Question.TextField":e=t.Multiline?this.props.LocalizedStrings.QuestionType_MultiLineText:this.props.LocalizedStrings.QuestionType_SingleLineText;break;case"Question.Ranking":e=this.props.LocalizedStrings.QuestionType_Ranking;break;case"Question.MatrixChoiceGroup":e=this.props.LocalizedStrings.QuestionType_MatrixChoiceGroup}return e},n.ul=function(){return r.createElement("div",{className:"office-form-question-ordinal office-form-theme-primary-background"},r.createElement("span",{id:this.rl()},this.props.Ordinal))},n.He=function(){var t,e,n,o,s=this.props.Master.Question,a=s.Model,l=s.Form.Model.HasQuestionMedia,h={},f="office-form-question-subtitle",m=this.props.IsMobile||Object(v.A)()||a.ImageSettings.Layout===S.a.Horizontal&&a.ImageSettings.Size===S.c.Large,O=s.hasValidVideoUrl(),j=m||O;if(this.props.HideMedia||O||!(a.ImageInfo&&a.ImageInfo.ResourceUrl||l||a.ImageInfo.ImageProcessingStatus===w.c.Uploading||a.ImageInfo.ImageProcessingStatus===w.c.Picking)){if(!this.props.HideMedia&&O){var y=Object(v.r)();f="office-form-question-subtitle with-video";var N=a.VideoInfo;if(h.className=Object(b.b)(h.className,"question-title-container office-form-theme-video-question-background"),Object(g.d)(N.Url,s.Form))o=r.createElement(_.a,{IsMobile:y,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:N.Url});else{var I={allowFullScreen:!0,frameBorder:"0",height:this.ll(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:N.Url,width:"100%"};t=r.createElement("div",{className:"office-form-question-video-container"},r.createElement("iframe",Object(i.__assign)({},I)))}}}else{h.className="question-title-container office-form-theme-image-question-background",f="office-form-question-subtitle with-image";var C=m?"office-form-question-horizontal-large-image-container office-form-theme-image-container-border":"office-form-question-image-container office-form-theme-image-container-border";if(a.ImageInfo&&a.ImageInfo.ResourceUrl){var x=s.ImageSettingsMaster.validateImageSettings(),F={className:C,style:m?void 0:{width:"{0}px".format(x.ContainerWidth)}},P=Object(T.c)(a.ImageInfo);t=r.createElement("div",Object(i.__assign)({},F),r.createElement(T.a,{Image:s.ImageInfoMaster,ImageSettings:s.ImageSettingsMaster,ImageType:"Question"}),P,r.createElement(G.a,null,this.props.Master.Question.ImageInfoMaster.Model.AltText))}else if(a.ImageInfo.ImageProcessingStatus===w.c.Uploading||a.ImageInfo.ImageProcessingStatus===w.c.Picking){F={className:C,style:{height:"{0}px".format(Object(u.u)()),width:"{0}px".format(Object(u.v)())}};t=r.createElement("div",Object(i.__assign)({},F),Object(T.c)())}}if(this.hl())if(a.IsMathQuiz&&!a.IsPlainTextInMathField){var D=Object(p.c)({DisableLinebreaks:this.props.DisableFormulaLinebreak,Formula:a.Subtitle,onRenderComplete:this.props.onHeightChange});e=r.createElement("div",{className:"office-form-question-formula"},D)}else{var M=this.questionLocalizedItemMaster,A=M&&M.Model,R=Object(k.c)((function(){return A&&A.subtitle||a.FormsProRTSubtitle||a.Subtitle}),k.f);R=Object(d.m)(R,!1),n=Object(L.a)({HTMLAttributes:{className:f,id:this.il()},HtmlContent:Object(c.g)(),Label:R})}return r.createElement("div",{className:"question-title-box"},r.createElement("div",Object(i.__assign)({},h),j?void 0:t,j?void 0:o,this.fl()?this.ul():void 0,this.al(),n,j?t:void 0,j?o:void 0,e))},n.fl=function(){var t=this;this.props.Master.Question.Form;return Object(k.c)((function(){return t.tl()}),k.f)},n.Iu=function(){return!Object(v.o)()&&Object(c.c)("ImmersiveReaderInForms")&&this.props.ShouldShowImmersiveReaderButtons?r.createElement("button",{className:"immersive-reader-button-form","data-locale":Object(a.f)()||navigator.language,"aria-label":Object(f.a)().ImmersiveReaderButton_Label,onClick:o.debounce(this.yu,this.pu,!0)},r.createElement(H.a,{src:"/Images/immersive-reader-icon.svg",alt:Object(f.a)().ImmersiveReaderButton_Hint,title:Object(f.a)().ImmersiveReaderButton_Hint,style:{verticalAlign:"middle"}})):null},n.Yu=function(){var t,e=this,n=this.props.Master.Question.Model;return n.CoAuthors&&n.CoAuthors.length>0?n.CoAuthors[n.CoAuthors.length-1].userId!==Object(h.a)().userInfo.UserId&&(t=o.map(n.CoAuthors,(function(t){if(t.userId!==Object(h.a)().userInfo.UserId){var n={ariaLabel:e.props.LocalizedStrings.DesignPage_NavBar_CoAuthor_Screen_Reader.format(t.displayName||t.userId,e.props.Ordinal||0),displayText:Object(E.a)(t.displayName,t.firstName,t.lastName),email:t.email,isCoAuthUser:!0,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId};return r.createElement(R.a,Object(i.__assign)({},n))}}))):t=void 0,r.createElement("div",{className:"question-coAuthor-notification-container-render-mode","aria-live":"polite"},t)},n.ll=function(){if(Object(v.r)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(this.Wu/this.$u)}return Object(u.l)()},n.rl=function(){return this.tl()?this.Ku+"-ordinal":void 0},n.ol=function(){return this.Ku+"-title"},n.il=function(){return this.hl()?this.Ku+"-subtitle":void 0},n.tl=function(){return this.props.Master.Question.Form.Model.HasQuestionMedia&&!this.props.HideMedia},n.hl=function(){var t=this.props.Master.Question.Model;return t.ShowSubtitle&&!!t.Subtitle},n.Xu=function(){var t=$(this.be.current),e=t.find(".office-form-question-formula span"),n=t.find(".office-form-question-choice-formula span"),i=t.find(".design-formula-mixer span");Object(l.a)(t.find("span").not(e).not(n).not(i))},e}(B.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(9),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t="form-renderer-section-breaker";return this.props.HasTheme&&(t=Object(o.b)(t,"office-form-theme-page-background")),r.createElement("div",{className:t})},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(60),s=n(8),a=n(197),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){return r.createElement("div",{className:"form-renderer-section-container",role:"region","aria-label":this.props.SectionMaster.Model.Title},this.createSectionTitle(),r.createElement("div",{className:"form-renderer-section-content"},this.props.children))},n.createSectionTitle=function(){var t=this;return r.createElement(o.a.Consumer,null,(function(e){var n=e.LocalizedStrings;return r.createElement(a.a,{IsMobile:t.props.IsMobile,LocaleId:t.props.LocaleId,LocalizedStrings:n,Master:t.props.SectionMaster,ShouldShowImmersiveReaderButtons:t.props.ShouldShowImmersiveReaderButtons,IsRuntime:!0})}))},e}(s.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return S})),n.d(e,"a",(function(){return N}));var i=n(2),r=n(0),o=n(20),s=n(15),a=n(7),c=n(1),u=n(9),l=n(36),h=n(34),f=n(11),d=n(14),b=n(13),m=n(64),v=n(5),g=n(18),O=n(16),p=n(78),j=n(97),y=n(87),w=n(24);function S(t){return r.createElement(N,Object(i.__assign)({},t))}var N=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dl=!1,e.bl=[],e.vl=Object(f.b)().Model,e.Ol=function(){var t=e.vl.FormsTenantSettings;e.setState({IsExternalSharingAllowed:null==t||t.externalShareResult})},e.jl=function(){return e.forceUpdate()},e.state={ConfirmDialogPrompt:void 0,ResetMenu:!1,ShowShareSummaryResultContainer:!1,ShowDeleteShareResultLinkContainer:!1,ShowSpinner:!0,ShowErrorBox:!1,PermissionToken:"",IsExternalSharingAllowed:null==e.vl.FormsTenantSettings||e.vl.FormsTenantSettings.externalShareResult},e.yl=function(){return e.props.Form.isCurrentUserFormOwnerOrGroupMember()||e.props.Form.canEditPermissionTokenByCoauthor()},e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){var t=document.getElementById("share-result-container-textbox-link")||document.getElementById("share-result-cancel-button");t&&(t.focus(),this.dl&&(document.getElementById("share-result-container-copy-button").click(),t.select(),this.dl=!1))},n.componentDidMount=function(){this.wl("#share-result-container-copy-button","#share-result-container-copy-button-status",Object(c.a)().SharePane_Link_SuccessMessage,Object(c.a)().SharePane_Link_FailedMessage);var t=Object(f.b)();t.observe(this.Ol,[t.Schema.FormsTenantSettings]),this.props.onReExportToExcel&&this.props.Form.observe(this.jl,[b.a.Schema.XlExportingLocalTag])},n.componentWillUnmount=function(){this.bl.forEach((function(t){t&&t.destroy()})),this.bl=[],Object(f.b)().unobserve(this.Ol),this.props.onReExportToExcel&&this.props.Form.unobserve(this.jl)},n.render=function(){return this.Sl()?r.createElement("div",null,this.Nl(),this.Il(),this.Cl()):null},n.Sl=function(){var t=!!this.props.onDelete||!!this.props.onPostScore;return Object(d.r)()?t:t||!!this.props.onPrint},n.kl=function(){var t=this;if(this.props.onDelete){var e={Action:function(){return t.props.onDelete()},ActionButtonText:Object(c.a)().Common_Delete_Text,CancelButtonText:Object(c.a)().Common_Cancel_Text,DialogDescription:this.Tl()};return{Checked:!1,Description:this.props.DeleteAllResponses?Object(c.a)().AnalyzeView_ResetResponses_ButtonText:Object(c.a)().AnalyzeView_DeleteSingleResponse_ButtonText,Key:"deleteResponseItem",onExecute:function(){t.props.onBeforeDeletedDialogShown&&t.props.onBeforeDeletedDialogShown(),t.setState({ConfirmDialogPrompt:e})},IsDisabled:!this.props.HasAnswers}}return null},n.xl=function(){var t=this;if(!Object(d.r)()&&this.props.onPrint){return{Checked:!1,Description:this.props.DeleteAllResponses?Object(c.a)().AnalyzeView_PrintResponses_ItemText:Object(c.a)().AnalyzeView_PrintSingleResponse_ItemText,Key:"printItem",onExecute:function(){Object(v.b)("DesignPage.Responses.PrintAnalyzeView"),t.props.onPrint()},IsDisabled:!this.props.HasAnswers}}return null},n.Fl=function(){var t=this;if(this.props.onPostScore&&!Object(a.a)().userInfo.IsMsa){var e={Action:this.props.onPostScore,ActionButtonText:Object(c.a)().GradingView_ReleaseResponse_Confirm_Release,CancelButtonText:Object(c.a)().Common_Cancel_Text,DialogDescription:Object(c.a)().GradingView_ReleaseResponse_Confirm_Description};return{Checked:!1,Description:this.props.IsScoreReleased?Object(c.a)().GradingView_AlreadyReleased:Object(c.a)().GradingView_Release,IsDisabled:this.props.IsScoreReleased,Key:"postScoreItem",onExecute:function(){return t.setState({ConfirmDialogPrompt:e})}}}return null},n.Pl=function(){var t=this;if(!Object(d.r)()&&this.props.onReExportToExcel){var e={Action:function(){t.props.Form.ensureFieldsReady([b.a.Schema.XlExportingLocalTag]).then((function(){t.props.Form.SetToExporting(),Object(v.b)("DesignPage.Responses.PopupReExportToExcelDialog"),t.props.onReExportToExcel()})),Object(m.a)("ReexportToExcelFile")},ActionButtonText:Object(c.a)().VirtualKeyboard_Button_Enter,CancelButtonText:Object(c.a)().Common_Cancel_Text,DialogDescription:Object(c.a)().ReExportToExcel_Confirm_Message},n=Object(c.a)().ReExportToExcel;return{Checked:!1,IsDisabled:this.props.Form.IsExporting(),Description:n,Key:"ReExportToExcelItem",onExecute:function(){Object(v.b)("DesignPage.Responses.PopupReExportToExcelDialog"),t.setState({ConfirmDialogPrompt:e})}}}return null},n.Nl=function(){var t=this,e=[this.kl(),this.xl(),this.Dl(),this.Fl(),this.Pl()].filter((function(t){return!!t}));return r.createElement(j.a,{ButtonStyle:"LightBackground",ClassNameForContainer:"analyze-view-menu-control-container",Disabled:this.props.Disabled,HTMLAttributes:{className:"analyze-view-ellipsis-button","aria-label":Object(c.a)().Common_More_Options_Text,title:Object(c.a)().Common_More_Options_Text,children:Object(g.b)({HTMLAttributes:{className:"forms-icon-size20x20"},IconName:"More"})},MenuItemType:0,Reset:this.state.ResetMenu,UnorderListMenuItems:e,onMenuReset:function(){return t.setState({ResetMenu:!1})}})},n.Il=function(){var t=this,e=this.state.ConfirmDialogPrompt;if(e){var n={ButtonsProps:[{ButtonStyle:"DarkBackGround",ClassName:"delete-confirm-control-reset-button",GlyphButtonStyle:"Horizontal",Key:"deleteConfirmItem",Text:e.ActionButtonText,onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),e.Action&&e.Action(),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}},{ButtonStyle:"DarkBackGround",ClassName:"delete-confirm-control-cancel-button",GlyphButtonStyle:"Horizontal",Key:"cancelConfirmItem",Text:e.CancelButtonText,onClick:function(){t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0}),t.props.onDeleteDialogDismissed&&t.props.onDeleteDialogDismissed()}}].filter((function(t){return!!t})),ClassName:"delete-confirm-control-container",Description:e.DialogDescription,HTMLAttributes:{"aria-label":this.Tl()},ShowDialog:!!e,TextClassName:this.props.ConfirmDialogTextClassName,onBlur:function(){return t.setState({ConfirmDialogPrompt:void 0})},onDismiss:function(){return t.setState({ConfirmDialogPrompt:void 0,ResetMenu:!0})}};return r.createElement(y.a,Object(i.__assign)({},n))}},n.Tl=function(){return this.props.DeleteAllResponses?Object(c.a)().AnalyzeView_ResetResponses_DescriptionText:Object(c.a)().AnalyzeView_ResetResponse_DescriptionText},n.Dl=function(){var t=this;if(this.props.onShareResult){return{Checked:!1,Description:this.props.PermissionToken?Object(c.a)().AnalyzeView_Get_Share_Result_Link:Object(c.a)().AnalyzeView_Create_Share_Result_Link,IsDisabled:!this.props.PermissionToken&&!this.yl(),Key:"shareResultItem",onExecute:function(){Object(v.b)("DesignPage.Responses.GetSummaryResult"),t.setState({ShowShareSummaryResultContainer:!0,ShowDeleteShareResultLinkContainer:!1}),t.props.PermissionToken?t.setState({PermissionToken:t.props.PermissionToken,ShowSpinner:!1}):t.props.onCreatePermissionToken().then((function(e){t.setState({PermissionToken:e,ShowSpinner:!1})})).catch((function(e){t.setState({ShowSpinner:!1,ShowErrorBox:!0});var n=Object(c.a)().Error_Message_Failed_Create_Permission_Token;t.Ml(n,"#share-result-error-status")})),t.dl=!0},Title:Object(c.a)().AnalyzeView_Share_Result_Link_Tooltip}}return null},n.Cl=function(){var t=this;if(this.state.ShowShareSummaryResultContainer)return r.createElement("div",{className:"delete-confirm-control-container share-result",key:"shareResultDialog",ref:"shareResultDialog",tabIndex:-1,onBlur:function(e){var n=Object(u.d)(e);o.findDOMNode(t.refs.shareResultDialog).contains(n)||t.setState({ShowShareSummaryResultContainer:!1})}},this.Ll(),this.Al())},n.Ll=function(){var t=this;if(!this.state.ShowDeleteShareResultLinkContainer){var e={id:Object(l.b)().FormId,AnalyzerToken:this.state.PermissionToken},n="../Pages/AnalysisPage.aspx?"+jQuery.param(e),i=Object(h.a)(n),o=this.state.IsExternalSharingAllowed&&!Object(s.s)()?Object(c.a)().AnalyzeView_Share_Result_Link_External_Title:Object(c.a)().AnalyzeView_Share_Result_Link_Internal_Title,a=!this.state.IsExternalSharingAllowed&&!Object(s.s)()&&r.createElement(g.a,{IconName:"Error",HTMLAttributes:{title:Object(c.a)().AnalyzeView_Share_Result_Link_Warning_Message,className:"flex-pane-dropdown-option-alert"}}),u=r.createElement("div",{className:"share-result-container-title"},o,a),f=r.createElement("input",{disabled:!1,readOnly:!0,value:i,className:"share-result-container-textbox",id:"share-result-container-textbox-link",onClick:function(){var t=$("#share-result-container-textbox-link");t.focus(),t.select()},"aria-label":Object(c.a)().AnalyzeView_Share_Result_Link_External_Title}),d={className:"share-result-contaienr-copy-button office-form-theme-button",id:"share-result-container-copy-button",disabled:this.state.ShowSpinner,onClick:function(){Object(v.b)("DesignPage.Share.CopyAnalysisResultLink")},"data-clipboard-target":"#share-result-container-textbox-link"},b=Object(w.b)({HTMLAttributes:d,ButtonStyle:"LightBackground",Text:Object(c.a)().Common_Copy_Text,ref:"copyButton",key:"copyButton"}),m=Object(O.a)({HTMLAttributes:{className:"share-result-contaienr-delete-button",onClick:function(){return t.setState({ShowDeleteShareResultLinkContainer:!0})},disabled:this.state.ShowSpinner||!this.yl()},ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Icon:"Delete",IconClassName:"share-result-contaienr-delete-button-icon forms-icon-size18x18",Text:Object(c.a)().AnalyzeView_Delete_Share_Result_Link_Button}),p=r.createElement("div",{className:"share-result-status",id:"share-result-container-copy-button-status",role:"alert"}),j=void 0;return this.state.ShowErrorBox&&(j=r.createElement("div",{className:"share-result-error-status",id:"share-result-error-status"})),r.createElement("div",{"aria-label":o,className:"share-result-content"},this.Rl(),u,f,b,m,p,j,this.vu())}},n.Al=function(){var t=this;if(this.state.ShowDeleteShareResultLinkContainer){var e=Object(c.a)().AnalyzeView_Delete_Share_Result_Link_Title,n=r.createElement("div",{className:"share-result-confirm-delete-text"},e),i=Object(w.b)({HTMLAttributes:{className:"share-result-confirm-cancel-button",id:"share-result-cancel-button",onClick:function(){t.setState({ShowDeleteShareResultLinkContainer:!1,ResetMenu:!0}),t.dl=!0}},Text:Object(c.a)().Common_Back_Text,ButtonStyle:"LightBackground"}),o=Object(w.b)({HTMLAttributes:{className:"share-result-confirm-delete-button",onClick:function(){t.setState({ShowShareSummaryResultContainer:!1,ResetMenu:!0}),t.props.onDeletePermissionToken&&(t.props.onDeletePermissionToken(),t.setState({ShowSpinner:!0}))}},Text:Object(c.a)().AnalyzeView_Delete_Share_Result_Link_Button,ButtonStyle:"LightBackground"});return r.createElement("div",{"aria-label":e,className:"share-result-delete-content"},this.Rl(),n,r.createElement("div",{className:"share-result-confirm-delete-buttons"},i,o))}},n.Rl=function(){var t=this;return Object(O.a)({HTMLAttributes:{className:"share-result-close-button",onClick:function(){return t.setState({ShowShareSummaryResultContainer:!1})}},Icon:"Cancel",IconClassName:"share-result-close-button-icon forms-icon-size14x14",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(c.a)().Common_Close_Text})},n.vu=function(){var t=r.createElement(p.a,Object(i.__assign)({},{ClassName:"designPage-share-result-spinner",Ignorable:!1}));if(this.state.ShowSpinner)return r.createElement("div",{className:"share-result-spinner-container"},r.createElement("div",{className:"share-resilt-spinner"},t))},n.wl=function(t,e,n,i){var r=new Clipboard(t);this.bl.push(r);var o=this.props.Form;r.on("success",(function(t){o.triggerShareAction(),Object(v.b)("DesignPage.Responses.CopySummaryLink");var i=$(e);i.removeClass("flex-pane-status-error"),i.addClass("flex-pane-status-success"),i.text(n),i.show(),setTimeout((function(){i.fadeOut("slow",(function(){i.hide()}))}),3e3),t.clearSelection()})),r.on("error",(function(){Object(v.b)("DesignPage.Send.ActionFailed",{action:t});var n=$(e);n.removeClass("flex-pane-status-success"),n.text(i),n.addClass("flex-pane-status-error")}))},n.Ml=function(t,e){var n=$(e);n.addClass("flex-pane-status-error"),n.removeClass("flex-pane-status-success"),n.text(t),n.show(),setTimeout((function(){n.fadeOut("slow")}),3e3)},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(28);function r(){return i.a.Resolve("IThirdPartyRateIt")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(41),r=n(207),o=n(81),s=n(31),a=n(98),c=Object(i.f)()?"https://graph.microsoft.com/v1.0/":"https://graph.microsoft-ppe.com/v1.0/",u=function(){function t(t){this.El=t.Model.Id,t&&(this.N=Object(s.i)(t))}var e=t.prototype;return e.createFileUploadSession=function(t,e){return this.N.createUploadSession(this.El,t,e).then((function(t){if(null==t)throw new Error("no data return");return t}))},e.cancelOrDeleteUploadFile=function(t){return this.N.cancelOrDeleteUploadFile(t)},e.uploadBytesToSession=function(t,e,n,i,r,o){return Object(a.a)({body:e,headers:{"Content-Range":"bytes "+i+"-"+r+"/"+o,"Content-Type":"*/*"},method:"PUT",qosEventName:"FileUpload.UploadFile",requestUri:t.uploadUrl})},e.getFileFolder=function(t){var e=this;return Object(r.b)((function(n){return Object(a.a)({headers:{Authorization:n,"Content-Type":"*/*"},method:"GET",qosEventName:"FileUpload.GetOD4BFolderPath",requestUri:c+(i=e.El,r=Object(o.a)(i),s=r.OwnerId,u=r.OrgId,l=r.IsGroupOwner?"groups":"users",u+"/"+l+"/"+s+"/drive/items/")+t}).then((function(t){return t.webUrl}));var i,r,s,u,l}))},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(15),s=n(1),a=n(119),c=n(25),u=n(8),l=n(214),h=n(122),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){if(this.props.AggregationMaster)return r.createElement("div",{className:this.SummaryViewContentClassName},r.createElement("div",{className:"analyze-view-summary-table"},r.createElement("div",{className:"analyze-view-summary-container"},this.Bl(),this.statisticsContent(),this._l()),this.Hl()),this.insightContent(),r.createElement("div",{className:"analysis-page-row-line"}))},Object.defineProperty(n,"IsAggregationReady",{get:function(){return this.props.AggregationMaster.Model.IsAggregationReady},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SummaryViewContentClassName",{get:function(){return"analyze-view-summary-content"},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsAggregationFailed",{get:function(){return this.props.AggregationMaster.Model.IsAggregationFailed},enumerable:!1,configurable:!0}),n.getAverageTimeProps=function(){var t=this.Gl(),e=Object(o.u)()?Object(s.a)().Mobile_AnalyzeView_Average_Fill_Time:Object(s.a)().AnalyzeView_Average_Fill_Time;return{AccessibilityText:Object(s.a)().AnalyzeView_Average_Fill_Time_Minutes_Seconds_Explicit.format(t.minutes,t.seconds),Data:Object(s.a)().AnalyzeView_Average_Fill_Time_Minutes_Seconds_Short.format(t.minutes<10?"0"+t.minutes:t.minutes,t.seconds<10?"0"+t.seconds:t.seconds),Description:e,Ignorable:!0,IsReady:0===this.props.AggregationMaster.Model.TotalResponseCount||this.IsAggregationReady||this.IsAggregationFailed}},n.statisticsContent=function(){return r.createElement(h.a,Object(i.__assign)({},this.getAverageTimeProps()))},n.insightContent=function(){return null},n.Bl=function(){var t=this.props.AggregationMaster.Model,e={AccessibilityText:Object(s.a)().AnalyzeView_NumberOfResponses_AccessibilityLabel.format(t.TotalResponseCount),Data:t.TotalResponseCount,Description:Object(s.a)().Common_Responses_Text,Ignorable:!1,IsReady:null!==t.TotalResponseCount};return r.createElement(h.a,Object(i.__assign)({},e))},n.Gl=function(){if(this.props.AggregationMaster.Model.TotalResponseCount>0){var t=this.props.AggregationMaster.Model.AverageSubmitTime/1e3;return{minutes:Math.floor(t/60),seconds:Math.floor(t%60)}}return{minutes:0,seconds:0}},n._l=function(){var t=this.ql(),e={AccessibilityText:Object(s.a)().AnalyzeView_FormStatus_AccessibilityLabel.format(t),Data:t,Description:Object(s.a)().AnalyzeView_Status_Label,Ignorable:!1,IsReady:null!=this.props.AggregationMaster.Model.FormStatus};return r.createElement(h.a,Object(i.__assign)({},e))},n.ql=function(){switch(this.props.AggregationMaster.Model.FormStatus){case a.a.Opened:return Object(s.a)().AnalyzeView_Status_Active;case a.a.Closed:case a.a.Expired:case a.a.NotStarted:return Object(s.a)().AnalyzeView_Status_Closed;default:return Object(s.a)().AnalyzeView_Status_Unknown}},n.Hl=function(){if(!Object(o.u)()&&this.props.AggregationMaster.FormMaster.SyncContext!==c.a.AnalysisTimeForm){var t={DeleteAllResponses:!0,Form:this.props.Form,HasAnswers:!1,onDelete:this.props.onDeleteResponses,onCreatePermissionToken:this.props.onCreatePermissionToken,onDeletePermissionToken:this.props.onDeletePermissionToken,onPrint:this.props.onPrint,onShareResult:!0,onReExportToExcel:this.props.onExportExcel,PermissionToken:this.props.PermissionToken};if(this.IsAggregationReady){var e=this.props.AggregationMaster;t.AggregationMaster=e,t.HasAnswers=this.props.AggregationMaster.Model.TotalResponseCount>0}return r.createElement(l.a,Object(i.__assign)({},t))}},e}(u.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return vt})),n.d(e,"a",(function(){return gt}));var i=n(2),r=n(0),o=n.n(r),s=n(20),a=n(3),c=n(6),u=n(127),l=n(181),h=n(15),f=n(41),d=n(12),b=n(50),m=n(69),v=n(144),g=n(7),O=n(28),p=n(5);function j(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,e;return Object(i.__generator)(this,(function(n){var i;return!Object(d.c)("PrefetchJSChunkOnSafari")||(i=document.createElement("link").relList)&&i.supports&&i.supports("prefetch")||(t=document.getElementsByTagName("link"),e=[],Array.prototype.slice.call(t).forEach((function(t){t.rel&&t.rel.match(/\b(?:pre(?:render|fetch)|next)\b/)&&e.push(t.href)})),e.forEach((function(t){return(new Image).src=t})),Object(p.b)("Polyfill.Prefetch")),[2]}))}))}var y=n(1),w=n(26),S=n(99),N=n(9),I=n(161),C=n(14),k=n(37),T=n(230),x=n(121),F=n(91),P=n(215),D=n(40),M=n(39);function L(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(112).then(n.bind(null,1136))];case 1:return[2,{default:t.sent().ReportPage}]}}))}))}function A(t){var e=Object(M.a)(A,L);return r.createElement(D.a,null,r.createElement(e,Object(i.__assign)({},t)))}function R(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(112).then(n.bind(null,1126))];case 1:return[2,{default:t.sent().ThankYouPage}]}}))}))}function E(t){var e=Object(M.a)(E,R);return r.createElement(D.a,null,r.createElement(e,Object(i.__assign)({},t)))}var B=n(25),_=n(13),H=n(66),G=n(155),q=(n(117),n(33)),Q=n(10),V=n(71),z=n(132),U=n(18),W=n(62),K=n(128);var J=n(24),X=n(116),Z=n(194),Y=n(60),tt=n(49),et=n(16);var nt=n(8),it=n(183),rt=n(46),ot=n(86),st=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Nt=r.createRef(),e}return Object(i.__extends)(e,t),e.prototype.render=function(){var t=r.createElement("div",{className:"introduction-title-container"},r.createElement("div",{className:"introduction-title"},Object(y.a)().Form_Introduction_Title_MSA),r.createElement("a",{className:"office-form-try-link",href:"javascript:void(0)",onClick:at},Object(y.a)().Form_Introduction_TryText_MSA)),e={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":Object(y.a)().Form_Introduction_CreateButtonText_MSA,className:"introduction-create-form",onClick:ct,title:Object(y.a)().Form_Introduction_CreateButtonText_MSA},ref:this.Nt,Text:Object(y.a)().Form_Introduction_CreateButtonText_MSA},n=r.createElement(J.a,Object(i.__assign)({},e));return r.createElement("div",{className:"office-form introduction-for-responser-container"},t,r.createElement("div",{className:"introduction-container"},r.createElement("div",{className:"introduction"},r.createElement(ot.a,{alt:Object(y.a)().Form_Introduction_MSA_1,className:"introduction-image",key:"introductionImage1",src:"/Images/MSAIntroduction1.png"}),r.createElement("div",{className:"introduction-text"},Object(y.a)().Form_Introduction_MSA_1)),r.createElement("div",{className:"introduction"},r.createElement(ot.a,{alt:Object(y.a)().Form_Introduction_MSA_2,className:"introduction-image",key:"introductionImage2",src:"/Images/MSAIntroduction2.png"}),r.createElement("div",{className:"introduction-text"},Object(y.a)().Form_Introduction_MSA_2)),r.createElement("div",{className:"introduction"},r.createElement(ot.a,{alt:Object(y.a)().Form_Introduction_MSA_3,className:"introduction-image",key:"introductionImage3",src:"/Images/MSAIntroduction3.png"}),r.createElement("div",{className:"introduction-text"},Object(y.a)().Form_Introduction_MSA_3))),r.createElement("div",{className:"introduction-button"},n))},e}(nt.a);function at(){return Object(p.b)("ResponsePage.IntroductionForResponser.TryForms"),Object(rt.c)("/Pages/DesignPage.aspx"),!0}function ct(){return Object(p.b)("ResponsePage.IntroductionForResponser.Create"),Object(rt.c)("/Pages/DesignPage.aspx"),!0}var ut=n(150),lt=n(212),ht=n(213),ft=n(124),dt=n(254),bt=n(38),mt=n(84);function vt(t){return r.createElement(gt,t)}var gt=function(t){function e(e){var n=t.call(this,e)||this;n.Ql=!1,n.Vl=!1,n.defaultLanguageId=n.props.Master.Model.DefaultLanguage,n.zl=!0,n.Ul=function(t){n.setState({ShouldShowImmersiveReaderButtons:t||!n.state.ShouldShowImmersiveReaderButtons})};var i=!1,o=e.IncrementalQuestionLoader;o&&(o.setFormRenderer(n),i=null!==o.getFormForFirstRender()&&Object(d.f)()&&!Object(S.g)()),n.$l=r.createRef(),n.formRuntimeMaster=new G.a(n.props.Master,{disableBranching:n.ba(),disableShuffle:i});var s=Object(X.d)();n.defaultLanguageName=s[n.defaultLanguageId];var a,u=Object(X.a)(Object(g.a)().cultureInfo.Name.toLowerCase()),l=c.a.Collection.getItemWithKeyFields(n.props.Master.Model.LocaleList,{localeId:u});l&&Object(d.c)("MultilinguaFirstShowingError")?a=l.localeName:(u=n.defaultLanguageId,a=n.defaultLanguageName),n.Wl(u),n.Kl(n.props.PersistedSectionId);var h=n.Jl();return n.state={IsSmallScreen:$(window).width()<768,SubmitState:0,ShowDuplicateSpinner:!1,ShowErrorPage:!1,ShowPhishingWarningBar:!0,IsStudentViewMode:null!=n.props.Response,IsReportingView:!1,HideQuestions:!1,EmailReceiptConsent:!1,LocalizedResource:n.props.Master.Model.LocaleList.length&&{localeId:u,localeName:a},ShowSpinnerWhenChangeLanguage:!1,ShowSpinnerForFirstTimeLoadMultilingual:!1,LocalizedStrings:Object(y.a)(),ShouldShowImmersiveReaderButtons:!1,ShowLongOperationMessage:!1,ShowProgressBar:h,CurrentPageNumber:n.Xl()+1,TotalPageNumber:n.props.Master.totalSectionCount(),ShowCompletionRate:h,CompletionRate:n.Zl(),WrongQuestionCount:n.Yl().length,SubmitButtonDependencyReady:!Object(d.b)(),ShowSensitiveInfoWarning:!1},n.eh=n.eh.bind(n),n.Oe=n.Oe.bind(n),n.nh=n.nh.bind(n),n.ih=n.ih.bind(n),n.rh=n.rh.bind(n),n.oh=n.oh.bind(n),n.sh=n.sh.bind(n),n.ah=n.ah.bind(n),n.uh=n.uh.bind(n),n.lh=n.lh.bind(n),n.fh=n.fh.bind(n),n.dh=n.dh.bind(n),n.bh=n.bh.bind(n),n.mh=n.mh.bind(n),n.vh=n.vh.bind(n),n.gh=n.gh.bind(n),n.Oh=n.Oh.bind(n),n.ph=n.ph.bind(n),n.jh=n.jh.bind(n),n.yh=n.yh.bind(n),n.wh=e.PhishingReviewUXFactory,n.Sh(),Object(d.b)()&&Promise.all([Object(T.a)(),Object(P.a)()]).then((function(){return n.setState({SubmitButtonDependencyReady:!0})})),n}Object(i.__extends)(e,t);var D=e.prototype;return D.componentWillMount=function(){this.state.IsStudentViewMode?this.updateWithResponse(this.props.Response):this.populatePersistedAnswers(),this.formRuntimeMaster.observeAnswerChange(this.nh),this.formRuntimeMaster.observe(this.ih,[G.a.Schema.RuntimeSectionId]),this.formRuntimeMaster.observe(this.Oe,[G.a.Schema.BranchChangeVersion,G.a.Schema.QuestionRuntimeMasters,G.a.Schema.UploadingFileCount]),window.addEventListener("resize",this.eh)},D.componentDidMount=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,e,n,r,o,s,a,u=this;return Object(i.__generator)(this,(function(l){switch(l.label){case 0:return Object(I.d)(),this.props.ForcedLocaleId?(this.props.Master.ensureFieldsReady([this.props.Master.Schema.LocalizedResources]).then((function(){var t=u.props.Master.Model.LocalizedResources;t&&t[0]&&t[0].localeId==u.props.ForcedLocaleId&&u.setState({LocalizedResource:t[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})})),[3,8]):[3,1];case 1:return this.state.IsStudentViewMode?(t=this.props.Response.SubmitLanguage)?(e=JSON.parse(t).localeId,[4,this.Wl(e)]):[3,3]:[3,4];case 2:l.sent(),this.ensureLayout(e),l.label=3;case 3:return[3,8];case 4:return(n=this.props.Master.Model.LocaleList).length>0?(r=this.props.Master.SyncContext===B.a.ResponseTimeForm,o=Object(X.a)(Object(g.a)().cultureInfo.Name.toLowerCase()),(s=c.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocaleList,{localeId:o}))?[4,this.Wl(o)]:[3,6]):[3,8];case 5:return l.sent(),this.ensureLayout(o),[3,7];case 6:this.ensureLayout(this.defaultLanguageId),o!==this.defaultLanguageId&&(a=Object(X.c)(this.defaultLanguageId),Object(y.c)(a).then((function(t){u.setState({LocalizedStrings:t})}))),l.label=7;case 7:r&&Object(p.b)("ResponsePage.MultiLingual.OpenForm",{browserLocaleId:o,defaultLocaleId:this.defaultLanguageId,firstRenderMatched:!!s,localeCount:n.length}),l.label=8;case 8:return this.Nh(),function(){Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return O.a.Resolve("IBootEvent").addBootCompleteListener((function(){j()})),[2]}))}))}(),Object(C.o)()||Object(q.a)().Flighting.isEnabled("ImmersiveReaderInForms")&&Object(m.a)("ImmersiveReader"),[2]}}))}))},D.Nh=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t,e,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return[4,this.Ih()];case 1:return t=i.sent(),[4,this.Ch()];case 2:return e=i.sent(),[4,this.kh()];case 3:return n=i.sent(),this.setState({DuplicateNavBar:t,DuplicateMessage:e,ResultContainer:n}),[2]}}))}))},D.setResultContainer=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e,n;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:return e=this.setState,n={},[4,this.kh()];case 1:return e.apply(this,[(n.ResultContainer=i.sent(),n),t]),[2]}}))}))},D.componentDidUpdate=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return Object(I.d)(),Object(v.a)($(".office-form-answerhint")),[2]}))}))},D.componentWillUnmount=function(){window.removeEventListener("resize",this.eh),this.formRuntimeMaster.observe(this.ih),this.formRuntimeMaster.unobserveAnswerChange(this.nh),this.formRuntimeMaster.unobserve(this.Oe),this.formRuntimeMaster.release()},D.render=function(){var t=this;if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return this.Th();var n,i=this.props.Master.SyncContext===B.a.SharedTimeForm;if(this.state.ShowErrorPage)return Object(x.a)({Error:this.error,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var o={className:Object(Q.c)((function(){return"office-form-content office-form-page-padding"}),Q.f)};this.props.HTMLAttributes&&(o.className=Object(N.b)(o.className,this.props.HTMLAttributes.className));var s=this.props.Master.Model;if(!this.state.IsReportingView&&this.state.ShowPhishingWarningBar&&Object(tt.g)(s.ReputationTier)&&(o.className=Object(N.b)(o.className,"height-with-tip-bar")),i&&(o.className=Object(N.b)(o.className,"share-page")),(this.props.ViewMode===mt.a.Mobile||this.state.IsSmallScreen)&&(o.className=Object(N.b)(o.className,"small-screen")),this.isMobile()&&(o.className=Object(N.b)(o.className,"mobile-view")),3===this.state.SubmitState||4===this.state.SubmitState&&!this.state.ShowQuizResult){var a,c;this.props.Master.Model.Settings.RequiresUniqueResponse||(a=function(){return t.xh()}),4===this.state.SubmitState&&(c=this.ah);var u=this.state.LocalizedResource.localeId;n=r.createElement(Y.a.Consumer,{children:function(e){return E({FormMaster:t.props.Master,LocaleId:u!==t.defaultLanguageId&&u,LocalizedStrings:e.LocalizedStrings,ShowPromotionMessage:!Object(S.f)(),submitAnother:a,viewResultsHandler:c,CustomStyle:!1,msRewardsThankYouProps:!1})}}),Object(b.d)()&&!this.isMobile()&&(n=r.createElement("div",null,n,r.createElement(st)))}else if(this.state.IsReportingView)n=r.createElement(Y.a.Consumer,{children:function(e){return A({LocalizedStrings:e.LocalizedStrings,FormMaster:t.props.Master})}});else{var l=!!this.state.ShowValidationStyle&&!!this.Yl().length;n=r.createElement("div",null,r.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.Fh(),!this.isMobile()&&this.Ph(),Object(Q.c)((function(){return t.He()}),Q.f),this.state.ResultContainer,r.createElement("div",{className:"office-form-body"},this.Dh(),this.props.PrintView&&this.Mh(),this.Lh(),this.props.PrintView&&e.createPrintTimePrivacyDeclare(),this.Ah(),this.Rh(),this.state.DuplicateMessage,r.createElement("div",{className:this.Ql?"office-form-error-message-container compact-view":"office-form-error-message-container"},l?this.Eh():null,this.Bh()),this._h(),this.Hh())),this.Gh(),this.qh())}var h="form-content-container";this.props.ViewMode===mt.a.Mobile?h="form-content-container mobile-view":this.state.IsSmallScreen&&(h="form-content-container small-screen");var f=!0;return Object(d.c)("MultilinguaFirstShowingError")&&(f=0===this.props.Master.Model.LocaleList.length||this.state.LocalizedResource.localeId===this.defaultLanguageId||this.props.Master.isFieldReady(this.props.Master.Schema.LocalizedResources)&&this.props.Master.Model.LocalizedResources&&this.props.Master.Model.LocalizedResources.length>0),r.createElement(Y.a.Provider,{value:this.state,children:r.createElement("div",{className:h,ref:this.$l},this.state.DuplicateNavBar,this.Qh(),this.Vh(),this.zh(),r.createElement("div",o,this.props.HeaderMessage&&this.ou(),r.createElement(ft.a,{ThemeMaster:this.props.Master.ThemeMaster}),this.isMobile()&&this.Ph(),f&&n),this.Uh(),this.$h(),this.props.PrintView&&e.createPrintFooter())})},D.updateWithResponse=function(t){t&&(this.Wh(t.Answers),this.formRuntimeMaster.updateWithResponse(t),this.setServerQuizResult(t.QuizResult),this.setState({ShowQuizResult:!0,IsStudentViewMode:!0}),this.setResultContainer())},D.Gh=function(){if(!this.props.MobileReadOnly){var t="ShowStatementWithNotice";return this.props.Master.SyncContext===B.a.ResponseTimeForm&&this.props.Master.Model.Settings.IsAnonymous&&(t="ShowStatement"),r.createElement(it.a,{FormMaster:this.props.Master,FooterType:t,FooterText:!1,LocaleId:this.state.LocalizedResource&&this.state.LocalizedResource.localeId})}},D.Vh=function(){if(this.wh)return this.wh.createPhishingWarningPage(this.props.Master,this.state.IsReportingView)},D.zh=function(){var t=this;if(this.props.Master.SyncContext===B.a.DesignTimeForm)return null;var e=this.props.Master.Model.ReputationTier,n=this.Kh()?"ShareForm":"Response";return Object(tt.g)(e)&&!this.state.IsReportingView&&this.state.ShowPhishingWarningBar?r.createElement(Y.a.Consumer,{children:function(){return Object(F.d)({Info:Object(tt.a)(e,n),TipBarLocation:"Up",TipBarStyle:"YellowBackground",ShouldClose:!0,onClose:t.ph})}}):void 0},D.Oh=function(){this.setState({IsReportingView:!0})},D.ph=function(){this.setState({ShowPhishingWarningBar:!1})},D.Wl=function(t){var e=this;t!==this.defaultLanguageId&&this.props.Master.fieldsReady([_.a.Schema.LocalizedResources]).then((function(){if(e.state.IsStudentViewMode){var n=Object(X.c)(t);Object(y.c)(n).then((function(n){e.setState({LocalizedStrings:n}),e.Jh(t)}))}else e.Jh(t)}))},D.Jh=function(t){var e=this;this.props.Master.getLocaleResouceById(t).then((function(t){var n=e.props.Master.Model.LocalizedResources,i=t.localizedResources;c.a.Collection.getItemWithKeyFields(n,{localeId:i[0].localeId})||c.a.Collection.itemsAddedInSource(n,i),e.setState({LocalizedResource:t&&i[0],ShowSpinnerForFirstTimeLoadMultilingual:!1})}))},D.Lh=function(){return this.state.HideQuestions?null:this.props.Master.hasSection()?this.Xh():r.createElement("div",null,this.Zh(this.formRuntimeMaster.TopQuestionRuntimeMasters()))},D.ah=function(){this.setState({ShowQuizResult:!0})},D.Hh=function(){if(this.state.ShowQuizResult&&4===this.state.SubmitState)return r.createElement("div",{className:"office-form-quiz-back-to-result-link"},r.createElement("a",{href:"javascript:void(0)",onClick:this.uh},Object(y.a)().Response_Page_Quiz_Result_Back_To_Thank_You_Message))},D.uh=function(){this.setState({ShowQuizResult:!1})},D.ou=function(){return r.createElement("div",{className:"form-header-text-message"},this.props.HeaderMessage)},D.Ih=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return!(this.props.Master.SyncContext===B.a.SharedTimeForm)||this.state.IsReportingView?[2]:[4,n.e(121).then(n.bind(null,1124))];case 1:return[2,(0,t.sent().createDuplicateNavBarInternal)(this)]}}))}))},D.Qh=function(){var t=this;if(this.wh)return this.wh.createAdminPhishingReviewNavBar(this.props.Master,(function(e){t.error=e,t.setState({ShowErrorPage:!0})}))},D.Ch=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.props.Master.SyncContext!==B.a.SharedTimeForm?[3,2]:[4,n.e(121).then(n.bind(null,1124))];case 1:return[2,(0,t.sent().showDuplicateMessageInternal)(this)];case 2:return[2]}}))}))},D.Dh=function(){if(4!==this.state.SubmitState&&!this.state.IsStudentViewMode&&!this.props.MobileReadOnly){var t=[this.Yh(),this.tf()];return t.some((function(t){return!!t}))?r.createElement.apply(r,Object(i.__spreadArrays)(["div",{className:"office-form-notice-container"}],t)):void 0}},D.Yh=function(){var t=this,e=this.props.Master.Model.Settings,n=this.props.Master.SyncContext===B.a.SharedTimeForm,i=!this.formRuntimeMaster.ElementManager().isFirstPage();return n||i?void 0:r.createElement(Y.a.Consumer,{children:function(n){var i;if(e.IsAnonymous||e.NotRecordIdentity||t.props.PrintView)i="";else{var o=Object(g.a)().userInfo.GivenName||Object(g.a)().userInfo.DisplayName;o?i=n.LocalizedStrings.Response_NonAnonymous_Notice.format(o):(Object(p.c)("MissingUserName",{displayName:!!Object(g.a)().userInfo.DisplayName,givenName:!!Object(g.a)().userInfo.GivenName,userId:!!Object(g.a)().userInfo.UserId}),i=n.LocalizedStrings.Response_NonName_Notice)}if(4!==t.state.SubmitState)return r.createElement("div",{},r.createElement("span",{className:"office-form-notice-long-text"},i))}})},D.tf=function(){if(!this.props.MobileReadOnly){var t=this.props.Master,e=[];return e=t.hasSection()&&!this.ef()?this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters.map((function(t){return t.Question.Model})):c.a.convertToArray(t.Model.Questions),a.some(e,(function(t){return t.Required}))?r.createElement(Y.a.Consumer,{children:function(t){return r.createElement("div",null,r.createElement("span",{className:"office-form-required-notice-star"}),r.createElement("span",null,t.LocalizedStrings.Answer_Required_Notice))}}):void 0}},D.kh=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return this.state.IsStudentViewMode||4===this.state.SubmitState?[4,Promise.resolve().then(n.bind(null,234))]:[3,2];case 1:return[2,(0,t.sent().createResultContainerInternal)(this)];case 2:return[2]}}))}))},D.Eh=function(){var t=this;return r.createElement(Y.a.Consumer,{children:function(e){var n,i=t.Yl(),o=i.map((function(t){return e.LocalizedStrings.Form_QuestionWithOrdinal.format(t)})).join(e.LocalizedStrings.Common_ItemSeperator);n=t.formRuntimeMaster.ElementManager().hasNextSection()?e.LocalizedStrings.Section_Question_Error_Message.format(i.length,o):e.LocalizedStrings.Form_Question_Error_Message.format(i.length,o);var s=Object(U.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),a=!!t.state.ShowValidationStyle&&!!i.length;return r.createElement("div",{className:Object(N.b)("office-form-submit-error",a?"":"NotVisible"),role:"alert"},s,r.createElement("span",{className:"error-message"},a?n:""))}})},D.Yl=function(){return this.formRuntimeMaster.Form.hasSection()?this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters):this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.TopQuestionRuntimeMasters())},D.Th=function(){if(this.state.ShowSpinnerForFirstTimeLoadMultilingual)return r.createElement("div",{className:"multi-lingual-page-loading-background"},r.createElement("div",{className:"page-loading-messagebox",tabIndex:0,"aria-label":Object(y.a)().Common_Loading_Text,"aria-live":"polite"},r.createElement("div",{className:"page-loading-animation"},r.createElement("div",{className:"spinner-tile-animation"})),r.createElement("div",{className:"page-loading-message"},Object(y.a)().Common_Loading_Text)))},D.Ph=function(){if(this.showMultiLingualSelect()){var t=this.props.Master.Model.LocaleList,e=[];e.push({DisplayName:this.defaultLanguageName,Key:"default-language",Value:this.defaultLanguageId}),a.forEach(t,(function(t){e.push({DisplayName:t.localeName||"",Key:t.localeId,Value:t.localeId||""})}));var n="multi-lingual-select-control office-form-theme-secondary-background";this.isMobile()&&(n=Object(N.b)(n,"isMobile"));var i=this.state.LocalizedResource.localeId,r=void 0,o=a.find(e,(function(t){return t.Value===i}));return o&&(r=o.DisplayName),Object(W.b)({HTMLAttributes:{className:n,disabled:this.props.MobileReadOnly},Label:r,onValueChange:this.gh,Placeholder:e[0]&&e[0].DisplayName,PlaceholderIcon:"World",SelectOptions:e,Value:i})}},D.Uh=function(){if(this.state.ShowSpinnerWhenChangeLanguage)return r.createElement("div",{className:"multi-lingual-spinner-container"},r.createElement("div",{className:"multi-lingual-blank-page"}),r.createElement("div",{className:"multi-lingual-spinner"},r.createElement("div",{className:"spinner-tile-animation"})))},D.gh=function(t){var e=this;Object(p.b)("ResponsePage.MultiLingual.ChangeLanguage",{LocaleId:t});var n=Object(X.c)(t);Object(y.c)(n).then((function(i){e.ensureLayout(n),e.setState({LocalizedStrings:i}),e.nf(t)}))},D.nf=function(t){if(t!==this.defaultLanguageId){if(this.props.Master.isFieldReady(_.a.Schema.LocalizedResources)){var e=c.a.Collection.getItemWithKeyFields(this.props.Master.Model.LocalizedResources,{localeId:t});e?this.setState({LocalizedResource:e}):this.if(t)}}else this.setState({LocalizedResource:{localeId:this.defaultLanguageId,localeName:this.defaultLanguageName}})},D.if=function(t){var e=this;this.setState({ShowSpinnerWhenChangeLanguage:!0}),this.props.Master.getLocaleResouceById(t).then((function(t){c.a.Collection.itemsAddedInSource(e.props.Master.Model.LocalizedResources,t.localizedResources),e.setState({LocalizedResource:t&&t.localizedResources[0],ShowSpinnerWhenChangeLanguage:!1})}))},D.showMultiLingualSelect=function(){return!(!this.props.Master.Model.LocaleList.length||this.state.IsStudentViewMode||!this.ef()&&!this.formRuntimeMaster.ElementManager().isFirstPage())},D.Fh=function(){var t=this.props.Master,e=t.SyncContext===B.a.SharedTimeForm;if(!this.isMobile()&&(this.ef()||this.formRuntimeMaster.ElementManager().isFirstPage())&&(this.props.PrintView||!(!Object(b.e)()&&Object(f.f)()||Object(g.a)().userInfo.IsMsa)&&e&&t.isFieldReady(_.a.Schema.DataClassificationLabel)&&t.Model.DataClassificationLabel)){var n=Object(N.b)(this.showMultiLingualSelect()?"office-form-duplicate-classification-label-with-multilingual":"office-form-duplicate-classification-label-without-multilingual","office-form-duplicate-classification-label","office-form-theme-secondary-background");return r.createElement(Z.a,{FormMaster:this.props.Master,HTMLAttributes:{className:n},DesignTimeView:!1})}},D.Kh=function(){return this.props.Master.SyncContext===B.a.SharedTimeForm},D.rf=function(){return 1===this.state.SubmitState||5===this.state.SubmitState},D.ensureLayout=function(t){this.sf(Object(X.f)(t),t)},D.sf=function(t,e){var n=this,i=this.props.Master.SyncContext===B.a.ResponseTimeForm,r=this.props.Master.SyncContext===B.a.DesignTimeForm&&!Object(C.r)(),o=this.props.Master.SyncContext===B.a.DesignTimeForm&&Object(C.r)(),s=t?"rtl":"ltr";i?($("html").attr("lang",e),$(".form-content").attr("dir",s),Object(l.a)(t?u.a.ResponsePageRtl:u.a.ResponsePage).then((function(){return n.forceUpdate()}))):r?($(".form-content").attr({dir:s,lang:e}),Object(l.a)(t?u.a.DesignPageRtl:u.a.DesignPage).then((function(){return n.forceUpdate()}))):o&&($(".form-content").attr({dir:s,lang:e}),Object(l.a)(t?u.a.MobileDesignPageRtl:u.a.MobileDesignPage).then((function(){return n.forceUpdate()})))},D.He=function(){var t=this.state.LocalizedResource.localeId;return Object(dt.a)({Form:this.props.Master,LocaleId:t!==this.defaultLanguageId&&t,IsMobile:this.props.ViewMode===mt.a.Mobile||Object(C.r)(),IsReadOnlyOnMobile:this.props.MobileReadOnly,IsSlimTitle:!this.ef()&&!this.formRuntimeMaster.ElementManager().isFirstPage(),ImmersiveReaderToggleProps:{ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons,ToggleImmersiveReaderButtons:this.Ul}})},D.cf=function(){},D.uf=function(t,e){var n=t.Section,i=t.TopQuestionMasters;if(!n)return this.Zh(i);var o=n.Model.Id,s=this.state.LocalizedResource.localeId,a=[];e||a.push(r.createElement(lt.a,{HasTheme:!this.isMobile(),key:"form-section-breaker-"+o}));var c=this.Zh(i);return a.push(r.createElement(ht.a,{children:c,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:this.props.ViewMode===mt.a.Mobile||Object(C.r)(),LocaleId:s!==this.defaultLanguageId&&s,key:"form-section-container-"+o,SectionMaster:n,ShouldShowImmersiveReaderButtons:this.state.ShouldShowImmersiveReaderButtons})),a},D.Xh=function(){var t=this;return this.ef()?[this.formRuntimeMaster.ElementManager().getAllSections().map((function(e,n){return t.uf(e,0===n)}))]:this.uf(this.formRuntimeMaster.ElementManager().getCurrentSection(),!0)},D.Zh=function(t){var e=this;if(t.length<=0)return null;var n,i=this.state.ShowValidationStyle,o=this.state.ShowQuizResult;Object(Q.c)((function(){n=a.indexOf(e.formRuntimeMaster.TopQuestionRuntimeMasters(),t[0])+1}),Q.f);var s=this.state.LocalizedResource.localeId;return r.createElement(Y.a.Consumer,{children:function(r){return t.map((function(t,a){var c=t.Question.Model.Id,u=n+a,l={SyncContext:e.props.Master.SyncContext,Master:t,LocaleId:s!==e.defaultLanguageId&&s,LocalizedStrings:r.LocalizedStrings,Ordinal:u,Disabled:4===e.state.SubmitState||e.state.IsStudentViewMode||Object(d.c)("TeamsFeaturedPractice")&&e.props.ReadOnlyMode||t.Question.hasRuntimeError(),key:c,IsMobile:e.isMobile(),IsPrintViewDesignTime:e.props.PrintView,ShowValidationStyle:i,ShowQuizResult:o,ShowPhishingWarning:e.lf(),ShowFileInfo:!!e.props.HeaderMessage,HideMedia:!1,IsStudentViewMode:e.state.IsStudentViewMode,HideDeleteButton:e.rf()||4===e.state.SubmitState||e.state.IsStudentViewMode,increaseUploadingFileCountCallBack:e.rh,decreaseUploadingFileCountCallBack:e.oh,setAbuseReportStateCallBack:e.sh,EnableShowHideQuestion:Object(Q.c)((function(){return!1}),Q.f),ShouldShowImmersiveReaderButtons:e.state.ShouldShowImmersiveReaderButtons,IncrementalLoadFormsEnabled:!!e.props.IncrementalQuestionLoader};return Object(ut.a)(l)}))},key:"elementRenderers"})},D.hf=function(){var t=this;return this.ff()?r.createElement(Y.a.Consumer,{children:function(e){return r.createElement("div",{className:"office-form-bottom-button-div"},Object(J.b)({HTMLAttributes:{className:"section-next-button office-form-bottom-button office-form-theme-button",disabled:!!t.formRuntimeMaster.Model.UploadingFileCount,onKeyUp:t.mh,onMouseUp:t.bh},ButtonStyle:"LightBackground",Text:e.LocalizedStrings.Common_Next_Text}))}}):null},D.df=function(){var t=this;if(this.ef()||!this.formRuntimeMaster.ElementManager().hasPrevSection())return null;var e=this.rf()||!!this.formRuntimeMaster.Model.UploadingFileCount;return r.createElement(Y.a.Consumer,{children:function(n){return r.createElement("div",{className:"office-form-bottom-button-div"},Object(J.b)({HTMLAttributes:{className:"office-form-bottom-button office-form-dark-theme-button gray-background",disabled:e,onKeyUp:t.dh,onMouseUp:t.fh},ButtonStyle:"LightBackground",Text:n.LocalizedStrings.Common_Back_Text}))}})},D.Bh=function(){var t=this,e=Object(U.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size16x16"},IconName:"Warning"}),n=this.rf()&&this.state.ShowLongOperationMessage;if(2===this.state.SubmitState||n)return r.createElement(Y.a.Consumer,{children:function(i){return r.createElement(K.a,{HTMLAttributes:{className:Object(N.b)("office-form-submit-error",n?"submitting-warning":"")},LazyRendering:!0,Role:"Alert"},n?void 0:e,r.createElement("span",{className:"error-message"},n?i.LocalizedStrings.RetryRecoverableErrorMessage_Submitting:t.state.ErrorMessage))}})},D.ff=function(){return!this.ef()&&this.formRuntimeMaster.ElementManager().hasNextSection()},D.$h=function(){var t,e,n=this.props.Master;if(3===this.state.SubmitState){if(this.state.LocalizedResource&&this.state.LocalizedResource.localeId!==n.Model.DefaultLanguage)t=H.a.getFormResourceMaster(this.state.LocalizedResource.localeId,n).Model.thankYouMessage;t=t||n.Model.ThankYouMessage||this.state.LocalizedStrings.Renderer_SubmissionSucceeded,e=this.state.LocalizedStrings.Response_Page_Thanks}return r.createElement("div",{className:"office-form-submit-success-hint","aria-live":"polite"},r.createElement("div",null,e),r.createElement("div",null,t))},D.bf=function(){var t=this;if(!(this.ff()||4===this.state.SubmitState||this.state.IsStudentViewMode||this.props.MobileReadOnly)){var e=this.rf(),n=e||!this.state.SubmitButtonDependencyReady||this.props.Master.SyncContext===B.a.SharedTimeForm||this.props.Master.SyncContext===B.a.AdminPhishingReviewForm||this.props.DisableSubmitButton||Object(C.x)()||!!this.formRuntimeMaster.Model.UploadingFileCount||!1;return r.createElement(Y.a.Consumer,{children:function(o){return r.createElement("div",{className:"__submit-button-div__ office-form-bottom-button-div"},Object(J.b)({HTMLAttributes:{className:Object(N.b)("__submit-button__ office-form-bottom-button office-form-theme-button",e?"office-form-hide-text":""),disabled:n,title:Object(C.x)()?o.LocalizedStrings.Renderer_SubmitButtonSPODisabledTitle:void 0,onClick:function(){return Object(i.__awaiter)(t,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){return this.formRuntimeMaster.TopQuestionRuntimeMasters().some((function(t){return t.Model.HasSensitiveInfo}))&&Object(d.c)("SensitiveInfoCheckInResponsePage")&&(Object(d.c)("SensitiveInfoCheckForAllForms")||this.props.Master.Model.Settings.IsAnonymous)?this.setState({ShowSensitiveInfoWarning:!0}):this.mf(o),[2]}))}))}},ButtonStyle:"LightBackground",Text:o.LocalizedStrings.Renderer_SubmitButtonText}),t.vf())}})}},D.mf=function(t){return Object(i.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(i.__generator)(this,(function(r){return 0!==this.state.SubmitState&&2!==this.state.SubmitState||this.setState({SubmitState:5},(function(){return Object(i.__awaiter)(e,void 0,void 0,(function(){var e,r,o,s;return Object(i.__generator)(this,(function(i){switch(i.label){case 0:e=!1,(r=new V.a("FormRenderer.LoadSubmitChunk")).start(),i.label=1;case 1:return i.trys.push([1,3,,4]),[4,n.e(112).then(n.bind(null,1125))];case 2:return o=i.sent().default,r.end({resultType:"Success",extraData:{PrefetchPolyfill:Object(d.c)("PrefetchJSChunkOnSafari")}}),e=!0,5===this.state.SubmitState&&o(t,this),[3,4];case 3:return s=i.sent(),e||(r.end({resultType:"Failure",extraData:{PrefetchPolyfill:Object(d.c)("PrefetchJSChunkOnSafari")}}),Object(p.c)("FormRendererSubmitChunkFailed",{PrefetchPolyfill:Object(d.c)("PrefetchJSChunkOnSafari"),error:s})),this.setState({SubmitState:2,ErrorMessage:t.LocalizedStrings.Error_Message_15001}),[3,4];case 4:return[2]}}))}))})),[2]}))}))},D.vf=function(){if(this.rf())return r.createElement("div",{className:"submit-spinner"},r.createElement("div",{className:"common-spinner-circle"},r.createElement(K.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log",children:Object(y.a)().Response_Page_Submitting_Message})))},D.SetMsRewardsThankyouState=function(t){},D.xh=function(){var t=this;Object(p.b)("ResponsePage.ThanksView.SubmitAnother"),this.Wh(),this.Kl(),this.formRuntimeMaster.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,ShowQuizResult:!1,SubmitState:0,ShowLongOperationMessage:!1,IsStudentViewMode:!1,HideQuestions:!0,EmailReceiptConsent:!1},(function(){t.setState({HideQuestions:!1},e.scrollToTop)}))},D.Wh=function(t){this.startTime=new Date,this.formRuntimeMaster.clearQuizResult(),this.formRuntimeMaster.Answers=t||[]},D.Kl=function(t){this.formRuntimeMaster.Model.RuntimeSectionId=t||null},D.populatePersistedAnswers=function(t){if(!this.state.IsStudentViewMode){var e=(this.props.PersistedAnswers||[]).slice(0);if(t&&this.props.AnswerStorage){var n=[];(this.props.AnswerStorage.Answers||[]).forEach((function(t){var r=t.QuestionId,o=t.Answer;if(null!==o){var s=a.findIndex(e,(function(t){return t.QuestionId===r}));s>-1?e[s]=Object(i.__assign)(Object(i.__assign)({},e[s]),{Answer:o}):n.push(t)}})),e=e.concat(n)}this.Wh(e)}},D.setServerQuizResult=function(t){if(t){var e=Object(C.G)(t);Array.isArray(e)&&this.formRuntimeMaster.setQuizResults(e)}else this.formRuntimeMaster.calculateQuizResultFromModel()},D.isMobile=function(){switch(this.props.ViewMode){case mt.a.Desktop:return!1;case mt.a.Mobile:return!0;default:return Object(C.r)()}},D.nh=function(){var t=this.props.persistAnswer;t&&(this.formRuntimeMaster.isDefaultAnswer()?t(void 0):t(c.a.convertToArray(this.formRuntimeMaster.Answers)));var e=this.Yl().length;e!==this.state.WrongQuestionCount&&this.setState({WrongQuestionCount:e})},D.ih=function(){var t=this.props.persistSectionId;t&&(null==this.formRuntimeMaster.Model.RuntimeSectionId?t():t(this.formRuntimeMaster.Model.RuntimeSectionId));var e={ShowValidationStyle:!1},n=this.Zl();if(n!=this.state.CompletionRate&&(e.CompletionRate=n),this.state.ShowProgressBar){var i=this.Xl()+1,r=this.props.Master.totalSectionCount();i!==this.state.CurrentPageNumber&&(e.CurrentPageNumber=i),r!==this.state.TotalPageNumber&&(e.TotalPageNumber=r)}this.setState(e,this.yh)},D.yh=function(){this.zl||Object(bt.a)(s.findDOMNode(this)),e.scrollToTop()},D.rh=function(){this.formRuntimeMaster.Model.UploadingFileCount++},D.oh=function(){this.formRuntimeMaster.Model.UploadingFileCount>0&&this.formRuntimeMaster.Model.UploadingFileCount--},D.sh=function(){this.setState({IsReportingView:!0})},D.eh=function(){Object(C.A)()!==this.state.IsSmallScreen?this.setState({IsSmallScreen:!this.state.IsSmallScreen}):Object(I.d)()},D._h=function(){var t=this;if(this.lf())return r.createElement(Y.a.Consumer,{children:function(e){return r.createElement("div",{className:"office-form-notice-password"},e.LocalizedStrings.Response_Page_Footer_Notice,r.createElement("a",{className:Object(C.w)()?"office-form-notice-report office-form-theme-spo-link":"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return t.setState({IsReportingView:!0})}},e.LocalizedStrings.Response_Page_Footer_Report))}})},D.lf=function(){var t=this.props.Master.Model.Settings,e=this.props.Master.SyncContext===B.a.ResponseTimeForm;if(!t.IsAnonymous||!e||this.state.ShowQuizResult||Object(h.w)())return!1;var n=!1;return Object(Q.c)((function(){n=Object(d.c)("HideReportAbuse")}),Q.f),!n},D.qh=function(){var t=this;return this.state.ShowSensitiveInfoWarning?r.createElement(Y.a.Consumer,{children:function(e){return n={Context:e,ShowReportAbuse:t.lf(),cancel:function(){return t.setState({ShowSensitiveInfoWarning:!1})},reportAubse:function(){return t.setState({IsReportingView:!0})},submit:function(){t.setState({ShowSensitiveInfoWarning:!1}),t.mf(e)}},i=function(){return n.cancel()},r=Object(et.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{autoFocus:!0,className:"sensitiveinfo-close",onClick:i},Icon:"Cancel",IconClassName:"forms-icon-size16x16",Text:n.Context.LocalizedStrings.Common_Close_Text}),s=Object(J.b)({HTMLAttributes:{autoFocus:!1,className:"sensitiveinfo-button",onClick:function(){return n.submit()}},ButtonStyle:"LightBackground",Text:n.Context.LocalizedStrings.Renderer_SubmitButtonText}),a=Object(J.b)({HTMLAttributes:{autoFocus:!1,className:"sensitiveinfo-button",onClick:i},ButtonStyle:"LightBackground",Text:n.Context.LocalizedStrings.Common_Cancel_Text}),c=n.ShowReportAbuse?o.a.createElement("div",{className:"sensitiveinfo-abuse"},n.Context.LocalizedStrings.Response_Page_Footer_Notice,o.a.createElement("a",{className:"office-form-notice-report",href:"javascript:void(0)",onClick:function(){return n.reportAubse()}},n.Context.LocalizedStrings.Response_Page_Footer_Report)):null,o.a.createElement("div",{"aria-label":n.Context.LocalizedStrings.Response_Page_SensitiveInfo_Dialog,className:"sensitiveinfo-container",style:{lineHeight:"normal"}},o.a.createElement("div",{className:"sensitiveinfo-dialog"},r,o.a.createElement("div",{className:"sensitiveinfo-box"},o.a.createElement("div",{className:"sensitiveinfo-title"},n.Context.LocalizedStrings.Response_Page_SensitiveInfo_Dialog_Title),o.a.createElement("div",{className:"sensitiveinfo-subtitle"},n.Context.LocalizedStrings.Response_Page_SensitiveInfo_Dialog_Subtitle),o.a.createElement("div",{className:"form-sensitive-button-contianer"},o.a.createElement("div",{className:"sensitiveinfo-buttons"},s,a)),c)));var n,i,r,s,a,c}}):null},e.scrollToTop=function(){Object(N.j)($(".office-form-title-container"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){Object(N.j)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},D.Ah=function(){var t=this,e=this.props.Master.Model,n=e.EmailReceiptEnabled&&!Object(h.w)()&&!e.Settings.IsAnonymous&&!e.Settings.NotRecordIdentity&&!this.state.ShowQuizResult&&!this.ff();return r.createElement(Y.a.Consumer,{children:function(e){return n&&Object(z.a)({HTMLAttributes:{className:"office-form-email-receipt-checkbox"},Value:t.state.EmailReceiptConsent,Description:e.LocalizedStrings.Response_Page_EmailReceipt_Checkbox_Description,SpanClassName:"office-form-email-receipt-checkbox-description",onValueChange:function(e){t.setState({EmailReceiptConsent:e})}})}})},D.Rh=function(){return r.createElement("div",{className:"office-form-navigation-container"},r.createElement("div",{className:"office-form-button-container"},this.df(),!1,this.bf(),this.hf()),this.gf(),!1)},D.gf=function(){var t=this;if(Object(d.c)("ProgressBarNew")&&this.state.ShowProgressBar&&!this.ef()){var e=r.createElement(Y.a.Consumer,{children:function(e){var n=t.state.CurrentPageNumber,i=t.state.TotalPageNumber;return n<=0||i<=1?null:function(t){if(t.CurrentStep<0||t.TotalSteps<=0||t.TotalSteps<t.CurrentStep)return null;var e=Math.round(100*t.CurrentStep/t.TotalSteps);return r.createElement("div",{className:"progress-bar-div"},r.createElement("div",{className:"progress-bar-background office-form-theme-progress-bar-background"},r.createElement("div",{className:"progress-bar-text office-form-theme-secondary-color"},t.DescriptionText),r.createElement("div",{className:"progress-bar"},r.createElement("div",{className:"progress-bar-control office-form-theme-primary-background",style:{width:e+"%"}}))))}({CurrentStep:n,TotalSteps:i,DescriptionText:e.LocalizedStrings.Response_Page_ProgressBar_Description.format(n,i)})}});return r.createElement("div",{className:"progress-bar-container"},e)}},D.Of=function(){var t=this;if(!Object(d.c)("ProgressBarNew")&&Object(d.c)("ProgressBar")&&this.state.ShowCompletionRate&&!this.state.ShowQuizResult){var e=r.createElement(Y.a.Consumer,{children:function(e){var n,i,o=e.LocalizedStrings.FormsType_Form;return"survey"==t.props.Master.Model.Type?o=e.LocalizedStrings.FormsType_Survey:t.props.Master.SettingMaster.Model.IsQuizMode&&(o=e.LocalizedStrings.FormsType_Quiz),n={percentage:t.state.CompletionRate,lowerText:t.state.CompletionRate+"%",totalWidth:300,tooltipText:e.LocalizedStrings.ResponsePage_ProgressBar.format(t.state.CompletionRate,o)},i=Math.round(n.percentage*n.totalWidth/100),r.createElement("div",{"aria-label":n.tooltipText,title:n.tooltipText},r.createElement("div",{className:"progress-bar-pro",style:{width:n.totalWidth+"px"}},r.createElement("div",{className:"progress-bar-pro-control office-form-theme-primary-background",style:{width:i+"px"}})),r.createElement("div",{className:"progress-bar-pro-text"},n.lowerText))}});return r.createElement("div",{className:"progress-bar-pro-container"},e)}},D.pf=function(){return!(this.formRuntimeMaster.getQuestionsWithWrongAnswer(this.formRuntimeMaster.ElementManager().getCurrentSection().TopQuestionMasters).length>0)||(this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError),!1)},D.lh=function(){this.formRuntimeMaster.ElementManager().gotoPrevSection()},D.fh=function(){this.zl=!0,this.formRuntimeMaster.ElementManager().gotoPrevSection()},D.dh=function(t){switch(t.keyCode){case 13:case 32:this.zl=!1,this.formRuntimeMaster.ElementManager().gotoPrevSection()}},D.vh=function(){(this.props.Master.SyncContext===B.a.SharedTimeForm||this.pf())&&this.formRuntimeMaster.ElementManager().gotoNextSection()},D.bh=function(){(this.props.Master.SyncContext===B.a.SharedTimeForm||this.pf())&&(this.zl=!0,this.formRuntimeMaster.ElementManager().gotoNextSection())},D.mh=function(t){switch(t.keyCode){case 13:case 32:(this.props.Master.SyncContext===B.a.SharedTimeForm||this.pf())&&(this.zl=!1,this.formRuntimeMaster.ElementManager().gotoNextSection())}},D.jf=function(){if(Object(C.v)()&&Object(d.c)("CustomerVoiceEventsWithData")){var t={Type:"FormPartialResponseSubmitted",Message:this.formRuntimeMaster.Answers};window.parent.postMessage(t,"*")}},D.ef=function(){return this.state.ShowQuizResult||this.props.PrintView||this.props.MobileReadOnly},D.Oe=function(){this.forceUpdate()},D.jh=function(){},D.ba=function(){return this.props.PrintView||this.props.MobileReadOnly},D.Sh=function(){return Object(i.__awaiter)(this,void 0,void 0,(function(){var t;return Object(i.__generator)(this,(function(e){switch(e.label){case 0:return t=!1,[4,Object(k.e)()];case 1:return e.sent()&&(t=!this.isMobile()||!Object(d.c)("ImmersiveReaderMobileToggle")),this.setState({ShouldShowImmersiveReaderButtons:t}),[2]}}))}))},D.Jl=function(){if(Object(d.c)("ProgressBar")||Object(d.c)("ProgressBarNew")){var t=this.props.Master;return!!t.isFieldReady(_.a.Schema.ProgressBarEnabled)&&("true"===t.Model.ProgressBarEnabled&&t.totalSectionCount()>=2)}return!1},D.Zl=function(){var t=0;if(this.state.ShowCompletionRate){var e=this.Xl(),n=this.props.Master.totalSectionCount();e&&0!=e&&(t=Math.round(100*e/n)),Object(p.b)("ResponsePage.Form.SectionRender",{ProgressBarPercentage:t})}return t},D.Xl=function(){var t=this.formRuntimeMaster,e=t.Model.RuntimeSectionId;if(!e)return 0;var n=t.Form.FormElementManager.getDescriptiveElementMasterById(e);if(!n)return 0;var i=this.props.Master.FormElementManager;return i.SectionMasters.indexOf(n)+(i.HeaderTopQuestionMasters.length>0?1:0)},D.Mh=function(){if(!this.props.Master.Model.Settings.NotRecordIdentity){var t=this.state.LocalizedStrings.Print_Form_Record_UserName_Question_Title;return r.createElement("div",{className:"print-user-name-record"},r.createElement("div",{className:"print-user-name-title-line"},r.createElement("span",{className:"print-user-name-remand-icon"},"*"),r.createElement("div",{className:"print-user-name-record-title"},t)),r.createElement("input",{className:"print-user-name-record-input"}))}},e.createPrintTimePrivacyDeclare=function(){var t=Object(y.a)().Print_Form_Privacy_Declaration;return r.createElement("div",{className:"print-privacy-declare"},r.createElement("div",{className:"print-privacy-declare-boundary"}),r.createElement("div",{className:"print-privacy-declare-content"},t),r.createElement("div",{className:"print-privacy-info"},r.createElement("img",{className:"print-privacy-icon",src:Object(w.b)("/Images/forms-logo-128.png")}),r.createElement("span",{className:"print-privacy-text"},Object(y.a)().Page_Title)))},e.createPrintFooter=function(){return r.createElement("div",{className:"print-footer"},r.createElement("span",{className:"print-footer-date"},(new Date).toFormatString("M/d/yyyy",Object(g.a)().cultureInfo)))},e}(nt.a)},function(t,e,n){"use strict";var i;function r(t){i=t}function o(){return i?i():Promise.reject("GetAddinAccessTokenFailed")}n.d(e,"b",(function(){return r})),n.d(e,"a",(function(){return o}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(20),r=n(1),o=n(92),s=n(121),a=n(10);function c(t){Object(a.d)(),Object(r.d)().then((function(){i.render(Object(s.a)({Error:t,ShowBackButton:Object(o.e)(),OnBackButtonClicked:Object(o.e)()?o.b:null}),document.getElementById("content-root"))}))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(2),r=n(3),o=n(6),s=n(1),a=n(52),c=n(11),u=n(100),l=n(17),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.Ranking"},e.createDefaultDefinition=function(){var t=[{Description:Object(s.a)().Designer_Choices_DefaultDescription.format(1),Order:1,Key:Object(a.c)()},{Description:Object(s.a)().Designer_Choices_DefaultDescription.format(2),Order:2,Key:Object(a.c)()},{Description:Object(s.a)().Designer_Choices_DefaultDescription.format(3),Order:3,Key:Object(a.c)()}];return{Type:e.getElementTypeName(),Title:Object(s.a)().Question_DefaultTitle,AllowMultipleValues:!0,ChoiceGroup:t,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.verify=function(t){return!this.Model.Required||t&&0!==t.length?l.e.Success:l.e.RequiredError},n.getTypeDisplayName=function(){return Object(s.a)().QuestionType_Ranking},n.isCorrectAnswer=function(t){var e=this;if(!t)return!1;var n,i=JSON.parse(this.Model.GradingBasis);n=r.isString(t)?JSON.parse(t):r.map(r.sortBy(t,(function(t){return t.answerOrder})),(function(t){return t.id}));var o=r.map(i,(function(t){return r.findWhere(e.Model.ChoiceGroup,{Key:t}).Id}));return n.length===o.length&&r.isEqual(o,n)},n.createQuizResult=function(t){if(this.Model.IsQuiz)return{IsAnswerCorrect:this.isCorrectAnswer(t),GradingBasis:this.Model.GradingBasis}},n.autoGradeAnswer=function(t){var e=this.Model.Point||0;t.Score=this.isCorrectAnswer(t.Answer)?e:0,t.IsAutoGraded=!0},n.autoGradeWithQuizResult=function(t,e){return e?e.IsAnswerCorrect?this.Model.Point:0:null},n.getNormalizedAnswer=function(t){return t||[]},n.hasCorrectAnswers=function(t){return!0},n.redressGradingBasis=function(){var t=this;this.Master.fieldsReady([Object(c.i)().Schema.ChoiceGroup,Object(c.i)().Schema.GradingBasis]).then((function(){var e=o.a.convertToArray(t.Master.Model.ChoiceGroup).sort((function(t,e){return t.Order-e.Order})).map((function(t){return t.Key}));t.Master.Model.GradingBasis=JSON.stringify(e)}))},e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var i=n(2),r=n(1),o=n(100),s=n(17),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.NPS"},e.createDefaultDefinition=function(){return{Type:e.getElementTypeName(),Title:Object(r.a)().NPS_DefaultTitle,LeftDescription:Object(r.a)().NPS_LeftDescription,RightDescription:Object(r.a)().NPS_RightDescription,QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1}},n.verify=function(t){return this.Model.Required&&!t&&0!==t?s.e.RequiredError:s.e.Success},n.getTypeDisplayName=function(){return Object(r.a)().QuestionType_NPS},n.isNumberType=function(){return!0},e}(o.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(2),r=n(1),o=n(10),s=n(73),a=n(100),c=n(17),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.FileUpload"},e.createDefaultDefinition=function(){var t=Object(o.c)((function(){return s.b}),o.f);return{Type:e.getElementTypeName(),Title:Object(r.a)().Question_DefaultTitle,HasSpecificFileType:!1,FileTypes:{Word:!0,Excel:!0,PowerPoint:!0,PDF:!0,Image:!0,Video:!0,Audio:!0},QuestionTagForIntelligence:"Unknown",InsightsInfo:"None",IsFromSuggestion:!1,MaxFileCount:1,MaxFileSize:t[Object.keys(t)[0]]}},n.verify=function(t){return this.Model.Required&&!t?c.e.RequiredError:c.e.Success},n.getTypeDisplayName=function(){return Object(r.a)().QuestionType_UploadFile},e}(a.a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return s})),n.d(e,"a",(function(){return a}));var i=n(2),r=n(0),o=n(111);function s(t){return"Accessibilit"}var a=function(t){function e(e){var n=t.call(this,e)||this;return n.state={Url:Object(o.a)()},n}return Object(i.__extends)(e,t),e.prototype.render=function(){var t={href:this.state.Url,target:"_blank"};return r.createElement("a",Object(i.__assign)({},t),(this.props.LocalizedStrings,"Accessibilit"))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(3),r=n(157);function o(t){if(!t.IsGroupForm&&!t.formOwnedByMe())return!0;var e=Object(r.b)();if(e.isFieldReady(e.Schema.groups)){var n=i.find(e.Groups,(function(e){return e.Model.id===t.Model.OwnerId}));return t.IsGroupForm&&!n}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(3),r=n(51),o=n(17),s=function(){function t(t){this.yf=[],this.wf=this.wf.bind(this),this.Sf=t}var e=t.prototype;return t.getBranchedSections=function(e,n){for(var s=[],a=[],c=0,u=function(){var u=e[c];if(i.findIndex(s,(function(t){return t.Section===u.Section}))>=0)return"break";for(var l=[],h=void 0,f=u.TopQuestionMasters[0],d=function(){if(i.include(a,f))return"break";a.push(f),l.push(f);var t=n(f,u.TopQuestionMasters),s=t.TargetElement;s instanceof o.d?f=s:(s&&r.a.isSection(s.Model.Type)?h=i.findIndex(e,(function(t){return t.Section===s})):"End"===t.Type&&(h=-1),f=null)};f;){if("break"===d())break}s.push({Section:u.Section,TopQuestionMasters:l}),c=void 0!==h?h:t.getNextSectionFromSection(u,e)};c<=e.length-1&&c>=0;){if("break"===u())break}return s},e.calculateQuestionRuntimeList=function(e){var n=[],i=this.Nf(e);this.formRuntimeMaster.IsDisableBranching||(i=t.getBranchedSections(i,this.wf));var r=this.yf,o=this.If(i,n);if(this.Sf||t.isBranchingResultChanged(r,o)){this.yf=o;var s=this.formRuntimeMaster.Model;this.formRuntimeMaster.bulkEdit((function(){s.QuestionRuntimeMasters=n,s.BranchChangeVersion=(s.BranchChangeVersion||0)+1}))}},e.hasPrevSection=function(){return this.Cf()>0},e.gotoPrevSection=function(){var t=this.Cf();if(t>0){var e=this.yf[t-1];this.formRuntimeMaster.Model.RuntimeSectionId=e.Section&&e.Section.Model.Id}},e.hasNextSection=function(){return this.Cf()<this.yf.length-1},e.gotoNextSection=function(){var t=this.kf();t&&(this.formRuntimeMaster.Model.RuntimeSectionId=t)},e.getAllSections=function(){return this.yf},e.getCurrentSection=function(){return this.Tf(this.formRuntimeMaster.Model.RuntimeSectionId)},e.isFirstPage=function(){var t=this.getCurrentSection();return 0===this.yf.indexOf(t)},t.isBranchingResultChanged=function(t,e){if(t.length!==e.length)return!0;for(var n=0;n<t.length;n++){if(t[n].Section!==e[n].Section||t[n].TopQuestionMasters.length!==e[n].TopQuestionMasters.length)return!0;for(var i=0;i<t[n].TopQuestionMasters.length;i++)if(t[n].TopQuestionMasters[i]!==e[n].TopQuestionMasters[i])return!0}return!1},e.wf=function(t,e){var n=this.formRuntimeMaster.getOrCreateQuestionRuntime(t),i=n.Model.BranchingType,r=n.Model.BranchedElement;return r instanceof o.d&&-1===e.indexOf(r)&&(r=e[e.indexOf(t)+1]),{TargetElement:r,Type:i}},e.If=function(t,e){var n=this;return t.map((function(t){return{Section:t.Section,TopQuestionMasters:t.TopQuestionMasters.map((function(t){var i=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);return e.push(i),t.SubQuestionMasters.forEach((function(t){var i=n.formRuntimeMaster.getOrCreateQuestionRuntime(t);e.push(i)})),i}))}}))},t.getNextSectionFromSection=function(t,e){var n=t.Section,r=n&&n.Model.BranchInfo;if(r){if(r.ToTheEnd)return-1;var o=i.findIndex(e,(function(t){return t.Section&&t.Section.Model.Id===r.TargetQuestionId}));if(o>=0)return o}return i.findIndex(e,t)+1},e.Tf=function(t){var e=this,n=i.find(this.yf,(function(e,n){return t?e.Section&&t===e.Section.Model.Id:0===n}));return t&&!n&&(n=this.yf[0],setTimeout((function(){e.formRuntimeMaster.Model.RuntimeSectionId=null}))),n},e.Cf=function(){return i.indexOf(this.yf,this.getCurrentSection())},e.Nf=function(t){var e=this.formRuntimeMaster.Form;return e.hasSection()?e.FormElementManager.getSectionNodes():[{TopQuestionMasters:t.filter((function(t){return!t.Model.GroupId}))}]},e.kf=function(){var t=this.Cf();if(t<this.yf.length-1&&t>=0){var e=this.yf[t+1];return e.Section&&e.Section.Model.Id}},t}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(1);function r(t){var e=Object(i.a)().Quiz_Points_BracketsText_Singular,n=Object(i.a)().Quiz_Points_BracketsText_Plural;return(1===t?e:n).format(t)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(3);function s(t){return r.createElement(a,Object(i.__assign)({},t))}var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.xf=function(){var t=this.props.content;return(o.isUndefined(this.props.trim)||this.props.trim)&&(t=t.trim()),t.split("\n")},n.render=function(){var t=this.xf();return r.createElement("span",null,t.map((function(e,n){var i=n!==t.length-1?r.createElement("br",null):void 0;return r.createElement("span",null,e,i)})))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(2),r=n(0),o=n(23),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){return Object(o.g)()?r.createElement("div",{className:"image-alternative-text"},this.props.children):null},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(28);function r(){return i.a.Resolve("IThirdPartyDateTimePicker")}},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(2),r=n(0),o=n(40),s=n(39);function a(){return Object(i.__awaiter)(this,void 0,void 0,(function(){return Object(i.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(6).then(n.bind(null,381))];case 1:return[2,{default:t.sent().TitleOverflowMenu}]}}))}))}function c(t){var e=Object(s.a)(c,a);return r.createElement(o.a,null,r.createElement(e,Object(i.__assign)({},t)))}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(2),r=n(0),o=n(19),s=n(14),a=n(8),c=n(193),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){var t;return t=this.props.ShowVideoUrl?r.createElement(c.a,{InDesignMode:this.props.InDesignMode,IsMobile:this.props.IsMobile,LocalizedStrings:this.props.LocalizedStrings,VideoUrl:this.props.Url}):r.createElement("iframe",{allowFullScreen:!0,className:this.props.ClassNameForIFrame,frameBorder:"0",height:e.calcVideoDisplayHeight(),sandbox:"allow-scripts allow-same-origin allow-popups allow-forms",src:this.props.Url,width:"100%"}),r.createElement("div",Object(i.__assign)({},this.props.HTMLAttributes),t,this.props.children)},e.calcVideoDisplayHeight=function(){if(Object(s.r)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),9*t/16}return Object(o.l)()},e}(a.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(0),r=n(12),o=n(1),s=n(9),a=(n(10),n(48));function c(t,e,n,c,u,l,h,f,d,b,m,v){var g,O={className:"office-form-rating-container-"+(g=0===t?"star":"number")+" container-margin-right"},p={className:"office-form-rating-container-"+g+" container-margin-left"};""===n&&(O.className=Object(s.b)(O.className,"container-empty")),f===d&&(O.className=Object(s.b)(O.className,"container-"+g+"-max-width"),p.className=Object(s.b)(p.className,"container-"+g+"-max-width"));var j,y,w=Object(a.b)({Text:Object(r.g)()&&m||n,RenderMode:Object(r.g)()?"RichText":void 0,ContainsHtml:!0}),S=Object(a.b)({Text:Object(r.g)()&&v||c,RenderMode:Object(r.g)()?"RichText":void 0,ContainsHtml:!0});if(Object(r.g)()?(j=i.createElement("div",O,i.createElement("div",{className:"office-form-question-rating-description-"+g},w)),y=i.createElement("div",p,i.createElement("div",{className:"office-form-question-rating-description-"+g},S))):(j=i.createElement("div",O,i.createElement("div",{className:"office-form-question-rating-description-"+g},n)),y=i.createElement("div",p,i.createElement("div",{className:"office-form-question-rating-description-"+g},c))),n||c){var N=m||n,I=v||c,C=i.createElement("div",{className:"office-form-response-rating-description"},i.createElement("div",{className:"office-form-rating-description-label"},u),i.createElement("div",{className:"rating-option-description"},Object(o.a)().Colon.format(N))),k=i.createElement("div",{className:"office-form-response-rating-description"},i.createElement("div",{className:"office-form-rating-description-label"},l),i.createElement("div",{className:"rating-option-description"},Object(o.a)().Colon.format(I))),T=i.createElement("div",{className:"office-form-rating-description-container",id:b},C,k);return[i.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:e},j,h,y),T]}return[i.createElement("div",{className:"office-form-question-rating-container",key:"container",ref:e},j,h,y)]}},function(t,e,n){"use strict";n.r(e),n.d(e,"createResultContainerInternal",(function(){return s})),n.d(e,"validateQuizPoint",(function(){return u}));var i=n(0),r=n(1),o=n(228);function s(t){var e=function(t){if(t.state.IsStudentViewMode){var e=t.props.Response.Feedback;if(e){var n=Object(r.a)().RuntimeView_FormComment.format(e),s=Object(o.a)({content:n});return i.createElement("div",{className:"office-form-formcomment-container"},i.createElement("div",{className:"office-form-formcomment office-form-theme-primary-foreground"},s))}return}}(t),n=function(t){var e=0,n=0,o=0,s=0,a=!1;(4===t.state.SubmitState||t.state.IsStudentViewMode)&&t.formRuntimeMaster.TopQuestionRuntimeMasters().forEach((function(i){var r=i.Question.Model,c=i.Question;if(r.IsQuiz)if(c.hasCorrectAnswers(i.Model.QuizResult)&&++o,n+=r.Point||0,s+=i.Model.QuizResult&&i.Model.QuizResult.IsAnswerCorrect?1:0,4===t.state.SubmitState)e+=i.Model.QuizResult&&i.Model.QuizResult.IsAnswerCorrect&&r.Point||0,a=!0;else{var u=i.SubQuestionRuntimeMasters,l=(i=u[u.length-1]||i).getScore();null!=l&&(e+=l,a=!0)}}));if(o||n){var c={className:"office-form-totalscore-bar",tabIndex:-1,autoFocus:!0};if(0===n&&0===e){var u=Math.round(100*s/o)+"%";return c["aria-label"]=Object(r.a)().Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format(Object(r.a)().Response_QuizResult_Title,u),i.createElement("div",c,i.createElement("div",{className:"office-form-point-label"},Object(r.a)().Common_Points_Text+":"),i.createElement("div",{className:"office-form-score-label office-form-theme-primary-foreground"},u))}var l=a?e:"-",h=n||"-";return c["aria-label"]=Object(r.a)().Response_Preview_SubmitNotificationUnderAutoReleaseGrade.format(Object(r.a)().Response_QuizResult_Title,Object(r.a)().Response_ScoreResult_Transcript.format(l,n)),i.createElement("div",c,i.createElement("div",{className:"office-form-point-label"},Object(r.a)().Common_Points_Text+":"),i.createElement("div",{className:"office-form-score-label office-form-theme-primary-foreground"},Object(r.a)().RuntimeView_TotalPoints_Content.format(l,h)))}return null}(t);if(e||n)return i.createElement("div",{className:"office-form-result-container"},e,n)}var a=/^[0-9.]*$/,c=/[0-9]$/;function u(t,e){if(void 0===e&&(e=100),t&&!a.test(t))return null;var n=Number("0"+t);if(isNaN(n))return null;var i=(n-Math.floor(n)).toString();return("0"===i||"0.5"===i)&&n>=0&&n<=e?{point:n,pointString:!!t&&c.test(t)?(Math.floor(10*n)/10).toString():t}:null}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(2),r=n(0),o=n(1),s=n(35),a=n(11),c=n(5),u=n(16),l=n(24),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){var t;return this.state.Loading&&(t=r.createElement("div",{className:"image-picker-loading-container"},r.createElement("div",{className:"image-picker-loading common-spinner-circle"}))),r.createElement("div",{className:"image-picker-container"},this.Ff(),Object(s.l)(),Object(s.k)(),this.createSwitchButtons(),this.createPickerContent(),this.createErrorHandling(),t)},n.createSwicherButton=function(t,e,n){return r.createElement("div",{className:"image-picker-switch-button-wrapper"},Object(l.b)({HTMLAttributes:{className:"image-picker-switch-button",onClick:n},ToggleActive:e,ButtonStyle:"LightBackground",Text:t}))},n.Ff=function(){var t=this,e=Object(a.b)().Model;if("MediaSelect"===e.PreviousFlexPane)return r.createElement("div",null,Object(u.a)({HTMLAttributes:{className:"image-picker-back-button",onClick:function(){Object(c.b)("DesignPage.MediaPicker.Back"),t.setState({Loading:!1,ErrorState:void 0},(function(){e.FlexPane="MediaSelect",t.rejectPickerDeferred()}))}},ButtonStyle:"LightBackground",Icon:"Back",IconClassName:"image-picker-back-button-img forms-icon-size17x17",Text:Object(o.a)().Common_Back_Text,TextClassName:"image-picker-back-button-text"}))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"b",(function(){return v})),n.d(e,"a",(function(){return g}));var i=n(2),r=n(0),o=(n(20),n(19)),s=n(1),a=n(11),c=n(83),u=n(14),l=n(89),h=(n(10),n(5)),f=n(18),d=n(27),b=n(24),m=n(38);function v(){return O.pickVideo()}function g(t){return r.createElement(O,t)}var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return e.pickVideo=function(){return e.videoRejected&&e.videoRejected(),new Promise((function(t,n){e.videoResolved=t,e.videoRejected=n;var i=Object(a.b)().Model;i.FlexPane="VideoPicker",Object(m.f)("Flexpane-VideoPicker",(function(){i.FlexPane="MediaSelect",e.rejectVideoPicker(!0)}))}))},e.rejectVideoPicker=function(t){e.videoRejected&&(e.videoRejected(t),e.videoRejected=null,e.videoResolved=null)},e.collapeFlexPaneHandler=function(){var t=Object(a.b)().Model;"VideoPicker"===t.FlexPane&&(t.FlexPane="None")},n.componentWillUnmount=function(){e.rejectVideoPicker()},n.rejectPickerDeferred=function(){e.rejectVideoPicker(!0)},n.createPickerContent=function(){return this.Pf()},n.createErrorHandling=function(){var t=this.state.ErrorState&&this.state.ErrorState.InnerCode;if(t){var e,n,i;switch(t){case 5400:i=Object(s.a)().Error_Message_5400;break;case 5401:i=Object(s.a)().Error_Message_5401;break;case 5402:i=Object(s.a)().Error_Message_5402;break;case 5403:i=Object(s.a)().Error_Message_5403;break;default:var o=this.state.VideoURL,a=Object(u.B)(),h=Object(l.b)();if(a&&h&&!Object(c.d)(o)){i=Object(s.a)().Error_Message_Client_VideoUrlError;break}if(!h&&Object(c.f)(o)){i=Object(s.a)().Error_Message_Client_Youtube_Disabled_VideoUrlError,n=Object(f.b)({HTMLAttributes:{className:"forms-icon-size32x32"},IconName:"Info"});break}a&&!Object(c.c)(o)&&(i=Object(s.a)().Error_Message_Client_MicrosoftStream_VideoUrlError)}i&&(e=Object(f.b)({HTMLAttributes:{className:"forms-icon-size32x32"},IconName:"Sad"}));return r.createElement("div",{className:"image-picker-error-hanlder-container"},r.createElement("div",{className:"image-picker-error-icon"},n||e),r.createElement("div",{className:"image-picker-error-message"},i))}},n.createSwitchButtons=function(){return r.createElement("div",{className:"image-picker-switch-button-container"},this.createSwicherButton(Object(s.a)().ImagePicker_switcher_VideoUrl,!0,(function(){})))},n.Df=function(t){e.videoResolved&&e.videoResolved(t),e.collapeFlexPaneHandler()},n.Mf=function(){var t=this.state.VideoURL,e=Object(u.B)(),n=Object(l.b)();e&&n&&Object(c.e)(t)||e&&!n&&Object(c.c)(t)||!e&&n&&Object(c.f)(t)?(Object(h.b)("DesignPage.MediaPicker.AddVideo",{videoSrc:Object(c.b)(t)}),this.Df(t),this.setState({VideoURL:void 0,ErrorState:void 0})):(Object(h.b)("DesignPage.MediaPicker.AddVideoFailure",{videoSrc:Object(c.b)(t)}),this.setState({ErrorState:{InnerCode:Object(o.d)()}}))},n.Pf=function(){var t,e=this,n=Object(u.B)(),i=Object(l.b)();n&&i?t=Object(s.a)().VideoPicker_FromUrl_HintMessage:n&&!i?t=Object(s.a)().VideoPicker_MicrosoftStream_FromUrl_HintMessage:!n&&i&&(t=Object(s.a)().ImagePicker_FromUrl_HintMessage);var o=Object(d.b)({Placeholder:t,HTMLAttributes:{className:"fromUrlTextField",onKeyUp:function(t){13===t.keyCode&&e.Mf()}},Value:this.state.VideoURL,TextFieldType:0,MinimalHeight:40,onValueChange:function(t){return e.setState({VideoURL:t,ErrorState:void 0})}}),a=Object(b.b)({HTMLAttributes:{className:"image-picker-add-button from-url","aria-describedby":!1,disabled:!1,onClick:function(){return e.Mf()}},Text:Object(s.a)().ImagePicker_Add_button,ButtonStyle:"LightBackground"}),c=Object(f.b)({HTMLAttributes:{className:"fromUrlIcon"},IconName:"Link"});return r.createElement("div",{className:"fromUrlContainer"},c,r.createElement("div",{className:"fromUrlLabel"},Object(s.a)().ImagePicker_switcher_Url),o,a)},e}(n(235).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return m}));var i=n(79),r=n(146),o=n(223),s=n(2),a=n(100),c=n(17),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(s.__extends)(e,t);var n=e.prototype;return e.getElementTypeName=function(){return"Question.MatrixChoice"},n.verify=function(t){return!this.Model.Required||t&&0!==t.length?c.e.Success:c.e.RequiredError},n.getTypeDisplayName=function(){return"MatrixChoice"},n.getNormalizedAnswer=function(t){return t},e}(a.a),l=n(189),h=n(222),f=n(221),d=n(147),b=n(115);function m(t){switch(t){case"Question.Choice":return i.a;case"Question.TextField":return b.a;case"Question.DateTime":return r.a;case"Question.Rating":return d.a;case"Question.Ranking":return f.a;case"Question.MatrixChoice":return u;case"Question.MatrixChoiceGroup":return l.a;case"Question.NPS":return h.a;case"Question.FileUpload":return o.a;default:throw Error(t+" is not supported")}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return k}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(19),c=n(1),u=n(9),l=n(11),h=n(44),f=n(22),d=n(125),b=n(10),m=n(5),v=n(18),g=n(16),O=n(56),p=n(78),j=n(24),y=n(8),w=n(45),S=n(43),N=n(27),I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Lf=r.createRef(),e.Af=r.createRef(),e.Rf=r.createRef(),e.Ef=r.createRef(),e.Bf=r.createRef(),e._f=!1,e.Hf=!1,e.state={ShowAltTextButton:!0},e.Gf=function(t){return e.qf(t)},e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){document.addEventListener("click",this.Gf)},n.componentDidUpdate=function(){var t=this.Lf.current;this._f&&t&&(o.findDOMNode(t).focus(),this._f=!1);var e=this.Rf.current;this.Hf&&e&&(o.findDOMNode(e).getElementsByTagName("input")[0].focus(),this.Hf=!1)},n.componentWillUnmount=function(){document.removeEventListener("click",this.Gf)},n.render=function(){var t=[];return this.props.Expanded?(this.props.SizeButtontDisabled||t.push(this.Qf()),this.props.ZoomButtonDisabled||t.push(this.Vf()),t.push(this.zf())):t.push(this.Uf()),t.push(this.$f()),r.createElement("div",{className:"image-edit-pane-container office-form-theme-border"},t)},n.Wf=function(){return 2===this.props.ZoomButtonState||0===this.props.ZoomButtonState},n.Kf=function(){return 2===this.props.ZoomButtonState||1===this.props.ZoomButtonState},n.Jf=function(t){this.props.SelectedImageSize!==t&&this.props.onImageStyleChange&&this.props.onImageStyleChange(t)},n.Uf=function(){var t=this,e=Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",disabled:this.props.EditButtonDisabled,id:"image-edit-pane-edit-button",onClick:function(){t.props.onImageEditClick&&t.props.onImageEditClick()}},Icon:"Edit",IconClassName:"forms-icon-size14x14",Text:Object(c.a)().Common_Edit_Text});return this._f=!0,r.createElement("div",{className:"image-edit-pane-edit",key:"edit-button"},e)},n.Qf=function(){var t=this,e="image-edit-pane-inner-button office-form-theme-button-foreground";this.props.SelectedImageSize===w.c.Small&&(e=Object(u.b)(e,"active"));var n={ButtonStyle:"LightBackground",children:Object(v.b)({HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"},IconName:"moderateIcon"}),HTMLAttributes:{"aria-label":Object(c.a)().ImageEditPane_SmallSize_Button||void 0,className:e,onClick:function(){return t.Jf(w.c.Small)},title:Object(c.a)().ImageEditPane_SmallSize_Button||void 0},ref:this.Lf},o=r.createElement(S.a,Object(i.__assign)({},n)),s="image-edit-pane-inner-button office-form-theme-button-foreground";this.props.SelectedImageSize===w.c.Large&&(s=Object(u.b)(s,"active"));var a={ButtonStyle:"LightBackground",children:Object(v.b)({HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"},IconName:"intenseIcon"}),HTMLAttributes:{"aria-label":Object(c.a)().ImageEditPane_LargeSize_Button||void 0,className:s,onClick:function(){return t.Jf(w.c.Large)},title:Object(c.a)().ImageEditPane_LargeSize_Button||void 0}},l=r.createElement(S.a,Object(i.__assign)({},a));return r.createElement("div",{className:"image-edit-pane-element-container office-form-theme-border",key:"size-button"},o,l)},n.Vf=function(){var t=this,e="image-edit-pane-inner-button";this.Wf()||(e=Object(u.b)(e,"office-form-theme-button-foreground"));var n=Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:e,disabled:this.Wf(),onClick:function(){t.props.onImageZoomClick&&t.props.onImageZoomClick(!0,(function(){t.Wf()&&t.Bf.current&&t.Bf.current.focus()}))}},Icon:"ZoomIn",IconClassName:"forms-icon-size15x15",ref:this.Ef,Text:Object(c.a)().ImageEditPane_ZoomIn_Button}),i="image-edit-pane-inner-button";this.Kf()||(i=Object(u.b)(e,"office-form-theme-button-foreground"));var o=Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:i,disabled:this.Kf(),onClick:function(){t.props.onImageZoomClick&&t.props.onImageZoomClick(!1,(function(){t.Kf()&&t.Ef.current&&t.Ef.current.focus()}))}},Icon:"ZoomOut",IconClassName:"forms-icon-size15x15",ref:this.Bf,Text:Object(c.a)().ImageEditPane_ZoomOut_Button});return r.createElement("div",{className:"image-edit-pane-element-container office-form-theme-border",key:"zoom-button"},n,o)},n.zf=function(){var t=this,e=Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:function(){Object(m.b)("DesignPage.ImageEditPane.AltText",{Id:t.props.imageId}),t.setState({ShowAltTextButton:!1})}},Icon:"TextField",IconClassName:"edit-pane-fieldText",ref:this.Af,Text:Object(c.a)().ImageEditPane_AltText_Button}),n=Object(N.b)({AutoSelection:!0,MaxLength:Object(a.p)(),MinimalHeight:28,onValueChange:this.props.onValueChange.bind(this.props),Placeholder:Object(c.a)().ImageEditPane_AltText_PlaceHolder,ref:this.Rf,TextFieldType:0,Value:this.props.Value});return this.state.ShowAltTextButton?r.createElement("div",{className:"image-edit-pane-alttext-button office-form-theme-border",key:"alttext-button"},e):(this.Hf=!0,r.createElement("div",{className:"image-edit-pane-alttext office-form-theme-border",key:"alttext"},n))},n.$f=function(){var t=this,e=Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:function(){t.props.onImageDeleteClick&&t.props.onImageDeleteClick()}},Icon:"Delete",IconClassName:"forms-icon-size14x14",Text:Object(c.a)().Common_Delete_Text});return r.createElement("div",{className:"image-edit-pane-delete",key:"delete-button"},e)},n.qf=function(t){var e=this.Rf.current;e&&(o.findDOMNode(e).contains(t.target)||-1!==t.target.className.indexOf("edit-pane-fieldText")||t.target.title===Object(c.a)().ImageEditPane_AltText_Button||this.setState({ShowAltTextButton:!0}))},e}(y.a),C=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.Xf=!1,n.Zf=r.createRef(),n.Yf=r.createRef(),n.td=r.createRef(),n.ed=r.createRef(),n.nd=Promise.resolve(),n.Gf=function(t){return n.qf(t)},n.rd=function(){return n.od()},n.sd=function(){return n.forceUpdate()},n.ad=function(){return n.pt()},n.state={EditPaneEditButtonDisabled:!0,EditPaneExpanded:!1,ShowImageEditPane:!1,ZoomButtonState:1},n.nn=n.nn.bind(n),n.fu=n.fu.bind(n),n.du=n.du.bind(n),n.ud=n.ud.bind(n),n.ld=n.ld.bind(n),n.hd=n.hd.bind(n),n.fd=n.fd.bind(n),n.bd=n.bd.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=Object(l.g)();this.props.ImageSettingsMaster.validateImageSettings(),this.props.ImageSettingsMaster.observe(this.sd,[t.Schema.Layout,t.Schema.Left,t.Schema.Top]),this.props.ImageSettingsMaster.observe(this.bd,[t.Schema.ContainerHeight,t.Schema.ContainerWidth]),this.props.ImageMaster.observe(this.sd,[Object(l.f)().Schema.ResourceUrl]),document.addEventListener("click",this.Gf),document.addEventListener("wheel",this.rd)},n.componentDidMount=function(){this.md()},n.componentDidUpdate=function(){this.Xf?(this.Xf=!1,this.md()):this.vd()},n.componentWillUnmount=function(){this.ce=!1,this.props.ImageSettingsMaster.unobserve(this.sd),this.props.ImageSettingsMaster.unobserve(this.bd),this.props.ImageMaster.unobserve(this.sd),document.removeEventListener("click",this.Gf),document.removeEventListener("wheel",this.rd);var t=this.props.ImageMaster.Model;t&&t.ErrorType!==f.a.NoError&&(t.ErrorType=f.a.NoError);var e=this.Zf.current;if(e){if(!this.sr()){var n=this.props.ImageSettingsMaster.Model,i=$(e).cropper("getCanvasData");i.naturalHeight===n.NaturalHeight&&i.naturalWidth===n.NaturalWidth&&(n.Left=Math.round(i.left),n.Top=Math.round(i.top),n.ActualWidth=Math.round(i.width),n.ActualHeight=Math.round(i.height))}$(e).cropper("destroy")}},n.render=function(){var t=s.extend({},this.props.HTMLAttributes);return t.className=Object(u.b)(t.className,"design-page-image-container"),r.createElement("div",Object(i.__assign)({},t),this.Od(),this.pd(),this.jd(),this.vf(),!1)},n.vd=function(){var t=this.props.ImageMaster.Model,e=this.props.ImageSettingsMaster.Model;if(!this.sr()&&t.ResourceUrl&&(null===t.ErrorType||t.ErrorType===f.a.NoError)){var n=this.Zf.current;if(n)try{$(n).cropper("setCanvasData",{height:e.ActualHeight||e.ContainerHeight,left:e.Left||0,naturalHeight:e.NaturalHeight,naturalWidth:e.NaturalWidth,top:e.Top||0,width:e.ActualWidth||e.ContainerWidth}),this.state.EditPaneExpanded?$(n).cropper("enable"):$(n).cropper("disable")}catch(t){var i=t.message||void 0,r=t.stack||void 0;Object(m.b)("Image.CanvasRender.Failure",{error:i+" "+r,imageSrc:n.src,imageType:this.props.IsFormLogo?"Logo":"Question",location:"0"})}}},n.md=function(){var t=this,e=this.props.ImageMaster.Model,n=this.props.ImageSettingsMaster.Model,i=new h.a;if(!this.sr()&&e.ResourceUrl&&(null===e.ErrorType||e.ErrorType===f.a.NoError)){var r=this.Zf.current;r&&(this.nd.finally((function(){try{$(r).cropper("destroy"),$(r).cropper({autoCropArea:1,background:!1,built:function(){var e=document.getElementsByClassName("cropper-invisible");$(e).css("opacity",0),Object(m.b)("Image.CanvasRender.Success",{imageType:t.props.IsFormLogo?"Logo":"Question",location:"0"}),t.vd(),i.resolve()},center:!1,checkCrossOrigin:!1,cropBoxMovable:!1,cropBoxResizable:!1,dragMode:"move",guides:!1,highlight:!1,minCanvasHeight:n.ContainerHeight,minCanvasWidth:n.ContainerWidth,minContainerHeight:0,minContainerWidth:0,modal:!1,responsive:!0,restore:!1,toggleDragModeOnDblclick:!1,viewMode:3})}catch(n){var e=n.message||void 0,o=n.stack||void 0;Object(m.b)("Image.CanvasRender.Failure",{error:e+" "+o,imageSrc:r.src,imageType:t.props.IsFormLogo?"Logo":"Question",location:"0"}),i.reject()}})),this.nd=i.promise())}},n.vf=function(){if(this.sr())return e.createSpinnerInternal()},e.createSpinnerInternal=function(t){var e=r.createElement(p.a,Object(i.__assign)({},{ClassName:"designPage-quesion-imageUpload-spinner",Ignorable:!1}));return r.createElement("div",{className:"image-spinner",ref:t},e)},n.Od=function(){var t,n,o,s,l,h,d,m=this.props.ImageMaster&&this.props.ImageMaster.Model;if(null!==m.ErrorType&&m.ErrorType!==f.a.NoError)return null;if(!m.ResourceUrl&&!this.sr())return null;var v=e.createSpinnerInternal(this.ed);if(m.ResourceUrl){n="design-question-title-image-button",m.ImageProcessingStatus===f.c.Deleting?n=Object(u.b)(n,"office-form-theme-border","design-question-title-image-gray"):d=this.Yf;var g=this.props.ImageSettingsMaster&&this.props.ImageSettingsMaster.Model;g?g.ContainerWidth&&g.ContainerHeight&&(l=g.ContainerHeight+"px",h=g.ContainerWidth+"px",!this.props.IsFormLogo&&g.ContainerWidth>Object(a.E)()&&(h=Object(a.E)()+"px",l=g.ContainerHeight/g.ContainerWidth*Object(a.E)()+"px"),t=m.ResourceUrl):t=m.ResourceUrl}t||(n="design-question-title-image-button-placeholder office-form-theme-border",s=Object(a.u)()+"px",o=Object(a.v)()+"px");var O=Object(b.c)((function(){return{}}),b.f);return r.createElement("div",{ref:d},r.createElement("div",Object(i.__assign)({"aria-label":Object(c.a)().DesignPage_Image_ImageDesigner,className:n,onKeyDown:this.nn,style:{height:s,width:o},tabIndex:0},O),r.createElement("img",{alt:m.AltText,className:"design-question-title-image-hidden",height:l,onError:this.du,onLoad:this.fu,ref:this.Zf,src:t,title:m.AltText,width:h})),v)},n.nn=function(t){var e=this.Zf.current;switch(t.keyCode){case 46:this.pt();break;case 37:$(e).cropper("move",-10,0);break;case 38:$(e).cropper("move",0,-10);break;case 39:$(e).cropper("move",10,0);break;case 40:$(e).cropper("move",0,10)}},n.fu=function(){Object(m.b)("Image.ImageOnLoad.Success",{imageType:this.props.IsFormLogo?"Logo":"Question",location:"0"});var t=this.ed.current;t&&$(t).css("display","none"),this.Xf=!0,this.setState({EditPaneEditButtonDisabled:!1,ShowImageEditPane:!0})},n.du=function(t){var e=this.Zf.current;if(e){$(e).css("visibility","visible"),Object(m.b)("Image.ImageOnLoad.Failure",{imageSrc:e.src,imageType:this.props.IsFormLogo?"Logo":"Question",location:"0"});var n=this.ed.current;n&&$(n).css("display","none"),this.setState({EditPaneEditButtonDisabled:!0,ShowImageEditPane:!0})}},n.jd=function(){var t=this,e=this.props.ImageSettingsMaster.Model,n=this.props.ImageMaster,o=n.Model;if(this.sr()||o.ErrorType===f.a.NoError)return null;var s,a=Object(O.a)({HTMLAttributes:{className:"error-message"},Label:n.getImageErrorMessage()});if(o.ErrorType===f.a.DeleteFailError){var u={ButtonStyle:"LightBackground",HTMLAttributes:{className:"office-form-theme-primary-foreground",onClick:function(){return n.clear()}},Text:Object(c.a)().Common_Try_again_Text};s=r.createElement(j.a,Object(i.__assign)({},u))}else s=Object(g.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"office-form-theme-primary-foreground",onClick:function(){Object(m.b)(t.props.IsFormLogo?"DesignPage.Form.Logo.AddImage":"DesignPage.Questions.AddImage"),Object(d.b)().then((function(t){return n.addImage(t)}))}},Icon:"Photo2",IconClassName:"errorPictureIcon forms-icon-size12x12",Text:Object(c.a)().Common_Try_again_Text});var l=Object(v.b)({HTMLAttributes:{className:"image-error-frowny-icon"},IconName:"Sad"});return r.createElement("div",{className:"design-image-error office-form-theme-border",style:{height:e.ContainerHeight,width:e.ContainerWidth}},l,a,r.createElement("div",null,s))},n.pd=function(){var t=this.props.ImageMaster.Model,e=this.props.ImageSettingsMaster&&this.props.ImageSettingsMaster.Model;return t.ResourceUrl&&!this.sr()&&t.ErrorType===f.a.NoError&&this.state.ShowImageEditPane?r.createElement(I,{EditButtonDisabled:this.state.EditPaneEditButtonDisabled,Expanded:this.state.EditPaneExpanded,imageId:t.ResourceId,onImageEditClick:this.ld,onImageStyleChange:this.props.IsFormLogo?void 0:this.hd,onImageZoomClick:this.fd,onImageDeleteClick:this.ad,onValueChange:this.ud,ref:this.td,SelectedImageSize:e&&e.Size,SizeButtontDisabled:this.props.IsFormLogo,Value:t.AltText,ZoomButtonDisabled:!1,ZoomButtonState:this.state.ZoomButtonState}):t.ResourceUrl&&this.sr()?r.createElement(I,{EditButtonDisabled:!0,imageId:t.ResourceId,onImageDeleteClick:this.ad,onValueChange:this.ud,ref:"edit-pane-container",Value:t.AltText}):void 0},n.ud=function(t){this.props.ImageMaster.Model.AltText=t},n.hd=function(t){var e=this.props.ImageMaster.Model,n=this.props.ImageSettingsMaster,i=n.Model;Object(m.b)("DesignPage.ImageEditPane.Style",{imageId:e.ResourceId,style:t}),i.Size!==t&&this.setState({ZoomButtonState:1}),n.onImageStyleChange(t)},n.ld=function(){Object(m.b)("DesignPage.ImageEditPane.Edit"),this.setState({EditPaneExpanded:!0});var t=this.Zf.current;$(t).cropper("enable"),this.od()},n.fd=function(t,e){var n=this.Zf.current;if(t)switch(this.state.ZoomButtonState){case 3:case 1:$(n).cropper("zoom",.1),Object(m.b)("DesignPage.ImageEditPane.ZoomIn")}else switch(this.state.ZoomButtonState){case 3:case 0:$(n).cropper("zoom",-.1),Object(m.b)("DesignPage.ImageEditPane.ZoomOut")}this.od(e)},n.od=function(t){if(!this.sr()){var e=this.Zf.current,n=$(e).cropper("getCanvasData"),i=this.props.ImageSettingsMaster.Model,r=void 0;n.width&&n.height&&(this.props.ImageSettingsMaster.bulkEdit((function(t){t.Left=Math.round(n.left),t.Top=Math.round(n.top),t.ActualWidth=Math.round(n.width),t.ActualHeight=Math.round(n.height)})),r=n.width>2*i.ContainerWidth&&n.height>2*i.ContainerHeight?0:n.width-i.ContainerWidth<1||n.height-i.ContainerHeight<1?1:3,this.state.ZoomButtonState!==r&&this.setState({ZoomButtonState:r},t))}},n.pt=function(){var t=this,e=this.props.ImageMaster,n=this.props.ImageSettingsMaster;Object(m.b)("DesignPage.ImageEditPane.Delete",{imageKind:this.props.IsFormLogo?"Logo":"Question"}),e.clear().then((function(){var e=t.Zf.current;$(e).cropper("destroy"),n.clear(),t.ce&&t.setState({EditPaneExpanded:!1})}))},n.qf=function(t){if(this.state.EditPaneExpanded&&-1===t.target.id.indexOf("image-edit-pane-edit-button")&&t.target.parentElement&&-1===t.target.parentElement.id.indexOf("image-edit-pane-edit-button")&&-1===t.target.parentElement.className.indexOf("forms-icon-container")){var e=this.Yf.current,n=this.td.current;if(e&&n){var i=o.findDOMNode(e),r=o.findDOMNode(n);if(!i.contains(t.target)&&!r.contains(t.target)&&-1===t.target.className.indexOf("ms-Icon")&&t.target.title!==Object(c.a)().ImageEditPane_AltText_Button){var s=this.Zf.current;$(s).cropper("disable"),this.setState({EditPaneExpanded:!1})}}}},n.sr=function(){return this.props.ImageMaster.Model.ImageProcessingStatus!==f.c.Idle},n.bd=function(){this.Xf=!0},e}(y.a);function k(t){var e=t.ImageMaster.Model;return e.ImageProcessingStatus===f.c.Picking||e.ErrorType!==f.a.NoError||Object(f.g)(e)?r.createElement(C,Object(i.__assign)({},t)):void 0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),r=n(6),o=n(4),s=n(7),a=n(77),c=n(35),u=n(25),l=n(13),h={BackgroundColor:o.a.string({IsLocalField:!0}),BackgroundImage:o.a.string({IsLocalField:!0}),Name:o.a.string(),PrimaryColor:o.a.string({IsLocalField:!0}),SecondaryColor:o.a.string({IsLocalField:!0}),Thumbnail:o.a.string({IsLocalField:!0})},f=function(t){function e(e){var n=t.call(this,e)||this;if(e.MasterTreeReady){var i=l.a.Schema;e.MasterTreeReady.then((function(){return n.Form.fieldsReady([i.Theme])})).then((function(){return n.Form.ensureFieldsReady([i.PrimaryCustomizedThemeColor,i.SecondaryCustomizedThemeColor,i.TertiaryCustomizedThemeColor,i.Background])})).then((function(){return n.yd()}))}return n}Object(i.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"Form",{get:function(){return this.Parent},enumerable:!1,configurable:!0}),n.isCustomized=function(){return this.Model.Name===a.a},n.getCustomizedTheme=function(){var t=this.Form.Model,e=Object(c.d)();return{BackgroundColor:t.TertiaryCustomizedThemeColor||e.BackgroundColor,BackgroundImage:t.Background.ResourceUrl,Name:a.a,PrimaryColor:t.PrimaryCustomizedThemeColor||e.PrimaryColor,SecondaryColor:t.SecondaryCustomizedThemeColor||e.SecondaryColor,Thumbnail:null}},n.yd=function(){var t=this;this.addRule({Name:"calculate theme basing on name",onChange:function(e){e.BeingDeleted||t.wd()}});var e=l.a.Schema;this.Form.observe((function(){return t.wd()}),[e.PrimaryCustomizedThemeColor,e.SecondaryCustomizedThemeColor,e.TertiaryCustomizedThemeColor,e.Background.ResourceUrl]),this.wd()},n.wd=function(){var t=this,e=this.Model.Name;switch(e){case a.a:this.setData(this.getCustomizedTheme());break;case a.b:this.setData(Object(c.d)());break;default:var n=Object(s.a)().themeConfig;if(n&&"object"==typeof n&&n[e]&&"object"==typeof n[e])return void this.setData(n[e]);this.Sd(e).then((function(e){return t.setData(e)}))}},n.Sd=function(t){return this.Form.SyncContext!==u.a.ResponseTimeForm?Object(a.c)(t):Object(a.d)(t)},e}(r.a.createObjectMasterClass("FormTheme",h))},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return g}));var i,r=n(2),o=n(0),s=n(20),a=n(7),c=n(1),u=n(76),l=n(9),h=n(162),f=n(230),d=(n(10),n(123)),b=n(16),m=new Date("1/1/1753 12:00:00 AM"),v=new Date("12/31/9999 11:59:59 PM");function g(t){return o.createElement(O,t)}!function(t){t[t.DatePicker=0]="DatePicker",t[t.TimePicker=1]="TimePicker",t[t.DateTimePicker=2]="DateTimePicker"}(i||(i={}));var O=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(r.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t=this.props,e=t.Options,n=e&&e.classNameForInnerDiv,i=e&&e.classNameForInnerLabel,r=t.Disabled;return[t.Label?o.createElement("span",{className:i,disabled:r},t.Label):void 0,o.createElement("div",{className:n,disabled:r},this.Nd()?this.Cd():void 0,this.kd()?this.Td():void 0,t.children)]},n.componentWillMount=function(){void 0===e.timeFormat&&this.kd()&&(e.timeFormat=Object(a.a)().cultureInfo.DateTimeFormat.ShortTimePattern,e.timeFormat=e.timeFormat.replace(/mm/g,"i").replace(/tt/g,"A").replace(/s/g,"0"),(e.timeFormat.indexOf("m")>=0||e.timeFormat.indexOf("t")>=0)&&(e.timeFormat=null))},n.componentDidMount=function(){var t=this;this.xd=Object(f.a)(),this.xd.then((function(){if(t.Nd()){var e=s.findDOMNode(t.refs.date_picker),n=$(e).pickadate(t.Fd());t.Pd=n.pickadate("picker")}if(t.kd()){var i=s.findDOMNode(t.refs.time_picker),r=$(i).pickatime(t.Dd());t.Md=r.pickatime("picker")}t.Ld()}))},n.componentDidUpdate=function(){var t=this;this.xd.then((function(){return t.Ld()}))},n.Cd=function(){var t=this,e=this.props,n=e.Options&&e.Options.HTMLPropsForInnerElement;return o.createElement("div",{className:"office-form-date-time-picker office-form-theme-focus-border"},o.createElement("input",Object(l.g)(n,{className:"form-control border-no-radius datepicker",disabled:e.Disabled,placeholder:e.Placeholder||Object(a.a)().cultureInfo.DateTimeFormat.ShortDatePattern,ref:"date_input",onFocus:function(){e.onValueValidation&&e.onValueValidation(!0,0)},onBlur:function(){var e=s.findDOMNode(t.refs.date_input).value,n=t.props;if(""===e&&null!=n.Value&&n.ShowClearButton)t.Ad(),t.Rd(void 0);else if(e&&e!==t.Ed()){var i=Date.parseDate(e,Object(a.a)().cultureInfo.DateTimeFormat.ShortDatePattern,Object(a.a)().cultureInfo),r=0;null==i&&(r=1),(i<=m||i>=v)&&(r=2),0!==r?n.onValueValidation&&n.onValueValidation(!0,r):t.Rd(i)}},onClick:function(n){e.Disabled||(n.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),t.Bd())},onKeyUp:Object(l.h)((function(t){return t.stopPropagation()}),27),onKeyDown:!1})),Object(b.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Icon:"Calendar",IconClassName:"dateIcon forms-icon-size20x20",HTMLAttributes:{disabled:e.Disabled,tabIndex:-1,onClick:function(n){e.Disabled||(n.stopPropagation(),n.nativeEvent.stopImmediatePropagation(),t.Bd())}},Text:e.DateTitle}),o.createElement("input",{ref:"date_picker",style:{display:"none"}}))},n.Td=function(){var t=this,e=this.props;return o.createElement("div",{className:"office-form-date-time-picker office-form-theme-focus-border"},o.createElement("input",{className:"form-control border-no-radius datepicker",disabled:e.Disabled,placeholder:e.TimePlaceholder||Object(a.a)().cultureInfo.DateTimeFormat.ShortTimePattern,readOnly:!0,tabIndex:-1,ref:"time_picker",onFocus:function(){e.onValueValidation&&e.onValueValidation(!1,0)},onBlur:function(){var e=s.findDOMNode(t.refs.time_picker).value;if(e&&e!==t._d()){var n=t.props,i=void 0;i=t.Nd()?new Date(n.Value):new Date;var r=Date.parseTime(e,Object(a.a)().cultureInfo.DateTimeFormat.ShortTimePattern,Object(a.a)().cultureInfo);if(isNaN(r))n.onValueValidation&&n.onValueValidation(!1,1);else{var o=Math.floor(r/1e3/60/60),c=r/1e3/60%60,u=r/1e3%60;i.setHours(o,c,u),t.Rd(i,!0)}}},onKeyUp:Object(l.h)((function(t){return t.stopPropagation()}),27)}),Object(b.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Icon:this.props.TimeIcon||"ChevronDown",IconClassName:"dateCaretDown forms-icon-size16x16",HTMLAttributes:Object(l.g)(e.Options&&e.Options.HTMLPropsForInnerElement,{disabled:e.Disabled,onClick:function(n){e.Disabled||(n.stopPropagation(),t.Md.open())}}),Text:e.TimeTitle}))},n.Fd=function(){var t=this,e=Object(c.a)();return{monthsShort:Object(a.a)().cultureInfo.DateTimeFormat.AbbreviatedMonthNames,weekdaysShort:Object(a.a)().cultureInfo.DateTimeFormat.AbbreviatedDayNames,firstDay:Object(a.a)().cultureInfo.DateTimeFormat.FirstDayOfWeek,today:e.DateTimePicker_Button_Today||void 0,clear:this.props.ShowClearButton?e.DateTimePicker_Button_Clear||void 0:"",close:e.Common_Close_Text||void 0,labelMonthNext:e.DateTimePicker_Label_NextMonth||void 0,labelMonthPrev:e.DateTimePicker_Label_PrevMonth||void 0,labelMonthSelect:e.DateTimePicker_Label_SelectMonth||void 0,labelYearSelect:e.DateTimePicker_Label_SelectYear||void 0,closeOnClear:!1,editable:!0,selectYears:200,selectMonths:!1,showMonthsShort:!0,onSet:function(e){var n;void 0===e.clear?null!=e.select&&(n=Object(h.a)(e.select)?new Date(e.select):e.select.obj,t.Rd(n)):t.Rd(void 0)}}},n.Dd=function(){var t=this;return{clear:"",format:e.timeFormat,editable:!this.props.IsTimeInputDisabled,interval:15,select:this.Hd(),onSet:function(e){if(null!=e.select){var n;if(t.Nd()){var i=new Date(t.props.Value),r=void 0,o=void 0;Object(h.a)(e.select)?(r=e.select%60,o=(e.select-r)/60):(o=e.select.hour,r=e.select.mins),i.setHours(o,r,0,0),n=i.toJSON()}else n=e.select.toString();t.props.Value!==n&&(t.props.onValueChange(n),t.forceUpdate())}}}},n.Bd=function(){this.Pd&&this.Pd.open()},n.Ad=function(){this.Pd&&this.Pd.clear()},n.Nd=function(){return this.props.Type!==i.TimePicker},n.kd=function(){return this.props.Type!==i.DatePicker},n.Gd=function(){var t=this.props.Value;return this.Nd()?isNaN(Date.parse(t)):isNaN(Number(t))},n.qd=function(){if(this.Nd()&&!this.Gd())return this.props.IsLocaleInvariant?e.parseLocaleInvariantString(this.props.Value).valueOf():Date.parse(this.props.Value)},n.Ed=function(){if(this.Nd())return this.Gd()?"":(this.props.IsLocaleInvariant?Date.parseDate(this.props.Value,"yyyy-MM-dd",Object(a.a)().cultureInfo):new Date(this.props.Value)).toDateShortString(Object(a.a)().cultureInfo)},n.Hd=function(){if(this.kd()&&!this.Gd()){if(this.Nd()){var t=new Date(this.props.Value);return 60*t.getHours()+t.getMinutes()}return parseInt(this.props.Value)}},n._d=function(){if(this.kd())return this.Gd()?"":new Date(this.props.Value).toLocaleTimeString(Object(a.a)().cultureInfo.Name)},n.Rd=function(t,n){var i,r=this.props;if(null!=t){var o=new Date(r.Value);o.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n&&o.setHours(t.getHours(),t.getMinutes(),t.getSeconds()),i=r.IsLocaleInvariant?e.formatLocaleInvariantString(o,!this.kd()):o.toJSON()}r.Value!==i&&(r.onValueChange(i),this.forceUpdate())},n.Ld=function(){var t=this.props,e=new Date(t.Value),n={Start:void 0,End:void 0},i=!1,r=!1;if(t.AllowedDateTime){if(t.AllowedDateTime.Start){n.Start=new Date(t.AllowedDateTime.Start.toJSON());var o=15,a=t.InSettingPane?1:o;n.Start.setMinutes(n.Start.getMinutes()+a,0,0),i=Object(u.c)(n.Start,e)}t.AllowedDateTime.End&&(n.End=new Date(t.AllowedDateTime.End.toJSON()),n.End.setMinutes(0,0,0),r=Object(u.c)(n.End,e),Object(u.a)(n.End,e)<0&&n.End.setDate(n.End.getDate()-1))}this.Nd()&&(this.Pd.set({min:void 0!==n.Start&&n.Start,max:void 0!==n.End&&n.End,select:this.qd()}),s.findDOMNode(this.refs.date_input).value=this.Ed());if(this.kd()){o=15;t.AllowedDateTime&&t.AllowedDateTime.Start&&(n.Start=new Date(t.AllowedDateTime.Start.toJSON()),n.Start.setMinutes(Math.floor(n.Start.getMinutes()/o)*o)),this.Md.set({min:i&&n.Start,max:r&&n.End,select:this.Hd(),highlight:this.Qd(),view:this.Qd()})}},n.Qd=function(){if(this.kd()&&!this.Gd()){if(this.Nd()){var t=new Date(this.props.Value);return t.setMinutes(15*Math.floor(t.getMinutes()/15)),60*t.getHours()+t.getMinutes()}return parseInt(this.props.Value)}},e.formatLocaleInvariantString=function(t,e){var n=new Date;n.setUTCFullYear(t.getFullYear(),t.getMonth(),t.getDate()),n.setUTCHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds());var i=n.toISOString();return i.slice(0,i.indexOf(e?"T":"Z"))},e.parseLocaleInvariantString=function(t){var e=new Date(t);return e.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),e.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),e},e}(d.a)},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e){var n,i,r=t.exports={};function o(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(t){n=o}try{i="function"==typeof clearTimeout?clearTimeout:s}catch(t){i=s}}();var c,u=[],l=!1,h=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):h=-1,u.length&&d())}function d(){if(!l){var t=a(f);l=!0;for(var e=u.length;e;){for(c=u,u=[];++h<e;)c&&c[h].run();h=-1,e=u.length}c=null,l=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===s||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function b(t,e){this.fun=t,this.array=e}function m(){}r.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new b(t,e)),1!==u.length||l||a(d)},b.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=m,r.addListener=m,r.once=m,r.off=m,r.removeListener=m,r.removeAllListeners=m,r.emit=m,r.prependListener=m,r.prependOnceListener=m,r.listeners=function(t){return[]},r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(t,e,n){"use strict";n.d(e,"a",(function(){return a})),n.d(e,"b",(function(){return c}));var i=n(15),r=n(7),o=n(46),s=n(129),a=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return Object(s.c)()},e.handleAuthForContentPage=function(t){},e.handleAuthForAddinPage=function(){},e.hasUserLoggedIn=function(){return!!Object(r.a)().userInfo.UserId},e.isValid=function(){return Object(i.o)()},e.redirectToLogin=function(){return Object(o.f)(Object(o.b)()),new Promise((function(){}))},e.refreshToken=function(){return Object(s.d)()},e.signIn=function(){return this.redirectToLogin()},e.signOut=function(){return Object(o.c)(Object(r.a)().signOutLink)},t}();function c(t){var e;if(t){var n=encodeURIComponent(t);e=window.location.origin+"/?redirecturl="+n+"#Login=True"}else e=window.location.origin+"#Login=True";Object(o.f)(e)}},function(t,e,n){"use strict";n.d(e,"a",(function(){return u}));var i=n(2),r=n(0),o=n(20),s=n(1),a=n(9),c=n(94),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.Vd(),this.unregisterTooltipMouseOverEventHandler(),t.prototype.componentWillUnmount.call(this)},n.componentDidMount=function(){this.Vd(),this.zd(),this.registerTooltipMouseOverEventHandler(),t.prototype.componentDidMount.call(this)},n.insightViewDescriptionDetail=function(){return r.createElement("div",{className:"association-rule-insight-container"},r.createElement("div",{className:"association-rule-insight-description"},this.Ud(),this.$d()))},n.shouldShowSourceQuestions=function(){return!1},n.insightViewSourceQuestions=function(){return null},n.updateContent=function(){this.Vd(),this.zd(),this.registerTooltipMouseOverEventHandler(),this.Wd("chartDescription")},e.getAnswerValue=function(t){var e=t.Value[0].RawValue;if("Rating"===t.Question.Type||"NPS"===t.Question.Type){var n=c.a.getRatingRange(t.Question.Choices.length);switch(t.Value[0].RawValue){case"Detractors":e=Object(s.a)().AnalyzeView_Insight_Association_Rule_Detractor_Answer;break;case"High":e=Object(s.a)().AnalyzeView_Insight_Association_Rule_High_Rating_Template.format(n[1][0],n[1][1]);break;case"Low":e=Object(s.a)().AnalyzeView_Insight_Association_Rule_Low_Rating_Template.format(n[0][0],n[0][1]);break;case"Passives":e=Object(s.a)().AnalyzeView_Insight_Association_Rule_Passive_Answer;break;case"Promoters":e=Object(s.a)().AnalyzeView_Insight_Association_Rule_Promoter_Answer}}return Object(a.i)(e)},e.isCategorizedType=function(t){var e=t.Type.toUpperCase();return"RATING"===e||"NPS"===e},n.Ud=function(){var t,n=this.props.Insight,i=e.isCategorizedType(n.ConditionAnswers[0].Question),o=e.isCategorizedType(n.TargetAnswer.Question),c=(t=100===Math.ceil(100*n.ConfidenceValue)?i&&o?Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Categorized_All:i?Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Common_All:o?Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Common_Categorized_All:Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Common_Common_All:i&&o?Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Categorized:i?Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Categorized_Common:o?Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Common_Categorized:Object(s.a)().AnalyzeView_Insight_Association_Rule_Description_Common_Common).format(e.getAnswerValue(n.ConditionAnswers[0]),e.createSourceQuestionTooltip(n.ConditionAnswers[0].Question),e.getAnswerValue(n.TargetAnswer),e.createSourceQuestionTooltip(n.TargetAnswer.Question)),u=t.format(e.getAnswerValue(n.ConditionAnswers[0]),Object(a.i)(n.ConditionAnswers[0].Question.Title),e.getAnswerValue(n.TargetAnswer),Object(a.i)(n.TargetAnswer.Question.Title));return r.createElement("div",{"aria-label":u,className:"association-rule-insight-description-text-container",dangerouslySetInnerHTML:{__html:c},tabIndex:0})},n.$d=function(){var t,n,i=this.props.Insight;t=e.isCategorizedType(i.ConditionAnswers[0].Question)?Object(s.a)().AnalyzeView_Insight_Association_Rule_Legend_Support_Categorized:Object(s.a)().AnalyzeView_Insight_Association_Rule_Legend_Support_Common,n=e.isCategorizedType(i.TargetAnswer.Question)?Object(s.a)().AnalyzeView_Insight_Association_Rule_Legend_Target_Categorized:Object(s.a)().AnalyzeView_Insight_Association_Rule_Legend_Target_Common;var o=t.format(Math.ceil(100*i.SupportValue),e.getAnswerValue(i.ConditionAnswers[0]),e.createSourceQuestionTooltip(i.ConditionAnswers[0].Question)),u=n.format(Math.ceil(100*i.ConfidenceValue),e.getAnswerValue(i.TargetAnswer),e.createSourceQuestionTooltip(i.TargetAnswer.Question)),l=t.format(Math.ceil(100*i.SupportValue),e.getAnswerValue(i.ConditionAnswers[0]),Object(a.i)(i.ConditionAnswers[0].Question.Title)),h=n.format(Math.ceil(100*i.ConfidenceValue),e.getAnswerValue(i.TargetAnswer),Object(a.i)(i.TargetAnswer.Question.Title)),f=c.b[this.props.Index%c.b.length][0],d=c.b[this.props.Index%c.b.length][1];return r.createElement("div",{"aria-label":l+" "+h,className:"association-rule-insight-view-charts-container",tabIndex:0},r.createElement("div",{className:"association-rule-insight-view-chart"},r.createElement("div",{className:"association-rule-insight-view-chart-row"},r.createElement("div",{className:"association-rule-insight-view-support-chart"}),r.createElement("div",{className:"association-rule-insight-view-target-chart"})),r.createElement("div",{className:"association-rule-insight-view-description-row animation",ref:"chartDescription"},r.createElement("div",{className:"association-rule-insight-view-legend-container support"},r.createElement("div",{className:"association-rule-insight-view-legend-dot",style:{background:f}}),r.createElement("div",{className:"association-rule-insight-view-legend-description",dangerouslySetInnerHTML:{__html:o}})),r.createElement("div",{className:"association-rule-insight-view-legend-container target"},r.createElement("div",{className:"association-rule-insight-view-legend-dot",style:{background:d}}),r.createElement("div",{className:"association-rule-insight-view-legend-description",dangerouslySetInnerHTML:{__html:u}})))))},n.zd=function(){var t=this.props.Insight,n=Math.ceil(100*t.SupportValue),i=t.ConditionAnswers.map((function(t){return e.getAnswerValue(t)}));this.Kd(n,i,0);var r=Math.ceil(100*t.ConfidenceValue),o=[e.getAnswerValue(t.TargetAnswer)];this.Kd(r,o,1)},n.Vd=function(){d3.select(".association-rule-insight-view-charts-container").selectAll("svg").remove()},n.Kd=function(t,e,n){var i=0===n;e=e.map((function(t){return t.length>=25?t.slice(0,22)+"...":t}));var r=[{name:"main",percent:t},{name:"other",percent:100-t}],o=i?150:300,s=i?74:45,a=i?62:38,u=i?75:250,l=i?0:1,h=c.b[this.props.Index%c.b.length][l],f=d3.scale.ordinal().range([h,"#E0E0E0"]),d=d3.layout.pie().value((function(t){return t.percent})).sort(null).padAngle(.03),b=d3.svg.arc().outerRadius(s).innerRadius(a),m=i?".association-rule-insight-view-support-chart":".association-rule-insight-view-target-chart",v=d3.select(m).append("svg").attr({width:o,height:150}).append("g").attr({transform:"translate("+u+",75)"});v.selectAll("path").data(d(r)).enter().append("path").attr({d:b,fill:function(t,e){return f(t.data.name)}}).transition().duration(1e3).attrTween("d",(function(t){var e=d3.interpolate({startAngle:0,endAngle:0},t);return function(t){return b(e(t))}}));setTimeout((function(){i||v.append("path").attr({class:"association-rule-chart-pointer",d:"M -25 -40 A 43 45 0 0 0 -25 40 L -250 0"}),v.selectAll("text").data(d(r)).enter().append("text").transition().duration(200).attr("dy",".4em").attr("text-anchor","middle").attr("class","association-rule-chart-percentage-text").text((function(t,e){if(0===e)return t.data.percent+"%"}))}),1e3)},n.Wd=function(t){var e=$(o.findDOMNode(this.refs[t]));e&&e.length>0&&(e.removeClass("animation"),window.setTimeout((function(){return e.addClass("animation")}),0))},e}(c.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var i=n(3),r=n(54),o=n(50),s=n(246),a=[];function c(t,e,n,c){void 0===c&&(c=!1);var u=Object(o.b)();if(u){var l={FormId:u,UserActionName:t,UserActionType:e,UserSignalType:n},h=Object(r.c)("UserActionSignalMaxQueueLength",10),f=(new Date).toUTCString();l.UpdateActionUTCTime=[];var d=function(t){return a&&i.find(a,(function(e){return e.UserActionName===t.UserActionName&&e.UserActionType===t.UserActionType}))}(l);if(d){var b=d.UpdateActionUTCTime;b.push(f),l.UpdateActionUTCTime=b}else l.UpdateActionUTCTime.push(f),a.push(l);var m=0;a.forEach((function(t){m+=t.UpdateActionUTCTime.length})),(c||m>=h)&&(Object(s.b)(a),a=[])}}},function(t,e,n){"use strict";n.d(e,"a",(function(){return i})),n.d(e,"b",(function(){return s}));var i,r=n(186),o=n(135);function s(t){var e=Object(r.a)()+"intelligence/api/";return Object(o.a)({body:JSON.stringify(t),method:"POST",qosEventName:"Intelligence.LogUserActionSignals",requestUri:e+"LogUserActionSignals"})}!function(t){t[t.Form=0]="Form",t[t.Question=1]="Question",t[t.Response=2]="Response",t[t.ThemeSuggestion=3]="ThemeSuggestion"}(i||(i={}))},function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));var i=n(15),r=n(149),o=n(1);function s(t){var e=Object(o.a)(),n="";if(t)if(t.correlationId){var s=t;s.innerCode&&(n=Object(r.a)(""+s.innerCode)||e.Error_Message_Default.format(s.innerCode))}else{switch(t.name){case"LoginIECrossZoneError":n=e.Error_Message_Client_LoginIECrossZoneError.format(window.location.origin,Object(i.b)());break;case"ThirdPartyCookieBlockedError":n=e.Error_Message_Client_ThirdPartyCookieError.format(Object(i.b)());break;case"AuthNoStorageError":n=e.Error_Message_Client_AuthNoStorageError;break;case"AADAcquireTokenMfaCheckError":n=e.Error_Message_705;break;case"TeamSiteNoGroupError":n=e.Error_Message_Client_TeamSiteNoGroupError}}return n}},function(t,e,n){"use strict";n.d(e,"a",(function(){return o}));var i=n(2),r=n(0);function o(t){return r.createElement(s,t)}var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(i.__extends)(e,t),e.prototype.render=function(){return r.createElement("div",{className:this.props.ClassName},r.createElement("div",{className:"common-spinner-dot common-spinner-dot1"}),r.createElement("div",{className:"common-spinner-dot common-spinner-dot2"}),r.createElement("div",{className:"common-spinner-dot common-spinner-dot3"}),r.createElement("div",{className:"common-spinner-dot common-spinner-dot4"}))},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var i=n(0);function r(t){var e,n=i.useState(!0),r=n[0],o=n[1];i.useEffect((function(){var n=t.closeToast?t.closeToast:null;return e=window.setTimeout((function(){o(!1),n()}),t.TimerInMs),function(){window.clearTimeout(e)}}));var s="toast-control-container";t.ClassName&&(s+=" "+t.ClassName);var a="toast-control",c="toast-control-message";switch(t.ToastStyle){case"Dark":a+=" toast-control-dark",c+=" toast-control-message-dark";break;case"Light":a+=" toast-control-light",c+=" toast-control-message-light"}return r?i.createElement("div",{className:s},i.createElement("div",{className:a},i.createElement("div",{className:c},t.Message))):null}},function(t,e,n){"use strict";n.d(e,"a",(function(){return h}));var i=n(2),r=n(0),o=n(3),s=n(12),a=n(1),c=n(9),u=n(123),l=n(233);function h(t){return r.createElement(f,t)}var f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.xs=o.uniqueId("ratingAccessibilityLabel."),e.Jd=o.uniqueId("ratingTable."),e}Object(i.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){var t,e=this.props;if(!(null!=e.Value&&""!==e.Value)&&e.ToRenderIfNoRatingAlreadyGiven)return[e.ToRenderIfNoRatingAlreadyGiven];var n=e.MinRating;return null==n&&(n=1),t=e.ShowRatingLabel?Object(l.a)(1,null,e.LeftDescription,e.RightDescription,n.toString(),e.Length.toString(),this.Xd(),e.Length,10,this.Jd,Object(s.g)()&&e.FormsProRTLeftDescription,Object(s.g)()&&e.FormsProRTRightDescription):[r.createElement("div",{className:"office-form-question-rating-container"},this.Xd())],e.ShouldAccessibleTextReadSelectedValue?[r.createElement("div",{"aria-labelledby":this.xs},r.createElement("div",{id:this.xs,className:"screenReaderVisible"},Object(a.a)().GradingView_RatingAnswer_LabelFormat.format(this.Zd(),e.Length)),r.createElement("div",{"aria-hidden":"true",role:"presentation"},t))]:t},n.Xd=function(){var t=this,e=this.props.MinRating;null==e&&(e=1);var n=o.range(e,this.props.Length+1),i=this.Zd(),s=Object(c.b)("office-form-question-rating-body","Center"===this.props.Layout?"justifyContentSpaceBetween":""),a=this.props.HTMLAttributes["aria-labelledby"],u=a?Object(c.b)(a,this.Jd):this.Jd;return r.createElement("div",{className:s,"aria-labelledby":u},n.map((function(e){var o=i===e;return r.createElement("div",{className:"office-form-question-rating-item",key:e},r.createElement("label",{htmlFor:t.Yd(e)},e),r.createElement("input",{id:t.Yd(e),"aria-checked":o,"aria-label":""+e,"aria-posinset":e,"aria-setsize":n.length,type:"radio",disabled:t.props.Disabled,checked:o,onClick:function(){return t.props.onValueChange(e)}}))})))},n.Yd=function(t){return this.xs+"-number-rating-"+t},n.Zd=function(){return parseInt(this.props.Value)},e}(u.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return f}));var i=n(2),r=n(0),o=n(3),s=n(15),a=n(7),c=n(198),u=n(1),l=n(5),h=n(43),f=function(t){function e(e){var n=t.call(this,e)||this;return n.tb=n.tb.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.render=function(){return r.createElement("span",{className:"suggest-theme-icon-container",role:"listitem"},this.eb(),this.nb())},n.eb=function(){var t=this.props.Theme,e={backgroundImage:"url("+t.Thumbnail+")"},n=r.createElement("span",{className:"theme-suggestion-view-button",style:e}),s=Object(c.a)(t.Name)||Object(u.a)().Suggest_Theme_Name,a={ButtonStyle:"LightBackground",children:n,HTMLAttributes:{"aria-label":s,className:"suggest-theme-icon-button",onClick:this.tb,title:s},ToggleActive:this.props.IsActive,key:s};return o.extend(a.HTMLAttributes,this.props.HTMLAttributes),r.createElement(h.a,Object(i.__assign)({},a))},n.nb=function(){var t=this.props.Theme,e={};return t.PrimaryColor&&(e.backgroundColor=t.PrimaryColor),r.createElement("div",{className:"suggest-theme-color-snapshot",onClick:this.tb},r.createElement("div",{className:"suggest-snapshot-title",style:e}),r.createElement("div",{className:"suggest-snapshot-content"},r.createElement("div",{className:"suggest-snapshot-submit-button",style:e})))},n.tb=function(){Object(l.b)("Intelligence.Theme.Apply",{isFromSuggestionCard:this.props.IsFromSuggestionCard,isQuiz:this.props.IsQuiz,suggestTheme:!0}),Object(l.b)("IntelligenceStatistic.ThemeSuggestion.Apply",{isFromSuggestionCard:this.props.IsFromSuggestionCard,isQuiz:this.props.IsQuiz,msftUser:Object(a.a)().userInfo.TenantId===Object(s.k)(),suggestTheme:!0,theme:this.props.Theme.Name}),this.props.applyTheme(this.props.Theme.Name)},e}(n(8).a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return i}));var i=function(){return function(){}}()},function(t,e,n){"use strict";n.d(e,"a",(function(){return O}));var i=n(2),r=n(0),o=n(20),s=n(3),a=n(1),c=n(11),u=n(13),l=n(10),h=n(5),f=n(73),d=n(132),b=n(16),m=n(56),v=n(62),g=n(59),O=function(t){function e(e){var n=t.call(this,e)||this;n.ib=0;var i=n.props.Master.Model.FileTypes;return Object.keys(i).forEach((function(t){i[t]&&n.ib++})),n.rb=n.rb.bind(n),n.ob=n.ob.bind(n),n.sb=n.sb.bind(n),n.ab=n.ab.bind(n),n}Object(i.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this),0===this.ib&&Object(f.j)(this.props.Master)},n.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this)},n.createReactNodes=function(){var t=Object(b.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"design-question-upload-button",disabled:!0},Icon:"Upload",IconClassName:"forms-icon-size18x18",Text:Object(a.a)().UploadFile_Button,TextClassName:"design-question-upload-text"});return[r.createElement("div",{className:"design-question-upload-container",key:"container"},t,r.createElement("div",{className:"design-question-upload-dropdown-container"},this.cb(),this.ub()),this.lb())]},n.createMainContent=function(){var e,n=this.props.Master.Form;n.isFieldReady(u.a.Schema.Id)&&(e=Object(f.i)(n.Model.Id));var i=Object(a.a)().UploadFile_Warning_Inform_GroupForm_Text,o=Object(a.a)().UploadFile_Warning_Inform_Form_Text,s=n.IsGroupForm?o:i;if(e){var l=Object(c.c)();return r.createElement(l,{description:s,clickNoButton:this.onClickDeleteButton,clickContinueButton:this.rb,key:"dialog"})}return t.prototype.createMainContent.call(this)},n.getErrorMessage=function(){var t=this.props,e=t.Master.Form;if(e.isFieldReady(u.a.Schema.Id)&&!Object(f.i)(e.Model.Id))return t.Master.getErrorMessage()},n.createMoreMenuItems=function(){return t.prototype.createMoreMenuItems.call(this).concat(this.createValidationItem())},n.createValidationItem=function(){return{Checked:this.props.Master.Model.HasSpecificFileType,Description:Object(a.a)().Designer_QuestionMenu_FileType,Key:"validationItem",MenuItemType:1,onExecute:this.ab}},n.updateComponentNodesStatus=function(){this.QuestionElementRef.current&&t.prototype.updateComponentNodesStatus.call(this)},n.ab=function(){var t=this,e=this.props.Master.Model;Object(h.b)("DesignPage.QuestionMenu.Validation",{questionType:e.Type,value:e.HasSpecificFileType}),e.HasSpecificFileType=!e.HasSpecificFileType;var n=e.FileTypes,i=Object.keys(n);i.filter((function(t){return n[t]})).length===i.length&&i.forEach((function(t){n[t]=!1})),e.HasSpecificFileType&&this.onUpdateDone((function(){var e=o.findDOMNode(t.getElementRef(1).current);$(e).find("input").focus()}))},n.lb=function(){if(this.props.Master.Model.HasSpecificFileType)return r.createElement("div",{className:"design-question-restrictions-container",key:"restrictionsContainer"},r.createElement("div",{className:"design-question-restrictions-label"},Object(a.a)().UploadFile_File_Type),this.hb("Word",1),this.hb("Excel"),this.hb("PowerPoint"),this.hb("PDF"),this.hb("Image"),this.hb("Video"),this.hb("Audio"))},n.hb=function(t,e){var n=this,i=this.props.Master.Model.FileTypes,r=Object.keys(i).filter((function(t){return i[t]})),o=(1===e?Object(a.a)().UploadFile_File_Type:"")+Object(a.a)().UploadFile_FileType_Checked_Count.format(r.length);return Object(d.a)({Description:Object(f.a)(Object(a.a)(),t),HTMLAttributes:{"aria-label":o,className:"inline-display design-question-upload-checkbox"},onValueChange:function(e){n.props.Master.Model.FileTypes[t]=e,e?n.ib++:n.ib--,n.fb("DesignPage.QuestionMenu.FileTypeChange")},Options:{classNameForInnerDiv:"inline-display"},SpanClassName:"design-question-file-type",Value:this.props.Master.Model.FileTypes[t],ref:1===e&&this.getElementRef(e)})},n.cb=function(){var t=this.props.Master.Model,e=Object(m.a)({HTMLAttributes:{className:"question-setting-label"},Label:Object(a.a)().UploadFile_Max_File_Number.format("")}),n=s.range(1,11).map((function(t){return{DisplayName:t.toString(),Key:t,Value:t}})),i=Object(v.b)({Label:Object(a.a)().UploadFile_Max_File_Number.format(""),onValueChange:this.ob,SelectOptions:n,Value:t.MaxFileCount});return r.createElement("div",{className:"design-question-upload-dropdown"},e,r.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},i))},n.ub=function(){var t=this.props.Master.Model,e=Object(m.a)({HTMLAttributes:{className:"question-setting-label"},Label:Object(a.a)().UploadFile_Single_File_Size.format("")}),n=Object(l.c)((function(){return f.b}),l.f),i=Object.keys(f.b).map((function(t){return{DisplayName:t,Key:t,Value:n[t]}})),o=Object(v.b)({Label:Object(a.a)().UploadFile_Single_File_Size.format(""),onValueChange:this.sb,SelectOptions:i,Value:t.MaxFileSize});return r.createElement("div",{className:"design-question-upload-dropdown"},e,r.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},o))},n.ob=function(t){this.props.Master.Model.MaxFileCount=t,this.fb("DesignPage.QuestionMenu.FileNumberChange")},n.sb=function(t){this.props.Master.Model.MaxFileSize=t,this.fb("DesignPage.QuestionMenu.FileSizeChange")},n.rb=function(){Object(f.k)(this.props.Master.Form,!1),this.setState({SelectedElementIndex:g.d},this.bb)},n.bb=function(){var t=o.findDOMNode(this.getElementRef(g.d).current);t&&$(t).find("textarea").focus()},n.fb=function(t){var e=this.props.Master.Model,n=JSON.parse(e.QuestionInfo),i={FileTypes:n.FileTypes,MaxFileCount:n.MaxFileCount,MaxFileSize:n.MaxFileSize};Object(h.b)(t,{questionType:e.Type,value:JSON.stringify(i)})},e.keyPrefixFileUploadDialogMap="officeforms.fileuploaddialogmap",e}(g.a)},function(t,e,n){"use strict";n.d(e,"a",(function(){return F}));var i=n(2),r=n(0),o=n(19),s=n(7),a=n(35),c=n(9),u=n(11),l=n(13),h=n(22),f=n(45),d=n(66),b=n(33),m=(n(10),n(8)),v=n(196),g=n(195),O=n(3),p=n(15),j=n(12),y=n(144),w=n(1),S=n(14),N=n(29),I=n(231),C=n(118),k=n(86),T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ou=r.createRef(),e.pu=400,e.yu=function(){var t={chunks:e.getFormattedDataForImmersiveReader(),title:""},n={uiLang:Object(p.f)()||navigator.language};Object(N.b)().getImmersiveReaderToken().then((function(e){e&&ImmersiveReader&&ImmersiveReader.launchAsync(e,null,t,n)}))},e}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.Oe=function(){return t.forceUpdate()};var e=l.a.Schema;this.props.Form.observe(this.Oe,[e.Title,e.Description,e.LogoInfo])},n.componentDidMount=function(){Object(y.a)($(this.Ou.current))},n.componentWillUnmount=function(){this.props.Form.unobserve(this.Oe)},n.render=function(){var t,e,n=this.props.Form,o=n.Model;if(o.Logo&&o.Logo.ResourceUrl){var s=n.getImageMaster(l.a.Schema.Logo),a=n.getImageSettingsMaster(l.a.Schema.LogoInfo);t=r.createElement("div",{className:"logo-image-container old"},r.createElement(C.a,{Image:s,ImageSettings:a,ImageType:"Logo"}),Object(C.c)(s.Model))}o.Description&&!this.props.IsSmallSize&&(e=r.createElement("div",{className:"office-form-subtitle heading-1",ref:this.Ou},o.Description));var u=Object(c.b)("__title__ office-form-title-container office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size");return r.createElement("div",{className:u},r.createElement("div",{className:"office-form-logo-title"},t,r.createElement("div",{className:"office-form-title heading-1"},r.createElement("span",{role:"heading","aria-level":1},o.Title),this.Iu()),Object(I.a)({ImmersiveReaderToggleProps:Object(i.__assign)({},this.props.ImmersiveReaderToggleProps)})),e)},n.Iu=function(){var t;return!Object(S.o)()&&Object(j.c)("ImmersiveReaderInForms")&&(null===(t=this.props.ImmersiveReaderToggleProps)||void 0===t?void 0:t.ShouldShowImmersiveReaderButtons)?r.createElement("button",{className:"immersive-reader-button-form","data-locale":Object(p.f)()||navigator.language,"aria-label":Object(w.a)().ImmersiveReaderButton_Label,onClick:O.debounce(this.yu,this.pu,!0)},r.createElement(k.a,{src:"/Images/IR_white.svg",alt:Object(w.a)().ImmersiveReaderButton_Hint,title:Object(w.a)().ImmersiveReaderButton_Hint,style:{verticalAlign:"middle"}})):null},n.getFormattedDataForImmersiveReader=function(){var t=this.props.Form.Model,e=[];return e.push({content:t.Title}),e.push({content:"\n"}),e.push({content:t.Description}),e},e}(m.a),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(i.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.Oe=function(){return t.forceUpdate()};var e=l.a.Schema;this.props.Form.observe(this.Oe,[e.Title,e.Description]);var n=this.props.Form.getImageSettingsMaster(l.a.Schema.LogoInfo),i=Object(u.g)().Schema;n.observe(this.Oe,[i.NaturalWidth,i.NaturalHeight]);var r=this.props.Form.getImageMaster(l.a.Schema.Logo),o=Object(u.f)().Schema;r.observe(this.Oe,[o.ImageProcessingStatus,o.UploadParameters])},n.componentWillUnmount=function(){this.props.Form.unobserve(this.Oe),this.props.Form.getImageSettingsMaster(l.a.Schema.LogoInfo).unobserve(this.Oe),this.props.Form.getImageMaster(l.a.Schema.Logo).unobserve(this.Oe)},n.render=function(){var t,e,n,o,s=this.props.Form,u=s.Model,f={className:Object(c.b)("__title__ office-form-form-title",!this.props.IsReadOnlyOnMobile&&"office-form-theme-primary-background",this.props.IsSmallSize&&"small-size",this.props.IsSlimTitle&&"slim-size")},b="Left",m=s.getImageMaster(l.a.Schema.Logo),O=s.getImageSettingsMaster(l.a.Schema.LogoInfo),p=m.Model;if(!p.ErrorType&&(p.ImageProcessingStatus!==h.c.Idle||Object(h.g)(p))){var j=this.Tu(O);b=j.ImageLayout,t=r.createElement(g.a,{ImageWidth:j.Width,ImageHeight:j.Height,ImageInfoMaster:m,ImageSettingMaster:O,ImageType:"Logo"})}var y=this.props.LocaleId;return y&&(e=(o=d.a.getFormResourceMaster(y,this.props.Form)).Model.title||"",n=o.Model.subtitle||""),e=e||u.Title,n=this.props.IsSlimTitle||this.props.IsSmallSize?"":n||u.Description,e=Object(a.m)(e,!0),n=Object(a.m)(n,!0),r.createElement(v.a,{HTMLAttributes:f,HTMLPropsForInnerElement:{"aria-level":1,role:"heading"},MediaLayout:b,SubTitle:n,Title:e,ImmersiveReaderToggleProps:Object(i.__assign)({},this.props.ImmersiveReaderToggleProps),IsMobile:this.props.IsMobile},t)},n.Tu=function(t){if(t.Model.NaturalWidth){var e=t.calcLogoLayout({isMobile:this.props.IsMobile,isSlimSize:this.props.IsSlimTitle,isSmallSize:this.props.IsSmallSize});return{Height:e.ActualHeight,ImageLayout:e.Layout===f.a.Vertical?"Top":"Left",Width:e.ActualWidth}}return{Height:Object(o.v)(),ImageLayout:"Left",Width:Object(o.u)()}},e}(m.a);function F(t){return Object(b.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")&&Object(s.a)().userInfo.IsMsa?r.createElement(T,Object(i.__assign)({},t)):r.createElement(x,Object(i.__assign)({},t))}},function(t,e,n){(function(e,n){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var i;i=function(){"use strict";function t(t){return"function"==typeof t}var i=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},r=0,o=void 0,s=void 0,a=function(t,e){b[r]=t,b[r+1]=e,2===(r+=2)&&(s?s(m):j())},c="undefined"!=typeof window?window:void 0,u=c||{},l=u.MutationObserver||u.WebKitMutationObserver,h="undefined"==typeof self&&void 0!==e&&"[object process]"==={}.toString.call(e),f="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var t=setTimeout;return function(){return t(m,1)}}var b=new Array(1e3);function m(){for(var t=0;t<r;t+=2)(0,b[t])(b[t+1]),b[t]=void 0,b[t+1]=void 0;r=0}var v,g,O,p,j=void 0;function y(t,e){var n=this,i=new this.constructor(N);void 0===i[S]&&L(i);var r=n._state;if(r){var o=arguments[r-1];a((function(){return D(r,i,o,n._result)}))}else F(n,i,t,e);return i}function w(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(N);return C(e,t),e}h?j=function(){return e.nextTick(m)}:l?(g=0,O=new l(m),p=document.createTextNode(""),O.observe(p,{characterData:!0}),j=function(){p.data=g=++g%2}):f?((v=new MessageChannel).port1.onmessage=m,j=function(){return v.port2.postMessage(0)}):j=void 0===c?function(){try{var t=Function("return this")().require("vertx");return void 0!==(o=t.runOnLoop||t.runOnContext)?function(){o(m)}:d()}catch(t){return d()}}():d();var S=Math.random().toString(36).substring(2);function N(){}function I(e,n,i){n.constructor===e.constructor&&i===y&&n.constructor.resolve===w?function(t,e){1===e._state?T(t,e._result):2===e._state?x(t,e._result):F(e,void 0,(function(e){return C(t,e)}),(function(e){return x(t,e)}))}(e,n):void 0===i?T(e,n):t(i)?function(t,e,n){a((function(t){var i=!1,r=function(t,e,n,i){try{t.call(e,n,i)}catch(t){return t}}(n,e,(function(n){i||(i=!0,e!==n?C(t,n):T(t,n))}),(function(e){i||(i=!0,x(t,e))}),t._label);!i&&r&&(i=!0,x(t,r))}),t)}(e,n,i):T(e,n)}function C(t,e){if(t===e)x(t,new TypeError("You cannot resolve a promise with itself"));else if(r=typeof(i=e),null===i||"object"!==r&&"function"!==r)T(t,e);else{var n=void 0;try{n=e.then}catch(e){return void x(t,e)}I(t,e,n)}var i,r}function k(t){t._onerror&&t._onerror(t._result),P(t)}function T(t,e){void 0===t._state&&(t._result=e,t._state=1,0!==t._subscribers.length&&a(P,t))}function x(t,e){void 0===t._state&&(t._state=2,t._result=e,a(k,t))}function F(t,e,n,i){var r=t._subscribers,o=r.length;t._onerror=null,r[o]=e,r[o+1]=n,r[o+2]=i,0===o&&t._state&&a(P,t)}function P(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var i=void 0,r=void 0,o=t._result,s=0;s<e.length;s+=3)i=e[s],r=e[s+n],i?D(n,i,r,o):r(o);t._subscribers.length=0}}function D(e,n,i,r){var o=t(i),s=void 0,a=void 0,c=!0;if(o){try{s=i(r)}catch(t){c=!1,a=t}if(n===s)return void x(n,new TypeError("A promises callback cannot return that same promise."))}else s=r;void 0!==n._state||(o&&c?C(n,s):!1===c?x(n,a):1===e?T(n,s):2===e&&x(n,s))}var M=0;function L(t){t[S]=M++,t._state=void 0,t._result=void 0,t._subscribers=[]}var A=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(N),this.promise[S]||L(this.promise),i(e)?(this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?T(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&T(this.promise,this._result))):x(this.promise,new Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;void 0===this._state&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,i=n.resolve;if(i===w){var r=void 0,o=void 0,s=!1;try{r=t.then}catch(t){s=!0,o=t}if(r===y&&void 0!==t._state)this._settledAt(t._state,e,t._result);else if("function"!=typeof r)this._remaining--,this._result[e]=t;else if(n===R){var a=new n(N);s?x(a,o):I(a,t,r),this._willSettleAt(a,e)}else this._willSettleAt(new n((function(e){return e(t)})),e)}else this._willSettleAt(i(t),e)},t.prototype._settledAt=function(t,e,n){var i=this.promise;void 0===i._state&&(this._remaining--,2===t?x(i,n):this._result[e]=n),0===this._remaining&&T(i,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;F(t,void 0,(function(t){return n._settledAt(1,e,t)}),(function(t){return n._settledAt(2,e,t)}))},t}(),R=function(){function e(t){this[S]=M++,this._result=this._state=void 0,this._subscribers=[],N!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e((function(e){C(t,e)}),(function(e){x(t,e)}))}catch(e){x(t,e)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then((function(t){return n.resolve(e()).then((function(){return t}))}),(function(t){return n.resolve(e()).then((function(){throw t}))})):this.then(e,e)},e}();return R.prototype.then=y,R.all=function(t){return new A(this,t).promise},R.race=function(t){var e=this;return i(t)?new e((function(n,i){for(var r=t.length,o=0;o<r;o++)e.resolve(t[o]).then(n,i)})):new e((function(t,e){return e(new TypeError("You must pass an array to race."))}))},R.resolve=w,R.reject=function(t){var e=new this(N);return x(e,t),e},R._setScheduler=function(t){s=t},R._setAsap=function(t){a=t},R._asap=a,R.polyfill=function(){var t=void 0;if(void 0!==n)t=n;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var i=null;try{i=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===i&&!e.cast)return}t.Promise=R},R.Promise=R,R},t.exports=i()}).call(this,n(242),n(241))},,,,function(t,e){"name"in Function.prototype||Object.defineProperty(Function.prototype,"name",{get:function(){var t=/function\s([^(]{1,})\(/.exec(this.toString());return t&&t.length>1?t[1].trim():""}})},function(t,e,n){"use strict";(function(t){var e=n(255),i=n.n(e);!function(){var e;if(void 0!==t)e=t;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=e.Promise;if(n){var r=null;try{r=Object.prototype.toString.call(n.resolve())}catch(t){}if("[object Promise]"===r&&!n.cast&&void 0!==n.prototype.finally)return}e.Promise=i.a.Promise}()}).call(this,n(241))},function(t,e){String.prototype.format||(String.prototype.format=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return this.replace(/{(\d+)}/g,(function(e,n){return void 0!==t[n]?t[n]:e}))}),String.prototype.includes||(String.prototype.includes=function(t,e){return void 0===e&&(e=0),-1!==this.indexOf(t,e)}),String.prototype.trimEnd=function(t){for(var e=this.length;--e>=0&&!(t.indexOf(this.charAt(e))<0););return this.substr(0,e+1)},String.prototype.startsWith=function(t){if(null==t||0===t.length)return!0;return!(null==this||this.length<t.length)&&t===this.substr(0,t.length)},String.prototype.endsWith=function(t){if(null==t||0===t.length)return!0;return!(null==this||this.length<t.length)&&t===this.substr(this.length-t.length,t.length)},String.prototype.replaceAll=function(t,e){return this.replace(new RegExp(t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),e)}},function(t,e){window.Forms={Common:{PageMethods:{}},DataProvider:{},DesignPage:{},Experiment:{},Experimentation:{},FileUploadProcess:{},FormsCdn:{},FormsProRelated:{},Grading:{},MobileDesignPage:{},Models:{FormManager:{}},Mru:{},MultilingualBatchRelated:{},O365ReactShell:{},PrintTemplate:{},Routing:{},Telemetry:{},Templates:{},Themes:{},Utilities:{FormId:{}},UX:{Addin:{},Admin:{},Analysis:{},Controls:{},Designer:{},DesignPage:{},FileUpload:{},FlexPane:{},FormDesignView:{},Intelligence:{},MultiLingual:{},NPS:{},OutlookQuickPoll:{},Phishing:{},PowerPoint:{},RecycleBin:{},Renderer:{},Teaching:{},TermsLink:{},TipBar:{},TopViews:{},Utilities:{}}},window.FormsPro={UX:{}}},function(t,e,n){var i={"./ls.af.json":[270,13],"./ls.am-et.json":[271,14],"./ls.ar.json":[272,15],"./ls.as-in.json":[273,16],"./ls.az-latn-az.json":[274,17],"./ls.be.json":[275,18],"./ls.bg.json":[276,19],"./ls.bn-bd.json":[277,20],"./ls.bn-in.json":[278,21],"./ls.bs-latn-ba.json":[279,22],"./ls.ca-es-valencia.json":[280,23],"./ls.ca.json":[281,24],"./ls.cs.json":[282,25],"./ls.cy-gb.json":[283,26],"./ls.da.json":[284,27],"./ls.de.json":[285,28],"./ls.el.json":[286,30],"./ls.en-gb.json":[287,31],"./ls.en-us.json":[288,32],"./ls.es-mx.json":[289,34],"./ls.es.json":[290,33],"./ls.et.json":[291,35],"./ls.eu.json":[292,36],"./ls.fa.json":[293,37],"./ls.fi.json":[294,38],"./ls.fil-ph.json":[295,39],"./ls.fr-ca.json":[296,40],"./ls.fr.json":[297,41],"./ls.ga-ie.json":[298,42],"./ls.gd.json":[299,43],"./ls.gl.json":[300,44],"./ls.gu.json":[301,45],"./ls.ha-latn-ng.json":[302,46],"./ls.he.json":[303,47],"./ls.hi.json":[304,48],"./ls.hr.json":[305,49],"./ls.hu.json":[306,50],"./ls.hy.json":[307,51],"./ls.id.json":[308,52],"./ls.is.json":[309,53],"./ls.it.json":[310,54],"./ls.ja.json":[311,55],"./ls.ka.json":[312,56],"./ls.kk.json":[313,57],"./ls.km-kh.json":[314,58],"./ls.kn.json":[315,59],"./ls.ko.json":[316,60],"./ls.kok.json":[317,61],"./ls.ky.json":[318,62],"./ls.lb-lu.json":[319,63],"./ls.lo.json":[320,64],"./ls.lt.json":[321,65],"./ls.lv.json":[322,66],"./ls.mi-nz.json":[323,67],"./ls.mk.json":[324,68],"./ls.ml.json":[325,69],"./ls.mn.json":[326,70],"./ls.mr.json":[327,71],"./ls.ms.json":[328,72],"./ls.mt-mt.json":[329,73],"./ls.nb-no.json":[330,74],"./ls.ne-np.json":[331,75],"./ls.nl.json":[332,76],"./ls.nn-no.json":[333,77],"./ls.or-in.json":[334,78],"./ls.pa.json":[335,79],"./ls.pl.json":[336,80],"./ls.prs-af.json":[337,81],"./ls.pt-br.json":[338,82],"./ls.pt-pt.json":[339,83],"./ls.quz-pe.json":[340,84],"./ls.ro.json":[341,85],"./ls.ru.json":[342,86],"./ls.sd-arab-pk.json":[343,87],"./ls.si-lk.json":[344,88],"./ls.sk.json":[345,89],"./ls.sl.json":[346,90],"./ls.sq.json":[347,91],"./ls.sr-cyrl-ba.json":[348,92],"./ls.sr-cyrl-rs.json":[349,93],"./ls.sr-latn-rs.json":[350,94],"./ls.sv.json":[351,95],"./ls.sw.json":[352,96],"./ls.ta.json":[353,97],"./ls.te.json":[354,98],"./ls.th.json":[355,99],"./ls.tk-tm.json":[356,100],"./ls.tr.json":[357,101],"./ls.tt.json":[358,102],"./ls.ug.json":[359,103],"./ls.uk.json":[360,104],"./ls.ur.json":[361,105],"./ls.uz-latn-uz.json":[362,106],"./ls.vi.json":[363,107],"./ls.zh-cn.json":[364,108],"./ls.zh-tw.json":[365,109]};function r(t){if(!n.o(i,t))return Promise.resolve().then((function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}));var e=i[t],r=e[0];return n.e(e[1]).then((function(){return n.t(r,3)}))}r.keys=function(){return Object.keys(i)},r.id=263,t.exports=r},function(t,e){function n(t){return $.expr.filters.visible(t)&&!$(t).parents().addBack().filter((function(){return"hidden"===$.css(this,"visibility")})).length}$.extend($.expr[":"],{focusable:function(t){
/*!
 * jQuery UI Core @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/category/ui-core/
 */
return function(t,e){var i,r,o,s=t.nodeName.toLowerCase();return"area"===s?(r=(i=t.parentNode).name,!(!t.href||!r||"map"!==i.nodeName.toLowerCase())&&(!!(o=$("img[usemap=#"+r+"]")[0])&&n(o))):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s&&t.href||e)&&n(t)}(t,!isNaN($.attr(t,"tabindex")))}})},function(t,e,n){(function(t){var i=Object.getOwnPropertyDescriptors||function(t){for(var e=Object.keys(t),n={},i=0;i<e.length;i++)n[e[i]]=Object.getOwnPropertyDescriptor(t,e[i]);return n},r=/%[sdj%]/g;e.format=function(t){if(!g(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(a(arguments[n]));return e.join(" ")}n=1;for(var i=arguments,o=i.length,s=String(t).replace(r,(function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(i[n++]);case"%d":return Number(i[n++]);case"%j":try{return JSON.stringify(i[n++])}catch(t){return"[Circular]"}default:return t}})),c=i[n];n<o;c=i[++n])m(c)||!j(c)?s+=" "+c:s+=" "+a(c);return s},e.deprecate=function(n,i){if(void 0!==t&&!0===t.noDeprecation)return n;if(void 0===t)return function(){return e.deprecate(n,i).apply(this,arguments)};var r=!1;return function(){if(!r){if(t.throwDeprecation)throw new Error(i);t.traceDeprecation?console.trace(i):console.error(i),r=!0}return n.apply(this,arguments)}};var o,s={};function a(t,n){var i={seen:[],stylize:u};return arguments.length>=3&&(i.depth=arguments[2]),arguments.length>=4&&(i.colors=arguments[3]),b(n)?i.showHidden=n:n&&e._extend(i,n),O(i.showHidden)&&(i.showHidden=!1),O(i.depth)&&(i.depth=2),O(i.colors)&&(i.colors=!1),O(i.customInspect)&&(i.customInspect=!0),i.colors&&(i.stylize=c),l(i,t,i.depth)}function c(t,e){var n=a.styles[e];return n?"["+a.colors[n][0]+"m"+t+"["+a.colors[n][1]+"m":t}function u(t,e){return t}function l(t,n,i){if(t.customInspect&&n&&S(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var r=n.inspect(i,t);return g(r)||(r=l(t,r,i)),r}var o=function(t,e){if(O(e))return t.stylize("undefined","undefined");if(g(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}if(v(e))return t.stylize(""+e,"number");if(b(e))return t.stylize(""+e,"boolean");if(m(e))return t.stylize("null","null")}(t,n);if(o)return o;var s=Object.keys(n),a=function(t){var e={};return t.forEach((function(t,n){e[t]=!0})),e}(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(n)),w(n)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return h(n);if(0===s.length){if(S(n)){var c=n.name?": "+n.name:"";return t.stylize("[Function"+c+"]","special")}if(p(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(y(n))return t.stylize(Date.prototype.toString.call(n),"date");if(w(n))return h(n)}var u,j="",N=!1,I=["{","}"];(d(n)&&(N=!0,I=["[","]"]),S(n))&&(j=" [Function"+(n.name?": "+n.name:"")+"]");return p(n)&&(j=" "+RegExp.prototype.toString.call(n)),y(n)&&(j=" "+Date.prototype.toUTCString.call(n)),w(n)&&(j=" "+h(n)),0!==s.length||N&&0!=n.length?i<0?p(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special"):(t.seen.push(n),u=N?function(t,e,n,i,r){for(var o=[],s=0,a=e.length;s<a;++s)T(e,String(s))?o.push(f(t,e,n,i,String(s),!0)):o.push("");return r.forEach((function(r){r.match(/^\d+$/)||o.push(f(t,e,n,i,r,!0))})),o}(t,n,i,a,s):s.map((function(e){return f(t,n,i,a,e,N)})),t.seen.pop(),function(t,e,n){if(t.reduce((function(t,e){return e.indexOf("\n")>=0&&0,t+e.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1];return n[0]+e+" "+t.join(", ")+" "+n[1]}(u,j,I)):I[0]+j+I[1]}function h(t){return"["+Error.prototype.toString.call(t)+"]"}function f(t,e,n,i,r,o){var s,a,c;if((c=Object.getOwnPropertyDescriptor(e,r)||{value:e[r]}).get?a=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(a=t.stylize("[Setter]","special")),T(i,r)||(s="["+r+"]"),a||(t.seen.indexOf(c.value)<0?(a=m(n)?l(t,c.value,null):l(t,c.value,n-1)).indexOf("\n")>-1&&(a=o?a.split("\n").map((function(t){return"  "+t})).join("\n").substr(2):"\n"+a.split("\n").map((function(t){return"   "+t})).join("\n")):a=t.stylize("[Circular]","special")),O(s)){if(o&&r.match(/^\d+$/))return a;(s=JSON.stringify(""+r)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function d(t){return Array.isArray(t)}function b(t){return"boolean"==typeof t}function m(t){return null===t}function v(t){return"number"==typeof t}function g(t){return"string"==typeof t}function O(t){return void 0===t}function p(t){return j(t)&&"[object RegExp]"===N(t)}function j(t){return"object"==typeof t&&null!==t}function y(t){return j(t)&&"[object Date]"===N(t)}function w(t){return j(t)&&("[object Error]"===N(t)||t instanceof Error)}function S(t){return"function"==typeof t}function N(t){return Object.prototype.toString.call(t)}function I(t){return t<10?"0"+t.toString(10):t.toString(10)}e.debuglog=function(n){if(O(o)&&(o=t.env.NODE_DEBUG||""),n=n.toUpperCase(),!s[n])if(new RegExp("\\b"+n+"\\b","i").test(o)){var i=t.pid;s[n]=function(){var t=e.format.apply(e,arguments);console.error("%s %d: %s",n,i,t)}}else s[n]=function(){};return s[n]},e.inspect=a,a.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},a.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=d,e.isBoolean=b,e.isNull=m,e.isNullOrUndefined=function(t){return null==t},e.isNumber=v,e.isString=g,e.isSymbol=function(t){return"symbol"==typeof t},e.isUndefined=O,e.isRegExp=p,e.isObject=j,e.isDate=y,e.isError=w,e.isFunction=S,e.isPrimitive=function(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||void 0===t},e.isBuffer=n(266);var C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function k(){var t=new Date,e=[I(t.getHours()),I(t.getMinutes()),I(t.getSeconds())].join(":");return[t.getDate(),C[t.getMonth()],e].join(" ")}function T(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.log=function(){console.log("%s - %s",k(),e.format.apply(e,arguments))},e.inherits=n(267),e._extend=function(t,e){if(!e||!j(e))return t;for(var n=Object.keys(e),i=n.length;i--;)t[n[i]]=e[n[i]];return t};var x="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function F(t,e){if(!t){var n=new Error("Promise was rejected with a falsy value");n.reason=t,t=n}return e(t)}e.promisify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');if(x&&t[x]){var e;if("function"!=typeof(e=t[x]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(e,x,{value:e,enumerable:!1,writable:!1,configurable:!0}),e}function e(){for(var e,n,i=new Promise((function(t,i){e=t,n=i})),r=[],o=0;o<arguments.length;o++)r.push(arguments[o]);r.push((function(t,i){t?n(t):e(i)}));try{t.apply(this,r)}catch(t){n(t)}return i}return Object.setPrototypeOf(e,Object.getPrototypeOf(t)),x&&Object.defineProperty(e,x,{value:e,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(e,i(t))},e.promisify.custom=x,e.callbackify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function n(){for(var n=[],i=0;i<arguments.length;i++)n.push(arguments[i]);var r=n.pop();if("function"!=typeof r)throw new TypeError("The last argument must be of type Function");var o=this,s=function(){return r.apply(o,arguments)};e.apply(this,n).then((function(e){t.nextTick(s,null,e)}),(function(e){t.nextTick(F,e,s)}))}return Object.setPrototypeOf(n,Object.getPrototypeOf(e)),Object.defineProperties(n,i(e)),n}}).call(this,n(242))},function(t,e){t.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){"use strict";n.r(e);var i=/('[^']*'|"[^"]*")/g,r=/('[^']*'|"[^"]*"|d{1,2}|M{1,2}|y{2,4}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|t{2})/g;function o(t,e){var n=t.toString();if(t<0)return n;if(e&&e>n.length)for(;e>n.length;)n="0"+n;return n}function s(t){return i.test(t)?t.substr(1,t.length-2):t}function a(t,e,n){var i={};return null==t||null==e||null==n?i:(e.split(r).forEach((function(e){var r;switch(e){case"d":case"dd":case"M":case"MM":case"h":case"hh":case"H":case"HH":case"m":case"mm":case"s":case"ss":r=2;case"yy":case"yyy":case"yyyy":r=r||4,i[e]=function(t,e){e=e||t.length;var n=t.match(/^\d+/g),i=n&&n[0];return i?i.length<=e?i:i.substr(0,e):""}(t,r),r=i[e].length;break;case"tt":r=0;var o=t.toUpperCase();o.startsWith(n.DateTimeFormat.AMDesignator.toUpperCase())?r=n.DateTimeFormat.AMDesignator.length:o.startsWith(n.DateTimeFormat.PMDesignator.toUpperCase())?r=n.DateTimeFormat.PMDesignator.length:(o.startsWith("AM")||o.startsWith("PM"))&&(r=2),i[e]=t.substr(0,r);break;default:r=0,e=s(e),t.startsWith(e)&&(r=e.length)}t=t.slice(r)})),t.length>0?{}:i)}function c(t,e){var n=parseInt(t.HH||t.H),i=parseInt(t.hh||t.h||t.time||12);if(isNaN(n)&&!isNaN(i)&&i>=1&&i<=12)if(null==t.tt)t.time||(n=0);else switch(t.tt.toUpperCase()){case"AM":case e.DateTimeFormat.AMDesignator.toUpperCase():n=i%12;break;case"PM":case e.DateTimeFormat.PMDesignator.toUpperCase():n=i%12+12}var r=parseInt(t.mm||t.m||t.time||0),o=parseInt(t.ss||t.s||0);return isNaN(n)||isNaN(r)?NaN:1e3*(60*(60*n+r)+o)}Date.prototype.toFormatString=function(t,e){var n=this;return null==n||null==t||null==e?null:t.split(r).map((function(t){switch(t){case"d":case"dd":return o(n.getDate(),t.length);case"ddd":return e.DateTimeFormat.AbbreviatedDayNames[n.getDay()];case"M":case"MM":return o(n.getMonth()+1,t.length);case"MMM":return e.DateTimeFormat.AbbreviatedMonthNames[n.getMonth()];case"yy":var i=n.getFullYear(),r=o(i,4);return i>e.Calendar.TwoDigitYearMax-100&&i<=e.Calendar.TwoDigitYearMax?r.slice(2):r;case"yyy":case"yyyy":case"yyyyy":return o(n.getFullYear(),t.length);case"H":case"HH":return o(n.getHours(),t.length);case"h":case"hh":return o((n.getHours()+11)%12+1,t.length);case"m":case"mm":return o(n.getMinutes(),t.length);case"s":case"ss":return o(n.getSeconds(),t.length);case"t":case"tt":var a=n.getHours()<12?e.DateTimeFormat.AMDesignator:e.DateTimeFormat.PMDesignator;return 1===t.length?a.charAt(0):a;default:return s(t)}})).join("")},Date.prototype.toDateShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortDatePattern,t)},Date.prototype.toTimeShortString=function(t){return this.toFormatString(t.DateTimeFormat.ShortTimePattern,t)};var u=n(7);Date.parseDate=function(t,e,n){var i=a(t,e,n),r=parseInt(i.yyyy||i.yyy),o=parseInt(i.yy);if(isNaN(r)&&!isNaN(o))if(o>=100)r=o;else{var s=Object(u.a)().cultureInfo.Calendar.TwoDigitYearMax%100;r=o<=s?Object(u.a)().cultureInfo.Calendar.TwoDigitYearMax-s+o:Object(u.a)().cultureInfo.Calendar.TwoDigitYearMax-s-100+o}var l=parseInt(i.MM||i.M),h=i.MMM;isNaN(l)&&h&&(l=n.DateTimeFormat.AbbreviatedMonthNames.indexOf(h)+1);var f=parseInt(i.dd||i.d),d=c(i,n);if(!(isNaN(r)||isNaN(l)||isNaN(f)||isNaN(d))){var b=new Date(r,l-1,f,0,0,0,d);if(b.getFullYear()===r&&b.getMonth()+1===l&&b.getDate()===f)return b}return null},Date.parseTime=function(t,e,n){var i=a(t,e,n);return i.time=!0,c(i,n)};n(259),n(260),n(261),n(262);function l(t){return t?n(263)("./ls."+t+".json").then((function(t){return t.default})):n.e(29).then(n.t.bind(null,1115,3)).then((function(t){return t.default}))}var h=n(28);h.a.Register("ILazyLoadResourceStringsFunc").UsingSingleton((function(){return l}));var f=n(34),d=n(36),b=n(50),m=n(219),v=n(15),g=n(5),O=n(57),p=n(46);var j,y,w,S=n(2),N=function(t){function e(e){var n=t.call(this,e)||this;return n.name="AuthNoStorageError",n}return Object(S.__extends)(e,t),e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Error)),I=n(129),C=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return Object(I.c)(j)},e.handleAuthForContentPage=function(t){var e=this;return y||(y=k().then((function(n){if(n.HasUserSignedIn)x();else if(t)return e.redirectToLogin()}))),y},e.handleAuthForAddinPage=function(){return y||(y=k().then((function(t){if(!t.HasUserSignedIn)throw new Error(null);x()}))),y},e.hasUserLoggedIn=function(){return!!j.getCachedUser()},e.isValid=function(){return!Object(v.o)()},e.redirectToLogin=function(){if(j.login(),w)return w;throw Error("redirectForAuthContextLogin not called.")},e.refreshToken=function(){},e.signIn=function(){return this.redirectToLogin()},e.signOut=function(){return j.config.postLogoutRedirectUri=window.location.href,j.logOut(),Promise.resolve()},t}();function k(){var t=Object(O.d)(),e=Object(O.e)();if(t||Object(g.b)("Auth.LocalStorageNotSupported",{supportsSessionStorage:e}),!t&&!e)return Promise.reject(new N("local storage or session storage can't be used"));var n,i=(n=Object(O.a)().getItem("officeforms.userAccountNameKey"))&&JSON.parse(n),r="response_mode=form_post&msafed=0";i&&(r+="&username="+(i=JSON.stringify(i)));var o=window.location.origin,s={cacheLocation:t?"localStorage":"sessionStorage",clientId:Object(v.a)(),displayCall:T,extraQueryParameter:r,instance:Object(v.b)(),postLogoutRedirectUri:o,redirectUri:o,tenant:""},a=new AuthenticationContext(s),c=a.isCallback(window.location.hash);return a.handleWindowCallback(),c?new Promise((function(){})):(j=a).getCachedUser()?new Promise((function(t){j.acquireToken(Object(v.a)(),(function(e,n){var i=!e&&!!n;i?"live.com"===j.getCachedUser().profile.idp&&(j.clearCache(),i=!1,Object(g.c)("UnexpectedLiveId")):j.clearCache();t({HasUserSignedIn:i,UserSignedInBefore:!0})}))})):Promise.resolve({HasUserSignedIn:!1,UserSignedInBefore:!1})}function T(t){if(w)throw Error("login in progress.");Object(p.f)(t),w=new Promise((function(t,e){window.setTimeout(e,3e3)}))}function x(){var t=j.getCachedUser();if(t){var e=t.profile.oid,n=Object(u.a)();n.userInfo={DisplayName:t.profile.name,Email:t.profile.unique_name,GivenName:t.profile.given_name||t.profile.name&&t.profile.name.split(" ")[0],IsMsa:!1,PUID:e.replace(/-/g,"").substring(16),TenantId:t.profile.tid,Upn:t.profile.upn,UserId:e},Object(u.b)(n)}}var F=n(243),P=function(){function t(){}var e=t.prototype;return e.getFormApiToken=function(){return this.mb().getFormApiToken()},e.handleAuthForContentPage=function(t){return this.mb().handleAuthForContentPage(t)},e.handleAuthForAddinPage=function(){return this.mb().handleAuthForAddinPage()},e.hasUserLoggedIn=function(){return this.mb().hasUserLoggedIn()},e.isValid=function(){return this.mb().isValid()},e.redirectToLogin=function(){return this.mb().redirectToLogin()},e.refreshToken=function(){return this.mb().refreshToken()},e.signIn=function(){return this.mb().signIn()},e.signOut=function(){return this.mb().signOut()},e.mb=function(){return this.vb||(Object(v.o)()?this.vb=new F.a:this.vb=new C),this.vb},t}(),D=function(){function t(t){this.gb=null,this.Ob=t?t.concat():[new P]}var e=t.prototype;return e.signIn=function(){return this.pb().then((function(t){return t.signIn()}))},e.getFormApiToken=function(){return this.pb().then((function(t){return t.getFormApiToken()}))},e.handleAuthForContentPage=function(t){return this.pb().then((function(e){return e.handleAuthForContentPage(t)}))},e.handleAuthForAddinPage=function(){return this.pb().then((function(t){return t.handleAuthForAddinPage()}))},e.hasUserLoggedIn=function(){var t=this.jb();return t&&t.hasUserLoggedIn()},e.redirectToLogin=function(){return this.pb().then((function(t){return t.redirectToLogin()}))},e.refreshToken=function(){return this.pb().then((function(t){return t.refreshToken()}))},e.signOut=function(){return this.pb().then((function(t){return t.signOut()}))},e.pb=function(){var t=this;if(this.gb)return this.gb;var e=function(n){var i=t.Ob[n];return i?i.isValid()?Promise.resolve(i):e(n+1):Promise.reject(new Error("No valid authenticator"))};return this.gb=e(0),this.gb},e.jb=function(){return this.Ob.filter((function(t){return t.isValid()}))[0]},t}(),M=n(41),L=function(){function t(t){var e=t.flights,n=void 0===e?"":e;this.yb={},""!==n&&(this.wb=G(n)),""===n&&(this.Sb=G(Object(u.a)().flights))}var e=t.prototype;return e.isEnabled=function(t){return this.Nb(t)},e.isEnabled_Deprecated=function(t){return this.Nb(t)},e.setFlights=function(t){this.wb=G(t)},e.Nb=function(t){var e=E[t];switch("tenant"===e&&(this.wb||H(t),e="environment"),e){case"environment":if(t in this.yb)return this.yb[t];break;case"deprecated":this.wb||H(t);break;default:throw Error("Checking uninitialized flight "+t+".")}var n=this.Ib(t);return"environment"===e&&(this.yb[t]=n),n},e.Ib=function(t){var e=this;if(B[t]&&B[t].some((function(t){return e.Nb(t)})))return!1;if(_[t]&&!_[t].every((function(t){return e.Nb(t)})))return!1;var n=t.toUpperCase(),i=function(){if(q)return q;var t={};if(!Object(M.f)()||Object(M.e)()){var e=Object(d.d)().fo;Array.isArray(e)&&(e=e[e.length-1]),e&&e.split(";").forEach((function(e){"!"!==e[0]?t[e.toUpperCase()]=!0:(e=e.substr(1).toUpperCase(),t[e]=!1)}))}return q=t,t}();if(n in i)return i[n];var r=this.wb||this.Sb;return t in r?r[t]:R[t]},t}(),A=function(){switch(Object(M.a)()){case"DevHost":return 1;case"Daily":case"Drill":case"Pilot":case"Trial":case"ProDaily":return 2;case"Weekly":case"Hotfix":return 3;case"Int":case"MSInt":case"CVInt":return 4;case"WWProd":case"MSProd":case"ProTip":case"CVProd":case"CVTip":case"CVFastfood":case"USGovProd":case"USDoDProd":case"USGovGccProd":case"USNat":case"USSec":default:return 5}}(),R={},E={},B={},_={};function H(t){var e=new Error('Checking flight "'+t+'" before ready.');Object(g.c)("UnstableFlightChecking",{flightName:t,flightType:E[t],stack:e.stack})}function G(t){var e={};return t&&t.split(";").forEach((function(t){"!"!==t[0]?e[t]=!0:(t=t.substr(1),e[t]=!1)})),e}var q=null;function Q(t,e){R[t]=e>=A,E[t]="environment"}function V(t,e){R[t]=e>=A,E[t]="tenant"}function z(t,e){R[t]=e>=A,E[t]="deprecated"}var U,W=function(t,e){_[t]=e};z("TestDeprecatedFlight",0),Q("TestEnvironmentFlight",5),Q("TestEnvironmentFlight_Blocker",0),V("TestTenantFlight",5),z("EnableMsaContentValidation",0),V("ResponseInApp",4),z("DisableBrandingForMSA",0),z("EmailHrdFallback",4),z("EnableExperimentation",4),z("FormInsight",4),z("LogDownloadExcelErrorMessage",4),z("PartialPut",1),z("Question200Limit",4),Q("A11yTooltip",4),Q("AddLoadingUIForQuickPoll",4),Q("AdminConfirmPhishingAPI",4),Q("AdminDeleteFormAPI",0),Q("AdminUnblockSurvey",4),Q("CustomerVoiceBlackList",0),Q("DelayLoadThirdPartyJs",3),Q("DisableRetryOption",4),Q("DisableStreamSSO",4),Q("EnableBatchCommentAPI",4),Q("EnableCustomerVoice",5),Q("EnableMoreResponseNav",5),Q("EnableNewUxForAllMobileUsers",4),Q("EnableNotifyAdminForApprovalAPI",4),Q("EnableOnlineExcelForMSA",0),Q("EnablePollDraft",4),Q("EnableSavingConfirmationOnAssignments",4),Q("EnableShowUnpinForMovedForm",5),Q("EnableUnicodeNormalization",4),Q("FixQuickPollAccessiblityBugs",4),Q("FormsIconCutInTeams",4),Q("LogUserActionSignals",4),Q("MobileA11yFix",4),Q("MobileBackBugFix",4),Q("MobileCriticalErrorFix",4),Q("MobileNewUXEnabled",4),Q("MobileQuestionCalloutBugfix",4),Q("MobileViewExitBugFix",4),Q("MultilinguaFirstShowingError",4),Q("MultiLingualMVP1",5),Q("OutlookPollMailBodyBugFix",4),Q("PortalPageRedirection",0),Q("PPTContentAddinSSO",4),Q("PPTContentAddinSSOComputer",0),Q("PPTContentAddinWelcomePage",0),Q("PrefetchFormInServerByApi",0),Q("PrefetchFormInServerByApi",0),Q("PrefetchJSChunkOnSafari",4),Q("ProRedirectInWeb",0),Q("QuizReviewLogicUpgrade",4),Q("RemoveAllQuestionsQuickFix",0),Q("RemoveEmbedLinkForAndroid",4),Q("RemoveRedundantAggregateAPI",4),Q("RemoveReviewAnswersButtonSync",4),Q("SensitiveInfoCheckForAllForms",4),Q("SensitiveInfoCheckInResponsePage",4),Q("ShareAssistant",4),Q("ShareByTeamsEnabled",4),Q("ShowSavingSpinner",4),Q("ShuffleSupportForIncLoadForms",0),Q("TeamsGuestUser",4),Q("TeamsPollConfigSettings",4),Q("TeamsPollUpdateAdaptiveCard",4),Q("TemplateCopyFormByAPI",0),Q("TextFormat",0),Q("TokenFetchErrorPage",0),Q("UnionFastAutoSaveEnabled",4),Q("UnionFeatureEnabled",4),Q("UnionShareMessage",4),Q("UnionSSOEnabled",4),Q("UserInterationSuggestionCard",4),V("AssignmentsIFrameLimitParentHeaders",4),V("BaseProFRE",0),V("BingImageAdminControl",4),V("BotSubmitResponseAPI",0),V("DesignerFileUpload",2),V("DisplayOptionSetting",0),V("EnableAnonymousUploadLink",0),V("EnableImmersiveReaderInMSA",4),V("EnableImmersiveReaderNewTokenAPI",4),V("EnableStrictMode",0),V("EstimationTimeExp",0),V("FormsProAvailableTeachingCallout",0),V("FrontDoorOptionToOption",4),V("GetInteractiveInsights",4),V("HideReportAbuse",0),V("ImmersiveReaderInForms",4),V("ImmersiveReaderMobileToggle",4),V("IntelligenceScenarioProcess",4),V("IntelligenceUseMemoryCache",4),V("PersonalContextInsight",4),V("PersonalContextSuggestion",4),V("PrintForm",1),V("ProgressBar",0),V("ProgressBarNew",5),V("QuickPollDisableEws",0),V("QuickPollTeachingUIControl",4),V("QuizHistorySuggestion",4),V("RtcRefactor",4),V("SpecificResponder",4),V("SuspiciousForm",4),V("TeamsFeaturedPractice",4),V("TeamsPracticeNewEntry",4),Q("FormsPro",0),U=["TestEnvironmentFlight_Blocker"],B["TestTenantFlight"]=U,W("BaseProFRE",["ProRedirectInWeb"]),W("TestTenantFlight",["TestEnvironmentFlight"]);var K,J,X=function(){function t(t){t=t||{},this.Cb=new D(t.authenticators),this.kb=new L({}),t.addinAccessTokenGetter&&Object(m.b)(t.addinAccessTokenGetter)}var e=t.prototype;return Object.defineProperty(e,"AuthContext",{get:function(){return this.Cb},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Flighting",{get:function(){return this.kb},enumerable:!1,configurable:!0}),Object.defineProperty(e,"RetryingRecoverableError",{get:function(){return this.Tb},set:function(t){this.Tb=t},enumerable:!1,configurable:!0}),t}(),Z=n(23),Y=n(12),tt=n(71),et=n(14),nt=function(){function t(){this.xb=null}var e=t.prototype;return t.getInstance=function(){return null==t.instance&&(t.instance=new t),t.instance},e.getMuid=function(){return this.xb},e.ensureMuid=function(){var e=this;return null==this.Fb&&(this.Fb=new Promise((function(n){var i=Object(et.h)("MUID");if(i)return e.xb=i,void n(e.xb);var r=new tt.a("Function.GetMuid");r.start(),t.loadMuid((function(){null!=(i=Object(et.h)("MUID"))?(e.xb=i,n(e.xb),r.end({resultType:"Success"})):(n(),r.end({resultType:navigator.cookieEnabled?"Failure":"ExpectedFailure"}))}))}))),this.Fb},t.loadMuid=function(t){var e=Object(v.l)();if(e){var n=document.createElement("img");n.style.display="none",n.src=e+"/c.gif",n.hidden=!0,n["aria-hidden"]="true",n.onload=n.onerror=t}else t()},t.instance=null,t}(),it=function(){function t(){this.Pb=[]}var e=t.prototype;return e.setFunctionToCall=function(t){var e=this;if(this.Ri!==t)if(this.Ri=t,t){var n=this.Pb;delete this.Pb,n&&n.length&&n.forEach((function(t){return e.Ri.apply(void 0,t)}))}else this.Pb=this.Pb||[]},Object.defineProperty(e,"queue",{get:function(){return this.Ri?this.Ri:this.Db},enumerable:!1,configurable:!0}),e.Db=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.Pb.push(t)},t}(),rt=n(76),ot=n(82),st=n(37),at=n(10),ct=n(180),ut=n(96),lt=n(202),ht=function(){return"".concat(Date.now(),"-").concat(Math.floor(8999999999999*Math.random())+1e12)},ft=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return{name:t,value:e,delta:0,entries:[],id:ht(),isFinal:!1}},dt=function(t,e){try{if(PerformanceObserver.supportedEntryTypes.includes(t)){var n=new PerformanceObserver((function(t){return t.getEntries().map(e)}));return n.observe({type:t,buffered:!0}),n}}catch(t){}},bt=!1,mt=!1,vt=function(t){bt=!t.persisted},gt=function(){addEventListener("pagehide",vt),addEventListener("beforeunload",(function(){}))},Ot=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];mt||(gt(),mt=!0),addEventListener("visibilitychange",(function(e){var n=e.timeStamp;"hidden"===document.visibilityState&&t({timeStamp:n,isUnloading:bt})}),{capture:!0,once:e})},pt=function(t,e,n,i){var r;return function(){n&&e.isFinal&&n.disconnect(),e.value>=0&&(i||e.isFinal||"hidden"===document.visibilityState)&&(e.delta=e.value-(r||0),(e.delta||e.isFinal||void 0===r)&&(t(e),r=e.value))}},jt=function(){return void 0===K&&(K="hidden"===document.visibilityState?0:1/0,Ot((function(t){var e=t.timeStamp;return K=e}),!0)),{get timeStamp(){return K}}},yt=function(){return J||(J=new Promise((function(t){return["scroll","keydown","pointerdown"].map((function(e){addEventListener(e,t,{once:!0,passive:!0,capture:!0})}))}))),J};function wt(t){!function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=ft("CLS",0),r=function(t){t.hadRecentInput||(i.value+=t.value,i.entries.push(t),e())},o=dt("layout-shift",r);o&&(e=pt(t,i,o,n),Ot((function(t){var n=t.isUnloading;o.takeRecords().map(r),n&&(i.isFinal=!0),e()})))}(t),function(t){var e=ft("FID"),n=jt(),i=function(t){t.startTime<n.timeStamp&&(e.value=t.processingStart-t.startTime,e.entries.push(t),e.isFinal=!0,o())},r=dt("first-input",i),o=pt(t,e,r);r?Ot((function(){r.takeRecords().map(i),r.disconnect()}),!0):window.perfMetrics&&window.perfMetrics.onFirstInputDelay&&window.perfMetrics.onFirstInputDelay((function(t,i){i.timeStamp<n.timeStamp&&(e.value=t,e.isFinal=!0,e.entries=[{entryType:"first-input",name:i.type,target:i.target,cancelable:i.cancelable,startTime:i.timeStamp,processingStart:i.timeStamp+t}],o())}))}(t),function(t){var e,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=ft("LCP"),r=jt(),o=function(t){var n=t.startTime;n<r.timeStamp?(i.value=n,i.entries.push(t)):i.isFinal=!0,e()},s=dt("largest-contentful-paint",o);if(s){e=pt(t,i,s,n);var a=function(){i.isFinal||(s.takeRecords().map(o),i.isFinal=!0,e())};yt().then(a),Ot(a,!0)}}(t),function(t){var e,n=ft("TTFB");e=function(){try{var e=performance.getEntriesByType("navigation")[0]||function(){var t=performance.timing,e={entryType:"navigation",startTime:0};for(var n in t)"navigationStart"!==n&&"toJSON"!==n&&(e[n]=Math.max(t[n]-t.navigationStart,0));return e}();n.value=n.delta=e.responseStart,n.entries=[e],n.isFinal=!0,t(n)}catch(t){}},"complete"===document.readyState?setTimeout(e,0):addEventListener("pageshow",e)}(t),function(t){var e,n=ft("FCP"),i=jt(),r=dt("paint",(function(t){"first-contentful-paint"===t.name&&t.startTime<i.timeStamp&&(n.value=t.startTime,n.isFinal=!0,n.entries.push(t),e())}));r&&(e=pt(t,n,r))}(t)}function St(){var t=Object(lt.a)();return"OneNoteUwp"===t||"PowerPointTaskpane"===t}function Nt(){switch(Object(M.a)()){case"Int":case"MSInt":case"CVInt":return"Int";case"WWProd":case"USGovProd":case"MSProd":case"ProTip":case"CVProd":return"Prod";default:return"DevEnv"}}function It(t){return isNaN(t)?"0":t.toString()}var Ct=function(){function t(t,e,n){var i=this;this.Mb=Object(ut.b)(),this.Lb=e,this.Ab=t,this.Rb=n,setTimeout((function(){nt.getInstance().ensureMuid().then((function(){i.yd()}))}))}var e=t.prototype;return e.logData=function(e){t.BUFFER.queue(e)},e.flush=function(t){this.Ab.flush(t)},e.yd=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e=this;return Object(S.__generator)(this,(function(n){switch(n.label){case 0:return this.Eb=Object(M.b)().toUpperCase(),this.Bb=function(){switch(Object(v.m)()){case"Design":return 0;case"Response":return 1;case"Analyze":return 3;case"TeamsConfig":return 4;default:return 2}}(),this._b=0,this.Hb=window.location.pathname.toLowerCase(),Object(M.d)()&&"OneNoteUwp"!==Object(lt.a)()?(Object(st.c)().then((function(t){return e._b=t})).finally((function(){e.Lb.then((function(){e.Ab.initialize(),t.BUFFER.setFunctionToCall(e.fb.bind(e))}))})),[3,3]):[3,3];case 1:return this._b=Object(ct.a)(),[4,this.Ab.initialize()];case 2:n.sent(),t.BUFFER.setFunctionToCall(this.fb.bind(this)),n.label=3;case 3:return wt((function(t){var e=t.name,n=t.value,i=t.delta,r=t.id,o=t.isFinal;Object(g.b)("Perf.WebVitals",{name:e,value:n,delta:i,id:r,isFinal:o})})),[2]}}))}))},e.fb=function(t){"session_start"===t.eventType&&function(t){var e,n={BuildVersion:Object(u.a)().version,Flights:(e=Object(u.a)(),{IsCdnEnabled:e.isCdnEnabled,IsAFDEnabled:e.isAFDEnabled,DelayLoadThirdPartyJs:Object(Y.b)(),PrefetchFormInServerByApi:Object(Y.c)("PrefetchFormInServerByApi"),IsCandidateForLightResponsePage:e.isCandidateForLightResponsePage,IsLight:e.isLight,LightMode:e.lightMode,NoLightReason:e.noLightReason,ShuffleSupportForIncLoadForms:Object(Y.f)(),RemoveAllQuestionsQuickFix:Object(Y.c)("RemoveAllQuestionsQuickFix"),ProgressBarNew:Object(Y.c)("ProgressBarNew"),IsIntegration:e.isIntegration,IntegrationHost:e.isOembedSPO?"SPO":e.integrationHost}),IsMobile:Object(et.r)(),JQueryLoaded:!!window.$,SessionRing:Nt(),SessionUrlPath:window.location.origin+window.location.pathname,UserAgent:navigator.userAgent};if(t.properties){var i=JSON.parse(t.properties);Object(ot.d)(n,i)}var r=Object(lt.a)(),o=navigator.connection,s=Object(Z.h)();r&&(n.Origin=r),o&&(n.Connection={downLink:o.downLink||-1,effectiveType:o.effectiveType||"unsupported",rtt:o.rtt||-1}),s&&(n.StartPageRoute=s),n.IsMobile&&(n.IsMobileView=Object(et.s)()),t.eventName=t.eventType,t.duration=0,t.properties=JSON.stringify(n),t.timeStamp=Object(rt.b)()}(t),"engagement_event"===t.eventType&&Object(et.r)()&&function(t){var e={},n={};t.properties&&(e=JSON.parse(t.properties)),Object(ot.d)(n,e,{IsMobileView:Object(et.r)()}),t.properties=JSON.stringify(n)}(t),this.Gb(t)},e.Gb=function(t){var e=h.a.Resolve("IAWTEventProperties");e.setName(t.eventType),e.setProperty("event_name",t.eventName),e.setProperty("event_correlation_id",t.eventCorrelationId),e.setProperty("duration",It(t.duration)),e.setProperty("timestamp",It(t.timeStamp)),e.setProperty("properties",t.properties),t.eventName&&t.eventName.indexOf("IntelligenceStatistic")>=0||t.withoutUserInfo?this.qb(e):this.Qb(e)},e.qb=function(t){St()||(t.setProperty("source_application",Object(at.c)((function(){return"Office Forms BrowserApp"}),at.f)),t.setProperty("user_role",this.Bb),t.setProperty("user_type",this._b),t.setProperty("page_type",this.Hb),this.Ab.logEvent(t))},e.Qb=function(t){if(!St()){var e=Object(u.a)().userInfo.UserId,n=Object(u.a)().userInfo.TenantId,i=this.Rb();if(i&&t.setProperty("form_id",i),t.setProperty("source_application",Object(at.c)((function(){return"Office Forms BrowserApp"}),at.f)),t.setProperty("user_id",e),t.setProperty("user_tenant_id",n),t.setProperty("user_role",this.Bb),t.setProperty("user_type",this._b),t.setProperty("session_id",this.Mb),t.setProperty("page_type",this.Hb),t.setProperty("server_build_version",Object(u.a)().serverBuild),t.setProperty("client_build_version",Object(u.a)().clientBuild),t.setProperty("server_dc",Object(u.a)().datacenter),t.setProperty("server_ring",Object(u.a)().ring),Object(u.a)()&&Object(u.a)().serverInfoFromPageHeaders&&(t.setProperty("server_instance",Object(u.a)().serverInfoFromPageHeaders.serverInstance),t.setProperty("routing_build",Object(u.a)().serverInfoFromPageHeaders.routingBuild),t.setProperty("routing_dc",Object(u.a)().serverInfoFromPageHeaders.routingDataCenter),t.setProperty("routing_instance",Object(u.a)().serverInfoFromPageHeaders.routingInstance)),n)if(n.toUpperCase()===this.Eb){var r=Object(u.a)().userInfo.PUID;t.setProperty("UserInfo.Id",r),t.setProperty("UserInfo.IdType","MSAPUID")}else t.setProperty("UserInfo.Id",e),t.setProperty("UserInfo.IdType","UserObjectId"),t.setProperty("UserInfo.OMSTenantId",n);else e||t.setProperty("MUID",nt.getInstance().getMuid());this.Ab.logEvent(t)}},t.BUFFER=new it,t}(),kt=function(){function t(){this.wo=!1}var e=t.prototype;return e.initialize=function(){var t=function(){var t={disableCookiesUsage:!0};switch(Object(M.a)()){case"USGovProd":t.collectorUri="https://tb.pipe.aria.microsoft.com/Collector/3.0";break;case"USDoDProd":t.collectorUri="https://pf.pipe.aria.microsoft.com/Collector/3.0";break;case"USNat":t.collectorUri="https://collector.azure.eaglex.ic.gov/Collector/3.0/"}return t}(),e=function(t){switch(void 0===t&&(t=b.d),Object(M.a)()){case"Int":case"MSInt":case"CVInt":return"79beea9c4fdb49a5adab4843729e1fa0-19b42cd4-5bd4-4bf8-8e49-05dc0f7f97f8-7484";case"WWProd":case"MSProd":case"ProTip":case"CVTip":case"CVProd":case"CVFastfood":return Object(ct.b)()||t()?"5f4ebf0f9a11474199e89f94bc7e2f50-61b8420a-22b1-4220-b531-4a4b96e4edb9-7406":Object(v.x)()?"d34df8693d35452c98f0e1cdfde6d6a8-44cd1abe-6b6d-4edc-a342-46ba159633a4-7645":Object(at.c)((function(){return"2ddc7e5f54754fc68f3ae1c5b7f3eb20-1883aa8c-4c7b-42d1-b3d6-c9cdb5956783-7092"}),at.f);case"USGovGccProd":return"aa96061debfd4ec7b9704f62060b4ca6-a498d428-fdba-43da-bc8b-4fe51865cb7f-7984";case"USGovProd":return"577e32a3275e48c5a639a92c9a8af033-4028cb75-b5f4-4ad0-835e-0e26d79ff209-6823";case"USDoDProd":return"291cebec6b9a4cbf9489bc8cf3a0cc50-06f4c682-bd49-4f88-a8c2-ac582180b7f9-7725";case"USNat":return"847cac884ec7438c803f8fc375832d7f-8af022cb-395a-4731-b40b-aade0142f724-7321";case"USSec":return"fb4a5e0bc6e5481a8790cf380d1b1058-eaf2bb92-036c-4ff5-984e-ad0782620010-7469";default:return"e132e188c609439ab47cd7b06511fc0a-433f81b3-fab9-415a-882a-ba9e2f91abea-6917"}}();AWTLogManager.initialize(e,t),this.Vb=AWTLogManager.getLogger(e),this.wo=!0},e.flush=function(t){this.wo?AWTLogManager.flush(t):t()},e.logEvent=function(t){var e;null===(e=this.Vb)||void 0===e||e.logEvent(t)},t}(),Tt=n(54),xt=n(247),Ft=n(141),Pt=function(){function t(){this.initialVisibility=document.visibilityState,this.initializeTime=new Date,this.zb=this.zb.bind(this),document.addEventListener("visibilitychange",this.zb)}var e=t.prototype;return e.stop=function(){document.removeEventListener("visibilitychange",this.zb)},e.zb=function(){this.visiToggleTime=new Date},t}(),Dt={engagement_event:At,error_event:At,formspro_event:At,nav_perf_event:function(t){var e=At(t);t.extraData&&(!function(t){if(Rt){var e=0;"hidden"===Rt.initialVisibility?e=Rt.initializeTime.getTime():Rt.visiToggleTime&&(e=Rt.visiToggleTime.getTime());t.extraData.VisiToggled=e,Rt.stop(),Rt=null}}(t),e.properties=JSON.stringify(t.extraData));return e},qos_event:function(t){var e={duration:t.duration,eventCorrelationId:t.correlationId,eventName:(t.eventName||Mt[t.eventType]).replace(" ",""),eventType:t.eventType,properties:"",timeStamp:Object(rt.b)()};t.extraData&&(e.properties=JSON.stringify(t.extraData));return e},session_start:At},Mt={engagement_event:"no_EngagementName",error_event:"no_ErrorName",formspro_event:"formspro_event",nav_perf_event:"no_NavPerfName",qos_event:"no_QosName",session_start:"session_start"},Lt=function(){function t(t){this.Ub=t}var e=t.prototype;return e.logFormsProEvent=function(t){t.eventInfo.timeStamp=Date.now()-60*(new Date).getTimezoneOffset()*1e3;var e={eventName:t.type,eventType:"formspro_event",extraData:t.eventInfo};this.Ub.logData(At(e))},e.logForTeamsTab=function(t){Object(Z.q)()&&(t?Object(Ft.a)(t)?microsoftTeams.appInitialization.notifySuccess():microsoftTeams.appInitialization.notifyFailure({message:Object(xt.a)(t),reason:"Other"}):microsoftTeams.appInitialization.notifySuccess())},e.logData=function(t,e){if(!function(t){return-1!==(Object(Tt.a)("DisabledEventNames")||[]).indexOf(t.eventName)}(t)){var n,i=Dt[t.eventType];if(i)n=i(t);else n=At({eventName:"no_ErrorName",eventType:"error_event",extraData:{initData:t,message:"Unsupported event"}});this.Ub.logData(Object(ot.d)(n,{withoutUserInfo:e}))}},t}();function At(t){var e={duration:0,eventCorrelationId:t.correlationId,eventName:(t.eventName||Mt[t.eventType]).replace(" ",""),eventType:t.eventType,properties:"",timeStamp:Object(rt.b)()};return t.extraData&&(e.properties=JSON.stringify(t.extraData)),e}var Rt=new Pt;var Et=n(3),Bt=n(112),_t=n(11),Ht=n(33),Gt=n(98),qt=n(173),Qt=n(104),Vt=n(81),zt=function(){function t(t,e){this.serviceUrl=t,this.ownerServiceUrl=e,this.partialUpdateHttpMethod=Object(Ht.a)().Flighting.isEnabled_Deprecated("PartialPut")?"PUT":"PATCH"}var e=t.prototype;return t.getQueryParameters=function(t,e,n){if(!e)return t+"$expand=questions";var i="$select="+(e=Et.union(["id"],e)).join(","),r={permissions:"permissions",questions:"questions($expand=choices)",permissionTokens:"permissionTokens"},o=e.map((function(t){return r[t]})).filter((function(t){return t}));return o.length&&(i+="&$expand="+o.join(",")),n&&(i+="&$filter="+n.name+"+"+n.operator+"+"+n.value),i&&t+i},e.getImmersiveReaderToken=function(){var t=Object(b.b)(),e=this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=ImmersiveReader";return Object(Y.c)("EnableImmersiveReaderNewTokenAPI")&&(e=this.getSurveyWebServiceUrl()+"decomposition/GetImmersiveReaderToken?formId="+t),this.sendRequest({method:"GET",qosEventName:"Decomposition.GetImmersiveReaderToken",requestUri:e}).then((function(t){if(t)return t;throw new Error("Failed to get ImmersiveReader token via GetTokenForResource")}))},e.getPrivacySettings=function(t,e){var n={};return t&&(n.ownerTenantId=t),e&&(n.currentUserTenantId=e),this.sendRequest({method:"GET",qosEventName:"Function.GetPrivacy",requestUri:this.getSurveyWebServiceUrl()+"privacy?"+$.param(n)})},e.reportAbuse=function(t){return this.sendRequest({data:t,method:"POST",qosEventName:"OnlineSafety.ReportAbuse",qosExtraData:{Category:t.Category},requestUri:this.getSurveyWebServiceUrl()+"contentvalidation/report"+window.location.search})},e.getRuntimeResponses=function(t,e){var n=e?"&$filter=responder+eq+'"+encodeURIComponent(e.replace(/\'/g,"''"))+"'":"",i=this.getSurveyWebOwnerServiceUrl();return this.sendRequest({qosEventName:"RuntimeResponses.Get",requestUri:i+"forms('"+t+"')/runtimeresponses?$expand=comments"+n})},e.getRuntimeResponse=function(t,e){var n=Object(d.d)(),i={};return n.GetResponseToken&&(i={GetResponseToken:n.GetResponseToken}),this.sendRequest({headers:i,qosEventName:"RuntimeResponse.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/runtimeresponses("+e+")?$expand=comments"})},e.submitFormResponse=function(t,e){var n=Object(Vt.a)(t),i="AAD";return null==n.OrgId?i="Unknown":n.OrgId.toLowerCase()===Object(M.b)()&&(i="MSA"),this.sendRequest({data:e,method:"POST",qosEventName:"Response.Submit",qosExtraData:{OwnerSource:i},requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses"})},e.getToken=function(){return Object(Ht.a)().AuthContext.getFormApiToken()},e.getRuntimeForm=function(e,n){var i=this.getSurveyWebOwnerServiceUrl()+"light/runtimeForms('"+e+"')";return i+=t.getQueryParameters("?",n),this.sendRequest({qosEventName:"ResponseForm.Get",requestUri:i},{hasPrefetch:!0})},e.getResponseDetailRuntimeForm=function(e,n){var i=Object(d.d)();if(i.GetResponseToken&&i.rid){var r={GetResponseToken:i.GetResponseToken},o=this.getSurveyWebOwnerServiceUrl()+"light/responseDetailRuntimeForms('"+e+"')/"+i.rid;return o+=t.getQueryParameters("?",n),this.sendRequest({headers:r,qosEventName:"QosEvent.ServiceEndpoints.Form.GetResponseDetailRuntimeForm",requestUri:o})}return Promise.resolve(null)},e.getLocaleResource=function(t,e){var n=this.getMultilingualBaseUrl(t)+"/'"+e+"'";return this.sendRequest({headers:{ValidationToken:""},method:"GET",qosEventName:"Locale.Get",requestUri:n})},e.createUploadSession=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"runtimeForms('"+t+"')/questions('"+e+"')/CreateUploadSession";return this.sendRequest({data:{value:n},method:"POST",qosEventName:"Question.CreateUploadSession",requestUri:i})},e.cancelOrDeleteUploadFile=function(t){return this.sendRequest({method:"DELETE",qosEventName:"FileUpload.CancelOrDeleteUploadFile",requestUri:t})},e.getUserInfo=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userInfo",method:"GET",qosEventName:"Function.GetUserInfo"})},e.getSharedForm=function(t){return this.sendRequest({body:'{"value" : "'+Object(d.d)().sharetoken+'"}',headers:{"Content-Type":"application/json;odata.metadata=minimal"},method:"GET",qosEventName:"SharedForm.Get",requestUri:this.getSurveyWebOwnerServiceUrl()+"GetSharedForm(formid='"+t+"',token='"+Object(d.d)().sharetoken+"')"})},e.getDataClassificationLabelDetail=function(t,e){return this.$b({method:"GET",qosEventName:"Function.GetDataClassificationLabelDetails",requestUri:this.getSurveyWebServiceUrl()+"/dataClassificationLabelInfo/"+t+"/"+encodeURIComponent(e)})},e.getMultilingualBaseUrl=function(t){return this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/localeResource"},e.getSurveyWebOwnerServiceUrl=function(){return this.ownerServiceUrl},e.getSurveyWebServiceUrl=function(){return this.serviceUrl},e.sendRequest=function(t,e){var n=this;return this.getToken().then((function(i){return t.headers=$.extend(!0,t.headers,n.getCommonHeaders(i)),Object(Gt.a)(t,e).then((function(t){return Object(Qt.a)(t).value}),Qt.b)}))},e.getCommonHeaders=function(e){var n={__RequestVerificationToken:Object(u.a)().antiForgeryToken,Accept:"application/json",AnalyzerToken:Object(d.d)().AnalyzerToken,Authorization:Object(I.a)(e),ContextParams:Object(d.d)().ctx,ValidationToken:Object(d.d)().vt},i=Object(d.b)().Token;return n.ShareInvitationKey=i||Object(d.d)().Token,n=Et.extend({},n,t.customizedHeaders)},e.$b=function(t,e){return t.headers=$.extend(!0,t.headers,this.getCommonHeaders("")),Object(Gt.a)(t,e).then(Qt.c,Qt.b)},t.customizedHeaders={},t}();function Ut(t){function e(t){var e=null;if(t&&t.settings){0;var n=null;try{n=JSON.parse(t.settings)}catch(t){}t.category&&t.category.split(" ").indexOf("Poll")>=0?e="Poll":n&&void 0!==n.IsQuizMode&&(e=n.IsQuizMode?"Quiz":"Form")}return e||void 0}return function(t){function i(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this;return i.Wb="aadFormLauncher",i.Kb="msaFormLauncher",i}Object(S.__extends)(i,t);var r=i.prototype;return i.addDefaultHeader=function(t,e){null===zt.customizedHeaders&&(zt.customizedHeaders={}),zt.customizedHeaders[t]=e},r.getForms=function(t,e){var n=this.getSurveyWebOwnerServiceUrl()+"light/";return n+="forms"+zt.getQueryParameters("?",t,e),this.sendRequest({requestUri:n,qosEventName:"Forms.Get"})},r.hardDeleteForms=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"light/deleteForms";return this.sendRequest({requestUri:e,method:"POST",data:t,qosEventName:"Forms.HardDeleteForms"})},r.getFormsSharedWithCurrentUser=function(){var t=this.getSurveyWebOwnerServiceUrl()+"sharedWithMeForms";return this.sendRequest({requestUri:t,qosEventName:"Forms.Get.SharedWithMe"})},r.getCachedSimpleForms=function(t,e){var n=""+this.serviceUrl+t+"/users/"+e+"/memorybasedforms";return this.sendRequest({requestUri:n,qosEventName:"Forms.GetCachedSimpleForms"})},r.getDesignForm=function(t,e){var n=this.getSurveyWebOwnerServiceUrl()+"light/";return n+="forms('"+t+"')",n+=zt.getQueryParameters("?",e),this.sendRequest({requestUri:n,qosEventName:"DesignForm.Get"})},r.getAnalysisTimeForm=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"light/analysisForms('"+t+"')?$expand=questions($expand=choices)";return this.sendRequest({requestUri:e,method:"GET",qosEventName:"AnalysisForm.Get"})},r.createOD4BSessionTempFolder=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"runtimeForms('"+t+"')/Microsoft.FormServices.CreateOneDriveSessionTempFolder",method:"POST",qosEventName:"Form.CreateOD4BSessionTempFolder"}).then((function(t){return t?t.itemId:Promise.reject(new Error("Failed to create OneDriveForBusiness session temp folder."))}))},r.deleteSharedWithMeLink=function(t){var e=this.getSurveyWebServiceUrl()+"light/sharedWithMeForms('"+t+"')";return this.sendRequest({requestUri:e,method:"DELETE",qosEventName:"Forms.DeleteSharedWithMe"})},r.changeSharingStatus=function(t,e){var n=e?"On":"Off";return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"/forms('"+t+"')/Microsoft.FormServices.Turn"+n+"AllowCopySetting",method:"POST",qosEventName:e?"FormDefinition.TurnOnFormSharing":"FormDefinition.TurnOffFormSharing"})},r.createPermissionLink=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/permissions",method:"POST",data:e,qosEventName:"FormDefinition.CreateFormPermissionLink",qosExtraData:{specificShare:"User"===e.type||"Group"===e.type}})},r.deletePermissionLink=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/permissions('"+e+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionLink"})},r.createResponderPermissionLink=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responderPermissions",method:"POST",data:e,qosEventName:"FormDefinition.CreateResponderFormPermissionLink",qosExtraData:{type:e.type}})},r.deleteResponderPermissionLink=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responderPermissions('"+e+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteResponderFormPermissionLink"})},r.getFormPermissions=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/permissions",method:"GET",qosEventName:"FormDefinition.GetFormPermissions"})},r.createPermissionToken=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/permissionTokens",method:"POST",data:e,qosEventName:"FormDefinition.CreateFormPermissionToken"})},r.getOrCreateFormPermissionToken=function(t,e,n){var i={};return Object(Z.q)()&&(i["x-ms-form-request-source"]="ms-teams"),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/Microsoft.FormServices.GetOrCreatePermissionToken",method:"POST",headers:i,data:{type:e,name:n},qosEventName:"Form.GetOrCreatePermissionToken"})},r.deletePermissionToken=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/permissionTokens('"+e+"')",method:"DELETE",qosEventName:"FormDefinition.DeleteFormPermissionToken"})},r.getIdentityProviderType=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"authinfo/idptype?username="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetIdentityProviderType"}).then((function(t){return t.ProviderType}))},r.createForm=function(t){var n={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms",method:"POST",data:t,headers:n,qosEventName:"Form.Create",qosExtraData:{FormType:e(t)}})},r.updateForm=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')",method:this.partialUpdateHttpMethod,data:e,qosEventName:"Form.Update",qosExtraData:{SoftDeleted:e.softDeleted}},{disableRetry:1===e.softDeleted})},r.postFormShareAction=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/shareaction",method:"POST",qosEventName:"Form.PostShareAction"})},r.createFormImageFromUrl=function(t,e,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/"+e,method:"POST",data:n,qosEventName:"logo"===e?"FormImage.CreateFromUrl":"ThemeImage.CreateFromUrl",qosExtraData:{FormProperty:e}})},r.deleteForm=function(t,e,n){void 0===e&&(e=""),void 0===n&&(n="");var i=Object(at.c)((function(){}),at.f);return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')",method:"DELETE",data:i,qosEventName:"Form.Delete"})},r.dupFormForExcel=function(t,e){var n={id:t,xlWorkbookId:e};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms",method:"POST",data:n,qosEventName:"Excel.DuplicateFormForExcel"})},r.copyForm=function(t,e,n,i){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/CopyToUser",method:"POST",data:{formId:t,newOwnerId:e,newTenantId:n,isNewOwnerGroup:i},qosEventName:"Function.CopyForm",qosExtraData:{FormId:t,NewOwnerId:e,IsNewOwnerGroup:i}},{disableRetry:!0}).then((function(t){return{id:t.id,title:t.title,createdDate:t.createdDate,modifiedDate:t.modifiedDate,settings:t.settings,xlWorkbookId:t.xlWorkbookId,ownerId:t.ownerId,ownerTenantId:t.ownerTenantId,category:t.category,otherInfo:t.otherInfo,background:t.background,softDeleted:t.softDeleted,type:t.type,fileUploadFormInfo:t.fileUploadFormInfo,status:t.status,version:t.version}}))},r.copyFormBySharingLink=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/CopyBySharingLink",method:"POST",headers:{ShareInvitationKey:e},data:{formId:t,sharingToken:e},qosEventName:"Function.CopyBySharingLink",qosExtraData:{FormId:t}})},r.moveForm=function(t,e,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/MoveForm",method:"POST",data:{newOwnerId:e,isNewOwnerGroup:n},qosEventName:"Function.MoveForm",qosExtraData:{FormId:t,NewOwnerId:e,IsNewOwnerGroup:n,IsDelegateMode:Object(Z.m)()}})},r.postRecentForm=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t,data:e,method:"POST",qosEventName:"Function.PostRecentForm"})},r.getRecentForms=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms"+(null==t?"":"?ownerType="+encodeURIComponent(t)),method:"GET",qosEventName:"Function.GetRecentForms"})},r.removeRecentForm=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t,method:"DELETE",qosEventName:"Function.RemoveRecentForm"})},r.updateExperienceType=function(t,e,n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+t+"/users/"+e+"/experiencetype/"+n+"/UpdateExperienceType",method:"POST",qosEventName:"Function.UpdateExperienceType"})},r.updateLastUsedEnv=function(t,e,n){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+t+"/users/"+e+"/UpdateLastUsedEnv",data:n,method:"POST",qosEventName:"Function.UpdateLastUsedEnv"})},r.updateFormsProLicense=function(t,e){var n="";t||(n="FORMS_PRO");var i="";return i="UpdateFormsProUserLicenses(licenseNames='{0}',isOptOutAction={1})".format(n,e?"true":"false"),this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+i,method:"DELETE",qosEventName:"Function.UpdateFormsProLicense"})},r.updateRecentForm=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"recent/forms/"+t+"?title="+encodeURIComponent(e),method:"PUT",qosEventName:"Function.UpdateRecentForm"})},r.getFormsTenantSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetFormsTenantSettings",method:"GET",qosEventName:"Function.GetFormsTenantSettings"})},r.getUserReputationTier=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userReputationTier",method:"GET",qosEventName:"Function.GetUserReputationTier"})},r.getFormCreatorPhotoDefinition=function(t){return this.Jb({requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorDefinition('"+t+"','')",method:"GET",qosEventName:"Function.GetFormCreatorPhotoDefinition"})},r.getFormCreatorPhotoValue=function(t){return this.Jb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/GetFormCreatorPhotoValue('"+t+"','')/$value",method:"GET",qosEventName:"Function.GetFormCreatorPhotoValue"})},r.getCurrentUserPhotoValue=function(){return this.Jb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"GetCurrentUserPhotoValue",method:"GET",qosEventName:"Function.GetCurrentUserPhotoValue"})},r.getDataClassificationLabels=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"/GetDataClassificationLabels",qosEventName:"Function.GetDataClassificationLabels"})},r.getFormQuestion=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')";return n&&(i=i+"?$select="+n.toString()),this.sendRequest({requestUri:i,qosEventName:"Question.Get"})},r.createFormQuestion=function(t,e,n,i){var r=Object(S.__assign)({IsQuiz:e.isQuiz,QuestionId:e.id,QuestionType:e.type},n),o={requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions",method:"POST",data:e,qosEventName:"Question.Create",qosExtraData:r};return i?this.Jb(o,{},i):this.sendRequest(o)},r.createQuestionImageFromUrl=function(t,e,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')/image",method:"POST",data:n,qosEventName:"QuestionImage.CreateFromUrl",qosExtraData:{QuestionId:e}})},r.updateFormQuestion=function(t,e,n,i,r){var o=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')",s=Object(S.__assign)({QuestionType:n},r);return this.sendRequest({requestUri:o,method:this.partialUpdateHttpMethod,data:i,qosEventName:"Question.Update",qosExtraData:s},{disableLog:!0})},r.deleteFormQuestion=function(t,e,n,i){var r=Object(S.__assign)({QuestionType:n,QuestionId:e},i);return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')",method:"DELETE",qosEventName:"Question.Delete",qosExtraData:r})},r.Xb=function(t){var e,n=this;if(t&&((e=Object(_t.b)())&&e.Model.FormMaster&&e.Model.FormMaster.Model.OwnerId===Object(u.a)().userInfo.UserId)){var i=Object(_t.b)();Object(st.c)().then((function(e){if(e&&i.Model.FormMaster.Model.OwnerUserType!==e.toString()){var r={};r.ownerUserType=e.toString(),i.bulkEdit((function(t){t.FormMaster.Model.OwnerUserType=e.toString()})),n.updateForm(t,r)}})).catch((function(){Object(g.e)({eventInfo:{Component:"FormAPI_fetchOwnerUserType",message:"Failed to fetch user type",pageName:"DesignPage",tenantId:Object(u.a)().userInfo.TenantId,userId:Object(u.a)().userInfo.UserId},type:"MFPUI_UserTypeFetchFailed"})}))}},r.getFormDescriptiveElement=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/descriptiveQuestions('"+e+"')";return n&&(i=i+"?$select="+n.toString()),this.sendRequest({requestUri:i,qosEventName:"DescriptiveElement.Get"})},r.createFormDescriptiveElement=function(t,e,n){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/descriptiveQuestions",method:"POST",data:e,qosEventName:"DescriptiveElement.Create",qosExtraData:Object(S.__assign)({QuestionId:e.id,QuestionType:e.type},n)})},r.updateFormDescriptiveElement=function(t,e,n,i,r){var o=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/descriptiveQuestions('"+e+"')";return this.sendRequest({requestUri:o,method:this.partialUpdateHttpMethod,data:i,qosEventName:"DescriptiveElements.Update",qosExtraData:Object(S.__assign)({QuestionType:n},r)},{disableLog:!0})},r.deleteFormDescriptiveElement=function(t,e,n,i){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/descriptiveQuestions('"+e+"')",method:"DELETE",qosEventName:"DescriptiveElement.Delete",qosExtraData:Object(S.__assign)({QuestionType:n},i)})},r.createQuestionChoice=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')/choices";return this.sendRequest({requestUri:i,method:"POST",data:n,qosEventName:"Choice.Create"})},r.getQuestionChoice=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')/choices("+n+")";return this.sendRequest({requestUri:i,method:"GET",qosEventName:"Choice.Get"})},r.updateQuestionChoice=function(t,e,n,i){var r=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')/choices("+n+")";return this.sendRequest({requestUri:r,method:this.partialUpdateHttpMethod,data:i,qosEventName:"Choice.Update"})},r.deleteQuestionChoice=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/questions('"+e+"')/choices("+n+")";return this.sendRequest({requestUri:i,method:"DELETE",qosEventName:"Choice.Delete"})},r.getFormResponses=function(t,e,n,i){var r=["$expand=comments"];e&&r.push("$filter={0}+{1}+{2}".format(e.name,e.operator,e.value)),n>=0&&i>=0&&r.push("$top={0}&$skip={1}".format(n,i));var o=r.filter((function(t){return!!t})).join("&");o=o&&"?"+o;var s=this.getSurveyWebOwnerServiceUrl()+"light/";return this.sendRequest({requestUri:s+"forms('"+t+"')/responses"+o,qosEventName:Et.any(r,(function(t){return-1===t.indexOf("$filter")}))?"Responses.Get":"Responses.Get.Filter"})},r.getAnalysisTimeResponses=function(t,e,n){var i=this.getSurveyWebOwnerServiceUrl()+"analysisForms('"+t+"')/responses?$expand=comments";return e>=0&&n>=0&&(i+="&$top={0}&$skip={1}".format(e,n)),this.sendRequest({requestUri:i,method:"GET",qosEventName:"AnalysisTimeResponses.Get"})},r.getFormsResponseCount=function(){return this.Jb({requestUri:this.getSurveyWebServiceUrl()+"light/GetRespCounts()",method:"GET",qosEventName:"Function.GetFormsResponseCount"})},r.getFormResponseCount=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses/$count",qosEventName:"ResponseCount.Get"},{disableLog:!0})},r.deleteFormResponses=function(t){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses",method:"DELETE",qosEventName:"Responses.Delete"})},r.deleteFormResponse=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses("+e+")/",method:"DELETE",qosEventName:"Response.Delete"})},r.deleteFormInvites=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"light/forms('"+t+"')/invites",method:"DELETE",data:e,qosEventName:"Invites.Delete"})},r.addFormResponseComment=function(t,e,n){var i={feedback:n.feedback,score:n.score,questionId:n.questionId};return n.id&&(i.id=n.id),this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses("+e+")/comments",method:"POST",data:i,qosEventName:"Comment.Add"})},r.addFormResponseComments=function(t,e){return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"batch/forms('"+t+"')/comments",method:"POST",data:e,qosEventName:"Comments.Add"})},r.setResponseReleaseDate=function(t,e,n){var i={releaseDate:n};return this.sendRequest({requestUri:this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/responses("+e+")",method:this.partialUpdateHttpMethod,data:i,qosEventName:"Response.Update"})},r.createExportFile=function(t){var e=this;return this.getToken().then((function(n){var i,r=function(t){var e=document.getElementById(t);return e&&e.parentNode.removeChild(e),(e=document.createElement("iframe")).id=t,e.name=t,e.hidden=!0,e}("cdb-export-iframe");if((i=document.createElement("form")).style.display="none",i.method="POST",i.action=e.getSurveyWebServiceUrl()+"forms('"+t+"')/Microsoft.FormServices.CreateExportFile",i.target="cdb-export-iframe",null!==n){var o=document.createElement("input");o.type="hidden",o.name="Authorization",o.value="Bearer "+n,i.appendChild(o)}if(null!==Object(u.a)().antiForgeryToken){var s=document.createElement("input");s.type="hidden",s.name="__RequestVerificationToken",s.value=Object(u.a)().antiForgeryToken,i.appendChild(s)}document.body.appendChild(r),$(r).ready((function(){r.contentDocument.body.appendChild(i)})),i.submit()}))},r.downloadExcelFile=function(t,e,i){var r=this,o=3,s=new tt.a("Function.DownloadExcel");s.start();var a=function(){return r.getToken().then((function(c){return new Promise((function(u,l){var h=$.extend(!0,{},r.getCommonHeaders(c));h["x-correlationid"]=s.CorrelationId,h["x-usersessionid"]=Object(ut.b)();var f=r.Zb({formid:t,timezoneOffset:(new Date).getTimezoneOffset().toString(),minResponseId:e,maxResponseId:i}),d=Date.now();Object(Gt.b)({requestUri:f,headers:h}).then((function(t){return Object(S.__awaiter)(r,void 0,void 0,(function(){var e,i,r;return Object(S.__generator)(this,(function(o){switch(o.label){case 0:return e={resultType:"Success"},i="Responses.xlsx",(r=Et.find(Et.keys(t.headers),(function(t){return"content-disposition"===t.toLowerCase()})))?i=t.headers[r].split("filename*=UTF-8''")[1]:e.extraData={IsFileNameInHeader:!1},[4,n.e(0).then(n.t.bind(null,1116,7))];case 1:return(0,o.sent().saveAs)(t.body,decodeURIComponent(i)),s.end(e),u(),[2]}}))}))}),(function(t){return Object(S.__awaiter)(r,void 0,void 0,(function(){var e,n,i,r,c,u;return Object(S.__generator)(this,(function(h){switch(h.label){case 0:return e=t.response,n={statusCode:e&&e.statusCode,sourceUrl:f,innerCode:10203,innerMessage:"",failureType:"Failure"},[4,(b=e.body,m=new FileReader,new Promise((function(t,e){m.onload=function(){return t(m.result)},m.readAsText(b)})))];case 1:switch(i=h.sent(),n.innerMessage=i,(r=Object(et.G)(i))&&r.error&&(n.innerCode=parseInt(r.error.code),n.innerMessage=r.error.message,n.failureType=r.error["@ms.form.error.type"]),n.innerCode){case 711:case 701:if(o>0)return o--,Object(Ht.a)().AuthContext.refreshToken().then((function(){Object(Bt.e)().then((function(){a()})).catch(p.d)})),[2];break;default:503===e.statusCode?(c=Date.now()-d,2e4,c>2e4&&(n.innerMessage="ConnectionClosedByClient",n.innerCode=10210,n.failureType="ExpectedFailure")):429===e.statusCode?(n.innerMessage="TooManyRequest",n.innerCode=10208,n.failureType="ExpectedFailure",i.includes("ManyRequestPerVM")&&(n.innerMessage="ManyRequestPerVM",n.innerCode=10209)):307!==e.statusCode&&403!==e.statusCode&&502!==e.statusCode||(u=["blocked","policy","violation","security","malware","virus","leak","denied","attention"],Et.contains(u,i.toLowerCase())&&(n.innerMessage="Blocked",n.innerCode=10207,n.failureType="ExpectedFailure"))}return s.end({resultType:n.failureType,extraData:{ServiceError:n}}),l(n),[2]}var b,m}))}))}))}))}))};return a()},r.getShellServiceInfo=function(t){var e,n=this,i=Object(O.c)();return(e=i.getItem(this.Wb))?Promise.resolve(JSON.parse(e)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"Function.GetShellServiceInfo"}).then((function(t){return i.setItem(n.Wb,JSON.stringify(t)),t}))},r.getConsumerShellServiceInfo=function(t){var e,n=this;return(e=Object(O.c)().getItem(this.Kb))?Promise.resolve(JSON.parse(e)):this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetConsumerShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"Function.GetConsumerShellServiceInfo"}).then((function(t){return window.sessionStorage.setItem(n.Kb,JSON.stringify(t)),t}))},r.getShellNavBarData=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"GetShellServiceInfo(culture='{0}')".format(t),method:"GET",qosEventName:"QosEvent.ServiceEndpoints.Function.GetShellNavBarData"})},r.getOrNewExcelInOneDrive=function(t,e){var n=this.getSurveyWebOwnerServiceUrl()+"GetOrNewExcelInOneDrive(formid='"+t+"',forcereexport='"+e+"')";return this.sendRequest({requestUri:n,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:"Action.OpenExcelInOneDrive"})},r.refreshUserInfo=function(){return this.sendRequest({method:"GET",requestUri:this.getSurveyWebServiceUrl()+"refreshUserInfo",qosEventName:"Function.RefreshUserInfo"})},r.getUserFeatureSettings=function(){return this.Jb({requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"GET",qosEventName:"Function.GetUserFeatureSettings"})},r.updateUserFeatureSettings=function(t){return this.Jb({data:JSON.stringify(t),requestUri:this.getSurveyWebServiceUrl()+"userfeaturesettings",method:"PATCH",qosEventName:"Function.UpdateUserFeatureSettings"})},r.getXlWorkbookId=function(t){var e=this.getSurveyWebServiceUrl()+"GetXlWorkbookId(formid='"+t+"')";return this.sendRequest({requestUri:e,method:"GET",headers:{__TimezoneOffset:(new Date).getTimezoneOffset().toString()},qosEventName:"Action.GetXlWorkbookId"})},r.isMemberOf=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"light/IsMemberOf('"+t+"')",method:"GET",qosEventName:"Function.IsMemberOf"},{disableXMsHeader:!0})},r.browseImage=function(t,e,n){var i={resourceId:t,itemCount:e,skipToken:n};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/browseimage",method:"POST",data:i,qosEventName:"Decomposition.BrowseImage"})},r.getToken=function(){return Object(Ht.a)().AuthContext.getFormApiToken()},r.searchImage=function(t,e,n,i,r){var o={query:t,itemCount:n,lcid:Object(u.a)().cultureInfo.Name.toLowerCase(),parameters:{license:e},skipToken:i.toString(),url:r};return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/searchimage",method:"POST",data:o,qosEventName:"Decomposition.SearchImage"})},r.getCdbToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=CollabDB",method:"GET",qosEventName:"Decomposition.GetCdbToken"}).then((function(t){if(t)return t;throw new Error("Failed to get CDB token via GetTokenForResource")}))},r.getOD4BToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=MSGraph",method:"GET",qosEventName:"Decomposition.GetOD4BToken"}).then((function(t){if(t)return"Bearer "+t;throw new Error("Failed to get OneDriveForBusiness token via GetTokenForResource")}))},r.getFormsProToken=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"decomposition/getTokenForResource?resourceType=FormsPro",method:"GET",qosEventName:"Decomposition.GetFormsProToken"}).then((function(t){if(t)return"Bearer "+t;throw new Error("Failed to get FormsPro token via GetTokenForResource")}))},r.unblockPhishingForm=function(t){return this.sendRequest({requestUri:this.Yb(t)+"/unblock",method:"PATCH",qosEventName:"AdminPage.UnblockPhishingForm"})},r.confirmPhishingForm=function(t){return this.sendRequest({requestUri:this.Yb(t)+"/confirmPhishing",method:"PATCH",qosEventName:"AdminPage.ConfirmPhishingForm"})},r.deleteEvilForm=function(t){return this.sendRequest({requestUri:this.Yb(t),method:"DELETE",qosEventName:"AdminPage.DeleteEvilForm"})},r.getAdminPhishingReviewForm=function(t,e){var n=this.Yb(t);return n+=zt.getQueryParameters("?",e),this.sendRequest({requestUri:n,method:"GET",qosEventName:"AdminPage.GetPhisingReviewForm"})},r.createAdminPhishingReviewPermissionLink=function(t,e){return this.sendRequest({requestUri:this.Yb(t)+"/permissions",method:"POST",data:e,qosEventName:"AdminPage.CreateFormPermissionLink"})},r.getRestrictedUser=function(t){return this.sendRequest({requestUri:this.tm(t),method:"GET",qosEventName:"AdminPage.GetRestrictedUser"})},r.unblockRestrictedUser=function(t){return this.sendRequest({requestUri:this.tm(t),method:"DELETE",qosEventName:"AdminPage.UnblockRestrictedUser"})},r.getGroups=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups",method:"GET",qosEventName:"Groups.Get"})},r.getGroupId=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groupinfo/getgroupid?onedriveweburl="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetGroupId"})},r.getGroup=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')",method:"GET",qosEventName:"Group.Get"})},r.getGroupOwners=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/owners",method:"GET",qosEventName:"Group.GetOwners"})},r.getGroupMembers=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/members",qosEventName:"Group.GetMembers"})},r.getGroupPhotoDefinition=function(t){return this.Jb({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/photo",method:"GET",qosEventName:"Group.GetPhotoDefinition"})},r.getGroupPhotoValue=function(t){return this.Jb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/photo/$value",method:"GET",qosEventName:"Group.GetPhotoValue"})},r.getUserPhotoValue=function(t){return this.Jb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"light/users/"+t+"/photo/$value",method:"GET",qosEventName:"User.GetPhotoValue"})},r.getGroupMemberPhotoDefinition=function(t,e){return this.Jb({requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/members('"+e+"')/photo",method:"GET",qosEventName:"Group.GetMemberPhotoDefinition"})},r.getGroupMemberPhotoValue=function(t,e){return this.Jb({blobResponseType:!0,requestUri:this.getSurveyWebServiceUrl()+"groups('"+t+"')/members('"+e+"')/photo/$value",method:"GET",qosEventName:"Group.GetMemberPhotoValue"})},r.getAnalysisSurveyData=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/GetAggregateSurveyData";return this.sendRequest({requestUri:e,qosEventName:"Analysis.AggregateSurveyData"})},r.getAnalysisQuizData=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/GetAggregateQuizData";return this.sendRequest({requestUri:e,qosEventName:"Analysis.AggregateQuizData"})},r.getResultSharingAnalysisSurveyData=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"analysisForms('"+t+"')/GetAggregateSurveyData";return this.sendRequest({requestUri:e,qosEventName:"Analysis.ResultSharingAggregateSurveyData"})},r.getResultSharingAnalysisQuizData=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"analysisForms('"+t+"')/GetAggregateQuizData";return this.sendRequest({requestUri:e,qosEventName:"Analysis.ResultSharingAggregateQuizData"})},r.getInsights=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"insights/getinsights?formId="+encodeURIComponent(t),method:"GET",qosEventName:"Form.GetInsights"})},r.getFormsWithToken=function(t,e,n){void 0===t&&(t=!1);var i=this.getSurveyWebServiceUrl()+"forms"+zt.getQueryParameters("?",e);return this.Jb({requestUri:i,qosEventName:"Forms.Get"},{skipExpiredTokenCheck:!!n},n)},r.createFormWithToken=function(t,n){var i={__TimezoneOffset:(new Date).getTimezoneOffset().toString()};return this.Jb({requestUri:this.getSurveyWebServiceUrl()+"forms",method:"POST",data:t,headers:i,qosEventName:"Form.Create",qosExtraData:{FormType:e(t)}},{},n)},r.checkAnonymousAccess=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"light/runtimeForms('"+t+"')";return Object(Gt.a)({requestUri:e,headers:[]},{disableLog:!0,skipExpiredTokenCheck:!0}).then((function(){return!0}),(function(t){var e=Object(qt.a)(t);if(401===e.statusCode)return!1;throw e}))},r.getMeetingInfo=function(t){var e=this.getSurveyWebServiceUrl()+"light/meetingInfo?meetingId="+t;return this.sendRequest({requestUri:e,method:"GET",qosEventName:"MeetingInfo.GetMeetingInfo"})},r.experimentationGetVariations=function(){var t=this.getSurveyWebServiceUrl()+"experimentation/getvariations";return this.sendRequest({requestUri:t,method:"GET",qosEventName:"Experimentation.GetVariations"})},r.experimentationActivate=function(t){var e=this.getSurveyWebServiceUrl()+"experimentation/activate?experimentKey="+t;return this.sendRequest({requestUri:e,method:"GET",qosEventName:"Experimentation.Activate"})},r.experimentationTrack=function(t,e){var n=this.getSurveyWebServiceUrl()+"experimentation/track?experimentKey="+t+"&eventKey="+e;return this.sendRequest({requestUri:n,method:"GET",qosEventName:"Experimentation.Track"})},r.getInactiveUserByIdOrEmail=function(t){var e=this.getSurveyWebServiceUrl()+"deleteduserinfo/byidemail/"+encodeURIComponent(t);return this.sendRequest({requestUri:e,isSensitiveUri:!0,method:"GET",qosEventName:"InactiveUserByIdOrEmail.Get"})},r.getUserSettings=function(){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:"GET",qosEventName:"UserSettings.Get"})},r.updateUserSettings=function(t){return this.sendRequest({requestUri:this.getSurveyWebServiceUrl()+"userSettings",method:this.partialUpdateHttpMethod,data:t,qosEventName:"UserSettings.Update"}).then((function(){return null}))},r.getAllLocaleResources=function(t){var e=this.getMultilingualBaseUrl(t);return this.sendRequest({requestUri:e,method:"GET",qosEventName:"Locale.GetAll"})},r.createLocaleItem=function(t,e){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(t),method:"POST",data:e,qosEventName:"LocaleItem.Create"})},r.updateLocaleItem=function(t,e){var n=this.getMultilingualBaseUrl(t)+"/'"+e.locale+"'/";return n+=e.questionId?"question/'"+e.questionId+"'/'":"form/'",n+=e.elementKey+"'",this.sendRequest({requestUri:n,method:this.partialUpdateHttpMethod,data:{ElementValue:e.elementValue},qosEventName:"LocaleItem.Update"})},r.deleteLocale=function(t,e){return this.sendRequest({requestUri:this.getMultilingualBaseUrl(t)+"/'"+e+"'",method:"DELETE",qosEventName:"Locale.Delete"})},r.copyLocaleResources=function(t,e){var n=this.getSurveyWebOwnerServiceUrl()+"batch/forms('"+t+"')/localeResource";return this.sendRequest({requestUri:n,method:"POST",data:e,qosEventName:"LocaleItem.Copy"})},r.getSuspiciousEvidence=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/GetSuspiciousEvidence";return this.sendRequest({requestUri:e,method:"GET",qosEventName:"SuspiciousEvidence.Get"})},r.notifyAdminForApproval=function(t){var e=this.getSurveyWebOwnerServiceUrl()+"forms('"+t+"')/NotifyAdminForApproval";return this.sendRequest({requestUri:e,method:"POST",qosEventName:"Function.NotifyAdminForApproval"})},r.Jb=function(t,e,n){var i=this;return Promise.resolve(n||this.getToken()).then((function(n){return t.headers=$.extend(!0,t.headers,i.getCommonHeaders(n)),Object(Gt.a)(t,e).then((function(t){return Object(Qt.c)(t)}),Qt.b)}))},r.Zb=function(t){return this.em()+"formapi/DownloadExcelFile.ashx?"+$.param(t)},r.em=function(){return this.serviceUrl.slice(0,-12)},r.Yb=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/forms('"+t+"')"},r.tm=function(t){return this.getSurveyWebOwnerServiceUrl()+"admin/RestrictedUsers/"+t},i}(t)}var $t=function(){function t(){}return t.prototype.getMixinFormApi=function(){return t.FormApiClass||(t.FormApiClass=Ut(zt)),t.FormApiClass},t}(),Wt=n(6),Kt=n(4),Jt={Action:Kt.a.reference(),AllFormList:Kt.a.collectionOf(Kt.a.reference()),AllFormListLoadState:Kt.a.reference(),AllSharedFormList:Kt.a.collectionOf(Kt.a.reference()),Analysis:Kt.a.boolean(),BranchingElementId:Kt.a.string(),CdsInfoAvailableInUrl:Kt.a.boolean(),CdsList:Kt.a.reference(),CdsValidationMap:Kt.a.reference(),CopyFormId:Kt.a.string(),CriticalError:Kt.a.reference(),CollapseIntelligenceSuggestionCard:Kt.a.boolean(),CurrentProject:Kt.a.reference(),CustomerVoiceDefaultEmailTemplates:Kt.a.reference(),CustomerVoiceDefaultETsLoadState:Kt.a.reference(),CustomerVoiceEmailTemplates:Kt.a.reference(),CustomerVoiceView:Kt.a.reference(),AllProjects:Kt.a.reference(),AlertRules:Kt.a.reference(),SMList:Kt.a.reference(),FilterObj:Kt.a.reference(),DataIdeas:Kt.a.boolean(),DefaultCdsId:Kt.a.string(),DefaultCdsInfoLoadState:Kt.a.reference(),DefaultCdsUrl:Kt.a.string(),DelegateInactiveUser:Kt.a.reference(),EnvironmentListLoadState:Kt.a.reference(),ErrorBarMessage:Kt.a.string(),ExecuteDownloadExcel:Kt.a.boolean(),ExperienceType:Kt.a.reference(),FlexPane:Kt.a.reference(),ForceDesktopView:Kt.a.boolean(),FormCollectionType:Kt.a.reference(),FormId:Kt.a.string(),FormList:Kt.a.collectionOf(Kt.a.reference()),FormListLoadState:Kt.a.reference(),FormMaster:Kt.a.reference(),FormsProBranchingData:Kt.a.string(),FormsProToken:Kt.a.string(),FormsTenantSettings:Kt.a.reference(),Grading:Kt.a.reference(),GroupMaster:Kt.a.reference(),GroupMruFormListLoadState:Kt.a.reference(),Host:Kt.a.string(),InfoBarMessageType:Kt.a.string(),IntelligeceQuestionSuggestionStatus:Kt.a.reference(),IntelligenceSuggestionStatus:Kt.a.reference(),IsDefaultCds:Kt.a.boolean(),LastActiveTime:Kt.a.number(),LastUsedEnv:Kt.a.reference(),Locale:Kt.a.string(),MeetingInfo:Kt.a.reference(),pendingCalls:Kt.a.reference(),PlaceholderList:Kt.a.collectionOf(Kt.a.reference()),Preview:Kt.a.reference(),PreviousFlexPane:Kt.a.reference(),RecycleBin:Kt.a.collectionOf(Kt.a.reference()),RelativeScrolHeight:Kt.a.number(),Scenario:Kt.a.string(),SearchContent:Kt.a.string(),SectionElementId:Kt.a.string(),SelectedCdsId:Kt.a.string(),SelectedCdsRegion:Kt.a.string(),SelectedCdsUrl:Kt.a.string(),SelectedPortalForm:Kt.a.reference(),SenderList:Kt.a.reference(),SharedWithMeFormList:Kt.a.collectionOf(Kt.a.reference()),SharedWithMeFormListLoadState:Kt.a.reference(),SharingToken:Kt.a.string(),ShouldDisableAllClick:Kt.a.boolean(),ShowBlockUsingFormsWarningPage:Kt.a.boolean(),ShowExcelSurveyIntroductionDialog:Kt.a.boolean(),ShowGroupListInPortal:Kt.a.boolean(),ShowShimmer:Kt.a.boolean(),ShowXLUnsyncedDialog:Kt.a.boolean(),Store:Kt.a.boolean(),TenantCountryCode:Kt.a.string(),Title:Kt.a.string(),Token:Kt.a.string(),TopView:Kt.a.reference(),UserActivities:Kt.a.reference(),ValidationChecked:Kt.a.reference(),XlWorkbookId:Kt.a.string(),SurveyReportId:Kt.a.string(),ResponseList:Kt.a.reference(),LastPageIndex:Kt.a.number(),Designer:Kt.a.boolean(),DesignerCalloutType:Kt.a.reference(),SidePaneVisible:Kt.a.boolean(),NavPanelOpen:Kt.a.boolean(),CurrentAlert:Kt.a.reference(),CurrentAlertlist:Kt.a.reference()},Xt=function(t){function e(){var e=t.call(this)||this;return e.nm=e.nm.bind(e),e.bulkEdit((function(){var t=e.Model;t.Analysis=!1,t.BranchingElementId=null,t.CollapseIntelligenceSuggestionCard=!1,t.IntelligenceSuggestionStatus={QuestionSuggestion:"Default",ThemeSuggestion:"Default",EstimatedTime:"Default"},t.DataIdeas=!1,t.IntelligeceQuestionSuggestionStatus="Default",t.Store=!1,t.Grading=null,t.FormListLoadState="NotStarted",t.SharedWithMeFormListLoadState="NotStarted",t.GroupMruFormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.MeetingInfo=null,t.SectionElementId=null,e.Model.LastActiveTime=Date.now(),t.CopyFormId=null,t.SharingToken=null,t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),Object(Y.c)("RtcRefactor")&&e.im(),e}Object(S.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.im=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(e){return document.addEventListener(e,t.nm,!0)}))},n.nm=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},e}(Wt.a.createObjectMasterClass("DesignPageUxState",Jt)),Zt=n(13),Yt=n(51),te=n(17),ee=n(22),ne=n(45),ie={Action:Kt.a.reference(),Analysis:Kt.a.boolean(),BottomView:Kt.a.reference(),DesignerView:Kt.a.reference(),CopyFormId:Kt.a.string(),CriticalError:Kt.a.reference(),ErrorBarMessage:Kt.a.string(),FormCollectionType:Kt.a.reference(),FormId:Kt.a.string(),FormList:Kt.a.collectionOf(Kt.a.reference()),FormListLoadState:Kt.a.reference(),FormMaster:Kt.a.reference(),FormsTenantSettings:Kt.a.reference(),InfoBarMessageType:Kt.a.string(),LastActiveTime:Kt.a.number(),Locale:Kt.a.string(),QuestionId:Kt.a.string(),QuestionInDesign:Kt.a.reference(),SelectedPortalForm:Kt.a.reference(),SharingToken:Kt.a.string(),ShouldDisableAllClick:Kt.a.boolean(),ShowHeadBar:Kt.a.boolean(),ShowSavingSpinner:Kt.a.boolean({IsLocalField:!0}),SurveyResults:Kt.a.boolean(),Title:Kt.a.string(),Token:Kt.a.string()},re=function(t){function e(){var e=t.call(this)||this;return e.nm=e.nm.bind(e),e.bulkEdit((function(t){t.Action="None",t.BottomView="None",t.DesignerView="None",t.FormListLoadState="NotStarted",t.FormCollectionType="OwnedForms",t.QuestionId=null,t.ShowHeadBar=!0,t.ShowSavingSpinner=!1,e.Model.LastActiveTime=Date.now(),t.FormsTenantSettings={bingImageSearch:!1,externalCollaboration:!0,externalSendForm:!0,externalShareCollaboration:!0,externalShareResult:!0,externalShareTemplate:!0,InOrgSurveyIncentive:!0,recordIdentityByDefault:!0}})),e.addRule({InterestedFields:[e.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){e.Model.FormMaster||e.rm()}}),e.addRule({InterestedFields:[e.Schema.QuestionInDesign],Name:"DesignQuestion",onChange:function(t){e.Model.QuestionInDesign?e.Model.QuestionId=e.Model.QuestionInDesign.Model.Id:e.Model.QuestionId=null}}),Object(Y.c)("RtcRefactor")&&e.im(),e}Object(S.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.rm=function(){var t=this;Object(Y.c)("MobileBackBugFix")?this.bulkEdit((function(){var e=t.Model;e.FormMaster=void 0,e.Analysis=!1,e.BottomView="None",e.DesignerView="None",e.QuestionId=null,e.ShowHeadBar=!0,e.SurveyResults=!1})):this.bulkEdit((function(){var e=t.Model;e.FormMaster=void 0,e.Analysis=!1,e.QuestionId=null,e.ShowHeadBar=!0,e.SurveyResults=!1}))},n.im=function(){var t=this;["mousedown","keydown","touchstart"].forEach((function(e){return document.addEventListener(e,t.nm,!0)}))},n.nm=function(){var t=Date.now();this.Model.LastActiveTime<t-1e3&&(this.Model.LastActiveTime=Date.now())},e}(Wt.a.createObjectMasterClass("MobileDesignPageUxState",ie)),oe=n(0),se=n.n(oe),ae=n(1),ce=n(87),ue=n(8),le=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t={ButtonsProps:[{ClassName:"upload-question-cancel-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.props.clickContinueButton,Text:Object(ae.a)().UploadFile_Dialog_Continue_Button,Title:Object(ae.a)().UploadFile_Dialog_Continue_Text}],ClassName:"upload-question-button-container",Description:this.props.description,IconClassName:"forms-icon-size36x36 upload-question-icon-class",IconName:"FabricFolder",ShowDialog:!0};return oe.createElement("div",{className:"upload-question-confirm-dialog"},Object(ce.b)(t))},e}(ue.a);function he(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this;return i.initializing?i.initializing.resolve():Object(g.b)("ResponsePage.FormMasterMixin.initializing.undefined",{formMasterAttrs:Object.keys(i),isBasicLoaded:!(!window.$||!window._)}),i}return Object(S.__extends)(e,t),e}(t)}var fe=n(190);var de,be=n(30),me=n(108);function ve(){return de||(de=new Oe)}var ge,Oe=function(){function t(){this.om=new me.a.CallbackManager,this.sm={}}var e=t.prototype;return t.isValidUser=function(t){return!!(t&&t.userId&&t.displayName)},e.registerUsersStateChange=function(t){this.om.register(t)},e.unregisterUsersStateChange=function(t){this.om.unregister(t)},e.getUser=function(t){return Et.clone(this.sm[t])},e.getAllUsers=function(){return Et.values(Object(et.d)(this.sm))},e.getUserCount=function(){return Et.keys(this.sm).length},e.addOrUpdateUser=function(e){if(t.isValidUser(e)){var n=this.sm[e.userId];if(null!=n){if(t.isValidUser(n))return;Et.extend(n,e)}else this.sm[e.userId]=e;this.om.trigger()}},e.removeUser=function(t){delete this.sm[t.userId]&&this.om.trigger()},e.removeAllUsers=function(){this.getUserCount()>0&&(this.sm={},this.om.trigger())},t}(),pe=n(44),je=n(99),ye=n(52),we=n(29),Se=function(){function t(){this.am={}}var e=t.prototype;return t.createNotificationProvider=function(e,n,i){return this.notificationProvider||(this.notificationProvider=new t),this.notificationProvider},e.close=function(t){this.am[t]&&(this.am[t].close(),delete this.am[t])},e.open=function(t,e){if(!t)return Promise.reject("PushNotification has no formId.");this.close(t);var n=Object(Vt.a)(t);return this.cm(t,e,n)},e.cm=function(t,e,n,i){return this.am[t]=new Ne(we.a.getInstance().getCollabDBServiceUrl(),n.OrgId,n.OwnerId,n.TableId,n.IsGroupOwner,i),this.am[t].open(e)},t}(),Ne=function(){function t(t,e,n,i,r,o){this.um=Object(ye.c)(),this.lm=!0,this.hm=null,this.fm=0,this.dm=Ie.MaxRetryCount;var s=t.trimEnd("/");o&&(s=Ie.ComposedCDBRealtimeSliceFormat.format(o,s)),this.bm=!1;var a=Object(Tt.c)("RealtimeAzureConnectionPercentage",0);if(a>=0&&a<=100){var c=this.vm(n+i);this.bm=Math.abs(c)%100<a}this.bm?this.gm=(r?Ie.CDBRealtimeAzureUrlForGroupsFormat:Ie.CDBRealtimeAzureUrlForUsersFormat).format(s,e,n,i):this.gm=(r?Ie.CDBRealtimeUrlForGroupsFormat:Ie.CDBRealtimeUrlForUsersFormat).format(s,e,n,i)}var e=t.prototype;return e.close=function(){var t=this;this.lm=!0;var e=function(){4!==t.hm.state&&t.Om(Ie.UserHubName,Ie.Leave).finally((function(){t.hm.stop(!0,!0)}))};null!=this.hm&&(0===this.hm.state||2===this.hm.state?this.hm.stateChanged(e):e())},e.open=function(t){var e,n=this;return this.pm(this.gm),(t=Et.clone(t)).onFormUpdated&&this.jm(Ie.TableDefinitionHubName,Ie.TableUpdated,(function(e,n){t.onFormUpdated(Ce.toFormUpdatePayload(n),Ce.toUserPayload(n._modifiedBy))})),t.onFormElementAdded&&this.jm(Ie.TableDefinitionHubName,Ie.ColumnAdded,(function(e,n){"Comments"!==e.propertyName&&"ReleaseDate"!==e.propertyName&&"FormsProData"!==e.propertyName&&t.onFormElementAdded(Ce.toFormElementPayload(n),Ce.toUserPayload(n._modifiedBy))})),t.onFormElementDeleted&&this.jm(Ie.TableDefinitionHubName,Ie.ColumnDeleted,(function(e,n){t.onFormElementDeleted(e.propertyName,Ce.toUserPayload(n._modifiedBy))})),t.onFormElementUpdated&&this.jm(Ie.TableDefinitionHubName,Ie.ColumnUpdated,(function(e,n){t.onFormElementUpdated(e.propertyName,Ce.toFormElementUpdatePayload(n),Ce.toUserPayload(n._modifiedBy))})),t.onChoiceAdded&&this.jm(Ie.TableDefinitionHubName,Ie.ChoiceAdded,(function(e,n){t.onChoiceAdded(e.propertyName,Ce.toChoicePayload(e,n),Ce.toUserPayload(n._modifiedBy))})),t.onChoiceDeleted&&this.jm(Ie.TableDefinitionHubName,Ie.ChoiceDeleted,(function(e,n){t.onChoiceDeleted(e.propertyName,e.choiceId,Ce.toUserPayload(n._modifiedBy))})),t.onChoiceUpdated&&this.jm(Ie.TableDefinitionHubName,Ie.ChoiceUpdated,(function(e,n){t.onChoiceUpdated(e.propertyName,e.choiceId,Ce.toChoicePayload(e,n),Ce.toUserPayload(n._modifiedBy))})),t.onResponseAdded&&this.jm(Ie.TableDataHubName,Ie.RowAdded,(function(e,n){t.onResponseAdded(Ce.toResponsePayload(n))})),t.onResponseDeleted&&this.jm(Ie.TableDataHubName,Ie.RowDeleted,(function(e,n){t.onResponseDeleted(Number(e._id),{modifiedBy:Ce.toUserPayload(n._modifiedBy),modifiedDateTime:new Date(n._modifiedBy.ModifiedDateTime)})})),t.onResponsesAllDeleted&&this.jm(Ie.TableDataHubName,Ie.RowsAllDeleted,(function(e,n){t.onResponsesAllDeleted({modifiedBy:Ce.toUserPayload(n._modifiedBy),modifiedDateTime:new Date(n._modifiedBy.ModifiedDateTime)})})),t.onResponseUpdated&&this.jm(Ie.TableDataHubName,Ie.RowUpdated,(function(e,n){t.onResponseUpdated(Number(e._id),Ce.toResponseUpdatePayload(n))})),t.onCommentAdded&&this.jm(Ie.TableDataHubName,Ie.RelatedRecordAdded,(function(e,n,i){Ce.isCommentPayload(e)&&t.onCommentAdded(Number(e.rowId),Ce.toCommentPayload(i),{modifiedBy:Ce.toUserPayload(n.modifiedBy),modifiedDateTime:new Date(n.modifiedDateTime)})})),t.onCommentDeleted&&this.jm(Ie.TableDataHubName,Ie.RelatedRecordDeleted,(function(e,n,i){Ce.isCommentPayload(e)&&t.onCommentDeleted(Number(e.rowId),Number(e.id),{modifiedBy:Ce.toUserPayload(n.modifiedBy),modifiedDateTime:new Date(n.modifiedDateTime)})})),t.onLocaleResourceAdded&&this.jm(Ie.TableDefinitionHubName,Ie.LocaleResourceAdded,(function(e,i){if(i){var r=i.localeResources;r.forEach((function(t){t.elementKey=n.ym(t.elementKey)})),t.onLocaleResourceAdded(r,Ce.toUserPayload(i._modifiedBy))}})),t.onLocaleResourceUpdated&&this.jm(Ie.TableDefinitionHubName,Ie.LocaleResourceUpdated,(function(e,i){if(i){var r=Et.clone(i);delete r._modifiedBy,r.elementKey=n.ym(r.elementKey),t.onLocaleResourceUpdated(r,Ce.toUserPayload(i._modifiedBy))}})),t.onLocaleResourceDeleted&&this.jm(Ie.TableDefinitionHubName,Ie.LocaleResourceDeleted,(function(e,n){n&&t.onLocaleResourceDeleted(n,Ce.toUserPayload(n._modifiedBy))})),t.onUserConnected&&this.jm(Ie.UserHubName,Ie.UserConnected,(function(e,n){t.onUserConnected(Ce.toUserPayload(e))})),t.onUserDisconnected&&this.jm(Ie.UserHubName,Ie.UserDisconnected,(function(e,n){t.onUserDisconnected(Ce.toUserPayload(e))})),this.hm.starting((function(){Object(g.b)("DataProvider.RealtimeClient.Connection.Starting",{clientId:n.getClientId(),connectionId:n.hm.id,host:Object(f.b)(n.gm),azureSignalr:n.bm})})),this.hm.connectionSlow((function(){Object(g.b)("DataProvider.RealtimeClient.Connection.Slow",{clientId:n.getClientId(),connectionId:n.hm.id,host:Object(f.b)(n.gm),azureSignalr:n.bm}),t.onConnectionSlow&&t.onConnectionSlow()})),this.hm.error((function(i){Object(g.b)("DataProvider.RealtimeClient.Connection.Error",{clientId:n.getClientId(),connectionId:n.hm.id,host:Object(f.b)(n.gm),azureSignalr:n.bm,error:i}),e={errorObject:i},t.onConnectionError&&t.onConnectionError(i)})),this.hm.reconnecting((function(){Object(g.b)("DataProvider.RealtimeClient.Connection.Reconnecting",{clientId:n.getClientId(),connectionId:n.hm.id,host:Object(f.b)(n.gm),azureSignalr:n.bm}),t.onConnectionReconnecting&&t.onConnectionReconnecting()})),this.hm.reconnected((function(){Object(g.b)("DataProvider.RealtimeClient.Connection.Reconnected",{clientId:n.getClientId(),connectionId:n.hm.id,host:Object(f.b)(n.gm),azureSignalr:n.bm}),t.onConnectionReconnected&&t.onConnectionReconnected(void 0)})),this.hm.disconnected((function(){if(Object(g.b)("DataProvider.RealtimeClient.Connection.Disconnected",{clientId:n.getClientId(),connectionId:n.hm.id,remainingRetryCount:n.dm,host:Object(f.b)(n.gm),azureSignalr:n.bm,lastError:e&&e.errorObject}),n.dm-- >0){n.fm++;var i={reconnectingCount:n.fm,refreshToken:e&&e.errorObject&&e.errorObject.context&&401===e.errorObject.context.status,retryCount:Ie.MaxRetryCount-n.dm,onSuccess:t.onConnectionReconnected,onError:t.onConnectionFailed};n.wm(i).then((function(){e=void 0})).catch((function(){}))}else Object(g.b)("DataProvider.RealtimeClient.Connection.Failed",{clientId:n.getClientId(),connectionId:n.hm.id,lastError:e&&e.errorObject,host:Object(f.b)(n.gm),azureSignalr:n.bm}),t.onConnectionDisconnected&&t.onConnectionDisconnected()})),Object(je.b)()&&(this.hm.logging=!0,this.hm.received((function(t){var e=new Date;console.log("[%s] %s: Received message: {%s}",e.toTimeString(),n.um,JSON.stringify(t))}))),this.lm=!1,this.wm({onSuccess:t.onConnectionStarted,onError:t.onConnectionFailed})},e.getClientId=function(){return this.um},e.vm=function(t){return t.split("").reduce((function(t,e){return(t<<5)-t+e.charCodeAt(0)|0}),0)},e.ym=function(t){switch(t){case"thankyoumessage":return"thankYouMessage";case"formclosemessage":return"formCloseMessage";case"leftdescription":return"leftDescription";case"rightdescription":return"rightDescription";case"formsprortlocaleldescription":return"formsprortlocaleldescription";case"formsprortlocalerdescription":return"formsprortlocalerdescription";case"footertext":return"footerText";default:return t}},e.pm=function(t){this.hm=$.hubConnection(t,{useDefaultPath:!1}),this.hm.createHubProxy(Ie.TableDefinitionHubName),this.hm.createHubProxy(Ie.TableDataHubName),this.hm.createHubProxy(Ie.UserHubName)},e.Sm=function(t){if(null==this.hm)throw Error("Realtime connection has not been created yet.");var e=this.hm.proxies[t.toLocaleLowerCase()];if(null==e)throw Error("Cannot find hub proxy {0}".format(t));return e},e.Nm=function(t){var e=this;return we.a.getInstance().createDataProvider().getCdbToken().then((function(t){e.hm.qs={Authorization:t}}))},e.Om=function(t,e){for(var n,i=this,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(this.Im()){var s=new tt.a("Connection.InvokeRemoteMethod");return s.start(),Object(pe.f)((n=this.Sm(t)).invoke.apply(n,Object(S.__spreadArrays)([e],r))).then((function(t){return s.end({resultType:"Success",extraData:{clientId:i.getClientId(),connectionId:i.hm.id,host:Object(f.b)(i.gm),azureSignalr:i.bm,methodName:e}}),t}),(function(t){return s.end({resultType:i.Im()?"Failure":"ExpectedFailure",extraData:{clientId:i.getClientId(),connectionId:i.hm.id,host:Object(f.b)(i.gm),azureSignalr:i.bm,methodName:e,error:JSON.stringify(t,["message","description","source","context","data"])}}),t}))}return Promise.reject("Realtime connection has not been established yet.")},e.Im=function(){return null!=this.hm&&1===this.hm.state},e.jm=function(t,e,n){n&&this.Sm(t).on(e,n)},e.wm=function(t){var e=this;if(this.lm)return Promise.reject("Connection disposed");var n=new Promise((function(n,i){var r=new tt.a("Connection.ConnectToCDBSignalR"),o=function(){r.end({resultType:"Success",extraData:{clientId:e.getClientId(),connectionId:e.hm.id,host:Object(f.b)(e.gm),azureSignalr:e.bm,reconnectingCount:t.reconnectingCount,retryCount:t.retryCount}}),e.dm=Ie.MaxRetryCount,e.Om(Ie.UserHubName,Ie.Join),e.Om(Ie.UserHubName,Ie.GetActiveUsers).then((function(t){n(t)}),(function(t){i(t)}))},s=function(n){r.end({resultType:"Failure",extraData:{clientId:e.getClientId(),connectionId:e.hm.id,host:Object(f.b)(e.gm),azureSignalr:e.bm,reconnectingCount:t.reconnectingCount,retryCount:t.retryCount,connectionError:n.source?JSON.stringify(n,["message","description","source","context","transport"]):void 0,serviceError:n.source?void 0:JSON.stringify(n,["message","statusCode","statusText","innerCode"])}}),i(n)};r.start(),e.Nm(t.refreshToken).then((function(){return e.hm.start().then(o,s)}),(function(t){s(t),Object(g.b)("DataProvider.RealtimeClient.Connection.Failed",{clientId:e.getClientId(),connectionId:e.hm.id,host:Object(f.b)(e.gm),azureSignalr:e.bm,lastError:JSON.stringify(t)})}))}));return t.onSuccess&&n.then((function(e){return t.onSuccess(e)})),t.onError&&n.catch((function(e){return t.onError(e)})),n},t}(),Ie=function(){function t(){}return t.TableDefinitionHubName="TableDefinitionChangeHub",t.TableDataHubName="TableChangeHub",t.UserHubName="TableActivityHub",t.TableUpdated="tableDefinitionUpdated",t.ColumnAdded="columnDefinitionAdded",t.ColumnDeleted="columnDefinitionDeleted",t.ColumnUpdated="columnDefinitionUpdated",t.ChoiceAdded="choiceAdded",t.ChoiceUpdated="choiceUpdated",t.ChoiceDeleted="choiceDeleted",t.RowAdded="rowAdded",t.RowDeleted="rowDeleted",t.RowsAllDeleted="rowsAllDeleted",t.RowUpdated="rowUpdated",t.RelatedRecordAdded="relatedRecordAdded",t.RelatedRecordDeleted="relatedRecordDeleted",t.LocaleResourceAdded="localeResourceAdded",t.LocaleResourceUpdated="localeResourceUpdated",t.LocaleResourceDeleted="localeResourceDeleted",t.UserConnected="userConnected",t.UserDisconnected="userDisconnected",t.GetActiveUsers="GetActiveUsers",t.Join="Join",t.Leave="Leave",t.MaxRetryCount=3,t.ComposedCDBRealtimeSliceFormat="{0}.{1}:797",t.ComposedCDBRealtimeAzureSliceFormat="{0}.{1}:779",t.CDBRealtimeUrlForUsersFormat="https://{0}/realtime/beta/{1}/users/{2}/tables/{3}/$notifications",t.CDBRealtimeUrlForGroupsFormat="https://{0}/realtime/beta/{1}/groups/{2}/tables/{3}/$notifications",t.CDBRealtimeAzureUrlForUsersFormat="https://{0}/realtimeazure/beta/{1}/users/{2}/tables/{3}/$azurenotifications",t.CDBRealtimeAzureUrlForGroupsFormat="https://{0}/realtimeazure/beta/{1}/groups/{2}/tables/{3}/$azurenotifications",t}(),Ce=function(){function t(){}t.prototype;return t.toFormUpdatePayload=function(e){return e&&t.normalize({id:void 0,tableId:e.id,title:e.displayName,createdBy:e.createBy,modifiedDate:e.dateTimeLastUpdated,description:e.description,settings:e.formSettings,otherInfo:e.otherInfo,questions:void 0,header:t.toImagePayload(e.header),logo:t.toImagePayload(e.logo),background:t.toImagePayload(e.background),thankYouMessage:e.thankYouMessage,version:e.version,xlWorkbookId:e.xlWorkbookId,xlExportingTag:e.xlExportingTag,xlFileUnSynced:e.xlFileUnSynced,xlUnsyncedReason:e.xlUnsyncedReason,permissionTokens:t.toPermissionTokenPayload(e.permissionTokens),onlineSafetyLevel:e.onlineSafetyLevel,reputationTier:t.toReputationTier(e.onlineSafetyLevel)})},t.toFormElementPayload=function(e){return e&&{id:e.propertyName,title:e.description||e.title||e.displayName,defaultValue:e.defaultValue,subtitle:e.subtitle,required:e.required,type:e.questionType,questionInfo:e.questionInfo,order:e.order,version:void 0,modifiedDate:e.questionModifiedDate,status:e.status,image:t.toImagePayload(e.image),isQuiz:e.isQuiz,titleHasPhishingKeywords:e.titleHasPhishingKeywords,subtitleHasPhishingKeywords:e.subtitleHasPhishingKeywords,formsProRTQuestionTitle:e.formsProRTQuestionTitle,formsProRTSubtitle:e.formsProRTSubtitle,choices:e.choices,groupId:e.columnGroupName,fileUploadSPOInfo:e.fileUploadSPOInfo&&JSON.parse(e.fileUploadSPOInfo),questionTagForIntelligence:e.questionTagForIntelligence,insightsInfo:e.insightsInfo,isFromSuggestion:e.isFromSuggestion}},t.toChoicePayload=function(e,n){return n&&t.normalize({id:e.choiceId,customProperties:n.customProperties,description:n.description,displayText:n.displayText,formsProDisplayRTText:n.formsProDisplayRTText,key:n.key,order:n.order})},t.toFormElementUpdatePayload=function(e){return t.normalize(t.toFormElementPayload(e))},t.toUserPayload=function(t){return{userId:t.Id||t.userId,displayName:t.DisplayName||t.displayName,firstName:t.FirstName||t.firstName,lastName:t.LastName||t.lastName,email:t.Email||t.email}},t.toImagePayload=function(t){return t?null==t.ResourceId||null!=t.ResourceUrl?{altText:t.AltText,contentType:t.ContentType,fileIdentifier:t.FileIdentifier,originalFileName:t.OriginalFileName,resourceId:t.ResourceId,resourceUrl:t.ResourceUrl}:void Object(g.c)("InvalidCdbImagePayload"):t},t.toPermissionTokenPayload=function(t){return t?JSON.parse(t).map((function(t){return{principalId:t.PrincipalId,name:t.Name,type:t.Type}})):t},t.toResponsePayload=function(e){return null==e?e:{id:null==e._id?void 0:Number(e._id),startDate:e.StartDate,submitDate:e.SubmitDate,responder:e.Responder,responderName:e.ResponderName,answers:t.toAnswers(e),quizResult:void 0,releaseDate:e.ReleaseDate}},t.toAnswers=function(t){var e=Et.difference(Object.keys(t).filter((function(t){return"_"!==t[0]})),["SubmitDate","ResponderName","Responder","StartDate","Comments_comments","Comments","ReleaseDate"]);return JSON.stringify(e.map((function(e){return{questionId:e,answer1:t[e]}})))},t.toResponseUpdatePayload=function(e){var n=t.normalize(t.toResponsePayload(e));return delete n.answers,n},t.isCommentPayload=function(t){return t&&"Comments_comments"===t.propertyName},t.toCommentPayload=function(e){return e&&{id:e.id,feedback:e.text,score:e.number,questionId:e.columnReference,createdDateTime:e.createdDateTime,createdBy:t.toUserPayload(e.createdBy)}},t.toReputationTier=function(t){return 0===t?1:80&t?4:8&t?0:2&t||16&t?3:128&t?2:1},t.normalize=function(t){var e=t;for(var n in e)void 0===e[n]&&delete e[n];return e},t}(),ke=n(58);!function(t){t[t.ConnectionStateChanged=0]="ConnectionStateChanged",t[t.UserAction=1]="UserAction",t[t.UserConnect=2]="UserConnect",t[t.UserDisconnect=3]="UserDisconnect"}(ge||(ge={}));var Te=n(95),xe=n(143),Fe=n(80);var Pe=n(19),De=n(176),Me=n(31),Le=n(134),Ae=n(188),Re=n(70),Ee=n(164);var Be,_e=n(169),He=n(88),Ge=n(63),qe=n(73);!function(t){t[t.None=0]="None",t[t.MoveInProgress=1]="MoveInProgress",t[t.CvsScanAllowed=2]="CvsScanAllowed"}(Be||(Be={}));var Qe=n(151),Ve=n(166),ze=n(182);var Ue=n(149);var $e=n(83),We=n(203);function Ke(){var t=Zt.a;return t=he(t=function(t){return function(t){function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=t.apply(this,n)||this;return r.Cm(),r.Xa(),r.Model.YouTubeMessageBarState=null,e.DesignOnlyRules.forEach((function(t){return r.addRule(t)})),Object(ne.d)(r,Zt.a.Schema.Logo,Zt.a.Schema.LogoInfo),r}Object(S.__extends)(e,t);var n=e.prototype;return n.isCurrentUserFormOwnerOrGroupMember=function(){return this.km},n.ensureReadyToDesign=function(){var t=this;return this.ensureFieldsReady(Object(Te.c)()).then((function(e){return null==t.km&&t.Tm(),e}))},n.ensureReadyToAdminPhishingReview=function(){var t=Object(Te.d)();return t.push(this.Schema.CreatedBy),this.ensureFieldsReady(t)},n.reachedQuestionNumberLimitation=function(){return Object(Ht.a)().Flighting.isEnabled_Deprecated("Question200Limit")?this.formElementManager.QuestionMasters.filter((function(t){return"Question.MatrixChoiceGroup"!=t.Model.Type})).length>=Object(Pe.F)():this.FormElementManager.QuestionMasters.length>=Object(Pe.F)()},n.searchResponseById=function(t){var e=this,n={name:"id",operator:"eq",value:t};return this.Synchronizer.existingInDataSource().then((function(){return Object(Le.d)(e,1,0,n)})).then((function(t){return t&&t[0]}))},n.syncFormResponses=function(){var t=this;return this.responsesQueryJob&&this.responsesQueryJob.states()===pe.b.Pending||(this.responsesQueryJob=new pe.c(this.Synchronizer.existingInDataSource().then((function(){var e=[Zt.a.Schema.Questions];e.push(Zt.a.Schema.Settings);var n=t.ensureFieldsReady(e);return Promise.all([Object(Le.d)(t),n]).then((function(e){var n=e[0];e[1];t.updatingResponsesFromServer=!0,t.bulkEdit((function(){t.Model.Responses=t.normalizeResponses(n),t.Synchronizer.onSourceDataReceived({rowCount:n.length})})),t.updatingResponsesFromServer=!1}))})))),this.responsesQueryJob.promise()},n.syncFormResponsesByPaging=function(t,e){var n=this;return this.getFormResponsesByPaging(t,e).then((function(t){n.updatingResponsesFromServer=!0,n.Model.BufferResponses=t,n.updatingResponsesFromServer=!1}))},n.getFormResponsesByPaging=function(t,e){var n=this,i=[Zt.a.Schema.Questions];i.push(Zt.a.Schema.Settings);var r=this.ensureFieldsReady(i),o=this.Synchronizer.existingInDataSource().then((function(){return Object(Le.d)(n,t,e)}));return Promise.all([o,r]).then((function(t){var e=t[0];t[1];return n.normalizeResponses(e)}))},n.getFormResponsesCountByAPICall=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return Object(Me.j)(t)})).then((function(e){t.Model.ResponsesCount=e}))},n.deleteAllResponses=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){return Object(Le.a)(t)})).then((function(){var e={Responses:[],ResponsesCount:0};t.updatingResponsesFromServer=!0,t.setData(e),t.updatingResponsesFromServer=!1}))},n.deleteBufferResponse=function(t){var e=this;return this.Synchronizer.existingInDataSource().then((function(){return Object(Le.b)(e.Model.Id,[t])})).then((function(){var n=Wt.a.getCollectionMasterFromModel(e.Model.BufferResponses),i=n.getItemWithKeyFields({Id:t});i&&e.bulkEdit((function(){n.itemsDeletedInSource([i]),--e.Model.ResponsesCount}))}))},n.resetBranchInfo=function(){this.FormElementManager.AllElementMasters.forEach((function(t){return t.resetBranchInfo()}))},n.formOwnedByMe=function(){return this.Model.OwnerId&&this.Model.OwnerId===Object(u.a)().userInfo.UserId},n.fileUploadAnonymousDisabled=function(){return!Object(Y.c)("EnableAnonymousUploadLink")&&!!Et.find(this.Model.Questions,(function(t){return"Question.FileUpload"===t.Type}))},n.Xa=function(){var t=this;Object(Re.b)(this),this.xm="Idle",this.Fm="Idle",this.Pm="Idle",this.fieldsReady([Zt.a.Schema.Questions]).then((function(){var e=Wt.a.getCollectionMasterFromModel(t.Model.Questions);Object(Re.c)(e,e.Schema[0].IntegratedSavingState,(function(e){t.xm=e,t.updateIntegratedSavingState()}))})),this.fieldsReady([Zt.a.Schema.DescriptiveElements]).then((function(){var e=Wt.a.getCollectionMasterFromModel(t.Model.DescriptiveElements);Object(Re.c)(e,e.Schema[0].IntegratedSavingState,(function(e){t.Pm=e,t.updateIntegratedSavingState()}))}));var e=Wt.a.getCollectionMasterFromModel(this.Model.ResponseModels);Object(Re.c)(e,e.Schema[0].IntegratedSavingState,(function(e){t.Fm=e,t.updateIntegratedSavingState()})),this.updateIntegratedSavingState()},n.updateIntegratedSavingState=function(){var t=this;if(this.syncBlocker.states()===pe.b.Pending)return this.Model.IntegratedSavingState="NotStarted",void this.syncBlocker.promise().then((function(){return t.updateIntegratedSavingState()}));var e=[this.Model.SavingState,this.xm,this.Fm],n=Zt.a.Schema;this.isFieldReady(n.DescriptiveElements)&&e.push(this.Pm),this.isFieldReady(n.Logo)&&e.push(this.Model.Logo.SavingState),this.isFieldReady(n.Background)&&e.push(this.Model.Background.SavingState),this.Model.IntegratedSavingState=Object(Re.a)(e)},Object.defineProperty(e,"DesignOnlyRules",{get:function(){if(!e.designOnlyRules){var t=Zt.a.Schema,n=Wt.a.getSubFieldSchemas(t).filter((function(t){return!Wt.a.getFieldSchemaInfo(t).Attributes.IsLocalField}));e.designOnlyRules=[{Name:"IntegrateSavingState",InterestedFields:[t.Background.SavingState,t.Logo.SavingState,t.SavingState],onChange:function(t){return t.Master.updateIntegratedSavingState()}},{Name:"Modified",InterestedFields:Et.without(n,t.SoftDeleted),onChange:function(e){if(!e.BeingDeleted&&!Et.contains(e.FieldSchemas,t.Modified)){var i=e.Master;if(Et.contains(e.FieldSchemas,t.ModifiedDate))i.Model.Modified=i.Model.ModifiedDate;else if(i.isFieldReady(t.Modified))Et.intersection(e.FieldSchemas,n).map(Wt.a.getFieldSchemaInfo).map((function(t){return t.Name})).some((function(t){return t in e.OldValues}))&&(i.Model.Modified=(new Date).toISOString())}}},{Name:"RowCount",InterestedFields:[t.RowCount],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model;e.ResponsesCount=e.RowCount}}},{Name:"SerializeSettings",InterestedFields:[Zt.a.Schema.Settings],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model;e.SerializedSettings=Ae.a.serialize(e.Settings)}}},{Name:"SerializePredefinedResponses",InterestedFields:[Zt.a.Schema.PredefinedResponses],onChange:function(t){if(!t.BeingDeleted){var e=t.Master.Model;e.SerializedPredefinedResponses=Object(Te.i)(e.PredefinedResponses)}}},{Name:"DeleteResponseModels",InterestedFields:[t.Responses],onChange:function(t){var e=t.Master,n=e.Model.Responses,i=[],r=[];t.SubChanges.filter((function(t){return t.Master.Model===n})).forEach((function(t){return t.RemovedModels.forEach((function(t){var n=e.getResponseModelById(t.Id);n?i.push(n):r.push(t.Id)}))}));var o=Wt.a.getCollectionMasterFromModel(e.Model.ResponseModels);e.updatingResponsesFromServer?o.itemsDeletedInSource(i):(o.deleteItems(i),Object(Ee.b)(e,r))}},{Name:"ResponsesCount",InterestedFields:[t.ResponsesCount],onChange:function(e){var n=e.Master;n.isFieldReady(t.ResponsesCount)&&-1===n.Model.ResponsesCount&&(n.Model.ResponsesCount=null)}},{Name:"ResponseModel Change",InterestedFields:[t.ResponseModels],onChange:function(t){var e=t.Master,n=Wt.a.getCollectionMasterFromModel(e.Model.ResponseModels),i=Wt.a.getCollectionMasterFromModel(e.Model.Responses);t.SubChanges.filter((function(t){return t.Master===n})).forEach((function(t){t.SubChanges.forEach((function(t){var e=Et.indexOf(i.Model,t.Master.Model);e>=0&&i.markAsChanged(e)}))}))}}]}return e.designOnlyRules},enumerable:!1,configurable:!0}),n.Cm=function(){this.isFieldReady(Zt.a.Schema.RowCount)&&(this.Model.ResponsesCount=this.Model.RowCount)},n.Tm=function(){var t=this;this.km=this.Model.Permissions&&this.Model.Permissions.length<=1||!this.isGroupForm&&this.formOwnedByMe(),this.isGroupForm&&!this.km&&Object(De.a)(this.Model.OwnerId).then((function(e){t.km=e.value.length>0}))},e}(t)}(t=function(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createLocale=function(t,e){var n={localeId:t,localeName:e};Wt.a.Collection.addItems(this.Model.LocaleList,[n]),Object(Fe.c)(n,this)},n.deleteLocale=function(t){var e=Wt.a.Collection.getItemWithKeyFields(this.Model.LocaleList,{localeId:t});e&&(Wt.a.Collection.deleteItems(this.Model.LocaleList,[e]),Object(Fe.i)(t,this))},n.getAllLocaleResources=function(){return Object(Me.h)(this.Model.Id).getAllLocaleResources(this.Model.Id).then((function(t){return Object(Fe.g)(t)}))},e}(t)}(t=function(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.setResponseComment=function(t,e){var n=this.Dm(t);n&&(n.Model.Feedback=e,this.Mm(n.Model))},n.setAnswerGrading=function(t,e,n,i){var r=this.Dm(t);r&&(r.setAnswerGrading(e,n,i),this.Mm(r.Model))},n.setReleaseDate=function(t,e){var n=this.Dm(t);n&&(n.Model.ReleaseDate=e,this.Mm(n.Model))},n.Dm=function(t){var e=this,n=this.getResponseModelById(t);if(!n){var i=this.Model.Responses,r=Et.findIndex(i,(function(e){return e.Id===t}));if(r<0)return!1;this.bulkEdit((function(){n=Wt.a.Collection.itemsAddedInSource(e.Model.ResponseModels,[i[r]])[0],i[r]=n}))}return Object(Ee.c)(n)},n.Mm=function(t){if(Object(Z.k)()&&Object(Z.l)()&&this.IsAssignmentForm&&Object(Y.c)("AssignmentsIFrameLimitParentHeaders")){var e=Et.reduce(t.Answers,(function(t,e){return t+(e.Score||0)}),0);window.parent.postMessage({eventName:"FormGradingChangePerformed",responseId:t.Id,responder:t.Responder,responseScore:e,feedback:t.Feedback,isReturned:"0001-01-01T00:00:00Z"!==t.ReleaseDateAsString},"*")}},e}(t)}(t=function(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.triggerShareAction=function(){if(Object(Ht.a)().Flighting.isEnabled_Deprecated("EnableMsaContentValidation")&&!this.Lm&&Object(u.a)().userInfo.IsMsa&&0==(this.Model.Flags&Be.CvsScanAllowed)){this.Lm=!0,we.a.getInstance().createDataProvider().postFormShareAction(this.Model.Id);var t=JSON.parse(this.Model.OtherInfo);t&&t.hasOwnProperty("TemplateId")&&Object(g.b)("MyTemplate.PostShare",{TemplateTitle:t.TemplateId},null,!0)}},n.appendPermission=function(t){for(var e=this.Model.Permissions,n=function(n){if("OrgLink"===e[n].Type||"Link"===e[n].Type||"ShareToPeople"===e[n].Type){var i=e[n],r=Object(Ve.c)(i),o=r.Model.Type;return r.Model.Type=t,{value:r.Synchronizer.flush().then((function(){return i.PrincipalId})).catch((function(t){throw r.Model.Type=o,t}))}}},i=0;i<e.length;i++){var r=n(i);if("object"==typeof r)return r.value}var o=Wt.a.Collection.addItems(e,[Object(Ve.b)(t)]),s=Object(Ve.c)(o[0]);return s.Synchronizer.existingInDataSource().then((function(){return s.Model.PrincipalId}))},n.appendSpecificPeoplePermissions=function(t){var e=this.Model.Permissions,n=Wt.a.Collection.addItems(e,t).map(Ve.c).map((function(t){return t.Synchronizer.existingInDataSource().catch((function(n){var i=Et.find(e,(function(e){return e.PrincipalId===t.Model.PrincipalId}));throw Wt.a.Collection.deleteItems(e,[i]),n}))}));return Promise.all(n).then((function(){}))},n.removeLinkPermission=function(){var t=this.Am();return this.removePermissions(t)},n.removePermissions=function(t){Wt.a.Collection.deleteItems(this.Model.Permissions,t);var e=t.map(Ve.c).map((function(t){return t.Synchronizer.deletedFromDataSource()}));return Promise.all(e).then((function(){}))},n.canEditPermissionTokenByCoauthor=function(){return!Et.some(this.Model.Permissions,(function(t){return"ShareToPeople"===t.Type}))},n.getPermissionToken=function(){var t=this;return this.Synchronizer.existingInDataSource().then((function(){var e=t.Am().map(Ve.c);return 0!==e.length?e[0].Synchronizer.existingInDataSource().then((function(){return e[0].Model.PrincipalId})):null}))},n.refreshPermissions=function(){var t=this;return new Promise((function(e,n){return t.Synchronizer.query([Zt.a.Schema.Permissions]).then(e,n)}))},n.getUserOrGroupPermissions=function(){return Et.filter(this.Model.Permissions,(function(t){return"Failed"!==t.SavingState&&("User"===t.Type||"Group"===t.Type)}))},n.appendResponderPermission=function(t){var e=this.Model.ResponderPermissions,n=Wt.a.Collection.addItems(e,[Object(ze.b)(t)]),i=Object(ze.c)(n[0]);return i.Synchronizer.existingInDataSource().then((function(){return i.Model.PrincipalId}))},n.appendSpecificResponderPermissions=function(t){var e=this.Model.ResponderPermissions,n=Wt.a.Collection.addItems(e,t).map(ze.c).map((function(t){return t.Synchronizer.existingInDataSource().catch((function(n){var i=Et.find(e,(function(e){return e.PrincipalId===t.Model.PrincipalId}));throw Wt.a.Collection.deleteItems(e,[i]),n}))}));return Promise.all(n).then((function(){}))},n.getUserOrGroupPermissionsInResponder=function(){return Et.filter(this.Model.ResponderPermissions,(function(t){return"Failed"!==t.SavingState&&("User"===t.Type||"Group"===t.Type)}))},n.getResponderPersonas=function(){var t=this.getUserOrGroupPermissionsInResponder();return Et.map(t,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}))},n.getResponderEmailList=function(){if(2!==this.getResponseCollectionType())return Promise.resolve(null);var t=Wt.a.convertToArray(this.getUserOrGroupPermissionsInResponder()).map((function(t){return Object(Qe.c)("User"===t.Type?"User":"Group",t.PrincipalId)}));return Promise.all(t).then((function(t){return encodeURIComponent(t.map((function(t){return t.Mail})).join(";"))})).catch((function(){return null}))},n.removeResponderPermissions=function(t){Wt.a.Collection.deleteItems(this.Model.ResponderPermissions,t);var e=t.map(ze.c).map((function(t){return t.Synchronizer.deletedFromDataSource()}));return Promise.all(e).then((function(){}))},n.removeResponderPermissionLink=function(){var t=this.Rm();return this.removeResponderPermissions(t)},n.getResponseCollectionType=function(){var t=this.SettingMaster.Model,e=Object(_t.b)().Model.FormsTenantSettings,n=t.IsAnonymous,i=e&&!e.externalSendForm,r=0;if((!n||i)&&this.isFieldReady(Zt.a.Schema.ResponderPermissions)){var o=this.Model.ResponderPermissions;r=Et.find(o,(function(t){return"SpecificResponder"===t.Type}))?2:1}return r},n.Rm=function(){return Et.filter(this.Model.ResponderPermissions,(function(t){return"User"===t.Type||"Group"===t.Type||"SpecificResponder"===t.Type}))},n.Am=function(){return Et.filter(this.Model.Permissions,(function(t){return"Link"===t.Type||"OrgLink"===t.Type||"ShareToPeople"===t.Type}))},e}(t)}(t=function(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this;i.Em=!1;var r=i.Synchronizer;return r.observe((function(t){var e=r.Model.UpdateError;e&&i.Bm(e)}),[r.Schema.UpdateError]),i}Object(S.__extends)(e,t);var n=e.prototype;return n.duplicateForm=function(t,e){var n=this;return this.ensureFieldsReady(Object(Te.b)()).then((function(){var i=Et.clone(n.getSnapshotToCopy());return i.OwnerId=t.OwnerId,i.OwnerTenantId=t.OwnerTenantId,i.Title=e,i.Settings=Et.clone(i.Settings),i.Settings.AllowCopy=!1,i.Settings.ShareToken=null,Object(Ge.a)(i,t.IsGroupForm)}))},n.ensureCreationDone=function(){var t=this,e=this.getImageMaster(Zt.a.Schema.Background),n=this.getImageMaster(Zt.a.Schema.Logo);return Promise.all(Object(S.__spreadArrays)([e.Synchronizer.flush(),n.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))],this.formElementManager.AllElementMasters.map((function(t){return t.ensureCreationDone()})))).then((function(){}))},n.ensureReadyForMruCard=function(){var t=Zt.a.Schema;return this.ensureFieldsReady([t.Title,t.ModifiedDate,t.Settings,t.XlWorkbookId,t.OwnerId,t.OwnerTenantId,t.Category,t.OtherInfo,t.Theme,t.RowCount])},n.moveToRecycleBin=function(){var t=this;return this.bulkEdit((function(){t.Model.MovingToRecycleBin=!0,t.Model.SoftDeleted=He.a.SoftDeleted})),this.Synchronizer.flush().then((function(){t.Model.MovingToRecycleBin=!1}))},n._m=function(t){var e=this;this.Model.MovingToRecycleBin&&this.isSoftDeleted()&&Object(Ft.a)(t)&&(6102===t.innerCode||6100===t.innerCode)&&this.bulkEdit((function(){return e.Model.SoftDeleted=He.a.Normal}))},n.isNotSoftDeleted=function(){return!this.isFieldReady(this.Schema.SoftDeleted)||this.Model.SoftDeleted===He.a.Normal},n.isSoftDeleted=function(){return!!this.isFieldReady(this.Schema.SoftDeleted)&&this.Model.SoftDeleted===He.a.SoftDeleted},n.getQuestionError=function(){return Object(qe.f)(this)},Object.defineProperty(n,"IsSharedForm",{get:function(){return this.Em},set:function(t){this.Em=t},enumerable:!1,configurable:!0}),n.Bm=function(t){this._m(t)},e}(t)}(t=function(t){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this;return i.Hm=[],i.Gm=Promise.resolve(),i.qm=new me.a.CallbackManager,i}Object(S.__extends)(e,t);var n=e.prototype;return n.startReceivingNotifications=function(t){var e=this,n=Zt.a.Schema;return this.ensureFieldsReady([n.Id,n.OwnerId,n.OwnerTenantId,n.TableId]).then((function(){t&&e.qm.register(t),e.Qm||(e.Qm=!0,e.Vm())}))},n.startReceivingNotificationsV2=function(){var t=this,e=Zt.a.Schema;return this.Model.RtcStatus=1,this.ensureFieldsReady([e.Id,e.OwnerId,e.OwnerTenantId,e.TableId]).then((function(){2!=t.Model.RtcStatus&&t.Vm()}))},n.stopReceivingNotifications=function(t){var e=this;this.existingOnServerSide().then((function(){Se.createNotificationProvider(e.DataProviderType,e.Model.OwnerTenantId,e.Model.OwnerId).close(e.Model.Id),e.Qm=!1,e.qm.clear(),e.responsesQueryJob=null,t()}))},n.stopReceivingNotificationsV2=function(){var t=this;this.existingOnServerSide().then((function(){Se.createNotificationProvider(t.DataProviderType,t.Model.OwnerTenantId,t.Model.OwnerId).close(t.Model.Id),t.Model.RtcStatus=3,t.responsesQueryJob=null,ve().removeAllUsers()}))},n.refreshFormResponsesCount=function(){var t=this;return this.Synchronizer.query([Zt.a.Schema.ResponsesCount]).then((function(){t.Model.LastSyncTime=Date.now()}))},n.zm=function(t,e){if(Oe.isValidUser(e)){var n=this.getElementById(t);n&&n.updateCoAuthors(e)}},n.Vm=function(){var t=this,e=function(e,n){return t.qm.trigger(e,n)},n=Se.createNotificationProvider(this.DataProviderType,this.Model.OwnerTenantId,this.Model.OwnerId),i=0,r=Promise.resolve(),o=function(){var e=++i;r.then((function(){e===i&&(r=t.refreshFormResponsesCount())}))},s=Object(Tt.c)("GetAggregateInterval",2e4),a=!1,c=function(){a||(a=!0,window.setTimeout((function(){a=!1,t.refreshFormResponsesCount()}),s))},u=function(){t.Synchronizer.query(Object(Te.c)())},l=Object(b.d)(),h={onConnectionStarted:function(n){Object(Y.c)("RtcRefactor")?t.Um(n):e(n||[],ge.ConnectionStateChanged),n&&n.length>1&&u(),t.Model.RtcStatus=2,t.Model.LastSyncTime=Date.now()},onConnectionFailed:function(e){t.Model.LastSyncTime=Date.now()},onConnectionReconnected:function(n){Object(Y.c)("RtcRefactor")?t.Um(n):e(n||[],ge.ConnectionStateChanged),n&&n.length>1&&u(),t.Model.LastSyncTime=Date.now()},onConnectionDisconnected:function(){t.Model.RtcStatus=3,t.Model.LastSyncTime=Date.now()},onResponseAdded:function(e){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?c():o()}))},onResponseDeleted:function(e){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?c():o()}))},onResponsesAllDeleted:function(){t.bulkEdit((function(){t.Model.Settings.IsQuizMode?c():o()}))},onFormElementAdded:l?null:function(n,i){var r=t.getElementById(n.id);if(r instanceof Object(_t.i)()){var o=n;o.choices||(o.choices=[]),r.Synchronizer.onSourceDataReceived(n)}else r instanceof ke.a?r.Synchronizer.onSourceDataReceived(n):t.Gm=Object(pe.d)(t.Gm.then((function(){Yt.a.isDescriptiveElement(n.type)?Wt.a.Collection.itemsAddedInSource(t.Model.DescriptiveElements,[Wt.a.convertFromSourceData(n,ke.a.Schema)]):Wt.a.Collection.itemsAddedInSource(t.Model.Questions,[Wt.a.convertFromSourceData(n,Object(_t.i)().Schema)])})));t.zm(n.id,i),Object(Y.c)("RtcRefactor")?t.Um([i]):e([i],ge.UserAction)},onFormElementDeleted:l?null:function(n,i){t.Gm=Object(pe.d)(t.Gm.then((function(){var e=t.getElementById(n);if(e instanceof te.d){var i=e.SubQuestionMasters.concat(e);Wt.a.Collection.itemsDeletedInSource(t.Model.Questions,i.map((function(t){return t.Model})))}else e instanceof ke.a&&Wt.a.Collection.itemsDeletedInSource(t.Model.DescriptiveElements,[e.Model])}))),Object(Y.c)("RtcRefactor")?t.Um([i]):e([i],ge.UserAction)},onFormElementUpdated:l?null:function(n,i,r){var o=t.getElementById(n);o&&((o instanceof te.d||o instanceof ke.a)&&o.Synchronizer.onSourceDataReceived(i),t.zm(n,r),Object(Y.c)("RtcRefactor")?t.Um([r]):e([r],ge.UserAction))},onChoiceAdded:l?null:function(n,i,r){var o=t.getQuestionById(n);if(o){var s;if(i.key){if(!o.getChoiceByKey(i.key)){var a=Wt.a.convertFromSourceData(i,xe.a.Schema);Wt.a.Collection.itemsAddedInSource(o.Model.ChoiceGroup,[a])}s=Promise.resolve()}else{var c=Et.map(o.Model.ChoiceGroup,(function(t){return Wt.a.getObjectMasterFromModel(t).Synchronizer.existingInDataSource()}));s=Promise.all(c).then((function(){if(!o.getChoiceById(i.id)&&-1===Wt.a.Collection.getIndexWithKeyFields(o.Model.ChoiceGroup,{Id:i.id})){var t=Wt.a.convertFromSourceData(i,xe.a.Schema);Wt.a.Collection.itemsAddedInSource(o.Model.ChoiceGroup,[t])}}))}s.then((function(){t.zm(n,r),Object(Y.c)("RtcRefactor")?t.Um([r]):e([r],ge.UserAction)}))}},onChoiceDeleted:l?null:function(n,i,r){var o=t.getQuestionById(n);if(o){var s=o.getChoiceById(i);s&&(s.Synchronizer.onDeletedInDataSource(),Object(Y.c)("RtcRefactor")?t.Um([r]):e([r],ge.UserAction))}},onChoiceUpdated:l?null:function(n,i,r,o){var s=t.getQuestionById(n);if(s){var a=s.getChoiceById(i);a&&(a.Synchronizer.onSourceDataReceived(r),t.zm(n,o),Object(Y.c)("RtcRefactor")?t.Um([o]):e([o],ge.UserAction))}},onUserConnected:l?null:function(n){Object(Y.c)("RtcRefactor")?t.Um([n]):e([n],ge.UserConnect)},onUserDisconnected:l?null:function(n){Object(Y.c)("RtcRefactor")?t.$m([n]):e([n],ge.UserDisconnect)},onFormUpdated:function(n,i){var r=Et.map(t.Model.PermissionTokens,(function(t){return Wt.a.getObjectMasterFromModel(t).Synchronizer.existingInDataSource()}));Promise.all(r).then((function(){t.Synchronizer.onSourceDataReceived(n),Object(Y.c)("RtcRefactor")?t.Um([i]):e([i],ge.UserAction)}))},onLocaleResourceAdded:l?null:function(n,i){t.bulkEdit((function(){Et.forEach(n,(function(e){if("localename"===e.elementKey){var n={localeId:e.locale,localeName:e.elementValue};-1===Wt.a.Collection.getIndexWithKeyFields(t.Model.LocaleList,{localeId:n.localeId})&&(Wt.a.Collection.itemsAddedInSource(t.Model.LocaleList,[n]),Object(Fe.c)(n,t))}else t.Wm(e)})),i&&(Object(Y.c)("RtcRefactor")?t.Um([i]):e([i],ge.UserAction))}))},onLocaleResourceUpdated:l?null:function(n,i){var r=Wt.a.Collection.getItemWithKeyFields(t.Model.LocaleList,{localeId:n.locale});if(r){if("localename"===n.elementKey){var o={localeName:n.elementValue};Wt.a.getObjectMasterFromModel(r).Synchronizer.onSourceDataReceived(o);var s=Wt.a.Collection.getItemWithKeyFields(t.Model.LocalizedResources,{localeId:n.locale});if(s)Wt.a.getObjectMasterFromModel(s).Synchronizer.onSourceDataReceived(o)}else t.Wm(n);i&&(Object(Y.c)("RtcRefactor")?t.Um([i]):e([i],ge.UserAction))}},onLocaleResourceDeleted:l?null:function(n,i){if(n.hasOwnProperty("locale")){var r=n.locale,o=Wt.a.Collection.getItemWithKeyFields(t.Model.LocaleList,{localeId:r});o&&Wt.a.Collection.itemsDeletedInSource(t.Model.LocaleList,[o])}else if(n.hasOwnProperty("propertyName")){var s=n.propertyName;Et.forEach(t.Model.LocalizedResources,(function(t){var e=Wt.a.Collection.getItemWithKeyFields(t.questionResources,{questionId:s});e&&Wt.a.getObjectMasterFromModel(e).Synchronizer.onDeletedInDataSource()}))}else Object(be.b)("Not supposed to happen.");i&&(Object(Y.c)("RtcRefactor")?t.Um([i]):e([i],ge.UserAction))}};n.open(this.Model.Id,h)},n.Wm=function(t){if(t.elementKey.startsWith("choiceid_")){var e=Et.find(this.Model.LocalizedResources,(function(e){return e.localeId==t.locale}));if(e){var n=Et.find(e.questionResources,(function(e){return e.questionId==t.propertyName}));if(n){var i=Wt.a.getObjectMasterFromModel(n),r=t.elementKey.substring("choiceid_".length),o=i.getChoiceLocalizedMaster(r),s={choiceId:r,description:t.elementValue,key:o.Model.key};o.Synchronizer.onSourceDataReceived(s)}}}else switch(t.elementKey){case"title":case"subtitle":case"formsprortlocaletitle":case"formsprortlocalesubtitle":"_id"===t.propertyName?this.Km(t.locale,t.elementKey,t.elementValue):this.Jm(t.locale,t.propertyName,t.elementKey,t.elementValue);break;case"thankYouMessage":case"formCloseMessage":case"footerText":"_id"===t.propertyName?this.Km(t.locale,t.elementKey,t.elementValue):Object(be.b)("Not supposed to happen. Should be form level property.");break;case"leftDescription":case"rightDescription":case"formsprortlocaleldescription":case"formsprortlocalerdescription":case"option":"_id"===t.propertyName?Object(be.b)("Not supposed to happen. Should be question level property."):this.Jm(t.locale,t.propertyName,t.elementKey,t.elementValue);break;default:Object(be.b)("Not supposed to happen. Unknown element key")}},Object.defineProperty(n,"DataProviderType",{get:function(){return this.isGroupForm?3:2},enumerable:!1,configurable:!0}),n.Km=function(t,e,n){var i=Et.find(this.Model.LocalizedResources,(function(e){return e.localeId==t}));if(i){var r=Wt.a.getObjectMasterFromModel(i),o={localeId:t};o[e]=n,r.Synchronizer.onSourceDataReceived(o)}},n.Jm=function(t,e,n,i){var r=Et.find(this.Model.LocalizedResources,(function(e){return e.localeId==t}));if(r){var o=Et.find(r.questionResources,(function(t){return t.questionId==e}));if(o){var s=Wt.a.getObjectMasterFromModel(o),a={localeId:t};a[n]=i,s.Synchronizer.onSourceDataReceived(a)}}},n.getQuestionSyncBlocker=function(t){return this.Hm.push(Object(pe.d)(t)),this.Gm},n.existingOnServerSide=function(){return this.Synchronizer.existingInDataSource()},n.Um=function(t){var e=this;t&&t.length>0&&t.forEach((function(t){ve().addOrUpdateUser(t),e.Model.CoAuthors=null}))},n.$m=function(t){var e=this;t.length>0&&t.forEach((function(t){ve().removeUser(t),e.Model.CoAuthors=null}))},e}(t)}(t=function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this;return i.observe((function(){i.ensureFieldsReady([Zt.a.Schema.XlExportingTag]).then((function(){return i.Model.XlExportingLocalTag=i.Model.XlExportingTag.toLocaleLowerCase()}))}),[Zt.a.Schema.XlExportingTag]),i}Object(S.__extends)(e,t);var n=e.prototype;return n.downloadExcelFile=function(t,e){return Object(Me.a)(this,t,e)},n.SetToExporting=function(){var t=this;this.ensureFieldsReady([Zt.a.Schema.XlExportingLocalTag]).then((function(){t.Model.XlExportingLocalTag="exporting"}))},n.IsExporting=function(){var t,e=this,n=0;if(this.isFieldReady(Zt.a.Schema.XlExportingLocalTag)&&this.Model.XlExportingLocalTag&&this.Model.XlExportingLocalTag.indexOf("exporting")>=0)try{var i=JSON.parse(this.Model.XlExportingLocalTag),r=Date.parse(i.starttime.toUpperCase());t=(n=(new Date).getTime()-r)<3e5}catch(e){t=!0}else t=!1;return t?this.Xm=this.Xm||window.setTimeout((function(){e.Model.XlExportingLocalTag="timeout"}),3e5-n):window.clearTimeout(this.Xm),t},n.IsExportingFailed=function(){return this.Model.XlExportingLocalTag.toLocaleLowerCase().indexOf("failed")>=0},e}(t))))))))}function Je(){return he(function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this,r=i.originalInitialData;return i.duplicatingImage&&i.Synchronizer.existingInDataSource().then((function(){return i.Zm(r)})),i}Object(S.__extends)(e,t);var n=e.prototype;return n.addImage=function(t){var e,n,i=this,r=new tt.a("Image.Add");if(r.start(),t.File)n="File",e=function(){return i.Ym(t.File,Object(Pe.s)(),Object(Pe.q)())};else{if(!t.FromUrl)throw Error("Invalid picked image result.");n="FromUrl",e=function(){return i.tv(t.FromUrl.Url,t.FromUrl.Size,t.FromUrl.Width,t.FromUrl.Height)}}return this.Model.ImageProcessingStatus=ee.c.Picking,this.Synchronizer.existingInDataSource().then(e).then((function(){i.Model.AltText=null,r.end({resultType:"Success",extraData:{imageSource:n}})})).catch((function(){r.end({resultType:"Failure",extraData:{imageSource:n}})}))},n.getImageErrorMessage=function(){switch(this.Model.ErrorType){case ee.a.NoError:return null;case ee.a.SizeTooLarge:return Object(ae.a)().Error_Message_5208;case ee.a.InvalidType:return Object(ae.a)().Error_Message_5209;case ee.a.BrokenImage:return Object(ae.a)().ImagePicker_Broken_Image;case ee.a.ServerError:return this.ev();case ee.a.DeleteFailError:return Object(ae.a)().Image_Delete_Fail}},n.clear=function(){var t=this,e=this.Model;return e.ResourceUrl?e.IsPredefined?(this.setData({AltText:null,ContentType:null,FileIdentifier:null,OriginalFileName:null,ResourceId:null,ResourceUrl:null,IsPredefined:!1,UploadParameters:null,ErrorType:ee.a.NoError,ResponseError:null,ImageProcessingStatus:ee.c.Idle,Width:null,Height:null}),Promise.resolve()):(this.bulkEdit((function(){e.ImageProcessingStatus=ee.c.Deleting,e.UploadParameters={Delete:!0}})),this.nv((function(){return t.setData(Object(ee.d)())}))):Promise.resolve()},n.updateSettings=function(t,e){this.getSettingsMaster()&&this.getSettingsMaster().updateWith(this.Model,t,e)},n.Zm=function(t){var e=this;if(this.Model.ResourceUrl){var n=t.AltText,i=this.getSettingsMaster(),r={};i&&(r=Et.clone(i.getSnapshot())),this.Synchronizer.existingInDataSource().then((function(){return e.tv(t.ResourceUrl,0,r?r.NaturalWidth:Object(Pe.s)(),r?r.NaturalHeight:Object(Pe.q)())})).then((function(){e.Model.AltText=n,i&&(delete r.NaturalHeight,delete r.NaturalWidth,i.setData(r))}))}},n.tv=function(t,e,n,i){var r=this;Object(g.b)("DesignPage.ImageLayout.ImageSize",{width:n,height:i});var o=this.Model;return this.bulkEdit((function(){var s=Object(ee.f)(n,i,800,600);return o.ErrorType=r.iv(e),o.ErrorType!==ee.a.NoError?Promise.reject(o.ErrorType):(r.resetStatus(ee.c.Picking),o.UploadParameters={Url:t,Size:e},r.nv(void 0,s.width,s.height))}))},n.Ym=function(t,e,n){var i=this,r=this.Model;return this.bulkEdit((function(){var e=i.iv(t.size,t.type);return e===ee.a.NoError?(i.resetStatus(ee.c.Uploading),r.UploadParameters={ImageFile:t},i.nv()):(r.ErrorType=e,r.ImageProcessingStatus=ee.c.Idle,Promise.reject(r.ErrorType))}))},n.nv=function(t,e,n){var i=this;return this.Synchronizer.flush().finally((function(){return i.Model.ImageProcessingStatus=ee.c.Idle})).catch((function(){})).then(t).then((function(){return i.updateSettings(e,n)})).catch((function(t){i.rv()}))},n.ev=function(){var t=this.Model,e=t.ResponseError&&t.ResponseError.innerCode;return Object(Ue.a)(""+e)||Object(ae.a)().Image_Upload_Fail},n.iv=function(t,e,n,i){var r=ee.a.NoError;return t>Object(Pe.r)()&&(r=ee.a.SizeTooLarge),e&&$.inArray(e,Object(Pe.w)())<0&&(r=ee.a.InvalidType),r},n.rv=function(){this.setData(Object(ee.d)(),Wt.a.getSubFieldSchemas(ee.b.Schema)),this.updateSettings()},e}(ee.b))}function Xe(){return he(function(t){function e(){for(var n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];var r=t.apply(this,n)||this;return Object(Re.b)(r),r.updateIntegratedSavingState(),e.DesignOnlyRules.forEach((function(t){return r.addRule(t)})),r}Object(S.__extends)(e,t);var n=e.prototype;return Object.defineProperty(e,"DesignOnlyRules",{get:function(){if(!e.designOnlyRules){var t=te.d.Schema;e.designOnlyRules=[{Name:"block id changes",InterestedFields:[t.Id],onChange:function(t){var e,n=t.Master.Model,i=n.Id,r=t.OldValues.Id;n.Id=r;try{throw Error("Changing question id")}catch(t){e=t}Object(g.c)("UpdatingQuestionId",{newId:i,oldId:r,stack:e.stack})}},{Name:"update CombinedTitle",InterestedFields:[t.Title,t.IsMathQuiz,t.Subtitle],onChange:function(t){return Object(We.a)(t.Master.Model)}},{Name:"update Title",InterestedFields:[t.CombinedTitle],onChange:function(t){return Object(We.b)(t.Master.Model)}},{Name:"IntegrateSavingState",InterestedFields:[t.ImageInfo.SavingState,t.SavingState],onChange:function(t){return t.Master.updateIntegratedSavingState()}},{Name:"IsQuiz",InterestedFields:[t.IsQuiz],onChange:function(t){var e=t.Master.Model;e.IsQuiz||(e.IsMathQuiz=null,Wt.a.convertToArray(e.Choices).forEach((function(t){t.IsAnswerKey=null})))}},{Name:"IsMathQuiz",InterestedFields:[t.IsMathQuiz],onChange:function(t){var e=t.Master.Model;e.IsMathQuiz||(e.IsMathQuiz=null,e.MathPatterns=null,e.MathAriaLabels=null,e.IsPlainTextInMathField=null,e.IsMathInputDefault=null,e.InputSwitcherDisabled=null,e.LastMathMLFormula=null)}},{Name:"NumberValidationRule",InterestedFields:[t.IsNumber],onChange:function(t){var e=t.Master.Model;e.IsNumber?null==e.NumberValidationRule&&(e.NumberValidationRule=te.b.None):e.NumberValidationRule=null}},{Name:"JustifyNumberBoundaries",InterestedFields:[t.NumberValidationRule],onChange:function(t){return t.Master.justifyNumberBoundaries()}}]}return e.designOnlyRules},enumerable:!1,configurable:!0}),n.ensureCreationDone=function(){var t=this;return this.ImageInfoMaster.Synchronizer.flush().then((function(){return t.Synchronizer.flush()}))},n.setVideoUrl=function(t,e){var n=this.Model.VideoInfo;Wt.a.getObjectMasterFromModel(n).bulkEdit((function(){n.Url=Object($e.a)(t),n.Title="",n.Author="",n.Thumbnail_url="",n.OriginalWidth=459,n.OriginalHeight=256,n.ShowWarningBar=e&&Object($e.c)(t)}))},n.clearVideoInfo=function(){this.Model.VideoInfo={}},n.addSubQuestion=function(t){t.GroupId=this.Model.Id,t.Required=this.Model.Required,this.Form.FormElementManager.insertElementAfter(t,this)},n.deleteSubQuestion=function(t){this.Form.getQuestionById(t).Deleted=!0},n.updateCoAuthors=function(t){var e=this,n=Wt.a.getCollectionMasterFromModel(this.Model.CoAuthors),i=Et.filter(this.Model.CoAuthors,(function(e){return t.userId===e.userId}))[0],r=function(){i&&n.deleteItems([i]),t.userId in e.coAuthorTimers&&(clearTimeout(e.coAuthorTimers[t.userId]),delete e.coAuthorTimers[t.userId])};n.bulkEdit((function(){r(),i=Wt.a.Collection.addItems(e.Model.CoAuthors,[t])[0]})),this.coAuthorTimers[t.userId]=window.setTimeout(r,1e4)},n.hasSectionBranching=function(){var t=this.Model;return Et.map(t.Choices,(function(t){return t.BranchInfo})).concat([t.BranchInfo,t.BranchInfoForOtherChoice]).map(Wt.a.getObjectMasterFromModel).some((function(t){return t.hasSectionBranching()}))},n.needObserveSettings=function(){return"Question.FileUpload"===this.Model.Type},n.getErrorMessage=function(){var t=this.Model.FileUploadSPOInfo;return this.Synchronizer.Model.CreationError?this.getCreationError():(null==t?void 0:t.errorCode)?Object(qe.g)(t.errorCode):(null==t?void 0:t.linkInfo)?Object(qe.h)(Number(t.linkInfo),!1):(null==t?void 0:t.anonymousLinkInfo)&&this.Form.SettingMaster.Model.IsAnonymous?Object(qe.h)(Number(t.anonymousLinkInfo),!0):void 0},n.getCreationError=function(){var t,e,n,i=null===(t=this.Synchronizer.Model)||void 0===t?void 0:t.CreationError.innerMessage,r=null===(n=null===(e=this.Synchronizer.Model)||void 0===e?void 0:e.CreationError)||void 0===n?void 0:n.innerCode;if("6614"==r){var o=i.match(/disableReason:([-0-9]*);/);if(o){var s=Number(o[1]);return Object(qe.h)(s,!1)}}else if(r)return Object(qe.g)(r);return null},n.updateIntegratedSavingState=function(){this.isFieldReady(te.d.Schema.ImageInfo)?this.Model.IntegratedSavingState=Object(Re.a)([this.Model.ImageInfo.SavingState,this.Model.SavingState]):this.Model.IntegratedSavingState=this.Model.SavingState},e}(te.d))}function Ze(){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.appendElement=function(t,e){var n=this,i=[];t.Id||((t=Et.clone(t)).Id=this.ov());var r=this.getAllElements(),o=r.length>0?r[r.length-1].Order:Yt.a.QuestionOrderFloor;if(t.Order=o+Yt.a.QuestionOrderDefaultStep,e&&(i=e.map((function(e,i){return(e=Et.clone(e)).Id=n.ov(),e.GroupId=t.Id,e.Order=t.Order+(i+1)*Yt.a.QuestionOrderDefaultStep,e}))),Yt.a.isDescriptiveElement(t.Type)){var s=Wt.a.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return Object(ke.c)(s[0])}var a=[t];return a=a.concat(i),s=Wt.a.Collection.addItems(this.formMaster.Model.Questions,a),Object(te.h)(s[0])},n.duplicateElement=function(t){var e=t.getSnapshotWithoutBranchInfo();delete e.Id;var n=t.SubQuestionMasters.map((function(t){var e=t.getSnapshotWithoutBranchInfo();return delete e.Id,delete e.GroupId,delete e.QuestionInfo,e}));return this.insertElementAfter(e,t,n)},n.duplicateSectionAndSubElements=function(t){var e=this,n=this.findQuestionsInSection(t,!0),i=Et.find(this.SectionMasters,(function(e){return e.Model.Order>t.Model.Order})),r=t.Model.Order,o=t.Model.Order+Yt.a.QuestionOrderDefaultStep*(n.length+1);n.length>0&&(r=Et.last(n).Model.Order),i&&(o=i.Model.Order);var s=(o-r)/(n.length+2),a=Et.clone(t.getSnapshot());a.Id=this.ov(),a.Order=r+s,a.Title=Object(ae.a)().Title_For_Duplicate_Section.format(a.Title);var c,u=[{newId:a.Id,oldId:t.Model.Id}],l=[];return n&&n.forEach((function(t,n){var i=Et.clone(t.getSnapshot());switch(i.Id=e.ov(),i.Order=a.Order+s*(n+1),l.push(i),i.Type){case"Question.MatrixChoiceGroup":c=i.Id;break;case"Question.MatrixChoice":i.GroupId=c}u.push({newId:i.Id,oldId:t.Model.Id})})),this.formMaster.bulkEdit((function(){Wt.a.Collection.addItems(e.formMaster.Model.DescriptiveElements,[a]),Wt.a.Collection.addItems(e.formMaster.Model.Questions,l)})),Object(Fe.e)(t.Form.Model.LocalizedResources,u),this.getDescriptiveElementMasterById(a.Id)},n.deleteFormQuestion=function(t){Wt.a.Collection.itemsDeletedInSource(t.Form.Model.Questions,t.SubQuestionMasters.map((function(t){return t.Model}))),t.Deleted=!0},n.deleteSectionAndSubElements=function(t){var e=this,n=this.findQuestionsInSection(t);this.formMaster.bulkEdit((function(){n.forEach((function(t){return e.deleteFormQuestion(t)})),t.Deleted=!0}))},n.moveElementDown=function(t){var e=this,n=this.TopElementMasters,i=Et.indexOf(n,t);if(i!==n.length-1){var r=n[i+1],o=r instanceof te.d&&r.SubQuestionMasters.length>0?r.SubQuestionMasters[r.SubQuestionMasters.length-1].Model.Order:r.Model.Order,s=o+Yt.a.QuestionOrderDefaultStep;i+1<n.length-1&&(s=n[i+2].Model.Order);var a=t.SubQuestionMasters.map((function(t){return t.Model}));this.formMaster.bulkEdit((function(){return e.av(t.Model,a,o,s)}))}},n.moveElementUp=function(t){var e=this,n=this.TopElementMasters,i=Et.indexOf(n,t);if(!(i<=0)){var r=Yt.a.QuestionOrderFloor,o=n[i-1],s=Et.indexOf(this.AllElementMasters,o);s>0&&(r=this.AllElementMasters[s-1].Model.Order);var a=n[i-1].Model.Order,c=t.SubQuestionMasters.map((function(t){return t.Model}));this.formMaster.bulkEdit((function(){return e.av(t.Model,c,r,a)}))}},n.moveSectionTo=function(t,e){var n,i=this,r=Yt.a.QuestionOrderFloor,o=this.SectionMasters,s=Et.indexOf(o,t),a=Et.indexOf(o,e),c=Et.last(this.HeaderTopQuestionMasters);c&&(r=c.Model.Order);var u=this.findQuestionsInSection(t,!0).map((function(t){return t.Model}));if(s>a)n=e.Model.Order,a>0&&(r=o[a-1].Model.Order,(l=this.findQuestionsInSection(o[a-1])).length>0&&(r=Et.max(l,(function(t){return t.Model.Order})).Model.Order));else{if(!(s<a))return;var l=this.findQuestionsInSection(e);r=o[a].Model.Order,l.length>0&&(r=Et.max(l,(function(t){return t.Model.Order})).Model.Order),n=r+Yt.a.QuestionOrderDefaultStep*(u.length+1),a+1<o.length&&(n=o[a+1].Model.Order)}this.formMaster.bulkEdit((function(){return i.cv(t.Model,u,r,n)}))},n.insertElementAfter=function(t,e,n){var i=this;t=Et.clone(t);var r=[];n&&(r=n.map(Et.clone));var o=this.getAllElements(),s=Yt.a.QuestionOrderFloor,a=s+Yt.a.QuestionOrderDefaultStep;if(e){e instanceof te.d&&e.SubQuestionMasters.length>0&&(e=e.SubQuestionMasters[e.SubQuestionMasters.length-1]);var c=Et.indexOf(o,e.Model);c!==o.length-1?(s=e.Model.Order,a=o[c+1].Order):(s=e.Model.Order,a=e.Model.Order+Yt.a.QuestionOrderDefaultStep)}else o.length>0&&(a=o[0].Order);if(this.av(t,r,s,a),t.Id||(t.Id=this.ov(),r.forEach((function(e){e.Id=i.ov(),e.GroupId=t.Id}))),Yt.a.isDescriptiveElement(t.Type)){var u=Wt.a.Collection.addItems(this.formMaster.Model.DescriptiveElements,[t]);return Object(ke.c)(u[0])}var l=[t];return l=l.concat(r),u=Wt.a.Collection.addItems(this.formMaster.Model.Questions,l),Object(te.h)(u[0])},n.ov=function(){return"r"+Object(ye.c)().replace(/-/g,"")},n.av=function(t,e,n,i){var r=(i-n)/(e.length+2);t.Order=n+r,e.forEach((function(e,n){e.Order=t.Order+r*(n+1)}))},n.cv=function(t,e,n,i){var r=(i-n)/(e.length+2);t.Order=n+r,e.forEach((function(e,n){e.Order=t.Order+r*(n+1)}))},e}(Yt.a)}function Ye(){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return t.apply(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.updateWith=function(t,e,n){var i=this;this.bulkEdit((function(){i.clear(),i.initImageSetting(t,e,n)}))},n.initImageSetting=function(t,e,n){var i=this,r=this.Model;this.bulkEdit((function(){null==r.Layout&&(t.ResourceUrl||t.ImageProcessingStatus!==ee.c.Idle?(r.NaturalWidth=t.Width||e,r.NaturalHeight=t.Height||n,i.uv(),i.hv()):i.clear())}))},n.onImageStyleChange=function(t){var e=this,n=this.Model;n.Size!==t&&this.bulkEdit((function(){n.Size=t,e.hv()}))},n.clear=function(){return this.setData({},Wt.a.getSubFieldSchemas(this.Schema))},n.uv=function(){var t=this.Model;if(this.IsFormLogo)t.Size=ne.c.Small;else{var e=t.NaturalHeight/t.NaturalWidth;t.Layout=e>1?ne.a.Vertical:e<1?ne.a.Horizontal:ne.a.Square,t.Size=e<.5?ne.c.Large:ne.c.Small}},n.hv=function(){var t=this.Model,e=this.getDefaultImageSettings();for(var n in e)t[n]=Math.round(e[n])},e}(ne.b)}function tn(){return function(t){function e(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var i=t.apply(this,e)||this;return i.addRule({InterestedFields:[i.Schema.FormMaster],Name:"ClearRouting",onChange:function(t){i.Model.FormMaster||(i.Model.FormsProBranchingData=null,i.rm())}}),i.addRule({InterestedFields:[i.Schema.FlexPane],Name:"RecordFlexPaneType",onChange:function(t){i.Model.PreviousFlexPane=t.OldValues.FlexPane}}),i}Object(S.__extends)(e,t);var n=e.prototype;return e.getInstance=function(){return this.instance||(this.instance=new e),this.instance},n.designForm=function(t){var n=e.getInstance(),i=n.Model;Object(g.b)("DesignPage.Form.Navigate",{isGroupForm:t.IsGroupForm,myForm:t.Model.OwnerId===Object(u.a)().userInfo.UserId}),n.bulkEdit((function(){i.Analysis=!1,i.Grading=null,i.FormId=null,i.FormMaster=t,t.IsGroupForm||(i.GroupMaster=null),t.existingOnServerSide().then((function(){i.FormMaster===t&&(i.FormId=t.Model.Id)}))}))},n.copyBySharingLinkFinished=function(t){var e=this;window.history.replaceState({},"","#FormId="+t.Model.Id),this.bulkEdit((function(){var n=e.Model;n.CopyFormId=null,n.SharingToken=null,n.FormId=null==t?void 0:t.Model.Id,n.FormMaster=t}))},n.shouldShowDesignView=function(){var t=this.Model;return!!(t.FormId||t.CopyFormId||t.FormMaster)},n.showTopView=function(t,e){this.Model.TopView=t,this.topViewCloseCallback=e},n.hideTopView=function(){this.Model.TopView="None"},n.resetTopViewCloseCallback=function(){var t=this.topViewCloseCallback;return this.topViewCloseCallback=void 0,t},n.collapseFlexPaneIfNeeded=function(t){var n=e.getInstance().Model,i=n.FlexPane;if("None"!==i){var r="flex-pane-container-"+i,o=document.getElementById(r);o&&!o.contains(t)&&(n.FlexPane="None")}},n.getUniqueFormName=function(t,n){void 0===n&&(n=!1);var i=e.getInstance(),r=[];if(n)r=i.Model.GroupMaster.FormMasters.filter((function(t){return!t.Deleted})).map((function(t){return t.Model.Title}));else{r=Wt.a.convertToArray(i.Model.FormList).map((function(t){return t.Model.Title}));var o=Wt.a.convertToArray(i.Model.PlaceholderList).map((function(t){return t.Title}));r=r.concat(o)}return Object(fe.a)(t,Object(ae.a)().Designer_Title_autoRenameFormat,r)},n.rm=function(){var t=this;this.bulkEdit((function(){var e=t.Model;e.FormMaster=void 0,e.DataIdeas=!1,e.Analysis=!1,e.BranchingElementId=null,e.SectionElementId=null,e.Store=!1,e.Grading=null,e.Preview=null,e.FlexPane="None"}))},e}(Xt)}var en,nn=function(){function t(){}var e=t.prototype;return e.getMixinFormMaster=function(){return t.FormMasterClass||(t.FormMasterClass=Ke()),t.FormMasterClass},e.getMixinImageInfoMaster=function(){return t.ImageInfoMasterClass||(t.ImageInfoMasterClass=Je()),t.ImageInfoMasterClass},e.getMixinQuestionMaster=function(){return t.QuestionMasterClass||(t.QuestionMasterClass=Xe()),t.QuestionMasterClass},e.getMixinFormApi=function(){return t.FormApiClass||(t.FormApiClass=Ut(zt)),t.FormApiClass},e.getMixinFormElementManager=function(){return t.FormElementManagerClass||(t.FormElementManagerClass=Ze()),t.FormElementManagerClass},e.getMixinImageSettingsMaster=function(){return t.ImageSettingsMasterClass||(t.ImageSettingsMasterClass=Ye()),t.ImageSettingsMasterClass},e.getMixinDesignPageUxStateMaster=function(){return t.DesignPageUxStateMasterClass||(t.DesignPageUxStateMasterClass=tn()),t.DesignPageUxStateMasterClass},e.getMobileDesignPageUxStateMaster=function(){return re},e.getFileUploadConfirmDialog=function(){return le},t}(),rn=function(){function t(){this.fv=new me.a.CallbackManager,this.dv=!1}var e=t.prototype;return e.addBootCompleteListener=function(t){this.dv?t():this.fv.register(t)},e.raiseBootComplete=function(){this.dv=!0,this.fv.trigger("BootCompleted"),this.fv.clear()},t}();!function(t){t.FP_CreateFormMaster="forms.boot.create.fm",t.FP_ParseFormResponse="forms.boot.parse.rf",t.FP_RenderResponseForm="forms.boot.render.rf",t.FP_ParseResourceString="forms.boot.parse.rs",t.FP_LoadFeatureChunks="forms.boot.load.fc"}(en||(en={}));window.performance;function on(){if(window.performance&&window.performance.getEntriesByType){for(var t=function(){for(var t=[],e=window.performance.getEntriesByType("navigation"),n=0,i=e;n<i.length;n++){var r=i[n],o=sn(r);o.redirectStart=Math.round(r.redirectStart),o.redirectEnd=Math.round(r.redirectEnd),o.domainLookupEnd=Math.round(r.domainLookupEnd),o.secureConnectionStart=Math.round(r.secureConnectionStart),o.connectEnd=Math.round(r.connectEnd),o.type=r.type,o.initiatorType=r.initiatorType,o.domComplete=Math.round(r.domComplete),o.domContentLoadedEventStart=Math.round(r.domContentLoadedEventStart),o.domContentLoadedEventEnd=Math.round(r.domContentLoadedEventEnd),o.domInteractive=Math.round(r.domInteractive),o.duration=Math.round(r.duration),t.push(o)}return t}(),e=0,n=window.performance.getEntriesByType("resource");e<n.length;e++){var i=n[e];i&&i.name&&(/(basics|design-page.min|response-page.min).+\.js/.test(i.name.toLowerCase())&&t.push(sn(i)))}return t}}function sn(t){var e,n=function(t){return void 0===t?-1:t};return{connectStart:Math.round(t.connectStart),decodedBodySize:n(t.decodedBodySize),domainLookupStart:Math.round(t.domainLookupStart),encodedBodySize:n(t.encodedBodySize),fetchStart:Math.round(t.fetchStart),name:(e=t.name,e.substring(e.lastIndexOf("/")+1,e.indexOf("?")>0?e.indexOf("?"):e.length)),requestStart:Math.round(t.requestStart),responseEnd:Math.round(t.responseEnd),responseStart:Math.round(t.responseStart),transferSize:n(t.transferSize)}}var an,cn,un={};function ln(t){cn=t}function hn(){return cn}function fn(){if(!window.performance)return{};var t=window.performance.timing.navigationStart,e=Object(rt.b)(),n=window.NavKeyPoints,i=un;return i.navigationStart=t,i.serverPageTime=n?n.ServerPageTime:0,i.pageLoaded=n?n.PageStartTime:0,i.basicJsLoaded=n?n.BasicJsLoadedTime:0,i.mainJsLoaded=n?n.MainJsLoadedTime:0,i.formRenderEnd=e,i.timeToContentReady=e-t,i.timeToSpin=i.pageLoaded-t,i.resourceTiming=on(),i.page=window.location.pathname,i.mainJsStart=n?n.MainJsStartTime:0,i.mainCssStart=n?n.MainCssStartTime:0,i.mainCssLoaded=n?n.MainCssLoadedTime:0,i.fetchDataAndJsStart=n?n.FetchDataAndJsStart:0,i.fetchDataAndJsEnd=n?n.FetchDataAndJsEnd:0,i.lazyMainJsLoaded=n?n.LazyMainJsLoaded:0,i.getAuthTokenStart=n?n.GetAuthTokenStart:0,i.getAuthTokenEnd=n?n.GetAuthTokenEnd:0,i.getRuntimeFormEnd=n?n.GetRuntimeFormEnd:0,i.getResponsesEnd=n?n.GetResponsesEnd:0,i.getUserInfoEnd=n?n.GetUserInfoEnd:0,i.getThemesEnd=n?n.GetThemesEnd:0,i}function dn(t,e){un[t]=e}var bn=n(126),mn=n(61),vn=n(191),gn=function(){function t(){this.bv={},this.La=[],this.Mc=6,this.Lc=3,this.mv=[],this.vv=[],this.gv=[],this.Ov="",this.pv=null,this.jv=null,this.vl=Object(_t.b)().Model}var e=t.prototype;return e.Initialize=function(){this.mv=[],this.vv=[],this.gv=[],this.Ov="",this.vl.IntelligeceQuestionSuggestionStatus="Default"},Object.defineProperty(e,"IntelligenceQuestionBankOutput",{get:function(){return this.pv},set:function(t){this.pv=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"IntelligenceHistoryOutPut",{get:function(){return this.jv},set:function(t){this.jv=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"TemplateQuestions",{get:function(){return this.bv},set:function(t){this.bv=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SubQuestionCollection",{get:function(){return this.La},set:function(t){this.La=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"BankSuggestion",{get:function(){return this.mv},set:function(t){this.mv=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"MoreSuggestion",{get:function(){return this.vv},set:function(t){this.vv=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HistorySuggestion",{get:function(){return this.gv},set:function(t){this.gv=t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"HistoryFormTitle",{get:function(){return this.Ov},set:function(t){this.Ov=t},enumerable:!1,configurable:!0}),e.Remove=function(t){return this.mv=this.mv.filter((function(e){return e.QuestionTagForIntelligence!==t.QuestionTagForIntelligence})),this.mv},e.askSuggestion=function(t,e){var n=this;return new Promise((function(i){Promise.all([n.yv(t),n.wv(t,e)]).then((function(){switch(n.vl.IntelligeceQuestionSuggestionStatus){case"ShowBank":case"ShowBankAndHistory":n.HistorySuggestion.length?n.vl.IntelligeceQuestionSuggestionStatus="ShowBankAndHistory":n.vl.IntelligeceQuestionSuggestionStatus="ShowBank";break;default:n.HistorySuggestion.length?n.BankSuggestion.length?n.vl.IntelligeceQuestionSuggestionStatus="ShowHistoryAndBank":n.vl.IntelligeceQuestionSuggestionStatus="ShowHistory":n.BankSuggestion.length?n.vl.IntelligeceQuestionSuggestionStatus="ShowBank":n.vl.IntelligeceQuestionSuggestionStatus="Default"}i()}))}))},e.yv=function(t){var e=this;return new Promise((function(n,i){t.ensureFieldsReady([t.Schema.Settings,t.Schema.Title,t.Schema.Id]).then((function(){var r=t.SettingMaster.Model.IsQuizMode;if(Object(u.a)().userInfo.IsMsa||Object(et.r)())e.HistorySuggestion=[],n();else{var o="";t.isFieldReady(t.Schema.Id)&&(o=t.Model.Id),bn.a.createIntelligenceProvider().getHistorySuggestion(t.Model.Title,o).then((function(i){if(i.Result){var s=i.Result.Questions;e.HistorySuggestion=s.filter((function(e){return!t.FormElementManager.QuestionMasters.find((function(t){return t.Model.Title===e.Title}))&&"Question.MatrixChoice"!==e.Type&&"Question.MatrixChoiceGroup"!==e.Type})),e.HistoryFormTitle=i.Result.Title;var a={SuggestionType:i.SuggestionType};e.jv={ExtraData:JSON.stringify(a),Feature:"HistorySuggestion",ModelName:"HistorySuggestion",SuggestionId:"",Variation:"None"},Object(vn.logQuestionSuggestionSeen)(e.HistorySuggestion,e.IntelligenceHistoryOutPut)}else e.HistorySuggestion=[];Object(g.b)("Ingelligence.HistorySuggestion.Get",{Addressable:i.IsAddressable,FormId:o,IsQuiz:r}),n()})).catch((function(t){console.error(t),i()}))}}))}))},e.wv=function(t,e){var n=this;return t.ensureFieldsReady([Zt.a.Schema.Id,Zt.a.Schema.Questions]).then((function(){var n=t.FormElementManager.QuestionMasters.map((function(n){var i=!1;if(null===e){var r=t.FormElementManager.TopElementMasters;i=n===r[r.length-1]}else if("Title"!==e){i=n===e}return{IsTarget:i,QuestionTagForIntelligence:n.Model.QuestionTagForIntelligence,Title:n.Model.Title}}));n=n.filter((function(t){return!!t}));var i={Id:t.Model.Id,Questions:n,Title:t.Model.Title},r={Data:JSON.stringify(i),Feature:"TitleSuggestsQuestion"};return mn.a.askSuggestion(r)})).then((function(e){var i=e.Suggestion,r=i.map((function(t){return n.TemplateQuestions[t]?n.TemplateQuestions[t]:null})).filter((function(t){return null!==t}));if(r&&!Et.isEqual(n.BankSuggestion,r)){r=r.filter((function(e){return!t.FormElementManager.QuestionMasters.find((function(t){return t.Model.Title===e.Title}))&&!n.BankSuggestion.find((function(t){return e.QuestionTagForIntelligence===t.QuestionTagForIntelligence}))}));var o=n.BankSuggestion.length?n.Lc:n.Mc;n.MoreSuggestion=r.slice(o,i.length),r=r.slice(0,o);var s=Et.union(n.BankSuggestion,r);n.BankSuggestion=s,n.pv=e,Object(vn.logQuestionSuggestionSeen)(n.BankSuggestion,n.IntelligenceQuestionBankOutput)}}))},t}();var On=n(26),pn=n(9),jn=n(84),yn=n(16);var wn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=Et.extend({},this.props.HTMLAttributes,{id:"preview-setting-pane"});return t.className=Object(pn.b)("preview-setting-pane",t.className),oe.createElement("div",t,this.createViewModeButtons())},n.createViewModeButtons=function(){return[this.createDeviceSwitchButton(jn.a.Desktop,"TVMonitor",Object(ae.a)().Response_Preview_DeviceType_Desktop,Object(ae.a)().Response_Preview_DeviceType_Desktop_ScreenReader),this.createDeviceSwitchButton(jn.a.Mobile,"CellPhone",Object(ae.a)().Response_Preview_DeviceType_Mobile,Object(ae.a)().Response_Preview_DeviceType_Mobile_ScreenReader)]},n.createDeviceSwitchButton=function(t,e,n,i){var r=this;return Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":i,className:"preview-mode-button office-form-theme-button-color office-form-theme-select-color",onClick:function(){r.props.onValueChange(t),Object(g.b)("DesignPage.PreView.Navigate",{previewMode:jn.a[t]})}},Icon:e,IconClassName:Object(Z.b)()?"forms-icon-size16x16":"forms-icon-size20x20",key:jn.a[t],Text:n,TextClassName:"preview-mode-button-text",ToggleActive:t===this.props.Value})},e}(ue.a),Sn=n(77),Nn=function(){function t(){}var e=t.prototype;return e.createPreviewSettingPane=function(t){return function(t){return oe.createElement(wn,t)}(t)},e.addHeaderFontToSchemas=function(t){return t},e.addSurveyFontToSchemas=function(t){return t},e.getModifiedTextField=function(t,e){return t},e.getFooterElement=function(t){return t},e.getLazyLoadThemes=function(){return n.e(12).then(n.t.bind(null,1117,3)).then((function(t){return t.default}))},e.getDefaultTheme=function(){return{BackgroundColor:"#E8F2F4",BackgroundImage:null,Name:Sn.b,PrimaryColor:"#008272",SecondaryColor:"#004B50",Thumbnail:Object(On.b)("/Images/Theme/teal-thumbnail.png")}},e.getThemeBackground=function(t){return t},e.getThemeStyle=function(t){return""},e.getMediaPickerPaneText=function(){return null},e.areImageUploadButtonsEnabled=function(){return!0},e.getMediaPickerPaneTitle=function(){return null},e.getMediaPickerPaneInfoContent=function(){return null},e.getImagePickerLocalContainerClassName=function(){return null},e.getFlexPaneWidth=function(){return 600},e.getErrorPage=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(112).then(n.bind(null,1130))];case 1:return[2,{default:t.sent().ErrorPage}]}}))}))},t}();var In,Cn,kn=n(145);function Tn(t){var e=Et.clone(t);e.OwnerId=Object(u.a)().userInfo.UserId,e.OwnerTenantId=Object(u.a)().userInfo.TenantId,e.Background.ResourceUrl=Object(f.a)(e.Background.ResourceUrl),e.Settings=JSON.parse(e.settings);var n=e.OtherInfo,i=Object(Ge.d)(e,"User",!1);return i.Model.Background.IsPredefined=!0,i.Model.OtherInfo=n,i.fieldsReady([Zt.a.Schema.Id]).then((function(){return Object(g.b)("PortalView.Templates.Edit",{FormId:i?i.Model.Id:""}),i}))}function xn(t){var e=Object(u.a)().isCdnEnabled;return Object(ae.d)().then((function(n){return Et.map(t,(function(t){var i=JSON.stringify(t);return i=i.replace(/Template_\w*/g,(function(t,e,i){return n[t]?JSON.stringify(n[t]).slice(1,-1):t})),e&&(i=i.replace(/\/Images\/MSATemplate/g,Object(On.a)("/Images/MSATemplate"))),JSON.parse(i)}))}))}function Fn(){return Object(kn.a)().then((function(t){var e={},n=[];return Object.keys(t).map((function(e){return t[e].Questions})).forEach((function(t){Et.forEach(t,(function(t){var i=n.find((function(e){return e.GroupId===t.GroupId&&e.Title===t.Title}));t.GroupId&&"Question.MatrixChoice"===t.Type&&!i&&n.push(t),!!t.QuestionTagForIntelligence&&"Subjective"!==t.QuestionTagForIntelligence&&"Unknown"!==t.QuestionTagForIntelligence&&(e[t.QuestionTagForIntelligence]=t)}))})),{Item_1:e,Item_2:n}})).catch((function(t){return console.error(t),null}))}var Pn,Dn,Mn=n(137),Ln=n(20),An=n(69),Rn=n(75);function En(t){var e=Object(oe.useState)(!1),n=e[0],i=e[1],r=Object(ae.a)().GoPremium;return!n&&se.a.createElement("a",{"aria-label":r,className:"upsell-button o365sx-button",href:"javascript:void(0);",onClick:function(){return e=function(){t.onUpsellSuccess(),i(!0)},void(Dn?Object(Rn.a)("https://products.office.com/"):Pn?(Pn.launch({experience:"gopremium"},e).then((function(t){Object(g.b)("UpsellDialogClosed",t)})).catch((function(t){Dn=!0,Object(g.c)("LaunchDimeFailed",t)})),Object(g.b)("LaunchDime")):Object(Rn.a)("https://products.office.com/"));var e},style:{lineHeight:"normal"}},se.a.createElement("span",{className:"upsell-button-icon ms-Icon ms-forms-Icon--Diamond"}),se.a.createElement("span",{className:"upsell-button-text"},r))}function Bn(){if(!Pn)try{Pn=new Dime({authHint:Object(u.a)().userInfo.Email,language:Object(v.i)(),partnerId:"forms",sessionId:Object(ut.b)()}),Object(g.b)("InitializeDime")}catch(t){Dn=!0,Object(g.c)("InitializeDimeFailed")}return Pn}var _n,Hn=n(64),Gn=!0,qn=!1;function Qn(t){_n=Date.now(),Gn=!0,qn=t}function Vn(){var t=_n>0?_n:window.performance?window.performance.timing.navigationStart:Number.NaN,e={};return"boot"===zn()&&(e=fn()),e.navigationStart=t,e.cached=qn,e.type=zn(),e.formRenderEnd=Object(rt.b)(),Gn=!1,qn=!1,_n=0,e}function zn(){return _n>0?"withinPage":"boot"}var Un=n(18);function $n(t){return oe.createElement(Wn,t)}var Wn=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Sv=function(){return Object(S.__awaiter)(e,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){return this.forceUpdate(),this.Nv(),[2]}))}))},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.props.Form.observe(this.Sv,[Zt.a.Schema.IntegratedSavingState]),Object(ae.a)()||Object(ae.d)().then((function(){return t.Sv()}))},n.componentWillUnmount=function(){this.props.Form.unobserve(this.Sv),window.onbeforeunload=null},n.render=function(){var t=Et.extend({},this.props.HTMLAttributes);if(!Object(ae.a)())return null;if(t["aria-live"]="polite",gi())return t.className="suiteheader-savingstatus",oe.createElement("span",t,this.Iv());var e="saving-state";return Object(Y.c)("EnableSavingConfirmationOnAssignments")&&Object(Z.k)()&&window.parent&&(e="saving-state-assignments"),t.className=Object(pn.b)(t.className,e,!1),oe.createElement("div",t,this.Cv(),this.Iv())},n.Cv=function(){var t=this.props.Form.Model.IntegratedSavingState;if(!("Saving"!==t&&"Scheduled"!==t||Object(Y.c)("EnableSavingConfirmationOnAssignments")&&Object(Z.k)()))return Object(Un.b)({HTMLAttributes:{className:"auto-saving-icon forms-icon-size14x14"},IconName:"Sync"})},n.Iv=function(){switch(this.props.Form.Model.IntegratedSavingState){case"Saving":case"Scheduled":return Object(ae.a)().Designer_AutoSaver_Saving;case"Failed":case"NotStarted":return null;case"Idle":return Object(ae.a)().Designer_AutoSaver_Saved;default:Object(be.b)("Not supported")}},n.Nv=function(){switch(this.props.Form.Model.IntegratedSavingState){case"Saving":case"Scheduled":window.onbeforeunload=function(){return""},Object(Y.c)("EnableSavingConfirmationOnAssignments")&&Object(Z.k)()&&window.parent&&(window.onbeforeunload=null,window.parent.postMessage("Saving","*"));break;default:window.onbeforeunload=null,Object(Y.c)("EnableSavingConfirmationOnAssignments")&&Object(Z.k)()&&window.parent&&window.parent.postMessage("Saved","*")}},e}(ue.a),Kn=function(t){function e(e){var n=t.call(this,e)||this;return n.kv=oe.createRef(),n.Ut=Et.uniqueId("rt"),n.Tv=function(){return n.forceUpdate()},n.xv=n.xv.bind(n),n.Fv=n.Fv.bind(n),n.Pv=n.Pv.bind(n),n.Dv=n.Ut+"-title",n.Mv=n.Ut+"-time",n.Lv=n.Ut+"-text",n.state={DialogExpanded:!0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.props.Form.observe(this.Tv,[this.props.Form.Schema.RtcStatus]),Object(ae.a)()||Object(ae.d)().then(this.Tv)},n.componentWillUnmount=function(){this.props.Form.unobserve(this.Tv)},n.render=function(){if(!Object(Y.c)("RtcRefactor")||!Object(Y.c)("EnableStrictMode"))return null;if(!Object(ae.a)()||!gi())return null;var t=this.props.Form.Model;switch(t.RtcStatus){case 1:case 2:return null}var e=Object(ae.a)().DesignPage_SuiteHeader_RtcDisconnect_Tooltip,n=Object(ae.a)().DesignPage_SuiteHeader_RtcDisconnect_LastSync,i=new Date(t.LastSyncTime);n=(n||"").format(i.toLocaleString());var r=Object(yn.a)({ButtonStyle:"DarkBackGround",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-expanded":this.state.DialogExpanded,className:"rtc-icon",onClick:this.Fv},Icon:"AlertSolid",IconClassName:"forms-icon-size14x14",Text:e,ref:this.kv}),o=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"rtc-close",onClick:this.Pv},Icon:"Cancel",IconClassName:"forms-icon-size14x14",Text:Object(ae.a)().Common_Close_Text}),s=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-describedby":Object(pn.b)(this.Mv,this.Lv),className:"rtc-reconnect",onClick:this.xv},Text:Object(ae.a)().DesignPage_SuiteHeader_RtcDisconnect_Reconnect,TextClassName:"ms-fontSize-m ms-fontWeight-semibold"});return oe.createElement("div",{"aria-label":e,className:"suiteheader-connectionstatus",role:"alert"},r,oe.createElement(ce.a,{HTMLAttributes:{"aria-labelledby":this.Dv},ShowDialog:this.state.DialogExpanded,onDismiss:this.Pv},oe.createElement("div",{className:"rtc-shape-beak",role:"presentation"}),o,oe.createElement("div",{className:"rtc-title ms-fontSize-m ms-fontWeight-semibold",id:this.Dv},e),oe.createElement("div",{className:"rtc-timestamp ms-fontSize-s ms-fontWeight-semibold",id:this.Mv},n),oe.createElement("div",{className:"rtc-text ms-fontSize-s"},oe.createElement("span",{id:this.Lv},Object(ae.a)().DesignPage_SuiteHeader_RtcDisconnect_Description),oe.createElement("a",{"aria-describedby":this.Lv,href:"https://go.microsoft.com/fwlink/?linkid=2128982"},Object(ae.a)().Common_Text_LearnMoreLink)),s))},n.xv=function(){this.props.Form.startReceivingNotificationsV2(),this.Pv()},n.Fv=function(){this.setState({DialogExpanded:!this.state.DialogExpanded})},n.Pv=function(){var t=this;this.setState({DialogExpanded:!1},(function(){t.kv&&t.kv.current&&t.kv.current.focus()}))},e}(ue.a),Jn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(_t.b)();this.Av=this.Av.bind(this),t.observe(this.Av,[t.Schema.FormMaster]),this.onDidMount()},n.componentWillUnmount=function(){Object(_t.b)().unobserve(this.Av),this.onWillUnmount()},n.render=function(){return this.createControl()},n.onDidMount=function(){},n.onWillUnmount=function(){},n.Av=function(){this.onFormChanged()},e}(ue.a),Xn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createControl=function(){return this.Rv&&this.Rv.isFieldReady(this.Rv.Schema.Title)?oe.createElement("span",{className:"suiteheader-formname-container","aria-live":"polite"},oe.createElement("span",{className:"suiteheader-formtitle"},this.state.FormName),oe.createElement("span",{className:"suiteheader-savingstatusdash","aria-hidden":"true"},this.Ev()),$n({Form:this.Rv}),oe.createElement(Kn,{Form:this.Rv})):null},n.onFormChanged=function(){this.onWillUnmount(),this.onDidMount()},n.onDidMount=function(){this.Bv=this.Bv.bind(this),this.Rv=Object(_t.b)().Model.FormMaster,this.Rv&&this.Rv.observe(this.Bv,[this.Rv.Schema.Title,this.Rv.Schema.IntegratedSavingState]),this.Bv()},n.onWillUnmount=function(){this.Rv&&(this.Rv.unobserve(this.Bv),this.Rv=void 0)},n.Bv=function(){var t=this;this.Rv?this.Rv.ensureFieldsReady([this.Rv.Schema.Title]).then((function(){t.Rv&&t.setState({FormName:t.Rv.Model.Title})})):this.setState({FormName:""})},n.Ev=function(){return this.state.FormName&&"-"},e}(Jn),Zn=n(120);function Yn(t){return Promise.all([ei(),Object(ae.d)()]).then((function(e){var n=e[0],i={Id:"switchToFormsLink",Text:Object(ae.a)().HeadBar_FormsSwitcher_Text,Title:Object(ae.a)().HeadBar_FormsSwitcher_Title,Url:"javascript: FormsPro.onClickToggleFormsExperienceSwitchToForms()"},r={Id:"switchToFormsProLink",Text:Object(ae.a)().HeadBar_FormsProSwitcher_Text,Title:Object(ae.a)().HeadBar_FormsProSwitcher_Title,Url:"javascript: FormsPro.onClickToggleFormsExperienceSwitchToFormsPro()"};return n&&(Object(u.a)().isProPortal?t.push(i):t.push(r)),t}))}function ti(){Object(g.b)("DesignPage.ProIntroductionDialog.SwitchExperienceToFormsPro"),we.a.getInstance().createDataProvider().updateExperienceType(Object(u.a)().userInfo.TenantId,Object(u.a)().userInfo.UserId,"1").then((function(t){if(t){var e=window.location.pathname;e.toLowerCase().startsWith(Zn.a.toLowerCase())||(e=Zn.a+e);var n=location.origin+e;if(Object(Y.c)("BaseProFRE")&&!(location.href.indexOf("switch=")>=0)){var i="switch=true";n+=i=0===location.search.length?"?"+i:"&"+i}Object(p.f)(n)}}))}function ei(){return Promise.all([Object(st.e)(),Object(st.d)(),Object(st.h)(),Object(st.g)()]).then((function(t){var e=t[0],n=t[1],i=t[2];return t[3]&&(e||n||i)}),(function(){return!1}))}FormsPro.onClickToggleFormsExperienceSwitchToForms=function(){Object(g.e)({eventInfo:{Component:"ProIntroductionDialog",pageName:"PortalPage",tenantId:Object(u.a)().userInfo.TenantId,userId:Object(u.a)().userInfo.UserId},type:"MFPUI_BaseExperienceSwitcherClick"}),we.a.getInstance().createDataProvider().updateExperienceType(Object(u.a)().userInfo.TenantId,Object(u.a)().userInfo.UserId,"0").then((function(t){if(t){var e=window.location.pathname;e.toLowerCase().startsWith(Zn.a.toLowerCase())&&(e=e.substring(Zn.a.length)),Object(p.f)(location.origin+e)}}))},FormsPro.onClickToggleFormsExperienceSwitchToFormsPro=function(){if(Object(g.b)("DesignPage.SuiteHeader.SwitchExperienceToFormsPro"),Object(Y.c)("BaseProFRE")){var t=Object(_t.b)();t.bulkEdit((function(){t.Model.TopView="ShowProFRE"}))}else ti()},FormsPro.onConfirmSwitchToFormsPro=ti,FormsPro.shouldShowExpTeachingCallout=function(){return Object(Y.c)("BaseProFRE")&&location.href.indexOf("switch=true")>=0};var ni=n(109),ii=n(111),ri=n(157),oi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createControl=function(){return this.state.GroupName?oe.createElement("span",{className:"suiteheader-groupname-container"},oe.createElement("a",{href:"javascript:void(0)",onClick:e.gotoGroupFormList},this.state.GroupName)):null},n.onFormChanged=function(){this.Tv(Object(_t.b)().Model)},n.onDidMount=function(){this.Tv(Object(_t.b)().Model)},n.Tv=function(t){var e=this,n=t.FormMaster,i=t.GroupMaster;if(n&&n.IsGroupForm)if(i)i.ensureFieldsReady([i.Schema.displayName]).then((function(){e.setState({GroupName:i.Model.displayName})}));else{var r=Object(ri.b)();r.ensureFieldsReady([r.Schema.groups]).then((function(){var i=Et.find(r.Groups,(function(t){return t.Model.id===n.Model.OwnerId}));i&&(t.GroupMaster=i,i.ensureFieldsReady([i.Schema.displayName]).then((function(){e.setState({GroupName:i.Model.displayName})})),i.ensureFieldsReady([i.Schema.formReferences]))}))}else this.setState({GroupName:""})},e.gotoGroupFormList=function(){var t=Object(_t.b)();if(Object(Z.h)()){var e=t.Model.GroupMaster,n=null==e?void 0:e.Model.id;Object(ii.e)(n)}else"PortalPage"===Object(d.d)().origin?Object(ii.d)():(t.bulkEdit((function(e){t.hideTopView(),e.FormId=null,e.FormMaster=void 0,e.CriticalError=void 0,e.Token=null,e.SearchContent="",e.FormCollectionType="GroupForms",Object(Hn.c)()})),Object(ni.d)())},e}(Jn),si={Primary:"#008272"};function ai(){"undefined"!=typeof O365Shell&&(Object(u.a)().userInfo.IsMsa?ci():ci((function(){we.a.getInstance().createDataProvider().getShellNavBarData(Object(u.a)().cultureInfo.Name).then((function(t){if(t.navBarDataJson){var e=$.parseJSON(t.navBarDataJson);e.AppBrandTheme=si,e.DisableTheming=!0,O365Shell.SetData(e),mi()}}))})))}function ci(t){var e=this;Promise.all([Object(ii.c)(),Object(ae.d)()]).then((function(n){var i=n[0];n[1];return Object(S.__awaiter)(e,void 0,void 0,(function(){var e,n;return Object(S.__generator)(this,(function(r){switch(r.label){case 0:return n=(e=O365Shell).RenderAsync,[4,ui(i)];case 1:return n.apply(e,[r.sent(),function(){var e;Object(g.b)("DesignPage.SuiteHeader.Rendered"),t&&t(),mi(),(e=Object(_t.b)()).observe(vi,[e.Schema.TopView])},function(){}]),O365Shell.OnSignOut((function(t){t&&t.triggerEvent&&t.triggerEvent.preventDefault(),Object(g.b)("DesignPage.SuiteHeader.SignOut"),Object(Ht.a)().AuthContext.signOut()})),[2]}}))}))}))}function ui(t){return Object(S.__awaiter)(this,void 0,void 0,(function(){var e,n,i;return Object(S.__generator)(this,(function(r){switch(r.label){case 0:return e={AppBrandTheme:si,Culture:Object(u.a)().cultureInfo.Name||"en-us",DisableTheming:!0,IsConsumer:Object(u.a)().userInfo.IsMsa,ShellBootHost:Object(u.a)().o365ShellBootHost,UPN:Object(u.a)().userInfo.Upn,UserDisplayName:Object(u.a)().userInfo.DisplayName,UserID:Object(u.a)().userInfo.PUID,WorkloadId:"OfficeForms"},n=[],Object(v.q)()?[3,2]:[4,Yn(n)];case 1:n=r.sent(),r.label=2;case 2:return i={initialRenderData:e},[4,li()];case 3:return i.layout=r.sent(),i.OnHelpButtonClick=function(){return Object(g.b)("DesignPage.SuiteHeader.Help"),!1},i.sessionID=Object(ut.b)(),i.shellDataOverrides={CommunityLink:{},FeedbackLink:{},HelpLink:{Id:"FormHelpLink",TargetWindow:"_blank",Text:Object(ae.a)().DesignPage_NavBar_Help,Url:Object(ii.b)()},PrivacyLink:{Id:"FormPrivacyLink",TargetWindow:"_blank",Text:Object(ae.a)().Form_Footer_PrivacyStatement,Url:t}},i.top="reactshellheader",i.workloadMeSubLinks=n,[2,i]}}))}))}function li(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var t,e,n,i;return Object(S.__generator)(this,(function(r){switch(r.label){case 0:return t={},e={},n=[{children:[{nativeControlID:"O365Branding"}],justifyContent:"flex-start"},{children:[{flex:"1 0 auto",id:"FormCenterHeader",render:function(t){var e=oe.createElement("div",null,[oe.createElement(oi,{key:"headerGroupName"}),oe.createElement(Xn,{key:"headerFormName"})]);Ln.render(e,t)},responsiveBehavior:{delayMinimize:!1,minimizeBehavior:"hide",responsivePriority:1}}],flex:"1 0 auto",justifyContent:"center"}],i={},[4,hi()];case 1:return[2,(t.centerCustomizationRegion=(e.children=n.concat([(i.children=r.sent(),i.justifyContent="flex-end",i)]),e),t.flexPaneCollection=[],t.leftCustomizationRegion={includeAppLauncher:!0},t.rightCustomizationRegion={includeMeControl:!0},t)]}}))}))}function hi(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var t;return Object(S.__generator)(this,(function(e){return t=[],Object(st.i)().then((function(e){e&&(t.push({id:"GoPremiumDiamond",render:function(t){Ln.render(oe.createElement(En,{onUpsellSuccess:st.l}),t)}}),Object(g.b)("ShowUpsellDiamond"))})),t.push({nativeControlID:"HelpIcon"}),[2,t]}))}))}function fi(t){gi()&&"undefined"!=typeof O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.OnFlexPaneVisibilityChanged(t)}function di(t){gi()&&"undefined"!=typeof O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.RemoveOnFlexPaneVisibilityChanged(t)}function bi(){gi()&&"undefined"!=typeof O365Shell&&O365Shell.FlexPane&&O365Shell.FlexPane.CloseFlexPaneForProvider(null)}function mi(){Object(ae.d)().then((function(){var t=Object(u.a)().isProPortal||Object(v.q)()&&Object(at.e)()?Object(ae.a)().HeaderBar_FormsProAppTitle:Object(ae.a)().HeaderBar_AppTitle;O365Shell.Header.UpdateHeaderLink(t,"javascript: FormsOnHeaderAppNameClick()")}))}function vi(t){var e="";switch(Object(_t.b)().Model.TopView){case"Preview":case"Branch":case"Grading_ReviewAnswers":case"Grading_PostGrades":case"MultiLingualEditionView":case"SurveyResults":e="none",bi()}$("#reactshellheader").css("display",e)}function gi(){return!Object(Z.b)()&&!!Object(u.a)().o365ShellBootHost}window.FormsOnHeaderAppNameClick=function(){Object(Z.h)()?Object(ii.e)():"PortalPage"===Object(d.d)().origin?Object(ii.d)():(Qn("Loaded"===(t=Object(_t.b)()).Model.FormListLoadState),t.bulkEdit((function(e){t.hideTopView(),e.FormId=null,e.FormMaster=void 0,e.CriticalError=void 0,e.Token=null,e.FormCollectionType="OwnedForms",e.SearchContent="",Object(Hn.c)()})),Object(ni.d)());var t};var Oi=n(158),pi=n(131),ji=n(174),yi=n(121);var wi=n(204),Si=n(139),Ni=n(165),Ii=n(220),Ci=n(101),ki=n(218);var Ti=n(140),xi=n(91),Fi=n(40),Pi=n(39);function Di(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(119).then(n.bind(null,1131))];case 1:return[2,{default:t.sent().createRecycleBinView}]}}))}))}function Mi(t){var e=Object(Pi.a)(Mi,Di);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}var Li=function(t){function e(e){return t.call(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t,e=this.props.text,n=this.props.learnMoreLink;switch(this.props.level){case"Information":t=oe.createElement("div",{className:"formspro-info-notification"},oe.createElement("span",{className:"formspro-error-notification-left-image"},oe.createElement("img",{src:Object(On.b)("/Images/FormsPro/info.svg"),alt:Object(ae.a)().Alt_Image_No_Permissions})),oe.createElement("span",{className:"formspro-error-notification-text"}," ",e," "),this._v(n));break;case"Warning":t=this.props.warningClick?oe.createElement("div",{className:"formspro-warning-notification"},oe.createElement("span",{className:"formspro-warning-notification-left-image"}," ",oe.createElement("img",{src:Object(On.b)("/Images/FormsPro/warning-solid.svg")})," "),oe.createElement("span",{className:"formspro-warning-notification-text"}," ",e," "),null!=this.props.warningClickText&&oe.createElement("a",{className:"formspro-warning-link-text",href:"",onClick:this.props.warningClick.bind(this)}," ",this.props.warningClickText," ")):oe.createElement("div",{className:"formspro-warning-notification"},oe.createElement("span",{className:"formspro-error-notification-left-image"},oe.createElement("img",{src:Object(On.b)("/Images/FormsPro/warning.svg"),alt:Object(ae.a)().Alt_Image_No_Permissions})),oe.createElement("span",{className:"formspro-error-notification-text"}," ",e," "),this._v(n));break;case"Error":default:t=this.props.warningClick?oe.createElement("div",{className:"formspro-error-notification"},oe.createElement("span",{className:"formspro-error-notification-left-image"},oe.createElement("img",{src:Object(On.b)("/Images/FormsPro/error.svg"),alt:Object(ae.a)().Alt_Image_No_Permissions})),oe.createElement("span",{className:"formspro-error-notification-text"}," ",e," "),null!=this.props.warningClickText&&oe.createElement("a",{className:"formspro-warning-link-text",href:"",onClick:this.props.warningClick.bind(this)}," ",this.props.warningClickText," ")):oe.createElement("div",{className:"formspro-error-notification"},oe.createElement("span",{className:"formspro-error-notification-left-image"},oe.createElement("img",{src:Object(On.b)("/Images/FormsPro/error.svg"),alt:Object(ae.a)().Alt_Image_No_Permissions})),oe.createElement("span",{className:"formspro-error-notification-text"}," ",e," "),this._v(n))}return t},n._v=function(t){return""!==t&&null!=t?oe.createElement("a",{className:"formspro-learn-more-text",href:t,target:"_blank"},Object(ae.a)().LEARN_MORE):null},e}(ue.a),Ai=n(105);var Ri=n(72),Ei=n(32),Bi=n(159),_i=n(65),Hi=n(86),Gi=n(24),qi=function(t){function e(e){var n=t.call(this,e)||this;return n.Hv=n.Hv.bind(n),n.Gv=n.Gv.bind(n),n.state={closePopUp:!1,dialogIndex:0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){document.addEventListener("keyup",this.Hv,!1)},n.componentWillUnmount=function(){document.removeEventListener("keyup",this.Hv,!1)},n.render=function(){return this.state.closePopUp?null:this.qv()},n.qv=function(){return oe.createElement("div",{className:"form-introduction-dialog-div"},oe.createElement("div",{className:"form-introduction-dialog-get-start-container"},this.Qv(),this.qc(),this.Vv(),this.zv()),this.au())},n.Uv=function(){var t=null;switch(this.state.dialogIndex){case 0:t=Vi("/Images/excelSurveyIntroductionDialog/ExcelSurvey_AccessSurvey.png",Object(ae.a)().ExcelSurvey_IntroductionDialog_AcessInfo.format(Object(ae.a)().HeaderBar_AppTitle));break;case 1:t=Vi("/Images/excelSurveyIntroductionDialog/ExcelSurvey_OneDrive.png",Object(ae.a)().ExcelSurvey_IntroductionDialog_SwitchInfo);break;case 2:t=oe.createElement("div",null,Qi("/Images/PortalMyForms/Forms_info_1.png","excelsurvey-introduction-fre-welcome-img",Object(ae.a)().Form_Introduction_Dialog_Introduction_1),Qi("/Images/PortalMyForms/Forms_info_2.png","excelsurvey-introduction-fre-welcome-img",Object(ae.a)().Form_Introduction_Dialog_Introduction_2),Qi("/Images/PortalMyForms/Forms_info_3.png","excelsurvey-introduction-fre-welcome-img",Object(ae.a)().Form_Introduction_Dialog_Introduction_3))}return t},n.Qv=function(){return oe.createElement("div",{className:"excelsurvey-introduction-dialog-container"},oe.createElement("div",{className:"excelsurvey-introduction-dialog-title-container"},oe.createElement("div",{className:"excelsurvey-introduction-dialog-title1"},Object(ae.a)().Form_Introduction_Dialog_Title2),oe.createElement("div",{className:"excelsurvey-introduction-dialog-title2"},Object(ae.a)().ExcelSurvey_IntroductionDialog_SubTitle)),oe.createElement("div",{className:"excelsurvey-introduction-dialog-image-container"},this.Uv(),this.$v()))},n.Gv=function(t,e){switch(t.keyCode){case 32:case 13:this.setState({dialogIndex:e})}},n.au=function(){for(var t=this,e=[],n=function(n){var r="excelsurvey-introduction-dialog-gallery-dot",o={className:r=Object(pn.b)(r,n===i.state.dialogIndex?"active":"inactive"),onClick:function(){t.setState({dialogIndex:n})},onKeyUp:function(e){return t.Gv(e,n)},tabIndex:0};e.push(oe.createElement("div",Object(S.__assign)({},o)))},i=this,r=0;r<3;r++)n(r);return oe.createElement("div",{className:"excelsurvey-introduction-dialog-gallery"},oe.createElement("div",{className:"excelsurvey-introduction-dialog-gallery-dots-container"},e))},n.qc=function(){var t=this;return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"excelsurvey-introduction-dialog-close-button",onClick:function(){t.Wv()}},Icon:"Cancel",IconClassName:"excelsurvey-introduction-dialog-close-icon forms-icon-size16x16",Text:Object(ae.a)().Common_Close_Text})},n.Hv=function(t){27===t.keyCode&&this.Wv()},n.$v=function(){var t=this;return 2===this.state.dialogIndex?Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"excelsurvey-introduction-dialog-gotit-button",onClick:function(){t.Wv()}},Text:Object(ae.a)().TeachingUi_GotIt}):null},n.Vv=function(){var t=this;return this.state.dialogIndex>0&&this.state.dialogIndex<3?Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"excelsurvey-introduction-dialog-previous-button",onClick:function(){t.setState({dialogIndex:t.state.dialogIndex-1})}},Icon:"ChevronLeft",IconClassName:"excelsurvey-introduction-dialog-previous-icon forms-icon-size36x36"}):null},n.zv=function(){var t=this;return this.state.dialogIndex>=0&&this.state.dialogIndex<2?Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"excelsurvey-introduction-dialog-next-button",onClick:function(){t.setState({dialogIndex:t.state.dialogIndex+1})}},Icon:"ChevronRight",IconClassName:"excelsurvey-introduction-dialog-next-icon forms-icon-size36x36"}):null},n.Wv=function(){this.setState({closePopUp:!0}),Object(Ei.c)().Model.ExcelSurveyIntroduction=_i.a.toString()},e}(ue.a);function Qi(t,e,n){return oe.createElement("div",{className:"excelsurvey-introduction-dialog-welcome-image"},oe.createElement(Hi.a,{className:e,src:t,"aria-hidden":"true"}),oe.createElement("div",{className:"excelsurvey-introduction-dialog-image-welcome-text"},n))}function Vi(t,e){return oe.createElement("div",{className:"excelsurvey-introduction-dialog-image"},oe.createElement("div",{className:"excelsurvey-introduction-dialog-image-text"},e),oe.createElement(Hi.a,{className:"excelsurvey-introduction-fre-img",src:t,"aria-hidden":"true"}))}var zi=n(138),Ui=function(){function t(){this.Kv=!1,this.Jv=!1,this.Xv={},this.Zv=this.Zv.bind(this),this.Yv=new $i(this,this.Zv),this.tg=function(){},this.Yv.grab()}var e=t.prototype;return e.getDefaultGrabber=function(){return this.Yv},e.getCurrentOwner=function(){return this.eg},e.getLocked=function(){return this.Jv},e.setLocked=function(t){this.Jv=!!t},e.createGrabber=function(t){if(t&&t in this.Xv)throw Error("Duplicated key while creating grabber");var e=new Wi(this,this.Zv,t);return t&&(this.Xv[t]=e),e},e.getGrabberByName=function(t){return this.Xv[t]},e.Zv=function(t,e){if(this.Kv||this.Jv)return!1;this.Kv=!0;var n=this.tg;return this.eg=t,this.tg=e,n(),this.Kv=!1,!0},t}(),$i=function(){function t(t,e){this.ng=new me.a.CallbackManager,this.grabbable=t,this.ig=e,this.tg=this.tg.bind(this)}var e=t.prototype;return e.getName=function(){return null},e.grab=function(){return!!this.ig(this,this.tg)&&(this.ng.trigger("grabbed"),!1)},e.focus=function(){return!!this.ig(this,this.tg)&&(this.ng.trigger("focused"),!1)},e.currentlyOwning=function(){return this.grabbable.getCurrentOwner()===this},e.lock=function(){return!!this.currentlyOwning()&&(this.grabbable.setLocked(!0),!0)},e.unlock=function(){this.currentlyOwning()&&this.grabbable.setLocked(!1)},e.observe=function(t){this.ng.register(t)},e.unobserve=function(t){this.ng.unregister(t)},e.tg=function(){this.ng.trigger("released")},t}(),Wi=function(t){function e(e,n,i){var r=t.call(this,e,n)||this;return r.rg=i||null,r}Object(S.__extends)(e,t);var n=e.prototype;return n.getName=function(){return this.rg},n.handsOff=function(){this.currentlyOwning()&&this.grabbable.getDefaultGrabber().grab()},e}($i),Ki=n(89),Ji=n(103),Xi=n(178),Zi=n(117),Yi=n(175),tr=function(){function t(e){if(t._instance)return t._instance;t._instance=this,this.og=e,Object(et.b)(this.og,"math service url is null")}var e=t.prototype;return t.getInstance=function(){return new t(t.getFormMathServiceUrl())},t.getFormMathServiceUrl=function(){return we.a.getInstance().getServiceUrl("formmath/api/")},e.mathFormulaCalculation=function(t){if(!t||!t.Mathml){return Promise.resolve({Aria:"",Responses:[]})}return er({data:{Context:t.Context,Formulas:[t.Mathml],InputFormat:"MathML",Locale:navigator.language,Mode:1,Origin:t.Origin,OutputFormat:"latex",RequiredIncorrectAnswerCount:t.IncorrectAnswerCount},method:"POST",requestUri:this.og+"mathapi/calculation?formId="+t.FormId+"&questionId="+t.QuestionId,qosEventName:"Question.MathCalculation"})},e.mathQuestionGeneration=function(t,e){if(!t.Context){return Promise.resolve({Features:0,Results:[]})}var n={data:{Features:t.Features,Input:t.Context,InputFormat:"MathML",Locale:navigator.language,Origin:t.Origin,OutputFormat:"latex",RequiredQuestionsCount:t.QuestionCount,RequiredIncorrectAnswerCount:t.IncorrectAnswerCount},method:"POST",requestUri:this.og+"mathapi/questions?formId="+t.FormId+"&questionId="+t.QuestionId,qosEventName:"Question.MathQuestionGeneration"};return e&&"error"!==e?function(t,e,n){return Promise.resolve(n||nr()).then((function(n){var i,r,o;return t.headers=$.extend(!0,t.headers,(r={Accept:"application/json",Authorization:(i=n)?"Bearer "+i:"",__RequestVerificationToken:Object(u.a)().antiForgeryToken,AnalyzerToken:Object(d.d)().AnalyzerToken,ValidationToken:Object(d.d)().vt},o=Object(d.b)().Token,r.ShareInvitationKey=o||Object(d.d)().Token,r)),Object(Gt.a)(t,e).then(Qt.c,Qt.b)}))}(n,{},e):er(n)},t}();function er(t){return nr().then((function(e){return t.headers=$.extend(!0,t.headers,{Accept:"application/json",Authorization:e?"Bearer "+e:"",__RequestVerificationToken:Object(u.a)().antiForgeryToken}),Object(Gt.a)(t).then((function(t){Object(et.b)(t,"math calculation result is null");var e=Object(Qt.c)(t);return Object(et.b)(e,"math calculation result parse failure"),e}),Qt.b)}))}function nr(){return Object(Ht.a)().AuthContext.getFormApiToken()}var ir,rr=n(55),or=n(42),sr=n(106),ar=n(27),cr=function(t){function e(e){var n=t.call(this,e)||this;return n.sg=oe.createRef(),n.ag=n.ag.bind(n),n.cg=n.cg.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.shouldComponentUpdate=function(t){return!this.lg||(this.hg=!0,!1)},n.componentWillMount=function(){var t=this;Object(An.a)("Sortable").then((function(){t.setState({SortableLoaded:!0})}))},n.componentDidMount=function(){this.state.SortableLoaded&&!this.props.Disabled&&this.fg()},n.componentDidUpdate=function(){this.props.Disabled||this.dg||!this.state.SortableLoaded||this.fg()},n.componentWillUnmount=function(){this.dg&&this.dg.destroy()},n.render=function(){return oe.createElement("div",{ref:this.sg},this.props.children)},n.fg=function(){var t=this.sg.current;t&&(this.dg=Sortable.create(t,{animation:100,chosenClass:this.props.ChosenClass,fallbackClass:this.props.FallbackClass,forceFallback:!0,ghostClass:this.props.GhostClass,handle:"."+this.props.Handler,onEnd:this.ag,onStart:this.cg,preventOnFilter:!1}))},n.ag=function(t){this.lg=!1;var e=!1,n=t.oldIndex,i=t.newIndex;if(n!==i){var r=this.sg.current;n<i?$(r).children(":eq("+n+")").before($(t.item)):n>i&&$(r).children(":eq("+n+")").after($(t.item)),e=this.props.onExchange(n,i)}this.hg&&!e&&(this.forceUpdate(),this.hg=!1)},n.cg=function(){this.lg=!0},e}(ue.a),ur=n(179),lr=n(67),hr=n(59),fr=function(t){function e(e,n){var i=t.call(this,e)||this;return i.mg=n,i.blockEndDesignMode=i.blockEndDesignMode.bind(i),i.mathCalculation=i.mathCalculation.bind(i),i.vg=i.vg.bind(i),i.gg=i.gg.bind(i),i.Og=i.Og.bind(i),i}Object(S.__extends)(e,t);var n=e.prototype;return n.createMathBar=function(){var t=this.props.Master.Model;if(t.IsPlainTextInMathField){var e={AutoFocus:hr.c===this.state.SelectedElementIndex,AutoSelection:!0,HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(hr.c),{className:"design-question-math-plaintext-text"}),MaxLength:Object(Pe.H)(),MinimalHeight:Object(Pe.j)(),onValueChange:this.vg,Options:{HTMLPropsForInnerElement:{className:"design-question-math-plaintext-text"}},Placeholder:Object(ae.a)().Designer_PlaceholderForQuestionSubtitle,Value:t.Subtitle||""};return oe.createElement("div",{className:"design-question-math-plaintext",ref:this.getElementRef(hr.c)},Object(ar.b)(e),this.vs())}var n=Object(pn.g)(this.getElementFocusingProps(hr.c),{className:this.state.SelectedElementIndex===hr.c?"active":""});return oe.createElement("div",{className:"design-question-math-container",ref:this.getElementRef(hr.c)},oe.createElement(rr.a,{blockEndDesignMode:this.blockEndDesignMode,Disabled:!1,HasFocus:hr.c===this.state.SelectedElementIndex,HTMLAttributes:n,Location:this.mg,onRenderComplete:this.mathCalculation,onValueChange:this.vg,Placeholder:Object(ae.a)().Designer_PlaceholderForQuestionFormula,QuestionId:t.Id,Value:t.Subtitle||""},this.vs()))},n.createMathItem=function(){var t,e=this.props.Master.Model;return e.IsQuiz&&!Object(v.w)()&&(t={Checked:e.IsMathQuiz,Description:Object(ae.a)().Designer_MenuItemForMathLabel,Key:"mathItem",MenuItemType:1,onExecute:this.gg}),t},n.mathCalculation=function(t,e){},n.blockEndDesignMode=function(t){this.props.DesignFocus.setLocked(t)},n.vg=function(t){this.props.Master.Model.Subtitle=t},n.vs=function(){var t,e,n,i,r=this.props.Master.Model,o="design-question-choice-to-math-button";return this.props.IsMobile&&(o=Object(pn.b)(o,"isMobile")),hr.c===this.state.SelectedElementIndex&&(o=Object(pn.b)(o,"active-choice")),r.IsPlainTextInMathField?(t={className:o,onClick:this.Og},e="NumberField",n=Object(ae.a)().Designer_Question_Equation_Button,i=Object(ae.a)().Designer_Question_Equation_Button_Tooltip):(t={className:o,onClick:this.Og},e="TextField",n=Object(ae.a)().Designer_Question_EquationToText_Button,i=Object(ae.a)().Designer_Question_EquationToText_Button_Tooltip),Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(hr.c),t),Icon:e,IconClassName:"design-question-choice-to-math-button-icon",Text:n,Tooltip:i})},n.Og=function(t){var e=this.props.Master.Model;e.IsPlainTextInMathField=!e.IsPlainTextInMathField,Object(g.b)(e.IsPlainTextInMathField?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:this.mg,questionId:e.Id}),this.forceUpdate()},n.gg=function(){var t=this.props.Master,e=t.Model;Object(g.b)("DesignPage.QuestionMenu.MathOption",{questionType:e.Type,value:!!e.IsMathQuiz}),t.bulkEdit((function(){e.IsMathQuiz=!e.IsMathQuiz;var t=new lr.a(e).getAnswers();e.IsMathQuiz?(e.ShowSubtitle=!0,e.OptionDisplayStyle=te.c.ListAll,Et.forEach(e.Choices,(function(t){t.IsGenerated&&(t.Description=""),t.IsMathOption=!0})),e.IsAnswerPlainText=!1,"Question.TextField"===e.Type&&(t&&t.length>0?(e.IsMathInputDefault=!1,e.InputSwitcherDisabled=!0):(e.IsMathInputDefault=!0,e.InputSwitcherDisabled=!1))):(Et.forEach(e.Choices,(function(t){t.IsMathOption=!1})),e.IsAnswerPlainText=!0,"Question.TextField"===e.Type&&(Et.each(t,(function(t){t.isMath=!1})),e.GradingBasis=JSON.stringify(t),e.InputSwitcherDisabled=!0,e.IsMathInputDefault=!1))}))},e}(hr.a);!function(t){t[t.None=0]="None",t[t.OptionSuggestionFromTitle=1]="OptionSuggestionFromTitle",t[t.OptionSuggestionFromOption=2]="OptionSuggestionFromOption",t[t.Math=3]="Math"}(ir||(ir={}));var dr=function(t){function e(e){var n=t.call(this,e,"Choice.Subtitle")||this;return n.pg=oe.createRef(),n.jg=oe.createRef(),n.ce=!0,n.yg="",n.wg={Mathml:"",OriginalText:""},n.Sg=!1,n.Ng=!1,n.Ig=null,n.Cg=null,n.kg=-1,n.Tg=-1,n.xg=function(){return n.Fg()},n.Pg=n.Pg.bind(n),n.Dg=n.Dg.bind(n),n.Mg=n.Mg.bind(n),n.Lg=n.Lg.bind(n),n.Ag=n.Ag.bind(n),n.Rg=n.Rg.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){if(t.prototype.componentDidMount.call(this),this.Eg(),!Object(v.w)()){var e=this.props.Master;e.observe(this.xg,[e.Schema.Choices[0].Description])}},n.componentWillUnmount=function(){(this.ce=!1,t.prototype.componentWillUnmount.call(this),Object(v.w)())||this.props.Master.unobserve(this.xg)},n.createReactNodes=function(){var t=this;return Object(at.c)((function(){return[t.Vo(),t.createAnswerTagDiv(t.props.Master.Model.FormsProAnswerTag)]}),at.f)},n.onTitleValueChange=function(){this.Eg(),this.Bg()},n.createMoreMenuItems=function(){var e,n,i=this.props.Master.Model;if("Question.Choice"===i.Type){e={Checked:i.ShuffleOptions,Description:Object(ae.a)().Designer_QuestinMenu_ShuffleOptions,Key:"shuffleItem",MenuItemType:1,onExecute:function(){Object(g.b)("DesignPage.QuestionMenu.ShuffleOptions",{questionType:i.Type,value:i.ShuffleOptions}),i.ShuffleOptions=!i.ShuffleOptions}}}"Question.Choice"!==i.Type||i.IsMathQuiz||i.ChoiceType===te.a.MultiChoice||(n={Checked:i.OptionDisplayStyle===te.c.Dropdown,Description:Object(ae.a)().Designer_AllowDropDown,Key:"dropdownItem",MenuItemType:1,onExecute:function(){Object(g.b)("DesignPage.QuestionMenu.DropDown",{questionType:i.Type}),i.OptionDisplayStyle=i.OptionDisplayStyle===te.c.Dropdown?te.c.ListAll:te.c.Dropdown}});var r=[e,this.createValidationItem(),n,this.createMathItem(),!1].filter((function(t){return!!t}));return r=r.concat(t.prototype.createMoreMenuItems.call(this))},n.createSuggestionBar=function(){var t=this,e=this.state;if(this.state.ChoiceCandidates&&(this.props.Master.Model.IsMathQuiz||e.IntelligenceProvider!==ir.Math)){var n=e.ChoiceCandidates.filter((function(n){return!t._g(n.text,e.IntelligenceProvider===ir.Math)}));if(n.length){e.IntelligenceProvider===ir.Math?this.Hg():this.Sg||(this.Gg(),this.Sg=!0);var i=[],r=void 0,o=void 0,s=Object(pn.b)("design-question-choice-candidate office-form-theme-primary-foreground","office-form-theme-bgcolor-hover");switch(e.IntelligenceProvider){case ir.OptionSuggestionFromTitle:i=[Object(ae.a)().Designer_Intelligence_Options];var a={ButtonStyle:"LightBackground",HTMLAttributes:{className:"design-question-choice-candidate office-form-theme-button",onClick:function(){n.forEach((function(e){return t.qg(e.text)})),t.setFocusToTitleElement()}},key:"option_addAll",Text:Object(ae.a)().Designer_Intelligence_AddAll};r=oe.createElement(Gi.a,Object(S.__assign)({},a)),o=n.map((function(e,i){var r={ButtonStyle:"LightBackground",HTMLAttributes:{className:s,onClick:function(r){t.qg(e.text),1!==n.length&&i!==n.length-1||t.setFocusToTitleElement()}},Text:e.text};return oe.createElement(Gi.a,Object(S.__assign)({key:"option_"+i},r))}));break;case ir.Math:if(i=[Object(ae.a)().Designer_Intelligence_Results],n.length>1){var c={ButtonStyle:"LightBackground",HTMLAttributes:{className:"design-question-choice-candidate office-form-theme-button",onClick:function(){n.forEach((function(e){return t.qg(e.text,e.isAnswer)})),t.setFocusToTitleElement()}},key:"option_addAll",Text:Object(ae.a)().Designer_Intelligence_AddAll};r=oe.createElement(Gi.a,Object(S.__assign)({},c))}o=n.map((function(e,n){var i,r;return e.isAnswer&&(i="CheckMark",r="design-question-choice-candidate-icon-correct forms-icon-size16x16"),Object(yn.a)({ButtonStyle:"LightBackground",children:Object(rr.c)({Formula:e.text}),GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:Object(pn.b)("design-question-choice-candidate-math office-form-theme-primary-foreground","office-form-theme-bgcolor-hover"),onClick:function(){t.qg(e.text,e.isAnswer),t.setState({SelectedElementIndex:hr.c});var n=t.getElementRef(hr.c).current;n&&$(n).find(".design-formula-mixer").focus()},title:e.isAnswer?Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel:Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel},Icon:i,IconClassName:r,key:"option_"+n})}))}return oe.createElement("div",{className:"design-question-candidate-bar"},i.concat(r,o))}}},n.mathCalculation=function(t,e){var n=this;if(this.wg={Mathml:e,OriginalText:t},t&&e){this.props.Master.Model.LastMathMLFormula=e;var i=this.props.Master.Model.Title+Yi.a+t,r=this.props.Master.Form.Model.Id,o=this.props.Master.Model.Id;tr.getInstance().mathFormulaCalculation({Context:i,FormId:r,IncorrectAnswerCount:3,Mathml:e,Origin:"ChoiceQuestion",QuestionId:o}).then((function(t){n.ce&&(Object(et.b)(t&&t.Responses,"math calculation result is null in question designer"),n.setState({ChoiceCandidates:t.Responses.map((function(t){return{isAnswer:t.Answer.IsCorrect,text:t.Answer.Formula,title:t.Answer.IsCorrect?Object(ae.a)().Designer_Question_Choice_CorrectAnswer_Tooltip:Object(ae.a)().Designer_Question_Choice_IncorrectAnswer_Tooltip}})),IntelligenceProvider:ir.Math}))}))}else this.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None})},n.Qg=function(){return this.state.ShowDeleteOptionDialog&&oe.createElement(ur.a,{ClassName:"design-question-button-two-line-container",clickCancelButton:this.Ag,clickDeleteQuestion:this.Rg,Description:Object(ae.a)().MFPBranchingRules_Delete_Option_Popup_Desc})},n.Ag=function(){this.setState({ShowDeleteOptionDialog:!1})},n.Rg=function(){this.setState({ShowDeleteOptionDialog:!1}),this.Vg(null,this.Tg)},n.Eg=function(){var t=this,e=this.props.Master.Model;if(!e.IsMathQuiz){window.clearTimeout(this.zg),this.zg=window.setTimeout((function(){mn.a.getChoiceOptionSuggestion(e.Title).then((function(e){t.ce&&(e&&e.MatchQuery&&e.Suggestion?t.setState({ChoiceCandidates:e.Suggestion.ChoiceCandidates.map((function(t){return{text:t}})),IntelligenceProvider:ir.OptionSuggestionFromTitle,MatchingPart:e.Suggestion.MatchingPart}):t.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None}))})).catch((function(e){t.ce&&t.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None})}))}),500)}},n.Fg=function(){var t=this,e=this.props.Master.Model;if(!(e.IsMathQuiz||this.state.ChoiceCandidates&&this.state.ChoiceCandidates.length>0&&this.state.IntelligenceProvider!==ir.OptionSuggestionFromOption)){var n=Et.filter(e.Choices,(function(t){return!t.IsGenerated}));if(0!==n.length){window.clearTimeout(this.zg);this.zg=window.setTimeout((function(){if(Object(Y.c)("FrontDoorOptionToOption")){var e={Data:n.map((function(t){return t.Description})),Feature:"ChoiceOptionSuggestsOption"};mn.a.askSuggestion(e).then((function(e){t.Ug(e.MatchQuery,e.Suggestion,JSON.stringify(e.ExtraData),e)})).catch((function(e){t.ce&&t.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None})}))}else mn.a.getOptionToOptionSuggestion(n.map((function(t){return t.Description})),"ChoiceOptionSuggestsOption").then((function(e){t.Ug(e.MatchQuery,e.Result.ChoiceCandidates,e.Result.MatchingPart)})).catch((function(e){t.ce&&t.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None})}))}),500)}else this.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None})}},n.Ug=function(t,e,n,i){var r=this;void 0===i&&(i=null),this.ce&&t&&(e&&e.length>0?this.setState({ChoiceCandidates:e.map((function(t){return{text:t}})),IntelligenceProvider:ir.OptionSuggestionFromOption,MatchingPart:n},(function(){r.yg=Object(ye.c)(),r.Gg(),Object(Y.c)("FrontDoorOptionToOption")&&(r.Ig=i,mn.a.logSuggestionSeen("Show",i))})):(Object(g.b)("IntelligenceStatistic.ChoiceOptionSuggestion.NoShow",{candidateType:ir[ir.OptionSuggestionFromOption],matchingPart:n,msftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),questionId:this.props.Master.Model.Id}),this.setState({ChoiceCandidates:[],IntelligenceProvider:ir.None})))},n.Bg=function(){var t=this,e=this.props.Master.Model;if(e.IsMathQuiz&&!e.IsPlainTextInMathField){window.clearTimeout(this.$g),this.$g=window.setTimeout((function(){t.mathCalculation(t.wg.OriginalText,t.wg.Mathml)}),1e3)}},n._g=function(t,e){var n=this.props.Master.Model.Choices;return Et.some(n,(function(n){return!!n.Description&&(e?n.Description.replace(/\s/g,"")===t.replace(/\s/g,""):n.Description===t)}))},n.qg=function(t,e){this.state.IntelligenceProvider===ir.Math?this.Wg(t,e):this.Kg(t);var n=this.props.Master,i=n.insertChoice(t,this.state.IntelligenceProvider===ir.Math);e&&n.setAnswerKey(i,!0)},n.Vo=function(){var t,e=this,n=this.props.Master.Model,i=n.Choices,r=i.length,o=oe.createElement("div",{className:"design-question-choice-options-div",key:"choiceMainContainer"},oe.createElement(cr,{ChosenClass:"design-question-choice-chosen",Disabled:!1,FallbackClass:"design-question-drag-fallback",GhostClass:"design-question-drag-ghost",Handler:"design-question-drag-handler",onExchange:this.Lg},Et.map(i,(function(t,n){return e.Jg(t,n)})))),s={className:"design-question-button office-form-theme-button-color",onClick:function(){Object(g.b)("DesignPage.Questions.AddOption",{index:r,questionId:n.Id,questionType:n.Type}),e.Xg(r)}},a=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:s,Icon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",ref:this.pg,Text:Object(ae.a)().Designer_AddOneMore,TextClassName:"design-question-addonemore"});if(!n.AllowOtherAnswer&&!n.IsQuiz){var c={className:"design-question-button office-form-theme-button-color",onClick:this.Dg};t=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:c,Text:Object(ae.a)().Designer_AllowOtherAnswer,TextClassName:"design-question-addothermore"})}return oe.createElement("div",{className:"design-question-all-choices",key:"choices"},o,this.Zg(),this.Yg(),oe.createElement("div",{className:"design-question-add-option-container",key:"addOptionContainer"},oe.createElement("div",{className:"design-question-add-option-element"},a),oe.createElement("div",{className:"design-question-add-option-element"},t)))},n.Lg=function(t,e){var n=this.props.Master,i=n.getSnapshot([Object(_t.i)().Schema.Choices]).Choices;return!(t>=i.length||e>=i.length)&&(n.bulkEdit((function(r){var o=Wt.a.convertToArray(i),s=o.splice(t,1);o.splice(e,0,s[0]),r.Choices=o,r.IsQuiz||Object(b.d)()||sr.a.handleChoicesV1Exchange(t,e,r.Id,n.Form)})),!0)},n.Dg=function(){var t=this;Object(g.b)("DesignPage.Questions.AddOtherOption",{questionType:this.props.Master.Model.Type}),this.onUpdateDone((function(){var e=t.pg.current;e&&e.focus()})),this.props.Master.Model.AllowOtherAnswer=!0},n.Jg=function(t,n){var i=this.props.Master,r=i.Model,o=!1,s=i.showAsDropdown(),a=r.DefaultValue&&JSON.parse(r.DefaultValue);a&&a.hasOwnProperty(n)&&(o=!0);var c=[e.createDragHandleIcon()],u="unselectable-text design-question-choice-label";if(s)u+=" design-question-dropdown-label";else{var l=r.ChoiceType===te.a.MultiChoice?"checkbox":"radio";c.push(oe.createElement("input",{"aria-label":Object(ae.a)().DesignPage_ChoiceOptionRadioBox_AriaLabel.format(n+1),disabled:!0,className:"design-question-choice-icon",type:l,key:"choiceIcon"})),u+=" design-question-choice-sortable"}var h,f=oe.createElement("div",{className:"design-question-choice-icon-group"},c);r.IsMathQuiz&&(t.IsMathOption?(n===this.kg&&(this.kg=-1),h=oe.createElement(rr.a,{blockEndDesignMode:this.blockEndDesignMode,HasFocus:this.state.SelectedElementIndex===n,HTMLAttributes:this.getElementFocusingProps(n),Location:"Choice.Option",onValueChange:this.tO.bind(this,n),Placeholder:Object(ae.a)().Designer_Choices_Euqation_Placeholder,QuestionId:"",Value:t.Description},this.eO(n))):h=oe.createElement("div",{className:"design-choice-option-text-input-container",key:"choiceContent"},this.nO(t.Description,n,o),this.eO(n)));var d=this.iO(t.Description,n),b=this.rO(n),m=this.oO(t.Description,n),v=Object(Y.g)()&&t.FormsProDisplayRTText||t.Description;return oe.createElement("div",{className:"design-question-choice",key:Wt.a.getObjectMasterFromModel(t).getInstanceId()},oe.createElement("div",{className:u,ref:this.getElementRef(n),key:"choiceContentContianer"},f,h||this.nO(v,n,o),d,b,m),this.sO(t,n))},e.createDragHandleIcon=function(){return oe.createElement("span",{className:"design-question-drag-handler",key:"dragIcon"},oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},oe.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"})))},n.eO=function(t){var e,n,i,r,o=this.props.Master.Model.Choices[t],s="design-question-choice-to-math-button";return this.props.IsMobile&&(s=Object(pn.b)(s,"isMobile")),t===this.state.SelectedElementIndex&&(s=Object(pn.b)(s,"active-choice")),o.IsMathOption?(e={className:s,onClick:this.Pg(t)},n="TextField",i=Object(ae.a)().Designer_Question_EquationToText_Button,r=Object(ae.a)().Designer_Question_EquationToText_Button_Tooltip):(e={className:s,onClick:this.Pg(t)},n="NumberField",i=Object(ae.a)().Designer_Question_Equation_Button,r=Object(ae.a)().Designer_Question_Equation_Button_Tooltip),Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,Icon:n,IconClassName:"design-question-choice-to-math-button-icon",Text:i,Tooltip:r})},n.Pg=function(t){var e=this;return function(n){var i=e.props.Master.Model.Choices;if(!(t>=i.length)){var r=i[t];r&&(e.kg=t,r.IsMathOption=!r.IsMathOption,e.forceUpdate(),Object(g.b)(r.IsMathOption?"DesignPage.Quiz.SwitchTextToMathInput":"DesignPage.Quiz.SwitchMathToTextInput",{location:"Choice.Option",questionId:e.props.Master.Model.Id}))}}},n.nO=function(t,e,n){var i=this.props.Master.Model,r=i.IsMathQuiz?"design-question-textbox-with-switcher":"inline-display design-question-choice-option-textbox",o={AutoFocus:this.state.SelectedElementIndex===e,AutoSelection:!0,AllowRichText:!0,HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(e),{className:r,onFocus:function(){var t=i.Choices[e];i.IsMathQuiz&&t.IsGenerated&&(t.Description="")},onKeyDown:this.nn(e),onPaste:this.Mg}),MaxLength:Object(Pe.G)(),onValueChange:function(t){i.Choices[e].IsGenerated&&i.Choices[e].Description!==t&&(i.Choices[e].IsGenerated=null),Object(Y.g)()?(i.Choices[e].Description=t?Object(or.b)(t,!0):t,i.Choices[e].FormsProDisplayRTText=Object(or.c)(t)):i.Choices[e].Description=t;var r=i.DefaultValue&&JSON.parse(i.DefaultValue);n&&r&&(r[e]=t),i.DefaultValue=JSON.stringify(r)},Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().DesignPage_ChoiceOptionInputBox_AriaLabel}},Placeholder:Object(ae.a)().Designer_Choices_Placeholder,Value:t};return Object(ar.c)(o)},n.tO=function(t,e){var n=this.props.Master;n.bulkEdit((function(){var i=n.Model.Choices[t];i.Description=e,e&&(i.IsGenerated=null)}))},n.sO=function(t,e){if(this.props.Master.Model.IsQuiz&&null!==t.AnswerHint)return Object(ar.c)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(e),{className:"design-question-choice-answer-hint"}),MaxLength:Object(Pe.b)(),MinimalHeight:Object(Pe.j)(),onValueChange:function(e){return t.AnswerHint=e},Placeholder:Object(ae.a)().Designer_Choices_AnswerHint_Placeholder,TextFieldType:2,Value:t.AnswerHint})},n.iO=function(t,e){var n=this,i=e===this.state.SelectedElementIndex?"option-edit-button active-choice":"option-edit-button";return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(e),{className:i,onClick:function(){n.onUpdateDone((function(){var t=n.props.Master.Model;if(e===t.Choices.length){var i=t.AllowOtherAnswer?n.jg.current:n.pg.current;i&&i.focus()}else{var r=n.getElementRef(e).current;r&&$(r).find(".office-form-textfield-input").focus()}})),Object(at.c)((function(){n.Vg(t,e)}),at.f)}}),Icon:"Delete",IconClassName:"option-edit-button-img forms-icon-size16x16",Text:Object(ae.a)().Common_Delete_Text})},n.rO=function(t){if(this.props.Master.Model.IsQuiz){var e=this.props.Master.Model.Choices,n=t===this.state.SelectedElementIndex?"option-edit-button active-choice":"option-edit-button";return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(t),{className:n,onClick:this.aO(t)}),Icon:"Chat",IconClassName:"option-edit-button-img forms-icon-size16x16",Text:Object(ae.a)().Quiz_AnswerHint,ToggleActive:null!==e[t].AnswerHint})}},n.oO=function(t,e){var n=this;if(this.props.Master.Model.IsQuiz){var i=this.props.Master.Model.Choices,r=e===this.state.SelectedElementIndex||i[e].IsAnswerKey?"option-edit-button active-choice":"option-edit-button";return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:i[e].IsAnswerKey?"Horizontal":"GlyphOnly",HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(e),{className:r,onClick:function(){Object(g.b)("DesignPage.Questions.ToggleCorrectChoice",{index:e,questionId:n.props.Master.Model.Id,questionType:n.props.Master.Model.Type,value:!i[e].IsAnswerKey}),n.props.Master.setAnswerKey(i[e],!i[e].IsAnswerKey)}}),Icon:"CheckMark",IconClassName:"option-edit-button-img forms-icon-size18x18",Text:Object(ae.a)().Quiz_CorrectAnswer,TextClassName:"designer-quiz-option-correct",ToggleActive:!!i[e].IsAnswerKey})}},n.Yg=function(){var t,e,n=this,i=this.props.Master,r=i.Model;if(i.showAsDropdown()?t="design-question-choice-label design-question-dropdown-label":(t="design-question-choice-label",e=oe.createElement("input",{"aria-label":Object(ae.a)().DesignPage_OtherChoiceOptionRadioBox_AriaLabel,className:"design-question-choice-icon",disabled:!0,type:r.ChoiceType===te.a.MultiChoice?"checkbox":"radio"})),r.AllowOtherAnswer){var o={HTMLAttributes:{className:"inline-display design-question-choice-option-textbox other-option",onFocus:function(){n.setState({SelectedElementIndex:hr.b})}},MaxLength:Object(Pe.G)(),onValueChange:function(){},Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().DesignPage_OtherChoiceOptionInputBox_AriaLabel,className:"office-form-unselectable",readOnly:!0}},Placeholder:Object(ae.a)().Designer_OtherAnswer,Value:""},s=Object(ar.c)(o),a=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:this.state.SelectedElementIndex===hr.b?"option-edit-button active-choice":"option-edit-button",onBlur:function(){n.setState({SelectedElementIndex:hr.b})},onClick:function(){n.onUpdateDone((function(){var t=n.pg.current;t&&t.focus()})),r.AllowOtherAnswer=!1}},Icon:"Delete",IconClassName:"option-edit-button-img forms-icon-size16x16",ref:this.jg,Text:Object(ae.a)().Common_Delete_Text});return oe.createElement("div",{className:"design-question-choice",key:"otherChoiceOption"},oe.createElement("div",{className:t},e,s,a))}},n.Xg=function(t){var e,n=this.props.Master.Model,i=n.Choices,r=null;n.IsMathQuiz?(e="",r=!0):e=Object(ae.a)().Designer_Choices_DefaultDescription.format(t+1),n.Choices=Wt.a.convertToArray(i).concat({Description:e,IsGenerated:!0,IsMathOption:r}),this.setState({SelectedElementIndex:t})},n.cO=function(t,e){FormsPro.getRuleValidator(Object(_t.b)().Model.FormMaster).optionReferred(this.props.Master.Model.Id,t)?this.setState({ShowDeleteOptionDialog:!0}):this.Vg(t,e)},n.Vg=function(t,e){var n=this.props.Master,i=n.Model,r=i.Choices,o=i.DefaultValue&&JSON.parse(i.DefaultValue);if(o&&Object.keys(o).length>0){o.hasOwnProperty(e)&&delete o[e];for(var s=e+1;s<r.length;s++)if(o.hasOwnProperty(s)){var a=o[s];o[s-1]=a,delete o[s]}}n.bulkEdit((function(){Wt.a.getObjectMasterFromModel(r[e]).Deleted=!0,i.DefaultValue=JSON.stringify(o),sr.a.handleChoicesV1Deleted(e,i.Id,n.Form)}))},n.aO=function(t){var e=this;return function(){var n=e.props.Master.Model.Choices;t>=0&&t<n.length&&(Object(g.b)("DesignPage.Quiz.AnswerHint",{toggleOn:null===n[t].AnswerHint}),n[t].AnswerHint=null===n[t].AnswerHint?Object(ae.a)().Designer_Choices_AnswerHint_Placeholder:null)}},n.nn=function(t){var e=this;return function(n){var i=e.props.Master.Model.Choices,r=i.length;if(13===n.keyCode)if(t===r-1)e.Xg(r);else{var o=Ln.findDOMNode(e),s=$(o).find(".design-question-choice")[t+1];if(i[t+1].IsMathOption){var a=$(s).find(".design-formula-mixer")[0];a&&a.focus()}else{var c=$(s).find(".design-question-choice-option-textbox input")[0];c&&c.focus()}}}},n.Mg=function(t){var e=this,n=t.clipboardData.getData("text");if(n){var i=n.replace(/\r/g,"").split("\n").map((function(t){return t.trim()})).filter((function(t){return!!t}));if(i.length>1){var r=this.props.Master,o=r.Model,s=o.Choices,a=i.map((function(t){return{Description:t,IsGenerated:!1,IsMathOption:!1}})),c=s.length;r.bulkEdit((function(){for(var n=Wt.a.convertToArray(s),i=t.target,r=e.state.SelectedElementIndex,c=s.length-1;c>r;--c){Wt.a.getObjectMasterFromModel(s[c]).Deleted=!0}s[r].Description=i.value.substring(0,i.selectionStart)+a.splice(0,1)[0].Description,a[a.length-1].Description+=i.value.substring(i.selectionEnd),n.splice.apply(n,Object(S.__spreadArrays)([r+1,0],a)),o.Choices=n})),Object(g.b)("DesignPage.Questions.PasteChoiceOptions",{LinesAfter:s.length,LinesBefore:c}),t.preventDefault()}}t.stopPropagation()},n.Zg=function(){var t=this;if(Object(v.w)())return null;var e=(this.state.ChoiceCandidates||[]).filter((function(e){return!t._g(e.text)})),n=null;if(!this.props.Master.Model.IsMathQuiz&&this.state.IntelligenceProvider===ir.OptionSuggestionFromOption&&e&&e.length>0){var i=Object(ae.a)().DesignPage_OptionSuggestionItem_AriaLabel,r=Object(ae.a)().DesignPage_OptionSuggestionBar_AriaLabel,o=e.map((function(e,n){var r={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":i.format(n+1,e.text),className:Object(pn.b)("design-question-choice-candidate office-form-theme-primary-foreground","office-form-theme-bgcolor-hover"),onClick:function(n){t.qg(e.text),t.uO()}},Text:e.text};return oe.createElement(Gi.a,Object(S.__assign)({key:n},r))}));n=oe.createElement("div",{"aria-label":r.format(e.length),className:"design-question-candidate-bar"},o)}var s=Object(pn.b)("design-question-candidate-bar-container",this.props.Master.showAsDropdown()?"choice-option-candidate-dropdown":"choice-option-candidate");return oe.createElement("div",{"aria-live":"polite",className:s,key:"suggestionBarForOption"},n)},n.Hg=function(){var t=this.state.ChoiceCandidates;this.Cg&&this.Cg===t||(this.Cg=t,this.Gg())},n.Wg=function(t,e){var n={candidateLength:t?t.length:0,candidatePosition:Et.findIndex(this.state.ChoiceCandidates,(function(e){return e.text===t})),candidateType:ir[this.state.IntelligenceProvider],currentOptionCount:this.props.Master.Model.Choices.length,isCorrectAnswer:e,msftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),questionId:this.props.Master.Model.Id};Object(g.b)("IntelligenceStatistic.ChoiceOptionSuggestion.Choose",n),Object(g.b)("Intelligence.ChoiceOptionSuggestion.Choose",{candidateType:ir[this.state.IntelligenceProvider]})},n.Kg=function(t){if(!this.Ng||this.state.IntelligenceProvider===ir.OptionSuggestionFromOption){var e={candidateLength:t?t.length:0,candidateType:ir[this.state.IntelligenceProvider],isQuiz:this.props.Master.Model.IsQuiz,msftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),optionSuggestionId:this.yg,questionId:this.props.Master.Model.Id};if(null!=this.state.MatchingPart&&(e.matchingPart=this.state.MatchingPart,e.firstChosen=t,e.firstChosenPosition=Et.findIndex(this.state.ChoiceCandidates,(function(e){return e.text===t}))),Object(g.b)("IntelligenceStatistic.ChoiceOptionSuggestion.Choose",e),Object(g.b)("Intelligence.ChoiceOptionSuggestion.Choose",{candidateType:ir[this.state.IntelligenceProvider]}),Object(Y.c)("FrontDoorOptionToOption")&&this.Ig){var n={candidateLength:t?t.length:0,candidateType:ir[this.state.IntelligenceProvider],isQuiz:this.props.Master.Model.IsQuiz};null!=this.Ig.ExtraData&&(n.firstChosen=t,n.firstChosenPosition=Et.findIndex(this.Ig.Suggestion,(function(e){return e===t}))),mn.a.logSuggestionKept("Choose",this.Ig,JSON.stringify(n))}this.Ng=!0}},n.Gg=function(){var t={candidatesCount:this.state.ChoiceCandidates?this.state.ChoiceCandidates.length:0,candidateType:ir[this.state.IntelligenceProvider],isQuiz:this.props.Master.Model.IsQuiz,msftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),optionSuggestionId:this.yg,questionId:this.props.Master.Model.Id};null!=this.state.MatchingPart&&(t.matchingPart=this.state.MatchingPart),Object(g.b)("IntelligenceStatistic.ChoiceOptionSuggestion.Show",t),Object(g.b)("Intelligence.ChoiceOptionSuggestion.Show",{candidateType:ir[this.state.IntelligenceProvider]})},n.uO=function(){var t=this.props.Master.Model.Choices;if(t&&t.length>0){var e=t.length-1;this.setState({SelectedElementIndex:e});var n=this.getElementRef(e).current;n&&$(n).find("input").focus()}},e}(fr),br=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createReactNodes=function(){var t=Object(Un.b)({HTMLAttributes:{className:"date-snapshot-event-icon forms-icon-size22x22"},IconName:"Calendar"}),e=Object(ae.a)().QuestionType_DateTime_PlaceHolder.format(Object(u.a)().cultureInfo.DateTimeFormat.ShortDatePattern);return oe.createElement("div",{className:"design-question-element"},oe.createElement("div",{className:"design-question-date-snapshot"},t,oe.createElement("input",{className:"form-control office-form-unselectable",disabled:!0,placeholder:e,"aria-label":Object(ae.a)().Designer_QuestionType_DateTime_AriaLabel})))},e}(hr.a),mr=n(253),vr=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.lO=500,n.Ng=!1,n.logLikertOptionsCandidatesAdopt=n.logLikertOptionsCandidatesAdopt.bind(n),n.logLikertOptionsCandidatesShown=n.logLikertOptionsCandidatesShown.bind(n),n.applyCandidate=n.applyCandidate.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t=this;if(!this.props.ShouldShow)return null;var e=this.props.Master.Model.ChoiceGroup,n=Et.filter(e,(function(t){return!t.IsGenerated&&!!t.Description})).length,i=(this.state.LikertOptionsCandidate||[]).filter((function(e){return!t.hasOption(e)}));return!i||i.length<=0||n>=Object(Pe.x)()?null:this.createSuggestionBar()},n.hasOption=function(t){var e=this.props.Master.Model.ChoiceGroup;return Et.some(e,(function(e){return!!e.Description&&e.Description.replace(/\s/g,"")===t.replace(/\s/g,"")}))},n.setLikertOptionsCandidates=function(t,e,n,i,r){this.ce&&(t&&e&&e.length>0?this.setState({DetectedLang:r,LikertOptionsCandidate:e,MatchingPart:i},this.logLikertOptionsCandidatesShown):this.resetLikertOptionsCandidates())},n.resetLikertOptionsCandidates=function(){this.ce&&this.setState({DetectedLang:void 0,LikertOptionsCandidate:[],MatchingPart:void 0})},n.logLikertOptionsCandidatesShown=function(){Object(g.b)("IntelligenceStatistic.LikertOptionSuggestion.Show",{DetectedLang:this.state.DetectedLang,IsQuiz:this.props.Master.Model.IsQuiz,IsTitleSuggestion:this.isSuggestionFromTitle(),MatchingPart:this.state.MatchingPart,MsftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),QuestionId:this.props.Master.Model.Id}),Object(g.b)("Intelligence.LikertOptionSuggestion.Show",{IsQuiz:this.props.Master.Model.IsQuiz,IsTitleSuggestion:this.isSuggestionFromTitle()})},n.logLikertOptionsCandidatesAdopt=function(){this.Ng&&this.isSuggestionFromTitle()||(Object(g.b)("IntelligenceStatistic.LikertOptionSuggestion.Choose",{DetectedLang:this.state.DetectedLang,IsQuiz:this.props.Master.Model.IsQuiz,IsTitleSuggestion:this.isSuggestionFromTitle(),MatchingPart:this.state.MatchingPart,MsftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),QuestionId:this.props.Master.Model.Id}),Object(g.b)("Intelligence.LikertOptionSuggestion.Choose",{IsQuiz:this.props.Master.Model.IsQuiz,IsTitleSuggestion:this.isSuggestionFromTitle()}),this.Ng=!0)},n.applyCandidate=function(t,e){this.logLikertOptionsCandidatesAdopt(),this.props.applyCandidateOption(t,e)},n.getTextAnalysisInterval=function(){return this.lO},n.resetTextAnalysisTimeout=function(t){window.clearTimeout(this.zg),this.zg=t},e}(ue.a),gr=function(t){function e(e){var n=t.call(this,e)||this;return n.hO=n.hO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.props.candidateOption;return Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":this.props.arialabel,className:this.props.className,onClick:this.hO},key:this.props.index,Text:t})},n.hO=function(){var t=this.props;t.applyCandidateOption(t.candidateOption,t.setFocus)},e}(ue.a),Or=function(t){function e(e){var n=t.call(this,e)||this;return n.Fg=n.Fg.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.props.Master.unobserve(this.Fg)},n.componentDidMount=function(){var t=this.props.Master;t.observe(this.Fg,[t.Schema.ChoiceGroup[0].Description])},n.createSuggestionBar=function(){var t=this,e=(this.state.LikertOptionsCandidate||[]).filter((function(e){return!t.hasOption(e)})),n=Object(ae.a)().DesignPage_OptionSuggestionItem_AriaLabel,i=Object(ae.a)().DesignPage_OptionSuggestionBar_AriaLabel,r=Object(pn.b)("design-question-choice-candidate office-form-theme-primary-foreground","office-form-theme-bgcolor-hover","likert-option-candidate"),o=e.map((function(e,i){var o=n.format(i+1,e);return oe.createElement(gr,{arialabel:o,applyCandidateOption:t.applyCandidate,className:r,candidateOption:e,index:i,key:i,setFocus:!0})}));return oe.createElement("div",{"aria-label":i.format(e.length),className:"design-question-candidate-bar likert-option-candidate"},o)},n.isSuggestionFromTitle=function(){return!1},n.Fg=function(){var t=this;if(this.props.ShouldShow){var e=Et.filter(this.props.Master.Model.ChoiceGroup,(function(t){return!t.IsGenerated}));if(0!==e.length){var n=window.setTimeout((function(){mn.a.getOptionToOptionSuggestion(e.map((function(t){return t.Description})),"LikertOptionSuggestsOption").then((function(e){e?t.setLikertOptionsCandidates(e.MatchQuery,e.Result.ChoiceCandidates,!1,e.Result.MatchingPart,e.Result.DetectedLanguage):t.resetLikertOptionsCandidates()})).catch(t.resetLikertOptionsCandidates)}),this.getTextAnalysisInterval());this.resetTextAnalysisTimeout(n)}else this.resetLikertOptionsCandidates()}},e}(vr),pr=function(t){function e(e){var n=t.call(this,e)||this;return n.hO=n.hO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props.candidateOptions;return Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{className:this.props.className,onClick:function(){e.forEach((function(n,i){return t.hO(n,i===e.length-1)}))}},Text:Object(ae.a)().Designer_Intelligence_AddAll})},n.hO=function(t,e){this.props.applyCandidateOption(t,e)},e}(ue.a),jr=function(t){function e(e){var n=t.call(this,e)||this;return n.fO=n.fO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this),this.props.Master.unobserve(this.fO)},n.componentDidMount=function(){var t=this.props.Master;t.observe(this.fO,[t.Schema.Title]),this.fO()},n.createSuggestionBar=function(){var t=this,e=(this.state.LikertOptionsCandidate||[]).filter((function(e){return!t.hasOption(e)})),n=oe.createElement(pr,{applyCandidateOption:this.applyCandidate,candidateOptions:e,className:"design-question-choice-candidate office-form-theme-button"}),i=e.map((function(e,n){return oe.createElement(gr,{applyCandidateOption:t.applyCandidate,className:"design-question-choice-candidate office-form-theme-primary-foreground office-form-theme-bgcolor-hover",candidateOption:e,index:n,key:n,setFocus:!0})}));return oe.createElement("div",{className:"design-question-candidate-bar"},Object(ae.a)().Designer_Intelligence_Options,n,i)},n.isSuggestionFromTitle=function(){return!0},n.fO=function(){var t=this;if(this.props.ShouldShow){var e=this.props.Master.Model;if(!e.IsMathQuiz){var n=window.setTimeout((function(){mn.a.getLikertQuestionSuggest(e.Title).then((function(e){e?t.setLikertOptionsCandidates(e.MatchQuery,e.Suggestion.ChoiceCandidates,!0,e.Suggestion.MatchingPart,e.Suggestion.DetectedLanguage):t.resetLikertOptionsCandidates()})).catch(t.resetLikertOptionsCandidates)}),this.getTextAnalysisInterval());this.resetTextAnalysisTimeout(n)}}},e}(vr),yr=n(38),wr=function(t){function e(e){var n=t.call(this,e)||this;return n.dO=oe.createRef(),n.state={IsFocused:!1},n.bO=n.bO.bind(n),n.en=n.en.bind(n),n.Vg=n.Vg.bind(n),n.nn=n.nn.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t={AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:this.state.IsFocused?"design-question-matrix-editor office-form-theme-border":"design-question-matrix-editor",onFocus:this.bO,onKeyDown:this.nn},MinimalHeight:Object(Pe.j)(),onValueChange:this.props.onValueChange,Options:{HTMLPropsForInnerElement:this.props.HTMLAttributes},TextFieldType:2,Value:this.props.Value},e=this.props.IsColumn?Object(ar.b)(t):Object(ar.c)(t);return oe.createElement("div",{className:"design-question-matrix-cell-box",onBlur:this.en,ref:this.dO},e,this.props.Deletable?this.mO():void 0)},n.focus=function(){var t=this.dO.current;t&&!t.contains(document.activeElement)&&t.querySelector(".office-form-textfield-input").focus()},n.bO=function(){this.setState({IsFocused:!0})},n.en=function(t){var e=Object(pn.d)(t);t.currentTarget.contains(e)||(e.className.indexOf("design-question-choice-candidate")>=0&&this.props.setCandidateApplyingTarget&&this.props.setCandidateApplyingTarget(),this.setState({IsFocused:!1}))},n.Vg=function(){var t=this.dO.current;t&&Object(yr.c)(t),this.props.delete()},n.nn=function(t){if(13===t.keyCode)if(t.preventDefault(),this.props.FocusOut){var e=this.dO.current;e&&Object(yr.c)(e)}else this.props.onKeyDown&&this.props.onKeyDown()},n.mO=function(){var t=Object(yn.a)({GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"design-question-matrix-remove-icon",onClick:this.Vg},Icon:"Delete",IconClassName:"option-remove-button-img forms-icon-size16x16",Text:Object(ae.a)().Common_Delete_Text}),e=Object(pn.b)("design-question-matrix-remove-container",this.state.IsFocused?"office-form-theme-primary-background active-choice":"");return oe.createElement("div",{className:e,tabIndex:-1},t)},e}(ue.a),Sr=function(t){function e(e){var n=t.call(this,e)||this;return n.vO=n.vO.bind(n),n.gO=n.gO.bind(n),n.OO=n.OO.bind(n),n.pO=n.pO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.jO=function(){return t.forceUpdate()},this.props.Master.observe(this.jO,[xe.a.Schema.Description])},n.componentWillUnmount=function(){this.props.Master.unobserve(this.jO)},n.render=function(){var t=this.props.Master.Model,e=this.props.saveRef(this.props.Master.getInstanceId());return oe.createElement("td",{className:"design-question-matrix-column-td",style:{width:"calc((100% - 220px)/"+this.props.Count+")"}},oe.createElement(wr,{onKeyDown:this.props.IsLast?this.props.addOption:void 0,Deletable:this.props.Count>1,delete:this.pO,HTMLAttributes:{"aria-label":Object(ae.a)().Designer_Choices_Placeholder},FocusOut:!this.props.IsLast,onValueChange:this.gO,ref:e,Value:Object(at.b)((function(){return Object(Y.c)("TextFormat")}))&&t.FormsProDisplayRTText||t.Description,setCandidateApplyingTarget:this.OO,IsColumn:!0}))},n.pO=function(){var t=this;Object(at.c)((function(){t.vO()}),at.f)},n.vO=function(){var t=this.props.Master;t.Deleted=!0,Object(g.b)("DesignPage.Questions.DeleteLikertOption",{questionId:t.Question.Model.Id})},n.gO=function(t){this.props.Master.bulkEdit((function(e){e.IsGenerated=!1,Object(at.b)((function(){return Object(Y.c)("TextFormat")}))?(e.Description=t?Object(or.b)(t,!0):t,e.FormsProDisplayRTText=Object(or.c)(t)):e.Description=t}))},n.OO=function(){this.props.setCandidateApplyingTarget(this.props.Master.Model)},e}(ue.a),Nr=function(t){function e(e){var n=t.call(this,e)||this;return n.yO=n.yO.bind(n),n.gO=n.gO.bind(n),n.Te=n.Te.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.wO=function(){return t.forceUpdate()},this.props.Master.observe(this.wO,[Object(_t.i)().Schema.Title])},n.componentWillUnmount=function(){this.props.Master.unobserve(this.wO)},n.render=function(){var t=this.props.Master.Model;return oe.createElement("tr",{className:"design-question-matrix-str"},oe.createElement("td",{className:"design-question-matrix-row-td",key:"subQuestion"},oe.createElement(wr,{onKeyDown:this.props.IsLast?this.props.addQuestion:void 0,Deletable:this.props.Count>1,delete:this.Te,HTMLAttributes:{"aria-label":Object(ae.a)().Designer_LabelForLikertRowTitle},FocusOut:!this.props.IsLast,onValueChange:this.gO,ref:this.props.saveRef(t.Id),Value:Object(Y.g)()&&t.FormsProRTQuestionTitle||t.Title})),this.props.children,oe.createElement("td",{key:"emptyTd"}))},n.Te=function(){var t=this;Object(at.c)((function(){t.yO()}),at.f)},n.yO=function(){var t=this.props.Master,e=t.Model.Id,n=t.ParentQuestionMaster;n.deleteSubQuestion(e),Object(g.b)("DesignPage.Questions.DeleteLikertSubquestion",{questionId:n.Model.Id})},n.gO=function(t){var e=this;this.props.Master.bulkEdit((function(){Object(Y.g)()?(e.props.Master.Model.Title=t?Object(or.b)(t,!0):t,e.props.Master.Model.FormsProRTQuestionTitle=Object(or.c)(t)):e.props.Master.Model.Title=t}))},e}(ue.a),Ir=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.SO={},n.NO=[],n.IO=oe.createRef(),n.CO=n.CO.bind(n),n.kO=n.kO.bind(n),n.TO=n.TO.bind(n),n.xO=n.xO.bind(n),n.FO=n.FO.bind(n),n.OO=n.OO.bind(n),n.PO=n.PO.bind(n),n.Ag=n.Ag.bind(n),n.Rg=n.Rg.bind(n),n.DO=n.DO.bind(n),n.MO=n.MO.bind(n),n.LO=n.LO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.ce=!1,Wt.a.getCollectionMasterFromModel(this.props.Master.Form.Model.Questions).unobserve(this.xO),t.prototype.componentWillUnmount.call(this)},n.componentDidMount=function(){t.prototype.componentDidMount.call(this),Wt.a.getCollectionMasterFromModel(this.props.Master.Form.Model.Questions).observe(this.xO)},n.createReactNodes=function(){var t=this.props.Master,e=this.AO(),n=this.RO(),i=oe.createElement("div",{className:"design-question-matrix-table",key:"matrixs"},oe.createElement("table",{role:"group"},e,n)),r=(this.state.ShowDeleteOptionDialog&&oe.createElement(ur.a,{ClassName:"design-question-button-two-line-container",clickCancelButton:this.Ag,clickDeleteQuestion:this.Rg,Description:Object(ae.a)().MFPBranchingRules_Delete_Option_Popup_Desc}),this.state.ShowDeleteLikertSubDialog&&oe.createElement(ur.a,{ClassName:"design-question-button-two-line-container",clickCancelButton:this.MO,clickDeleteQuestion:this.LO,Description:Object(ae.a)().MFPBranchingRules_Delete_Question_Popup_Desc}),t.SubQuestionMasters.length),o=Object(Pe.y)()>r?this.EO():void 0;return Object(at.c)((function(){return[i,o]}),at.f)},n.createSuggestionBar=function(){return oe.createElement(jr,{applyCandidateOption:this.FO,Master:this.props.Master,ShouldShow:this.ce,ref:this.IO})},n.Ag=function(){this.setState({ShowDeleteOptionDialog:!1})},n.Rg=function(){this.setState({ShowDeleteOptionDialog:!1}),this.BO.Deleted=!0,Object(g.b)("DesignPage.Questions.DeleteLikertOption",{questionId:this.BO.Question.Model.Id})},n.MO=function(){this.setState({ShowDeleteLikertSubDialog:!1})},n.LO=function(){this.setState({ShowDeleteLikertSubDialog:!1});var t=this._O,e=t.Model.Id,n=t.ParentQuestionMaster;n.deleteSubQuestion(e),Object(g.b)("DesignPage.Questions.DeleteLikertSubquestion",{questionId:n.Model.Id})},n.xO=function(t){var e=this.props.Master.Model.Id;if(t.AddedModels.concat(Wt.a.convertToArray(t.RemovedModels)).map(Wt.a.getObjectMasterFromModel).some((function(t){return t.Model.GroupId===e}))){var n=this.NO;this.NO=[],this.forceUpdate((function(){return n.forEach((function(t){return t()}))}))}},n.AO=function(){var t=this,e=this.props.Master.Model,n=e.ChoiceGroup,i=n.length,r=[oe.createElement("td",{key:"matrixTd"})],o=Et.map(n,(function(e,n){var r=Wt.a.getObjectMasterFromModel(e);return oe.createElement(Sr,{addOption:t.kO,Count:i,IsLast:n===i-1,key:r.getInstanceId(),Master:r,saveRef:t.CO,setCandidateApplyingTarget:t.OO,showDeleteOptionDialog:t.PO})}));r=r.concat(o);var s,a=Object(yn.a)({GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{onClick:this.kO},Icon:"Add",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().Designer_AddOneMore});n.length<Object(Pe.x)()&&(s=oe.createElement("td",{className:"design-question-add-option"},a));var c=oe.createElement("tr",{className:"design-question-matrix-pr"},r,s),u=e.ChoiceGroup.length,l=u<Object(Pe.x)()?u+2:u+1,h=this.IO.current,f=!!h&&h.state.LikertOptionsCandidate&&h.state.LikertOptionsCandidate.length>0,d=oe.createElement("tr",null,oe.createElement("td",{"aria-live":"polite",className:"design-question-candidate-bar-container likert-option-candidate",colSpan:l},oe.createElement(Or,{applyCandidateOption:this.FO,Master:this.props.Master,ShouldShow:!f})));return oe.createElement("thead",{className:"design-question-matrix-pthead"},c,d)},n.kO=function(){var t=this,n=this.props.Master.Model,i=n.ChoiceGroup.length;if(i<Object(Pe.x)()){Object(g.b)("DesignPage.Questions.AddLikertOption",{index:i,questionId:n.Id}),this.onUpdateDone((function(){var e=Wt.a.getObjectMasterFromModel(n.ChoiceGroup[i]).getInstanceId(),r=t.SO[e].current;r&&r.focus()}));var r={Description:Object(ae.a)().Designer_Choices_DefaultDescription.format(i+1),IsGenerated:!0,Order:e.generateNonDuplicateID()};Wt.a.Collection.addItems(n.ChoiceGroup,[r])}},e.generateNonDuplicateID=function(){return Date.now()},n.RO=function(){var t=this,n=this.props.Master,i=n.Model,r=Et.map(i.ChoiceGroup,(function(t,n){return e.createMatrixRadio(n,t.Description)})),o=n.SubQuestionMasters,s=o.length,a=Et.map(o,(function(e,n){return oe.createElement(Nr,{addQuestion:t.TO,Count:s,IsLast:n===s-1,key:e.Model.Id,Master:e,saveRef:t.CO,showDeleteQuestionDialog:t.DO},r)}));return oe.createElement("tbody",{className:"design-question-matrix-stbody"},a)},n.DO=function(t){},n.EO=function(){var t=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"design-question-button office-form-theme-button-color",onClick:this.TO},Icon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",Text:Object(ae.a)().Designer_AddOneMoreRow,TextClassName:"design-question-addonemore"});return oe.createElement("div",{className:"design-question-addbutton-container",key:"addButton"},t)},n.TO=function(){var t=this,e=this.props.Master.SubQuestionMasters.length;if(e+1>=Object(Pe.y)()&&Object(g.b)("DesignPage.Questions.AddItemHitLimitation",{questionId:this.props.Master.Model.Id,questionType:this.props.Master.Model.Type}),e<Object(Pe.y)()){Object(g.b)("DesignPage.Questions.AddLikertSubquestion",{index:e,questionId:this.props.Master.Model.Id}),this.NO.push((function(){var n=t.SO[t.props.Master.SubQuestionMasters[e].Model.Id].current;n&&n.focus()}));var n={Title:Object(ae.a)().Desinger_Likert_DefaultDescription.format(e+1),Type:"Question.MatrixChoice"};this.props.Master.addSubQuestion(n)}},e.createMatrixRadio=function(t,e){return oe.createElement("td",{className:"design-question-matrix-radio",key:t},oe.createElement("input",{"aria-disabled":!0,"aria-label":e,className:"design-question-matrix-radio",disabled:!0,name:"subquestion-radio",type:"radio"}))},n.CO=function(t){return this.SO[t]||(this.SO[t]=oe.createRef()),this.SO[t]},n.OO=function(t){this.HO=t},n.PO=function(t){},n.FO=function(t,n){var i,r=this,o=this.props.Master.Model,s=o.ChoiceGroup;if(this.HO)if(this.HO.IsGenerated||!this.HO.Description)i=this.HO;else if(o.ChoiceGroup.length===Object(Pe.x)())i=Et.find(s,(function(t){return t.IsGenerated}));else{var a=Et.sortBy(o.ChoiceGroup,(function(t){return t.Order})).filter((function(t){return r.HO&&t.IsGenerated&&t.Order>r.HO.Order}));i=a.length>0?a[0]:null}else i=Et.find(s,(function(t){return t.IsGenerated}));if(i)Wt.a.getObjectMasterFromModel(i).bulkEdit((function(e){e.Description=t,e.IsGenerated=null,e.IsMathOption=!1})),n&&this.GO(i);else if(n&&this.onUpdateDone((function(){r.GO(o.ChoiceGroup[s.length-1])})),s.length<Object(Pe.x)()){var c={Description:t,IsGenerated:!1,Order:e.generateNonDuplicateID()};Wt.a.Collection.addItems(s,[c])}this.HO=null},n.GO=function(t){var e=Wt.a.getObjectMasterFromModel(t).getInstanceId(),n=this.SO[e].current;n&&n.focus()},e}(hr.a),Cr=n(153),kr=function(t){function e(e){var n=t.call(this,e)||this;return Object(Y.g)()?(n.qO=function(t){n.props.Master.Model.FormsProRTLeftDescription=Object(or.c)(t),n.props.Master.Model.LeftDescription=t?Object(or.b)(t,!0):t},n.QO=function(t){n.props.Master.Model.FormsProRTRightDescription=Object(or.c)(t),n.props.Master.Model.RightDescription=t?Object(or.b)(t,!0):t}):(n.qO=function(t){return n.props.Master.Model.LeftDescription=t},n.QO=function(t){return n.props.Master.Model.RightDescription=t}),n}Object(S.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){return[oe.createElement("div",{className:"design-question-element design-question-nps-container",key:"npsContainer"},oe.createElement(Cr.a,{Disabled:!0,Value:void 0}),this.zs()),this.createAnswerTagDiv(this.props.Master.Model.FormsProAnswerTag)]},n.createMoreMenuItems=function(){var e=this;return Object(at.c)((function(){return t.prototype.createMoreMenuItems.call(e)}),at.f)},n.zs=function(){var t=this.props.Master.Model,e=t.LeftDescription,n=t.RightDescription;e=Object(Y.g)()&&t.FormsProRTLeftDescription||t.LeftDescription,n=Object(Y.g)()&&t.FormsProRTRightDescription||t.RightDescription;var i=Object(ar.c)({AllowRichText:!0,HTMLAttributes:{className:"rating-option-description-designer"},MinimalHeight:25,onValueChange:this.qO,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_NPSDescription_Label.format(0)}},Placeholder:Object(ae.a)().Designer_PlaceholderForRatingDescription,TextFieldType:0,Value:e}),r=Object(ar.c)({AllowRichText:!0,HTMLAttributes:{className:"rating-option-description-designer"},MinimalHeight:25,onValueChange:this.QO,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_NPSDescription_Label.format(10)}},Placeholder:Object(ae.a)().Designer_PlaceholderForRatingDescription,TextFieldType:0,Value:n});return oe.createElement("div",{className:"nps-label-container clearfix"},i,r)},e}(hr.a),Tr=function(t){function e(e){var n=t.call(this,e)||this;return n.Lg=n.Lg.bind(n),n.nn=n.nn.bind(n),n.Mg=n.Mg.bind(n),n.setState({ChangeWithPaste:!1}),n}Object(S.__extends)(e,t);var n=e.prototype;return n.createReactNodes=function(){return[this.VO(),this.zO(),this.UO()]},n.zO=function(){return oe.createElement("div",{className:"design-sort-list",key:"itemsList"},oe.createElement(cr,{Disabled:!1,FallbackClass:"design-question-drag-fallback",GhostClass:"design-question-drag-ghost",Handler:"design-question-drag-handler",onExchange:this.Lg},this.$O()))},n.Lg=function(t,e){var n=this.props.Master,i=n.Model.ChoiceGroup;return!(t>=i.length||e>=i.length)&&(n.bulkEdit((function(n){var r=Wt.a.convertToArray(i).sort((function(t,e){return t.Order-e.Order}));if(t>e){for(var o=r[e].Order,s=e;s<t;++s)r[s].Order=r[s+1].Order;r[t].Order=o}else{for(o=r[e].Order,s=e;s>t;--s)r[s].Order=r[s-1].Order;r[t].Order=o}n.GradingBasis=JSON.stringify(r.sort((function(t,e){return t.Order-e.Order})).map((function(t){return t.Key})))})),!0)},n.$O=function(){var t=this,n=this.props.Master,i=n.Model,r=Wt.a.convertToArray(i.ChoiceGroup).sort((function(t,e){return t.Order-e.Order})),o=e.createDragHandleIcon();return Et.map(r,(function(e,s){var a=Object(at.b)((function(){return Object(Y.c)("TextFormat")}))&&e.FormsProDisplayRTText||e.Description,c=Object(ar.b)({AllowRichText:!0,AutoFocus:t.state.SelectedElementIndex===s,AutoSelection:!0,HTMLAttributes:{className:"design-sort-list-item",onFocus:function(){t.setState({SelectedElementIndex:s})},onKeyDown:t.nn(s),onPaste:t.Mg(s)},MaxLength:Object(Pe.G)(),onValueChange:t.WO(s),Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().DesignPage_RankingOptionInputBox_AriaLabel}},Placeholder:Object(ae.a)().Designer_Choices_Placeholder,ref:t.getElementRef(s),Value:a}),u=t.state.SelectedElementIndex===s?"design-sort-item-button inline-block-display":"design-sort-item-button none-display",l=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:u,onClick:function(){Object(g.b)("DesignPage.Questions.DeleteRankingOption",{questionId:i.Id,questionType:i.Type});var e=Wt.a.convertToArray(r).sort((function(t,e){return t.Order-e.Order})),o=e[s];if(Wt.a.getObjectMasterFromModel(o).isFieldReady(xe.a.Schema.Id)){e.splice(s,1);var a=JSON.parse(i.GradingBasis),c=a.indexOf(o.Key);-1!==c&&a.splice(c,1),n.bulkEdit((function(){i.GradingBasis=JSON.stringify(a),i.ChoiceGroup=e,t.setState({SelectedElementIndex:s})}))}}},Icon:"Delete",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().Common_Delete_Text});return oe.createElement("div",{className:"design-sort-item",key:e.Key},oe.createElement("div",{className:"design-sort-item-parents"},o,c),l)}))},n.VO=function(){var t=this.props.Master.Model.IsQuiz,e=Object(ae.a)().Designer_Ranking_Tip;return t?oe.createElement("div",{className:"design-sort-tip-container",key:"correctAnswerTip"},oe.createElement(Un.a,Object(S.__assign)({},{HTMLAttributes:{className:"design-sort-list-tip forms-icon-size14x14"},IconName:"CheckMark"})),oe.createElement("span",null,e)):void 0},n.UO=function(){var t=this,e=this.props.Master.Model,n=Wt.a.convertToArray(e.ChoiceGroup).sort((function(t,e){return t.Order-e.Order}));if(!(n.length>=Object(Pe.C)())){var i={"aria-label":Object(ae.a)().Designer_Question_Equation_Button,className:"design-question-button office-form-theme-button-color",onClick:function(){Object(g.b)("DesignPage.Questions.AddRankingOption",{index:n.length,questionId:e.Id,questionType:e.Type}),t.Xg()}},r=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:i,Icon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",Text:Object(ae.a)().Designer_AddOneMore,TextClassName:"design-question-addonemore"});return oe.createElement("div",{className:"design-question-addbutton-container",key:"addOptionButton"},r)}},n.Xg=function(){var t=this,n=this.props.Master,i=n.Model,r=i.ChoiceGroup,o=Wt.a.convertToArray(r).sort((function(t,e){return t.Order-e.Order})),s=r.length,a=Object(ae.a)().Designer_Choices_DefaultDescription.format(s+1),c=Object(ye.c)(),u={Description:a,Key:c,Order:e.generateNonDuplicateOrder()};o.push(u),o.length>=Object(Pe.C)()&&Object(g.b)("DesignPage.Questions.AddItemHitLimitation",{questionId:i.Id,questionType:i.Type});var l=JSON.parse(i.GradingBasis);l.push(c),n.bulkEdit((function(){i.GradingBasis=JSON.stringify(l),i.ChoiceGroup=o,t.setState({SelectedElementIndex:i.ChoiceGroup.length-1})}))},n.WO=function(t){var e=this;return this.state.ChangeWithPaste?function(){e.setState({ChangeWithPaste:!1})}:function(n){var i=Wt.a.convertToArray(e.props.Master.Model.ChoiceGroup).sort((function(t,e){return t.Order-e.Order}))[t];i&&i.Description!==n&&(Object(at.b)((function(){return Object(Y.c)("TextFormat")}))?(i.Description=n?Object(or.b)(n,!0):n,i.FormsProDisplayRTText=Object(or.c)(n)):i.Description=n)}},n.Mg=function(t){var e=this;return function(n){var i=n.clipboardData.getData("text").replace(/\r/g,"").split("\n").join(" "),r=Et.sortBy(e.props.Master.Model.ChoiceGroup,(function(t){return t.Order}))[t];r&&(r.Description=i),e.setState({ChangeWithPaste:!0})}},n.nn=function(t){var e=this;return function(n){var i=e.props.Master.Model.ChoiceGroup.length;if(13===n.keyCode)if(t===i-1&&t<Object(Pe.C)()-1)e.Xg();else{var r=e.getElementRef(t+1).current;r&&r.focus()}}},e.generateNonDuplicateOrder=function(){return Date.now()},e.createDragHandleIcon=function(){return oe.createElement("span",{className:"design-question-drag-handler",key:"dragIcon"},oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},oe.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"})))},e}(hr.a);var xr=n(56),Fr=n(168),Pr=n(62),Dr=function(t){function e(e){var n=t.call(this,e)||this;return n.KO=oe.createRef(),n.JO=n.JO.bind(n),n.XO=n.XO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){t.prototype.componentDidMount.call(this)},n.componentDidUpdate=function(){t.prototype.componentDidUpdate.call(this)},n.createMoreMenuItems=function(){var e={Checked:this.props.Master.Model.ShowRatingLabel,Description:Object(ae.a)().Designer_MenuItemForRatingLabel,Key:"labelItem",MenuItemType:1,onExecute:this.JO};return t.prototype.createMoreMenuItems.call(this).concat(this.createValidationItem(),e,this.createAnswerTagMenuItem())},n.createReactNodes=function(){var t,e=this.props.Master.Model,n=Et.range(2,11),i=Object(xr.a)({HTMLAttributes:{className:"question-setting-label"},Label:Object(ae.a)().Designer_DescriptionForRatingRange}),r=n.map((function(t){return{DisplayName:t.toString(),Key:t,Value:t}})),o=Object(Pr.b)({Label:Object(ae.a)().Designer_DescriptionForRatingRange,onValueChange:function(t){e.Length=t,Object(g.b)("DesignPage.Questions.RatingLevelModified",{operation:"ModifyRatingLevel",questionType:e.Type})},SelectOptions:r,Value:e.Length});t=oe.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},o);var s,a=oe.createElement("div",{className:"rating-question-dropdown-container",key:"range"},i,t),c=Object(xr.a)({HTMLAttributes:{className:"question-setting-label"},Label:Object(ae.a)().Designer_DescriptionForRatingShape}),u=[{DisplayName:Object(ae.a)().Common_Number_Text,Key:te.f.Number,Value:te.f.Number},{DisplayName:Object(ae.a)().Designer_DescriptionForRatingShapeStar,Key:te.f.Star,Value:te.f.Star}],l=Object(Pr.b)({Label:Object(ae.a)().Designer_DescriptionForRatingShape,onValueChange:function(t){e.RatingShape=t},SelectOptions:u,Value:e.RatingShape});s=oe.createElement("div",{className:"question-setting-dropdown",style:{width:"110px"}},l);var h,f=oe.createElement("div",{className:"rating-question-dropdown-container",key:"shape"},c,s),d=Object(at.c)((function(){return oe.createElement("div",{className:"question-setting-container",key:"setting"},a,f)}),at.f),b=e.MinRating;b||(b=1),e.ShowRatingLabel&&(h=oe.createElement("div",{className:"rating-description-container",key:"description"},this.ZO(!0,this.KO),this.ZO(!1)));var m,v,O,p=this.createAnswerTagDiv(e.FormsProAnswerTag);if(e.RatingShape===te.f.Number){var j=Et.range(b,e.Length+1),y=j.map((function(t,e){return oe.createElement("td",{className:"office-form-question-rating-title-td",key:e},t)})),w=oe.createElement("tr",{className:"office-form-question-rating-tr"},y),S=Et.uniqueId("rating."),N=j.map((function(t,e){return oe.createElement("td",{className:"office-form-question-rating-td",key:e},oe.createElement("input",{"aria-label":t.toString(),disabled:!0,name:S,type:"radio"}))})),I=oe.createElement("tr",{className:"office-form-question-rating-tr"},N);return[oe.createElement("table",{className:"design-question-element",key:"iconTable"},w,I),d,h,p]}return e.RatingShape===te.f.Smiley?(m=e.Length,v=FormsPro.getSentimentArray(m),O=[],v.forEach((function(t){O.push(function(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"Dissatisfied":return n.SmileyControl_Dissatisfied;case"Label_Disabled_Title":return n.SmileyControl_Label_Disabled_Title;case"Neutral":return n.SmileyControl_Neutral;case"Satisfied":return n.SmileyControl_Satisfied;case"VeryDissatisfied":return n.SmileyControl_VeryDissatisfied;case"VerySatisfied":return n.SmileyControl_VerySatisfied;default:return""}}(t))})),e.FormsProSmileyList=JSON.stringify(O),[FormsPro.createSmileyRating({ContainerClass:"design-question-element",Disabled:!0,EditMode:!0,Model:this.props.Master.Model}),d,null,p]):[Object(Fr.a)({Disabled:!0,HTMLAttributes:{className:"design-question-element"},key:"ratingelement",Length:this.props.Master.Model.Length,NoTabFocus:!0,onValueChange:function(){},ShowRatingLabel:!1,Value:0}),d,h,p]},n.ZO=function(t,e){var n,i,r=this.props.Master.Model,o=r.MinRating;o||(o=1),r.RatingShape===te.f.Number?(n="office-form-rating-description-label-number",i=t?o.toString():r.Length.toString()):(n="office-form-rating-description-label-star",i=t?Object(ae.a)().RatingDescriptionTitle.format(o):Object(ae.a)().RatingDescriptionTitlePlural.format(r.Length));var s=Object(ar.c)({AllowRichText:!0,HTMLAttributes:{className:"rating-option-description-designer"},MinimalHeight:25,onValueChange:function(e){Object(Y.g)()?t?(r.LeftDescription=e&&Object(or.b)(e,!0),r.FormsProRTLeftDescription=e):(r.RightDescription=e&&Object(or.b)(e,!0),r.FormsProRTRightDescription=e):t?r.LeftDescription=e:r.RightDescription=e},Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_RatingDescription_Label.format(i)}},Placeholder:Object(ae.a)().Designer_PlaceholderForRatingDescription,ref:e,TextFieldType:Object(at.c)((function(){return 0}),at.f),Value:this.YO(t)});return oe.createElement("div",{className:"rating-description-div"},oe.createElement("div",{className:n},i),s)},n.YO=function(t){var e=this.props.Master.Model;return t?e.LeftDescription:e.RightDescription},n.XO=function(){var t=this;Object(at.b)((function(){t.KO.current&&t.KO.current.focus()}))},n.JO=function(){var t=this.props.Master.Model;Object(g.b)("DesignPage.QuestionMenu.RatingLabel",{questionType:t.Type,value:t.ShowRatingLabel}),t.ShowRatingLabel=!t.ShowRatingLabel,t.ShowRatingLabel&&window.setTimeout(this.XO,0)},e}(hr.a),Mr=n(102),Lr=n(115);var Ar=function(t){function e(e){var n=t.call(this,e,"TextField.Subtitle")||this;return n.tp=oe.createRef(),n.ep=n.ep.bind(n),n.np=n.np.bind(n),n.ip=n.ip.bind(n),n.rp=n.rp.bind(n),n.op=n.op.bind(n),n.state=Object(S.__assign)(Object(S.__assign)({},n.state),{IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!1,ShowConfirmDialog:!1,TemporaryNewPossibleAnswerNotSavedInBackEnd:""}),n.ds(),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){t.prototype.componentWillMount.call(this)},n.componentWillUnmount=function(){t.prototype.componentWillUnmount.call(this)},n.createReactNodes=function(){var t=this,e=this.props.Master,n=e.Model,i=n.Multiline?Object(ae.a)().Designer_Question_Text_Answer_Long:Object(ae.a)().Designer_Question_Text_Answer_Short,r=Object(ae.a)().TextField_DefaultPlaceholder;if(n.IsNumber)r=e.getNumberValidationErrorMessage();else if(n.IsMathQuiz){var o=new lr.a(n).getAnswers();o&&o.length>0&&o[0].isMath&&!o.some((function(t){return t.isMath!==o[0].isMath}))&&(r=Object(ae.a)().TextField_EnterMathAnswer)}var s,a={"aria-label":i,className:"form-control office-form-unselectable",disabled:!0,placeholder:r,readOnly:!0,type:"text"};s=n.Multiline?oe.createElement("textarea",Object(S.__assign)({},a)):oe.createElement("input",Object(S.__assign)({},a));var c,u=oe.createElement("div",{className:"design-question-element",key:"icon"},oe.createElement("div",{className:"design-question-text-snapshot"},s)),l=n.IsQuiz&&!n.Multiline?this.sp():void 0;Object(at.c)((function(){n.IsNumber&&(c=t.ap())}),at.f);var h=this.createAnswerTagDiv(n.FormsProAnswerTag);return[u,l,c,h]},n.createValidationItem=function(){var t=this.props.Master.Model;return{Checked:t.IsNumber,Description:Object(ae.a)().NumberValidation_Rule_Description_Label,Key:"validationItem",MenuItemType:1,onExecute:function(){Object(g.b)("DesignPage.QuestionMenu.Validation",{questionType:t.Type,value:t.IsNumber}),t.IsNumber=!t.IsNumber,t.NumberValidationRule=t.NumberValidationRule||te.b.None}}},n.createMoreMenuItems=function(){return t.prototype.createMoreMenuItems.call(this).concat(this.createValidationItem(),this.createMathItem(),this.createAnswerTagMenuItem())},n.createPhishingWarningBar=function(){return function(t){switch(t.Master.Model.SuspiciousEvidence){case 1:return Object(xi.d)({Info:Object(ae.a)().Phishing_Question_Level_Message_Suspicous,InlineHrefInfo:Object(Y.c)("EnableNotifyAdminForApprovalAPI")?Object(ae.a)().Notify_Your_Admin_For_Approval_Link:null,onClickInlineHref:Object(Y.c)("EnableNotifyAdminForApprovalAPI")?function(){Object(Me.i)(t.Master.Form).notifyAdminForApproval(t.Master.Form.Model.Id).then((function(){t.Master.Model.SuspiciousEvidence=3,t.Master.Form.Model.NotifiedAdminForApproval=!0}))}:null,TipBarIconClassName:"ms-Icon ms-Icon--Error forms-icon-size20x20",TipBarLocation:"Question",TipBarStyle:"RedBackground"});case 2:return Object(xi.d)({Info:Object(ae.a)().Phishing_Question_Level_Message_Good,TipBarIconClassName:"ms-Icon ms-Icon--Completed forms-icon-size20x20",TipBarLocation:"Question",TipBarStyle:"GreenBackground"});case 3:return Object(xi.d)({Info:Object(ae.a)().Phishing_Question_Level_Message_Admin_Notified,TipBarIconClassName:"ms-Icon ms-Icon--Recent forms-icon-size20x20",TipBarLocation:"Question",TipBarStyle:"RedBackground"});default:return null}}({Master:this.props.Master})},n.sp=function(){var t=this.props.Master.Model,e=new lr.a(t).getAnswers(),n=this.cp(e),i=this.up(e,t),r=this.lp();return oe.createElement("div",{className:"design-question-element",key:"correctAnswer"},oe.createElement("div",null,Object(ae.a)().Designer_ShortText_PossibleAnswers_Label),n,i,r)},n.cp=function(t){var e=[];if(t&&t.length>0)for(var n=this.state.IsLastPossibleAnswerEditable?t.length-2:t.length-1,i=0;i<=n;i++){var r=this.hp(t[i]);e.push(r)}return e},n.up=function(t,e){var n,i=this,r=!1,o=function(t){},s=new lr.a(e);if(this.state.IsLastPossibleAnswerEditable){var a=t[t.length-1];n=a.answer,o=function(t){""===t?(s.deleteAnswer(a.id),e.GradingBasis=s.serialize(),i.fp(),i.dp(),i.setState({IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!0})):(!s.updateAnswer(a.id,t,!e.IsAnswerPlainText)&&(s.deleteAnswer(a.id),i.dp(),i.setState({IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!0,TemporaryNewPossibleAnswerNotSavedInBackEnd:t})),e.GradingBasis=s.serialize(),i.fp());s.areAnyAnswersDefined()||i.bp()}}else this.state.ShouldShowNewPossibleAnswerInputField&&(n=this.state.TemporaryNewPossibleAnswerNotSavedInBackEnd,r=!0,o=function(t){if(""!==t){var n=s.areAnyAnswersDefined();if(!s.addAnswer(t,!e.IsAnswerPlainText))return void i.setState({TemporaryNewPossibleAnswerNotSavedInBackEnd:t});n||i.mp(),i.vp(),e.GradingBasis=s.serialize(),i.fp(),i.setState({IsLastPossibleAnswerEditable:!0,ShouldShowNewPossibleAnswerInputField:!1,TemporaryNewPossibleAnswerNotSavedInBackEnd:""})}else i.setState({TemporaryNewPossibleAnswerNotSavedInBackEnd:""})});if(this.state.IsLastPossibleAnswerEditable||this.state.ShouldShowNewPossibleAnswerInputField){var c=s.areAnyAnswersDefined()?Object(ae.a)().Designer_ShortText_NextNewPossibleAnswer_Placeholder:Object(ae.a)().Designer_ShortText_FirstNewPossibleAnswer_Placeholder;if(e.IsMathQuiz){if(e.IsAnswerPlainText){var u=Object(ar.b)({AutoFocus:!0,HTMLAttributes:{className:"office-form-textfield-input",id:"newCorrectMathAnswerInputBox"},onValueChange:o,Options:{HTMLPropsForInnerElement:{className:"design-question-short-correct-answer-input",onBlur:this.rp,onKeyDown:this.op}},Placeholder:c,Value:n});return oe.createElement("div",{className:"design-question-short-correct-math-answer-container",ref:this.tp},u,this.gp())}var l={className:"office-form-textfield-input",id:"newCorrectMathAnswerFormulaDesigner",onKeyDown:this.op};return oe.createElement("div",{className:"design-question-short-correct-math-answer-container"},oe.createElement(rr.a,{blockEndDesignMode:this.blockEndDesignMode,Disabled:!1,ForceDesignMode:!0,HasFocus:!0,HTMLAttributes:l,key:"textmathquestion",Location:"TextField.Answer",onBoxBlur:this.rp,onRenderComplete:this.mathCalculation,onValueChange:o,Placeholder:c,QuestionId:e.Id,containerRef:this.tp,Value:n},this.gp()))}return Object(ar.b)({AutoFocus:r,HTMLAttributes:{className:"office-form-textfield-input design-question-short-correct-answer-container",id:"newCorrectAnswerInputBox",onBlur:this.rp,onKeyDown:this.op},onValueChange:o,Options:{HTMLPropsForInnerElement:{className:"design-question-short-correct-answer-input"}},Placeholder:c,Value:n})}},n.lp=function(){var t=this;if(!this.state.IsLastPossibleAnswerEditable&&!this.state.ShouldShowNewPossibleAnswerInputField){var e={className:"design-question-button design-question-short-add-answer-button office-form-theme-button-color",onClick:function(){t.Op()},ref:"addAnswerButton"};return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:e,Icon:"Add",IconClassName:"forms-icon-size18x18 office-form-theme-primary-foreground",Text:Object(ae.a)().Designer_ShortText_AddNewPossibleAnswerButton_Label,TextClassName:"design-question-addonemore"})}},n.hp=function(t){var e=this,n=this.props.Master.Model,i="correctAnswer"+t.id,r=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"design-question-short-correct-answer-delete-button",onClick:function(){return e.pp(n,t.id)}},Icon:"Delete",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().Designer_ShortText_DeleteCorrectAnswerButton_AccessibilityFormat.format(t.answer)}),o=Object(Un.b)({HTMLAttributes:{className:"office-form-right-answerkey forms-icon-size16x16",role:"presentation"},IconName:"CheckMark"}),s=this.state.ActivatedPossibleAnswerId===t.id?r:o,a=this.state.IsLastPossibleAnswerEditable||this.state.ShouldShowNewPossibleAnswerInputField?"":" design-question-short-correct-answer-box-margin",c=Object(ae.a)().Designer_ShortText_CorrectAnswer_AccessibilityFormat.format(t.answer),u=t.isMath?Object(rr.c)({Formula:t.answer}):t.answer;return oe.createElement("div",{"aria-labelledby":i,className:"design-question-short-correct-answer-box"+a,key:i,onFocus:this.np(t.id),onMouseEnter:this.np(t.id),onMouseLeave:this.ip,tabIndex:0},oe.createElement("a",{className:"screenReaderVisible",id:i},c),oe.createElement("span",{"aria-hidden":"true",role:"presentation"},u),s)},n.gp=function(){var t,e,n,i,r=this.props.Master.Model,o="design-question-choice-to-math-button";return this.props.IsMobile&&(o=Object(pn.b)(o,"isMobile")),hr.c===this.state.SelectedElementIndex&&(o=Object(pn.b)(o,"active-choice")),r.IsAnswerPlainText?(t={className:o,id:"textFieldAnswerMathSwitcher",onClick:this.ep},e="NumberField",n=Object(ae.a)().Designer_Question_Equation_Button,i=Object(ae.a)().Designer_Question_Equation_Button_Tooltip):(t={className:o,id:"textFieldAnswerMathSwitcher",onClick:this.ep},e="TextField",n=Object(ae.a)().Designer_Question_EquationToText_Button,i=Object(ae.a)().Designer_Question_EquationToText_Button_Tooltip),Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:Object(pn.g)(this.getElementFocusingProps(hr.c),t),Icon:e,IconClassName:"design-question-choice-to-math-button-icon",Text:n,Tooltip:i})},n.ep=function(){var t=this.props.Master.Model;t.IsAnswerPlainText=!t.IsAnswerPlainText,Object(g.b)(t.IsAnswerPlainText?"DesignPage.Quiz.SwitchMathToTextInput":"DesignPage.Quiz.SwitchTextToMathInput",{location:"TextField.Answer",questionId:t.Id}),this.forceUpdate()},n.fp=function(){this.props.Master.Model.IsMathQuiz&&this.ds()},n.ds=function(){var t=this.props.Master.Model;if(!t.IsMathQuiz)return t.IsAnswerPlainText=!0,t.IsMathInputDefault=!1,void(t.InputSwitcherDisabled=!0);var e=new lr.a(t).getAnswers();e&&e.length>0?(e[e.length-1].isMath?t.IsAnswerPlainText=!1:t.IsAnswerPlainText=!0,t.IsMathInputDefault=e.some((function(t){return t.isMath})),t.InputSwitcherDisabled=!e.some((function(t){return t.isMath!==e[0].isMath}))):(t.IsAnswerPlainText=!1,t.IsMathInputDefault=!0,t.InputSwitcherDisabled=!1)},n.np=function(t){var e=this;return function(){e.setState({ActivatedPossibleAnswerId:t})}},n.ip=function(){this.setState({ActivatedPossibleAnswerId:void 0})},n.rp=function(t){if(t){var e=Object(pn.d)(t),n=this.tp.current;if(e&&n&&n===e.parentElement)return}if(this.state.IsLastPossibleAnswerEditable){var i=this.props.Master.Model,r=new lr.a(i),o=r.getAnswers();if(o&&o.length>0){var s=o[o.length-1],a=s.answer.trim();if(a!==s.answer||!i.IsAnswerPlainText!==s.isMath)!r.updateAnswer(s.id,a,!i.IsAnswerPlainText)&&r.deleteAnswer(s.id),i.GradingBasis=r.serialize(),this.fp()}}this.setState({IsLastPossibleAnswerEditable:!1,ShouldShowNewPossibleAnswerInputField:!1,TemporaryNewPossibleAnswerNotSavedInBackEnd:""})},n.op=function(t){13===t.keyCode&&(this.rp(),this.Op())},n.Op=function(){this.setState({ShouldShowNewPossibleAnswerInputField:!0})},n.pp=function(t,e){var n=new lr.a(t);n.deleteAnswer(e),t.GradingBasis=n.serialize(),this.fp(),n.areAnyAnswersDefined()||this.bp(),this.dp()},n.vp=function(){Object(g.b)("DesignPage.Questions.ShortTextAnswerAdded",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.dp=function(){Object(g.b)("DesignPage.Questions.ShortTextAnswerDeleted",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.mp=function(){Object(g.b)("DesignPage.Questions.FirstShortTextAnswerAdded",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.bp=function(){Object(g.b)("DesignPage.Questions.LastRemainingShortTextAnswerDeleted",{isMathAnswer:!this.props.Master.Model.IsAnswerPlainText,isMathQuestion:this.props.Master.Model.IsMathQuiz,questionId:this.props.Master.Model.Id})},n.jp=function(){var t,n,i,r,o,s,a,c,u=this,l=this.props.Master,h=l.Model;if(h.IsNumber||h.HasTFRestrictionForPro){t=Object(xr.a)({HTMLAttributes:{className:"question-setting-label"},Label:Object(ae.a)().NumberValidation_Rule_Description_Label});var f=Object(Pr.b)({onValueChange:function(t){return h.NumberValidationRule=t},SelectOptions:e.getNumberValidationRuleDisplayNames(),Value:h.NumberValidationRule,Label:Object(ae.a)().Designer_Question_Text_Restriction_Condition_AriaLabel}),d=!1,b=!0,m=!0,v=h.NumberValidationRule;h.FormsProValidationType===te.g.Email?(b=!1,m=!1):h.FormsProValidationType===te.g.Custom?(d=!0,b=!1,m=!1):h.IsNumber&&(n=oe.createElement("div",{className:"question-setting-dropdown",style:{width:"240px"}},f));var O=Object(Pr.b)({onValueChange:function(t){return function(t){Object(g.e)({eventInfo:{validationType:h.FormsProValidationType},type:"DesignPage.QuestionMenu.ValidationType"}),h.FormsProValidationType=t}(t)},SelectOptions:e.getRestTypeDisplayNames(),Value:h.FormsProValidationType,Label:Object(ae.a)().Designer_Question_Text_Restriction_Type_AriaLabel});if(i=oe.createElement("div",{className:"question-setting-dropdown",style:{width:"185px"}},O),d&&(r=Object(ar.b)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div number-validation-boundary-width",onBlur:function(){return u.yp()}},onValueChange:function(t){h.FormsProCustomRegEx=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Placeholder:Object(ae.a)().CustomRegExPlaceholder,Value:h.FormsProCustomRegEx})),h.FormsProValidationType!==te.g.Number||v!==te.b.Between&&v!==te.b.NotBetween)switch(v){case te.b.None:b=!1,m=!1;break;case te.b.Less:case te.b.LessOrEqual:b=!1;break;default:m=!1}else a=Object(xr.a)({HTMLAttributes:{className:"number-validation-between-label"},Label:Object(ae.a)().NumberValidation_Between_Label});b&&(o=Object(ar.b)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div number-validation-boundary-width",onBlur:function(){return l.justifyNumberBoundaries()}},onValueChange:function(t){h.NumberMinBoundary=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:h.NumberMinBoundary})),m&&(s=Object(ar.b)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div number-validation-boundary-width",onBlur:function(){return l.justifyNumberBoundaries()}},onValueChange:function(t){h.NumberMaxBoundary=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:h.NumberMaxBoundary})),c=this.wp()}return oe.createElement("div",{className:"question-setting-container",key:"FormsProNumberValidation"},t,i,n,r,o,a,s,c)},n.Sp=function(){var t=this.props.Master.Model,e=!0;try{new RegExp(t.FormsProCustomRegEx)}catch(t){e=!1}return e},n.yp=function(){var t=this.props.Master.Model;t.FormsProCustomRegEx&&this.Sp()||(t.FormsProCustomRegEx=".*")},n.ap=function(){var t,n,i,r,o,s,a=this.props.Master,c=a.Model;if(c.IsNumber){t=Object(xr.a)({HTMLAttributes:{className:"question-setting-label"},Label:Object(ae.a)().NumberValidation_Rule_Description_Label});var u=Object(ae.a)().NumberValidation_Rule_Description_Label,l=Object(Pr.b)({Label:u+" "+Object(Lr.b)(c.NumberValidationRule),onValueChange:function(t){return c.NumberValidationRule=t},SelectOptions:e.getNumberValidationRuleDisplayNames(),Value:c.NumberValidationRule});n=oe.createElement("div",{className:"question-setting-dropdown",style:{width:"240px"}},l);var h=!0,f=!0,d=c.NumberValidationRule;if(d!==te.b.Between&&d!==te.b.NotBetween)switch(d){case te.b.None:h=!1,f=!1;break;case te.b.Less:case te.b.LessOrEqual:h=!1;break;default:f=!1}else o=Object(xr.a)({HTMLAttributes:{className:"number-validation-between-label"},Label:Object(ae.a)().NumberValidation_Between_Label});h&&(i=Object(ar.b)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div",onBlur:function(){return a.justifyNumberBoundaries()}},onValueChange:function(t){c.NumberMinBoundary=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:c.NumberMinBoundary})),f&&(r=Object(ar.b)({AutoSelection:!0,HTMLAttributes:{className:"number-validation-boundary-div",onBlur:function(){return a.justifyNumberBoundaries()}},onValueChange:function(t){c.NumberMaxBoundary=t},Options:{HTMLPropsForInnerElement:{className:"number-validation-content"}},Value:c.NumberMaxBoundary})),s=this.Np()}return oe.createElement("div",{className:"question-setting-container",key:"numberValidation"},t,n,i,o,r,s)},n.wp=function(){var t=this.props.Master.Model;if(t.HasTFRestrictionForPro)switch(t.FormsProValidationType){case te.g.Custom:if(!t.FormsProCustomRegEx||!this.Sp())return Object(xr.a)({HTMLAttributes:{className:"validation-design-error-message-label"},Label:Object(ae.a)().ValidCustomRegExErrMsg});break;case te.g.Number:return this.Np()}return null},n.Np=function(){var t,e=this.props.Master.Model,n=e.NumberMinBoundary||"",i=e.NumberMaxBoundary||"",r=e.NumberValidationRule,o="";switch(e.NumberMinBoundary&&(Object(Mr.b)(n)||(o=Object(ae.a)().Invalid_Number_Errmessage_In_DesignTime_Label)),e.NumberMaxBoundary&&(Object(Mr.b)(i)||(o=Object(ae.a)().Invalid_Number_Errmessage_In_DesignTime_Label)),r){case te.b.Between:case te.b.NotBetween:if(e.NumberMinBoundary&&e.NumberMaxBoundary){var s=parseFloat(Object(Mr.a)(n)),a=parseFloat(Object(Mr.a)(i));!isNaN(s)&&!isNaN(a)&&s>a&&(o=Object(ae.a)().Invalid_Boundary_ErrMessage_In_DesignTime_Label)}}return o&&(t=Object(xr.a)({HTMLAttributes:{className:"validation-design-error-message-label"},Label:o})),t},e.getRestTypeDisplayNames=function(){for(var t=[],e=te.g.Number;e<=te.g.Custom;e++)t.push({DisplayName:Object(Lr.c)(e),Key:e,Value:e});return t},e.getNumberValidationRuleDisplayNames=function(){for(var t=[],e=te.b.None;e<te.b.Max;++e)t.push({DisplayName:Object(Lr.b)(e),Key:e,Value:e});return t},e}(fr);function Rr(t){var e=function(t){switch(t){case"Question.Choice":return dr;case"Question.TextField":return Ar;case"Question.DateTime":return br;case"Question.FileUpload":return mr.a;case"Question.MatrixChoiceGroup":return Ir;case"Question.NPS":return kr;case"Question.Ranking":return Tr;case"Question.Rating":return Dr;default:throw Error('Type "'+t+'" has not been registered.')}}(t.Master.Model.Type);if(e)return oe.createElement(e,t)}var Er,Br=n(156),_r=n(79),Hr=n(147);!function(t){t[t.None=0]="None",t[t.SimilarMathQuestionSuggestions=1]="SimilarMathQuestionSuggestions"}(Er||(Er={}));var Gr=n(146);function qr(t,e,n){var i;switch(t.QuestionType){case"Question.Choice":i=_r.a.createDefaultDefinition();var r=void 0;r=(r=t.IncorrectAnswers.map((function(t){return{Description:t,IsGenerated:!0,IsMathOption:!0}}))).concat({Description:t.CorrectAnswer,IsAnswerKey:!0,IsGenerated:!0,IsMathOption:!0}),i.Choices=Et.shuffle(r);break;case"Question.DateTime":i=Gr.a.createDefaultDefinition();break;case"Question.TextField":i=Lr.a.createDefaultDefinition();break;case"Question.Rating":i=Hr.a.createDefaultDefinition();break;default:return null}return i.Title=t.QuestionTitle,i.Subtitle=t.Formula,i.IsMathQuiz=!0,i.IsQuiz=!0,i.ShowSubtitle=!0,i.Point=e,i.Required=n,i}var Qr={createMathQuestionByType:qr,getMathQuestionsSuggestion:function(t,e,n){var i={Context:JSON.stringify(t),Features:Er.SimilarMathQuestionSuggestions,FormId:t.FormId,IncorrectAnswerCount:3,Origin:t.Origin,QuestionCount:e||3,QuestionId:t.QuestionId};return tr.getInstance().mathQuestionGeneration(i,n).then(function(t){return function(e){var n={MatchQuery:!0,Templates:[]},i=e;if(i&&i.Results&&i.Results.length&&i.Results[0].Result&&i.Results[0].Result.Questions){var r=[];i.Results[0].Result.Questions.map((function(e){var n=qr(e,t.QuestionPoints,t.QuestionRequired);null!==n&&r.push(n)})),n.Templates.push({Questions:r,TemplateId:i.Results[0].Result.Id}),n.Templates=mn.a.getFilteredTemplates(n.Templates)}return n}}(t)).catch((function(t){return t}))}},Vr=n(133),zr=function(t){function e(e){var n=t.call(this,e)||this;return n.Ip=n.Ip.bind(n),n.Cp=n.Cp.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t,e=this.props.Question,n=this.props.Selected,i=this.props.Index,r="form-intelligence-question-row",o="forms-icon-size18x18";if(n)r=Object(pn.b)(r,this.props.IsMobile&&"mobile-office-form-intelligence-theme-li",!this.props.IsMobile&&"office-form-intelligence-theme-li"),o="office-form-theme-secondary-color",t="CheckMark";else{switch(e.Type){case"Question.Choice":t="RadioBtnOn",o="forms-icon-size16x16";break;case"Question.TextField":t="TextField",o="forms-icon-size20x20";break;case"Question.Rating":t="Like";break;case"Question.DateTime":t="Calendar";break;case"Question.Ranking":t="Sort";break;case"Question.MatrixChoiceGroup":t="ViewList";break;case"Question.NPS":t="AutoRacing",o="forms-icon-size20x20";break;case"Question.FileUpload":t="Upload";break;default:t="Add"}o=Object(pn.b)(o,"form-intelligence-icon-black")}o=Object(pn.b)(o,"form-intelligence-question-row-icon");var s,a={className:r,key:"formIntelligenceRow"+i,onClick:this.Ip,onKeyDown:this.Cp,ref:"formIntelligenceRow"+i,tabIndex:0};if(e.IsMathQuiz){var c=Object(rr.c)({DisableLinebreaks:!0,Formula:e.Subtitle});s=oe.createElement("div",{className:"form-intelligence-question-row-math-container"},oe.createElement("p",{className:"form-intelligence-question-row-math-text"},e.Title),oe.createElement("div",{className:"form-intelligence-question-row-math-formula"},c))}else s=oe.createElement("p",{className:"form-intelligence-question-row-text"},e.Title);var u=Object(Un.b)({HTMLAttributes:{className:o},IconName:t});return oe.createElement("div",{className:"form-intelligence-question-row-container",key:"formIntelligenceRowContainer"+i},oe.createElement("div",Object(S.__assign)({},a),s,u))},n.Ip=function(){this.props.changeQuestionSuggestion(this.props.Index,this.props.Selected)},n.Cp=function(t){switch(t.stopPropagation(),t.keyCode){case 32:case 13:this.props.changeQuestionSuggestion(this.props.Index,this.props.Selected),t.preventDefault()}},e}(ue.a),Ur=n(208),$r=function(t){function e(e){return t.call(this,e)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.getContainerClassName();return oe.createElement("div",{className:t,key:"formIntelligenceCardContainer",id:"form-intelligence-question-suggestion-card",tabIndex:-1},this.createHeader(),this.kp(),this.createQuestionGroup(),this.createGallery())},n.getContainerClassName=function(){return"form-intelligence-container office-form-theme-focus-border office-form-theme-border-top"},n.createHeader=function(){var t=Object(ae.a)().IntelligenceSuggestion_Title,e=oe.createElement("div",{className:"form-intelligence-header-count-container"},oe.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),oe.createElement("span",{className:"form-intelligence-ideas-title"},t));return oe.createElement("div",{className:"form-intelligence-header-container"},e,oe.createElement("div",{className:"form-intelligence-header-button-container"},oe.createElement("div",{className:"form-intelligence-header-buttons"},this.createAddButton(),this.createCloseButton())))},n.createSubHeader=function(){return null},n.createAddButton=function(){var t={ButtonStyle:"LightBackground",HTMLAttributes:{className:Object(pn.b)("form-intelligence-header-add-button","office-form-theme-interactive-color"),onClick:this.props.onClickAdd},Text:this.getTextForAddButton()};return oe.createElement(Gi.a,Object(S.__assign)({},t))},n.createCloseButton=function(){return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this.props.onClickClose},Icon:"Cancel",IconClassName:"forms-icon-size14x14"})},n.createGallery=function(){var t=this;if(this.props.Templates.length<=1)return null;var e=this.props.Templates.map((function(e,n){return oe.createElement(Ur.a,{changeGalleryDot:t.props.changeGalleryDot,Index:n,key:n,Selected:n===t.props.TemplateIndex})}));return oe.createElement("div",{className:"question-suggestion-card-gallery"},oe.createElement("div",{className:"question-suggestion-card-gallery-dots-container"},e))},n.getTextForAddButton=function(){var t,e=this.Tp(),n=this.props.SelectedIndex.reduce((function(t,e){return t.concat(e)})).length;this.props.Templates.length>1&&n>0?t=Object(ae.a)().IntelligenceSuggestion_Add_With_Count.format(n):t=n>0?Object(ae.a)().IntelligenceSuggestion_Add:1===e.length?Object(ae.a)().IntelligenceSuggestion_AddQuestion:Object(ae.a)().IntelligenceSuggestion_AddAll;return t},n.createQuestionGroup=function(){var t=this,e=this.Tp().map((function(e,n){return oe.createElement(zr,{changeQuestionSuggestion:t.props.changeQuestionSuggestion,Index:n,IsMobile:t.props.IsMobile,key:n,Question:e,Selected:t.props.SelectedIndex[t.props.TemplateIndex].indexOf(n)>=0})}));return oe.createElement("div",{className:"form-intelligence-question-group",key:"formIntelligenceGroup",role:"group"},e)},n.kp=function(){if(!Object(u.a)().userInfo.IsMsa)return this.createSubHeader()},n.Tp=function(){return this.xp().filter((function(t){return"Question.MatrixChoice"!==t.Type}))},n.xp=function(){return this.props.Templates[this.props.TemplateIndex].Questions},e}(ue.a),Wr=n(92),Kr=function(t){function e(e){var n=t.call(this,e)||this;return n.Ac=Object(_t.h)(),n.Fp=oe.createRef(),n.Pp=n.Pp.bind(n),n.Dp=n.Dp.bind(n),n.Mp=n.Mp.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.Lp()},n.componentDidUpdate=function(){this.Lp()},n.render=function(){return oe.createElement("div",{className:"mobile-bottom-view"},oe.createElement("div",{className:"mobile-frost-gray-backgrond"}),this.Ap())},n.closeBottomView=function(t){this.props.WithAnimation?(this.Fp.current.className=Object(pn.b)("mobile-design-bottom-view-button-group insertCard",Object(Wr.h)()&&"new-ux",this.props.WithAnimation&&"bottom-move-down"),this.Fp.current.addEventListener("animationend",t)):t()},n.Ap=function(){var t=Object(pn.b)("mobile-design-bottom-view-button-group insertCard",Object(Wr.h)()&&"new-ux",this.props.WithAnimation&&"bottom-move-up"),e=this.props.HTMLAttributes&&this.props.HTMLAttributes["aria-label"];return oe.createElement("div",{"aria-label":e,className:t,onBlur:this.props.CannotBeBlurred?void 0:this.Pp,onKeyUp:this.Mp,ref:this.Fp,tabIndex:0},this.props.children)},n.Pp=function(t){t.stopPropagation();var e=Object(pn.d)(t);$("div.insertCard").has(e).length>0||e.className.indexOf("insertCard")>=0||$("div.people-picker-container").length>0||this.closeBottomView(this.Dp)},n.Dp=function(){this.Ac.Model.BottomView="None",this.props.onCloseView&&this.props.onCloseView()},n.Lp=function(){this.Fp&&this.Fp.current&&this.Fp.current.focus()},n.Mp=function(t){switch(t.keyCode){case 27:t.preventDefault(),t.stopPropagation(),this.closeBottomView(this.Dp)}},e}(ue.a),Jr=function(t){function e(e){var n=t.call(this,e)||this;return n.Rp=oe.createRef(),n.Ep=n.Ep.bind(n),n.Bp=n.Bp.bind(n),n._p=n._p.bind(n),n.Hp=n.Hp.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.getContainerClassName();return oe.createElement(Kr,{onCloseView:this._p,ref:this.Rp,WithAnimation:!0},oe.createElement("div",{className:t,key:"formIntelligenceCardContainer",tabIndex:-1},this.createHeader(),this.createQuestionGroup(),this.createGallery()))},n.getContainerClassName=function(){return"mobile-intelligence-container"},n.createAddButton=function(){var t={ButtonStyle:"LightBackground",HTMLAttributes:{className:"form-intelligence-header-add-button",onClick:this.Hp},Text:this.getTextForAddButton()};return oe.createElement(Gi.a,Object(S.__assign)({},t))},n.createCloseButton=function(){var t=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this._p},Icon:"Cancel",IconClassName:"forms-icon-size18x18"});return oe.createElement("div",{className:"mobile-intelligence-template-close-container"},t,oe.createElement("div",{className:"form-intelligence-line"}))},n.createGallery=function(){return null},n.Ep=function(){this.props.onClickAdd(),Object(_t.h)().Model.BottomView="None"},n.Hp=function(){this.Rp.current.closeBottomView(this.Ep)},n.Bp=function(){this.props.onClickClose(),Object(_t.h)().Model.BottomView="None"},n._p=function(){this.Rp.current.closeBottomView(this.Bp)},e}($r);function Xr(t){return t&&t.Templates||[]}var Zr=function(t){function e(e){var n=t.call(this,e)||this;return n.state={SelectedIndex:[],TemplateIndex:0,Templates:[]},n.closeSuggestionCard=n.closeSuggestionCard.bind(n),n.changeGalleryDot=n.changeGalleryDot.bind(n),n.changeQuestionSuggestion=n.changeQuestionSuggestion.bind(n),n.onClickAddButton=n.onClickAddButton.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUpdate=function(t,e){var n=this.state;!this.props.ShowSuggestionCard&&t.ShowSuggestionCard?(this.Gp(n.Templates),this.askSuggestion()):this.props.ShowSuggestionCard&&!Et.isEqual(n.Templates,e.Templates)&&this.Gp(e.Templates)},n.render=function(){return this.props.ShowSuggestionCard&&this.state.Templates&&0!==this.state.Templates.length?this.qp():null},n.createSuggestionCardLayout=function(){return oe.createElement($r,Object(S.__assign)({},this.props,{changeQuestionSuggestion:this.changeQuestionSuggestion,changeGalleryDot:this.changeGalleryDot,onClickAdd:this.onClickAddButton,onClickClose:this.closeSuggestionCard,SelectedIndex:this.state.SelectedIndex,TemplateIndex:this.state.TemplateIndex,Templates:this.state.Templates}))},n.updateSuggestion=function(t){Et.isEqual(this.state.Templates,t)||this.setState({SelectedIndex:t.map((function(t){return[]})),TemplateIndex:0,Templates:t})},n.onClickAddButton=function(){this.state.SelectedIndex.forEach((function(t){return t.sort()}));var t=this.state.Templates||[],e=t[this.state.TemplateIndex],n=e.TemplateId,i=t.map((function(t){return t.Questions})).reduce((function(t,e){return t.concat(e)})),r=!1,o=!1,s=this.state.SelectedIndex.map((function(e,n){var i=t[n],s=i.Questions.filter((function(t){return"Question.MatrixChoice"!==t.Type}));return e&&e.length&&(to(i)?r=!0:o=!0),e.map((function(t){return s[t]}))})).reduce((function(t,e){return t.concat(e)})),a=0===s.length;a&&(s=this.Tp(),to(e)?r=!0:o=!0);var c="",u=this.props.Form.getInstanceId();if(u){var l=Object(Vr.b)(u);l&&l.Model&&l.Model.suggestions&&(c=JSON.stringify(l.Model.suggestions))}var h=Yr(t),f=this.props.Form.Model.Settings.IsQuizMode;Object(g.b)(a?"IntelligenceStatistic.QuestionSuggestion.AddAll":"IntelligenceStatistic.QuestionSuggestion.Add",{AddedQuestionsCount:s.length,HasHistoryQuestion:r,HasTemplateQuestion:o,IsMathSuggestion:i.some((function(t){return t.IsMathQuiz})),IsMobile:this.props.IsMobile,IsQuiz:f,ModelType:e.AlgorithmType,SelectedQuestions:s.map((function(t){return t.Id})),SuggestedQuestionsCount:i.length,SuggestTemplate:1===this.getSuggestionType(),TemplateId:n,TemplateIds:this.state.Templates.map((function(t){return t.TemplateId})),TemplateIndex:this.state.TemplateIndex,ThemeCategories:c,Type:h}),Object(g.b)(a?"Intelligence.QuestionSuggestion.AddAll":"Intelligence.QuestionSuggestion.Add",{HasHistoryQuestion:r,HasTemplateQuestion:o,IsMathSuggestion:i.some((function(t){return t.IsMathQuiz})),IsMobile:this.props.IsMobile,IsNPSSuggestion:"10"===n,IsQuiz:f,ModelType:e.AlgorithmType,SuggestTemplate:1===this.getSuggestionType(),Type:h}),Object(Y.c)("PersonalContextSuggestion")&&1===this.getSuggestionType()&&mn.a.logUserSignal({AdoptTemplates:[e.TemplateId],FormId:this.props.Form.Model.Id,UserSignalType:1}),this.setState({SelectedIndex:[],Templates:[]}),n=n||"",this.Qp(i,s),this.props.collapseInsertPane()},n.changeQuestionSuggestion=function(t,e){var n=this.state.SelectedIndex,i=n[this.state.TemplateIndex].indexOf(t);i>=0&&e?n[this.state.TemplateIndex].splice(i,1):n[this.state.TemplateIndex].push(t),this.setState({SelectedIndex:n})},n.closeSuggestionCard=function(){var t=this.Tp(),e=this.state.Templates[this.state.TemplateIndex],n=e.TemplateId,i=e.AlgorithmType||-1;Object(g.b)("IntelligenceStatistic.QuestionSuggestion.Dismiss",{IsMathSuggestion:t.some((function(t){return t.IsMathQuiz})),IsMobile:this.props.IsMobile,ModelType:e.AlgorithmType,SuggestedQuestionsCount:t.length,SuggestTemplate:1===this.getSuggestionType(),TemplateId:n,Type:i}),Object(g.b)("Intelligence.QuestionSuggestion.Dismiss",{IsMathSuggestion:t.some((function(t){return t.IsMathQuiz})),IsMobile:this.props.IsMobile,IsNPSSuggestion:"10"===n,ModelType:e.AlgorithmType,SuggestTemplate:1===this.getSuggestionType(),Type:i}),this.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})},n.changeGalleryDot=function(t){this.setState({TemplateIndex:t})},n.Qp=function(t,e){var n,i=this.props.Form.FormElementManager,r=this.props.InsertAfter;if(r||"Title"===r){e.reverse();var o="Title"===r?null:r;n=function(t,e){return i.insertElementAfter(t,o,e)}}else n=function(t,e){return i.appendElement(t,e)};e.forEach((function(e){var i;"Question.MatrixChoiceGroup"===(e=Et.clone(e)).Type&&(i=t.filter((function(t){return t.GroupId===e.Id})).map((function(t){var e=Et.clone(t);return delete e.Id,e}))),delete e.Id,n(e,i)})),this.props.designElement&&this.props.designElement(null)},n.qp=function(){return this.props.IsMobile?this.Vp():this.createSuggestionCardLayout()},n.Vp=function(){return oe.createElement("div",{className:"mobile-template-suggestion-container"},oe.createElement(Jr,Object(S.__assign)({},this.props,{changeQuestionSuggestion:this.changeQuestionSuggestion,changeGalleryDot:this.changeGalleryDot,onClickAdd:this.onClickAddButton,onClickClose:this.closeSuggestionCard,SelectedIndex:this.state.SelectedIndex,TemplateIndex:this.state.TemplateIndex,Templates:this.state.Templates})))},n.Tp=function(){return this.xp().filter((function(t){return"Question.MatrixChoice"!==t.Type}))},n.xp=function(){return this.state.Templates[this.state.TemplateIndex].Questions},n.Gp=function(t){if(0!==t.length){var e=this.props.Form,n=Yr(t),i=e.Model.Settings.IsQuizMode,r="",o=e.getInstanceId();if(o){var s=Object(Vr.b)(o);s&&s.Model&&s.Model.suggestions&&(r=JSON.stringify(s.Model.suggestions))}Object(g.b)("IntelligenceStatistic.QuestionSuggestion.Show",{IsMathSuggestion:t.filter((function(t){return t.Questions.some((function(t){return t.IsMathQuiz}))})).length>0,IsMobile:this.props.IsMobile,IsQuiz:i,ModelTypes:t.map((function(t){return t.AlgorithmType})),TemplateId:t.map((function(t){return t.TemplateId})),ThemeCategories:r,Type:n}),Object(g.b)("Intelligence.QuestionSuggestion.Show",{IsMathSuggestion:t.filter((function(t){return t.Questions.some((function(t){return t.IsMathQuiz}))})).length>0,IsMobile:this.props.IsMobile,IsNPSSuggestion:t.some((function(t){return"10"===t.TemplateId})),IsQuiz:i,ModelTypes:t.map((function(t){return t.AlgorithmType})),SuggestionTemplate:1===this.getSuggestionType(),Type:n})}},e}(ue.a);function Yr(t){return Et.first(t.map((function(t){return t.AlgorithmType})).filter((function(t){return t>0})))||-1}function to(t){return t.TemplateId===mn.a.HISTORYTEMPLATEID}var eo=function(t){function e(e){var n=t.call(this,e)||this;n.zp=500,n.Up=n.Up.bind(n),n.askSuggestion=n.askSuggestion.bind(n),n.$p=n.$p.bind(n);var i=n.props.Question;return i.observe(n.Up,[i.Schema.Title]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.Question.unobserve(this.Up)},n.askSuggestion=function(){var t=this.props.Form,e=this.props.Question;t.SettingMaster.Model.IsQuizMode&&e&&e.Model.IsMathQuiz?this.Wp():!t.SettingMaster.Model.IsQuizMode&&e.Model.Title&&this.Kp()},n.getSuggestionType=function(){return 0},n.Kp=function(){var t=this,e=this.props.Question,n={ExistingQuestions:Et.map(e.Form.Model.Questions,(function(t){return t.Title})),Locale:Object(u.a)().cultureInfo.Name,QuestionType:e.Model.Type,TargetQuestion:e.Model.Title};mn.a.getQuestionsIntelligenceResult(n).then((function(e){if(e&&e.MatchQuery){var n=Xr(e);t.updateSuggestion(n)}})).catch((function(e){t.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})}))},n.Wp=function(){var t=this,e=this.props.Form,n=this.props.Question,i=n.Model.Title,r=n.Model.LastMathMLFormula,o=Et.filter(e.Model.Questions,(function(t){return t.IsMathQuiz}));r&&Qr.getMathQuestionsSuggestion({ExistingMathQuestions:Et.map(o,(function(t){return t.Subtitle})),ExistingMathQuestionTitles:Et.map(o,(function(t){return t.Title})),FormId:e.Model.Id,Formula:r,Origin:"AddQuestion",QuestionId:n.Model.Id,QuestionPoints:n.Model.Point,QuestionRequired:n.Model.Required,Title:i}).then((function(e){if(e&&e.MatchQuery){var n=Xr(e);t.updateSuggestion(n)}})).catch((function(e){t.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})}))},n.Up=function(){this.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]},this.$p)},n.$p=function(){this.Jp&&window.clearTimeout(this.Jp),this.Jp=window.setTimeout(this.askSuggestion,this.zp)},e}(Zr),no=n(237);function io(t){return Yt.a.isDescriptiveElement(t.Type)?ke.a.supportMobileDesign(t):Object(no.a)(t.Type).supportMobileDesign(t)}var ro=n(25);var oo=0;function so(t){return Object(kn.a)().then((function(e){var n=e[t.TemplateId];return n&&function(t,e){var n=(r=t,new(Object(_t.a)())(ro.a.LocalForm,{InitialData:r},!1)),i={Questions:[]};var r;return i.TemplateId=e.TemplateId,i.AlgorithmType=e.ModelType,i.Questions=n.FormElementManager.QuestionMasters.map((function(t){var e=Et.clone(t.getSnapshot());return delete e.Order,e})),i}(n,t)})).catch((function(){return null}))}var ao={getFormTemplateSuggestion:function(t){var e=++oo;return mn.a.isDefaultTitle(t)?Promise.resolve({MatchQuery:!0,Templates:[]}):function(t,e,n){var i={MatchQuery:!0,Templates:[]};return mn.a.textAnalyzeWithFeatures(n,t).then((function(t){if(t&&t.Results&&t.Results.length&&t.Results[0].Result){var n=t.Results[0].Result;Et.isArray(n)||(n=[n]);var r=Et.map(n,so);return Promise.all(r).then((function(t){return t=Et.filter(t,(function(t){return!!t})),i.Templates=mn.a.getFilteredTemplates(t),i.MatchQuery=e===oo,i}))}return i.MatchQuery=e===oo,i}))}(t,e,131072)}},co=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createHeader=function(){var t=this.props.Templates||[],e=this.props.TemplateIndex,n=Object(ae.a)().IntelligenceSuggestion_Title;if(e<t.length){var i=t[e].AlgorithmType||-1,r=t[e].FormTitle;switch(i){case 3:n=Object(ae.a)().Designer_Intelligence_History_Suggest_Frequently;break;case 2:case 1:n=Object(ae.a)().Designer_Intelligence_History_Suggest_Relevant.format(r);break;default:n=Object(ae.a)().Designer_Intelligence_Template_Suggest_Popular}}var o=oe.createElement("div",{className:"form-intelligence-header-count-template-container"},oe.createElement("span",{className:"form-intelligence-ideas-template-title"},n));return oe.createElement("div",{className:"form-intelligence-header-template-container"},oe.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),o,oe.createElement("div",{className:"form-intelligence-header-template-button-container"},oe.createElement("div",{className:"form-intelligence-header-buttons"},this.createAddButton(),this.createCloseButton())))},e}($r),uo=function(t){function e(e){var n=t.call(this,e)||this;n.Xp=500,n.Zp=n.Zp.bind(n),n.askSuggestion=n.askSuggestion.bind(n),n.$p=n.$p.bind(n);var i=n.props.Form;return i.observe(n.Zp,[i.Schema.Title]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.Form.unobserve(this.Zp)},n.createSuggestionCardLayout=function(){return oe.createElement(co,Object(S.__assign)({},this.props,{changeQuestionSuggestion:this.changeQuestionSuggestion,changeGalleryDot:this.changeGalleryDot,onClickAdd:this.onClickAddButton,onClickClose:this.closeSuggestionCard,SelectedIndex:this.state.SelectedIndex,TemplateIndex:this.state.TemplateIndex,Templates:this.state.Templates}))},n.askSuggestion=function(){var t=this,e=this.props.Form,n=e.Model.Title,i=e.Model.Settings.IsQuizMode;if(!i||Object(Y.c)("QuizHistorySuggestion")){var r;if(Object(u.a)().userInfo.IsMsa||this.props.IsMobile)r=mn.a.getDefaultQuestionResult();else{var o="";e.isFieldReady(e.Schema.Id)&&(o=e.Model.Id),r=mn.a.getHistoryFormSuggestion(n,o,i)}var s=i?mn.a.getDefaultQuestionResult():ao.getFormTemplateSuggestion(n);Promise.all([s,r]).then((function(e){var n=e[0],i=e[1];if(n&&n.MatchQuery&&i&&i.MatchQuery){var r=Xr(n),o=Xr(i).concat(r);t.props.IsMobile&&(o.forEach((function(t){t.Questions=t.Questions.filter(io)})),o=o.filter((function(t){return t.Questions.length>0}))),t.updateSuggestion(o)}})).catch((function(){t.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]})}))}},n.getSuggestionType=function(){return 1},n.Zp=function(){this.setState({SelectedIndex:[],TemplateIndex:0,Templates:[]},this.$p)},n.$p=function(){this.Yp&&window.clearTimeout(this.Yp),this.Yp=window.setTimeout(this.askSuggestion,this.Xp)},e}(Zr),lo=n(223),ho=n(189),fo=n(222),bo=n(221),mo=n(97),vo=n(90),go=n(225),Oo=n(49);function po(t){return oe.createElement(jo,t)}var jo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this.props,e=Et.clone(t.HTMLAttributes)||{};return e.className=Object(pn.b)("design-insert-card new-margin",e.className),e.onClick=t.onClick,Object(yn.a)({ButtonStyle:"DarkBackGround",HTMLAttributes:e,Icon:t.IconClass,IconClassName:t.IconClassName+" design-insert-card-img office-form-theme-primary-foreground",Text:t.DisplayText,TextClassName:"design-insert-card-text"})},e}(ue.a),yo=function(t){function e(e){var n=t.call(this,e)||this;return n.tj=oe.createRef(),n.ej=oe.createRef(),n.nj=oe.createRef(),n.ij=oe.createRef(),n.rj=oe.createRef(),n.oj=oe.createRef(),n.sj=n.sj.bind(n),n.aj=n.aj.bind(n),n.cj=n.cj.bind(n),n.uj=n.uj.bind(n),n.lj=n.lj.bind(n),n.en=n.en.bind(n),n.hj=n.hj.bind(n),n.fj=n.fj.bind(n),n.dj=n.dj.bind(n),n.bj=n.bj.bind(n),n.mj=n.mj.bind(n),n.nn=n.nn.bind(n),n.vj=n.vj.bind(n),n.gj=n.gj.bind(n),n.Oe=n.Oe.bind(n),n.Oj=n.Oj.bind(n),n.pj=n.pj.bind(n),n.jj=n.jj.bind(n),n.yj=n.yj.bind(n),n.wj=n.wj.bind(n),n.Sj=n.Sj.bind(n),n.Nj=n.Nj.bind(n),n.state={FocusedOnInsertPanelItem:!1,InsertPanelActiveElementIndex:0,InsertPanelExpanded:!1,MoreQuestionsMenuExpanded:!1,ScreenSize:wo(),ShowLikertTooltip:!1},n.ce=!0,n.props.Form.observe(n.Oe,[Zt.a.Schema.ReputationTier]),window.addEventListener("resize",n.vj),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.ce=!1,this.props.Form.unobserve(this.Oe),window.removeEventListener("resize",this.vj)},n.componentDidUpdate=function(){this.state.FocusedOnInsertPanelItem&&!this.state.MoreQuestionsMenuExpanded&&this.Ij(this.state.InsertPanelActiveElementIndex)},n.componentDidMount=function(){var t=this.ej.current;this.Cj=t?t.getElementsByTagName("button"):[]},n.render=function(){var t=this.props.Form.Model;if(Object(Ri.a)(this.props.Form,"DisableEditForm")||Object(Oo.e)(t.ReputationTier))return null;var e=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:this.state.InsertPanelExpanded?"GlyphOnly":"Horizontal",HTMLAttributes:this.kj(),Icon:"Add",IconClassName:"design-view-insert-panel-img",ref:this.tj,Text:Object(ae.a)().DesignPage_InsertPanel_CreateElement,TextClassName:"button-text"}),n={className:"__insert-pane__ design-view-insert-panel-container",onBlur:this.en,onKeyDown:this.lj};return oe.createElement("div",Object(S.__assign)({},n),oe.createElement("div",{className:"design-view-insert-button-group office-form-theme-primary-background",tabIndex:-1},e,this.Tj()),this.props.createSuggestionCard(this.state.InsertPanelExpanded,this.sj,this.aj))},n.setFocusOnAddButton=function(){this.tj.current&&this.tj.current.focus()},n.Tj=function(){var t,e=1===this.state.ScreenSize,n=2===this.state.ScreenSize,i=(t=this.props.insertCallback,po({DisplayText:Object(ae.a)().QuestionCategory_Choice,IconClass:"RadioBtnOn",IconClassName:"design-insert-card-icon forms-icon-size16x16",key:"choice",onClick:function(){var e=_r.a.createDefaultDefinition();t(e),Object(g.b)("DesignPage.Questions.Create",{isMathQuiz:!!e.IsMathQuiz,questionType:"choice"})}})),r=function(t){return po({DisplayText:Object(ae.a)().QuestionCategory_Text,IconClass:"TextField",IconClassName:"design-insert-card-icon forms-icon-size20x20",key:"text",onClick:function(){var e=Lr.a.createDefaultSingleLineDefinition();t(e),Object(g.b)("DesignPage.Questions.Create",{isMathQuiz:!!e.IsMathQuiz,questionType:"text"})}})}(this.props.insertCallback),o=!n&&function(t){return po({DisplayText:Object(ae.a)().QuestionCategory_Rating,IconClass:"Like",IconClassName:"thumbUpEmptyIcon forms-icon-size18x18",key:"rating",onClick:function(){var e=Hr.a.createDefaultDefinition();t(e),Object(g.b)("DesignPage.Questions.Create",{questionType:"rating"})}})}(this.props.insertCallback),s=!e&&!n&&function(t){return po({DisplayText:Object(ae.a)().QuestionCategory_DateTime,IconClass:"Calendar",IconClassName:"forms-icon-size18x18",key:"dateTime",onClick:function(){var e=Gr.a.createDefaultDefinition();t(e),Object(g.b)("DesignPage.Questions.Create",{questionType:"dateTime"})}})}(this.props.insertCallback);return oe.createElement("div",{"aria-orientation":"horizontal",className:this.state.InsertPanelExpanded?"insertPanel":"insertPanel dn",onKeyDown:this.nn,ref:this.ej},i,r,o,s,this.xj(),this.state.ShowLikertTooltip&&this.Fj(),this.props.Form.SettingMaster.Model.IsAnonymous&&this.Pj(),void 0)},n.Fj=function(){return oe.createElement("div",{className:"teachingUI-likertTooltip",ref:this.ij},oe.createElement("div",{className:"teachingUI-likertTooltip-direction-shadow"}),oe.createElement("div",{className:"teachingUI-likertTooltip-direction"}),oe.createElement("div",{className:"teachingUI-likertTooltip-text"},Object(ae.a)().Likert_Tooltip_Text),oe.createElement(Hi.a,{className:"teachingUI-likertTooltip-img",src:"/Images/question_backgrounds/likert_tooltip.png","aria-hidden":"true"}))},n.kj=function(){var t={"aria-expanded":this.state.InsertPanelExpanded,className:"design-view-insert-panel-expand-or-collapse __insert-button__"};return this.props.Form.reachedQuestionNumberLimitation()?(t.className=Object(pn.b)(t.className,"add-question-button-disabled"),t.title=Object(ae.a)().DesignPage_LimitMessage_QuestionNumber):(t.className=Object(pn.b)(t.className,"office-form-theme-button"),t.onClick=this.cj,t.onKeyDown=this.uj,t.onFocus=this.Oj),t},n.cj=function(){this.setState({FocusedOnInsertPanelItem:!this.state.InsertPanelExpanded,InsertPanelExpanded:!this.state.InsertPanelExpanded}),Object(g.b)("DesignPage.Questions.clickAddNewButton")},n.uj=function(t){switch(t.keyCode){case 9:this.state.InsertPanelExpanded&&(t.stopPropagation(),t.preventDefault(),this.setState({FocusedOnInsertPanelItem:!0}));break;case 13:t.stopPropagation(),t.preventDefault(),this.setState({FocusedOnInsertPanelItem:!this.state.InsertPanelExpanded,InsertPanelExpanded:!this.state.InsertPanelExpanded})}},n.Oj=function(t){t.stopPropagation(),this.setState({FocusedOnInsertPanelItem:!1})},n.Dj=function(){var t=1===this.state.ScreenSize,e=2===this.state.ScreenSize,n=[],i=this.Mj(!0,"dateTime","Calendar","forms-icon-size16x16",Object(ae.a)().QuestionCategory_DateTime,this.hj);return e?(n.push(this.Mj(!0,"rating","Like","forms-icon-size16x16",Object(ae.a)().QuestionCategory_Rating,this.bj)),n.push(i)):t&&n.push(i),n.push(this.Mj(!0,"ranking","Sort","forms-icon-size18x18",Object(ae.a)().QuestionCategory_Ranking,this.dj)),n.push(this.Mj(!0,"likert","ViewList","forms-icon-size18x18",Object(ae.a)().QuestionCategory_Likert,this.fj)),Object(Y.c)("DesignerFileUpload")&&!Object(st.j)()&&n.push(this.Lj()),n.push(this.Aj()),n.push(oe.createElement(vo.a,{key:"line-breaker"},Object(mo.b)())),n.push(this.Mj(!0,"section","Tab","forms-icon-size18x18",Object(ae.a)().DesciptiveElementCategory_Section,this.gj)),n},n.Lj=function(){var t=this,e=this.props.Form,n=Object(at.c)((function(){return e.SettingMaster.Model.IsAnonymous&&!Object(Y.c)("EnableAnonymousUploadLink")}),at.f),i=n||!e.isFieldReady(Zt.a.Schema.Id)||!!Object(go.a)(e),r=Object(ae.a)().QuestionCategory_UploadFile;return oe.createElement(vo.a,{Active:!0,Disabled:i,key:"fileUpload",onClick:function(){Object(at.c)((function(){return Object(qe.k)(t.props.Form,!0)}),at.f);var e=lo.a.createDefaultDefinition();t.props.insertCallback(e),Object(g.b)("DesignPage.Questions.Create",{questionType:"fileUpload"})},HTMLAttributes:{"aria-label":r,onMouseLeave:n?this.yj:void 0,onMouseOver:n?this.wj:void 0,title:r}},oe.createElement("div",{className:"design-insert-card-dropdown-option"},oe.createElement(Un.a,{IconName:"Upload",HTMLAttributes:{className:"design-insert-card-dropdown-img office-form-theme-primary-foreground forms-icon-size18x18"}}),oe.createElement("span",{className:"design-insert-card-dropdown-text"},r),n&&oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size15x15 design-insert-card-warning-icon"},IconName:"UnknownSolid",ref:this.oj}),void 0))},n.Pj=function(){var t=Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title;return oe.createElement("div",{className:"design-insert-card-upload-tip",ref:this.nj,key:"toolTip"},oe.createElement("div",{className:"design-insert-card-upload-tip-text"},Object(ae.a)().UploadFile_CardInsert_Tip.format(t)),oe.createElement("div",{className:"design-insert-card-beak"}),oe.createElement("div",{className:"design-insert-card-beak-shadow"}))},n.wj=function(t){var e=$(this.nj.current),n=$(this.oj.current.getHtmlElement());e.css({display:"inline-block",left:n.offset().left-(e.width()-n.width())/2,top:n.offset().top-e.height()})},n.yj=function(t){this.nj.current&&$(this.nj.current).css("display","none")},n.Nj=function(){var t=this;this.setState({ShowLikertTooltip:!0},(function(){var e=$(t.rj.current.getHtmlElement()),n=$(t.ij.current),i=e.offset().left+124,r=e.offset().top-54;document.body.clientWidth<1300&&(i=e.offset().left-383),n.css({left:i,top:r})}))},n.Sj=function(){this.setState({ShowLikertTooltip:!1})},n.Rj=function(t,e,n,i,r,o,s){var a=Object(Un.b)({HTMLAttributes:{className:"forms-icon-size15x15 teachingUI-likertTooltip-warning-icon"},IconName:"Info",key:"likertTooltipIcon",ref:this.rj});return oe.createElement(vo.a,{Active:t,Disabled:s,key:e,onClick:o,HTMLAttributes:{"aria-label":r,onMouseLeave:this.Sj,onMouseOver:this.Nj,title:r}},oe.createElement("div",{className:"design-insert-card-dropdown-option"},oe.createElement(Un.a,{IconName:n,HTMLAttributes:{className:i}}),oe.createElement("span",{className:"design-insert-card-dropdown-text"},r),a))},n.Mj=function(t,e,n,i,r,o,s){var a=Object(pn.b)("design-insert-card-dropdown-img office-form-theme-primary-foreground",i);return"likert"===e?this.Rj(t,e,n,a,r,o,s):oe.createElement(vo.a,{Active:t,Disabled:s,key:e,onClick:o,HTMLAttributes:{"aria-label":r}},oe.createElement("div",{className:"design-insert-card-dropdown-option"},oe.createElement(Un.a,{IconName:n,HTMLAttributes:{className:a}}),oe.createElement("span",{className:"design-insert-card-dropdown-text"},r)))},n.Aj=function(){var t=this;return this.Mj(!0,"nps","AutoRacing","forms-icon-size18x18",Object(ae.a)().QuestionCategory_NPS,(function(){var e=fo.a.createDefaultDefinition();t.props.insertCallback(e),Object(g.b)("DesignPage.Questions.Create",{questionType:"NPS"})}))},n.sj=function(){this.setState({InsertPanelExpanded:!1})},n.aj=function(){this.setState({InsertPanelExpanded:!0})},n.en=function(t){var e=this,n=Ln.findDOMNode(this);setTimeout((function(){e.ce&&!n.contains(document.activeElement)&&e.state.InsertPanelExpanded&&e.setState({FocusedOnInsertPanelItem:!1,InsertPanelExpanded:!1})}),0)},n.hj=function(){var t=Gr.a.createDefaultDefinition();this.props.insertCallback(t),Object(g.b)("DesignPage.Questions.Create",{questionType:"dateTime"})},n.dj=function(){var t=bo.a.createDefaultDefinition();this.props.insertCallback(t),Object(g.b)("DesignPage.Questions.Create",{questionType:"ranking"})},n.bj=function(){var t=Hr.a.createDefaultDefinition();this.props.insertCallback(t),Object(g.b)("DesignPage.Questions.Create",{questionType:"rating"})},n.fj=function(){var t=ho.a.createDefaultDefinition(),e=ho.a.createSubQuestionsDefinition();this.props.insertCallback(t,e),Object(g.b)("DesignPage.Questions.Create",{questionType:"likert"})},n.gj=function(){this.mj()},n.mj=function(){var t=Object(ke.b)();this.props.insertCallback(t),Object(g.b)("DesignPage.Section.Create",{elementType:"section"});var e=this.props.Form,n="survey"===e.Model.Type;Object(Y.c)("ProgressBarNew")&&n&&2===e.totalSectionCount()&&(Object(g.b)("DesignPage.Setting.ProgressBarEnabled"),e.Model.ProgressBarEnabled="true")},n.Ej=function(t,e,n){var i=this.Dj();this.state.MoreQuestionsMenuExpanded&&(t=Object(pn.b)(t,"active"),e=Object(pn.b)(e,"active"));var r={className:e,title:Object(ae.a)().QuestionCategory_More},o={"aria-label":Object(ae.a)().QuestionCategory_More,children:oe.createElement(Un.a,{HTMLAttributes:r,IconName:n}),className:"design-insert-card-more-button",title:Object(ae.a)().QuestionCard_Menu_Tooltip};return oe.createElement(mo.a,{ButtonStyle:"DarkBackGround",MenuItemType:0,ClassName:"design-insert-card-more-menu",ClassNameForContainer:t,HTMLAttributes:o,onMenuCollapse:this.pj,onMenuExpand:this.jj},i)},n.xj=function(){return this.Ej("design-insert-card-more-exp-container office-form-theme-button-lightbackground","forms-icon-size18x18 office-form-theme-primary-color","ChevronDown")},n.pj=function(){this.setState({MoreQuestionsMenuExpanded:!1})},n.jj=function(){this.setState({MoreQuestionsMenuExpanded:!0}),Object(g.b)("DesignPage.onMoreQuestionsMenuEvent")},n.nn=function(t){var e=this.state.InsertPanelActiveElementIndex;switch(t.keyCode){case 9:++e<this.Cj.length&&(t.stopPropagation(),t.preventDefault(),this.setState({InsertPanelActiveElementIndex:e}));break;case 39:e=(e+1+this.Cj.length)%this.Cj.length,this.setState({InsertPanelActiveElementIndex:e});break;case 37:e=(e-1+this.Cj.length)%this.Cj.length,this.setState({InsertPanelActiveElementIndex:e});break;case 13:this.state.InsertPanelActiveElementIndex<this.Cj.length-1&&$(":focus").click()}},n.lj=function(t){var e=this;this.state.InsertPanelExpanded&&27===t.keyCode&&(t.stopPropagation(),t.preventDefault(),this.setState({FocusedOnInsertPanelItem:!1,InsertPanelActiveElementIndex:0,InsertPanelExpanded:!1},(function(){e.setFocusOnAddButton()})))},n.Ij=function(t){var e=this.Cj[t];e&&e.focus()},n.vj=function(){this.setState({ScreenSize:wo()})},n.Oe=function(){this.forceUpdate()},e}(ue.a);function wo(){var t=$(window).width();return t<=Object(Pe.i)()?2:t<=Object(Pe.g)()?1:0}var So=To((function(t,e,n,i){return!Object(Y.c)("UserInterationSuggestionCard")||t.Form.SettingMaster.Model.IsQuizMode||Object(et.r)()?xo(t,e,"Title",n):Po(t,n,i,"Title",e)}),(function(t,e,n){var i=ko(t.Form,!0,e.Type),r=t.Form.FormElementManager.insertElementAfter(e,i,n);t.designElement(r)})),No=To((function(t,e,n){return t.Section,null}),(function(t,e,n){var i=t.Section,r=i.Form.FormElementManager.insertElementAfter(e,i,n);t.designElement(r)})),Io=To((function(t,e,n,i){var r=Object(_t.b)();if(!Object(Y.c)("UserInterationSuggestionCard")||t.Form.SettingMaster.Model.IsQuizMode||Object(et.r)())return Fo(t,t.Question,e,n);if(Object(Y.c)("PersonalContextSuggestion")){var o=Object(Bi.a)(t.Form);(null==o?void 0:o.RemainingQuestionSuggestions.length)>0&&i()}else switch(r.Model.IntelligeceQuestionSuggestionStatus){case"InSessionHistry":case"InSessionBank":case"InSessionHistoryAndBank":case"InSessionBankAndHistory":i()}return Po(t,n,i,t.Question,e)}),(function(t,e,n){var i=t.Question;!Yt.a.isDescriptiveElement(e.Type)&&Do(i.Model,e,n),ko(t.Form,!1,e.Type);var r=i.Form.FormElementManager.insertElementAfter(e,i,n);t.designElement(r)})),Co=To((function(t,e,n,i){if(!Object(Y.c)("UserInterationSuggestionCard")||t.Form.SettingMaster.Model.IsQuizMode||Object(et.r)()){var r=t.Form.FormElementManager.TopElementMasters;if(!r.length)return xo(t,e,null,n);var o=r[r.length-1];return Yt.a.isDescriptiveElement(o.Model.Type)?null:Fo(t,o,e,n)}return Po(t,n,i,null,e)}),(function(t,e,n){var i=t.Form.FormElementManager,r=i.TopElementMasters;if(!Yt.a.isDescriptiveElement(e.Type)){var o=r[r.length-1];o&&!Yt.a.isDescriptiveElement(o.Model.Type)&&Do(o.Model,e,n)}ko(t.Form,0===r.length,e.Type);var s=i.appendElement(e,n);t.designElement(s)}));function ko(t,e,n){if(!(e?t.hasSection()&&!Yt.a.isSection(n):!t.hasSection()&&Yt.a.isSection(n)))return null;var i=t.FormElementManager.insertElementAfter({Title:"",Type:"Question.ColumnGroup"},null);return Object(g.b)("DesignPage.Section.Create",{elementType:"section",isDefault:"true"}),i}function To(t,e){return function(n){function i(t){var e=n.call(this,t)||this;return e.Bj=oe.createRef(),e._j=e._j.bind(e),e.Hj=e.Hj.bind(e),e}Object(S.__extends)(i,n);var r=i.prototype;return r.render=function(){return oe.createElement(yo,{createSuggestionCard:this._j,Form:this.props.Form,insertCallback:this.Hj,ref:this.Bj})},r.setFocusOnAddButton=function(){this.Bj.current&&this.Bj.current.setFocusOnAddButton()},r._j=function(e,n,i){return t(this.props,e,n,i)},r.Hj=function(t,n){!Yt.a.isDescriptiveElement(t.Type)&&(t.IsQuiz=this.props.Form.SettingMaster.Model.IsQuizMode),e(this.props,t,n)},i}(oe.Component)}function xo(t,e,n,i){return 0!==t.Form.FormElementManager.TopQuestionMasters.length?null:oe.createElement(uo,{collapseInsertPane:i,designElement:t.designElement,Form:t.Form,InsertAfter:n,ShowSuggestionCard:e})}function Fo(t,e,n,i){return oe.createElement(eo,{collapseInsertPane:i,designElement:t.designElement,Form:t.Form,InsertAfter:e,Question:e,ShowSuggestionCard:n})}function Po(t,e,n,i,r){return Object(Y.c)("PersonalContextSuggestion")?Object(Br.d)({collapseInsertPane:e,designElement:t.designElement,expandInsertPane:n,Form:t.Form,InsertAfter:i,InsertPaneExpanded:r}):r?Object(Br.c)({collapseInsertPane:e,designElement:t.designElement,expandInsertPane:n,Form:t.Form,InsertAfter:i,ShowSuggestionCard:r}):void 0}function Do(t,e,n){e.Required=t.Required,e.ShowSubtitle=t.ShowSubtitle,n&&n.forEach((function(e){e.Required=t.Required})),e.Type===_r.a.getElementTypeName()?e.ShuffleOptions=t.ShuffleOptions:e.Type===Hr.a.getElementTypeName()&&(e.ShowRatingLabel=t.ShowRatingLabel),e.IsQuiz&&t.IsQuiz&&(e.Point=t.Point,function(t,e){!t.IsMathQuiz||e.Type!==_r.a.getElementTypeName()&&e.Type!==Lr.a.getElementTypeName()||(e.IsMathQuiz=t.IsMathQuiz,e.IsAnswerPlainText=t.IsAnswerPlainText,e.ShowSubtitle=t.ShowSubtitle,e.Choices&&Et.forEach(e.Choices,(function(t){t.IsGenerated&&!t.IsMathOption&&(t.Description=""),t.IsMathOption=!0})))}(t,e))}var Mo=n(194),Lo=function(){function t(t,e,n,i){this.Gj=t,this.qj=n&&e.getGrabberByName(n)||e.createGrabber(n),i&&this.qj.grab(),this.Qj=this.Qj.bind(this),this.qj.observe(this.Qj)}var e=t.prototype;return Object.defineProperty(e,"Grabber",{get:function(){return this.qj},enumerable:!1,configurable:!0}),e.release=function(){this.qj.unobserve(this.Qj),this.qj.handsOff()},e.Qj=function(t){this.Gj.setState({InDesignMode:"grabbed"===t})},t}();function Ao(){throw Error("Never called.")}function Ro(){throw Error("Never called.")}var Eo=function(t){function e(e){var n=t.call(this,e)||this;return n.cn=n.cn.bind(n),n.Vj=n.Vj.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.zj()},n.componentDidUpdate=function(t,e){e.InDesignMode||this.zj()},n.getHtmlAttributes=function(){var t,e=this,n=Object(at.c)((function(){return e.state.InDesignMode}),at.f);return n?t="design-time-editing":this.props.DesignFocus.getLocked()?t="design-time-mixer locked":(t="design-time-mixer",this.props.ShowWarning&&(t=Object(pn.b)(t,"design-time-editing-error"))),Object(pn.g)(this.props.HTMLAttributes,{"aria-expanded":!1,className:t,onClick:this.cn,onKeyDown:this.Vj,role:n?"group":"button",tabIndex:n?-1:0})},n.Vj=function(t){if(this.state.InDesignMode)27===t.keyCode&&(this.leaveDesignMode(),t.stopPropagation());else switch(t.keyCode){case 13:case 32:this.enterDesignMode(),t.stopPropagation()}},n.cn=function(t){this.state.InDesignMode||(this.enterDesignMode(),t.stopPropagation())},n.zj=function(){this.state.InDesignMode&&this.props.scrollToDesigner&&this.props.scrollToDesigner()},e}(function(t){function e(e){var n=t.call(this,e)||this;return n.Uj=new Lo(n,n.props.DesignFocus,n.props.Name,n.props.AutoFocus),n.state={InDesignMode:n.Uj.Grabber.currentlyOwning()},n}Object(S.__extends)(e,t);var n=e.prototype;return Object.defineProperty(e,"Designer",{get:function(){return Ao},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Renderer",{get:function(){return Ro},enumerable:!1,configurable:!0}),n.componentWillUnmount=function(){this.Uj.release()},n.render=function(){var t=this.state.InDesignMode,n=this.props.ShowWarning&&!t&&Object(Un.b)({HTMLAttributes:{className:"design-time-editing-error-icon"},IconName:"Error"});return oe.createElement("div",Object(S.__assign)({},this.getHtmlAttributes()),n,t&&this.$j(e.Designer),!t&&this.$j(e.Renderer))},n.enterDesignMode=function(){return this.props.scrollToDesigner&&this.props.scrollToDesigner(),this.Uj.Grabber.grab()},n.leaveDesignMode=function(){this.Uj.Grabber.handsOff()},n.getHtmlAttributes=function(){return this.props.HTMLAttributes},n.$j=function(t){var e=oe.Children.toArray(this.props.children).filter((function(e){return e&&e.type===t}))[0];return e&&e.props.children},e}(ue.a)),Bo=function(t){function e(e){var n=t.call(this,e)||this;n.Wj=oe.createRef();var i=e.DesignFocus.getDefaultGrabber();return n.state.InDesignMode=i.currentlyOwning(),n.Qj=n.Qj.bind(n),i.observe(n.Qj),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.DesignFocus.getDefaultGrabber().unobserve(this.Qj)},n.componentDidUpdate=function(){this.state.FocusByDefault&&this.Wj.current&&this.Wj.current.setFocusOnAddButton&&this.Wj.current.setFocusOnAddButton()},n.render=function(){return this.state.InDesignMode&&oe.createElement(Co,{designElement:this.props.designElement,Form:this.props.Form,ref:this.Wj})},n.Qj=function(t){this.setState({InDesignMode:"grabbed"===t||"focused"===t,FocusByDefault:"focused"===t})},e}(ue.a),_o=n(60),Ho=n(197),Go=function(t){function e(e){var n=t.call(this,e)||this;return n.Kj=oe.createRef(),n.Jj=n.Jj.bind(n),n.lj=n.lj.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.Kj.current;t&&(Object(yr.g)(Ln.findDOMNode(this)),t.focus())},n.componentDidUpdate=function(t){if(this.props.Shown&&!t.Shown){var e=this.Kj.current;e&&(Object(yr.g)(Ln.findDOMNode(this)),e.focus())}},n.render=function(){if(!this.props.Shown)return null;var t={className:Object(pn.b)("dialog-container",this.props.ClassName),onKeyDown:this.lj,role:"dialog",tabIndex:-1};return oe.createElement("div",Object(S.__assign)({},t),this.Xj())},n.Xj=function(){var t=Object(pn.g)(this.props.HTMLAttributes,{className:"dialog-content",onBlur:this.Jj,ref:this.Kj,tabIndex:0});return oe.createElement("div",Object(S.__assign)({},t),this.props.children)},n.Jj=function(t){if(this.props.onBlur){var e=Object(pn.d)(t),n=this.Kj.current;n&&n.contains(e)||this.props.onBlur()}},n.lj=function(t){27===t.keyCode&&(t.preventDefault(),t.stopPropagation(),this.props.onClose())},e}(ue.a),qo=n(43),Qo=function(t){function e(e){var n=t.call(this,e)||this;return n.Zj=-1,n.Yj=oe.createRef(),n.ty=!1,n.state={SortedElements:Et.clone(n.props.AllElements)},n.ey=n.ey.bind(n),n.ny=n.ny.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(An.a)("Sortable").then((function(){t.setState({SortableLoaded:!0})}))},n.componentWillUnmount=function(){this.dg&&(this.dg.destroy(),this.dg=void 0)},n.componentWillReceiveProps=function(t){Et.isEqual(this.props.AllElements,t.AllElements)||(this.setState({SortedElements:Et.clone(t.AllElements)}),this.dg&&(this.dg.destroy(),this.dg=void 0))},n.componentDidMount=function(){var t=this.Yj.current;this.state.SortableLoaded&&t&&this.fg(t),this.iy()},n.componentDidUpdate=function(t,e){if(this.state.SortedElements.length>0&&-1!==this.Zj&&this.iy(),this.state.SortableLoaded&&!this.dg){var n=this.Yj.current;n&&this.fg(n)}},n.render=function(){var t=this,e={className:this.props.IsMobile?"office-form-mobile-sort-list":"office-form-sort-list",ref:this.Yj,role:"listbox"};return oe.createElement("div",Object(S.__assign)({},e,{key:"Ranking"}),Et.map(this.state.SortedElements,(function(e,n){return t.oy(e,n)})))},n.fg=function(t){var e=this,n={animation:150,chosenClass:"office-form-sortable-chosen",delay:this.props.IsMobile?150:0,fallbackClass:"office-form-sortable-fallback",filter:".office-form-ranking-arrow",forceFallback:!0,ghostClass:"office-form-sortable-ghost",handle:".office-form-move-control-item",onEnd:function(n){var i=n.newIndex,r=n.oldIndex;r===i?n.item.firstChild.focus():(e.Zj=0,r<i?$(t).find(".office-form-sortable-list-item-container:eq("+r+")").before($(n.item)):r>i&&$(t).find(".office-form-sortable-list-item-container:eq("+r+")").after($(n.item)),e.sy(r,i))},preventOnFilter:!1};try{this.dg=Sortable.create(t,n),this.ty||Object(g.b)("DesignPage.Section.OpenMovePane",{Successful:!0}),this.ty=!0}catch(t){Object(g.b)("DesignPage.Sections.SortableInitialization",{Successful:!1}),this.ty=!1}},n.oy=function(t,n){var i,r=this.ay(t.Model.Id);this.props.IsMobile&&(i=e.createDragHandleIcon());var o,s=Object(pn.b)("office-form-sort-item",!this.props.Disabled&&r?"office-form-move-control-item office-form-theme-sort-item office-form-selected-item":"office-form-move-control-disabled-item"),a=t.Model.Id+"-"+n,c={"aria-posinset":n+1,"aria-setsize":this.state.SortedElements.length,className:s,disabled:this.props.Disabled,id:a,role:"option",tabIndex:!this.props.Disabled&&r?0:void 0};if(!this.props.Disabled&&r){var u={disabled:!0,tabIndex:-1},l=0===n,h={"aria-describedby":a,"aria-label":Object(ae.a)().Section_MovePanel_ArrowUp_Narrator,className:Object(pn.b)("office-form-ranking-arrow",l?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:l?void 0:this.ey,title:Object(ae.a)().Section_MovePanel_ArrowUp_Narrator};h=l?Object(pn.g)(h,u):h;var f={ButtonStyle:"LightBackground",children:Object(Un.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Up"}),HTMLAttributes:h,key:"form-up-arrow"+n},d=oe.createElement(qo.a,Object(S.__assign)({},f)),b=n===this.state.SortedElements.length-1,m={"aria-describedby":a,"aria-label":Object(ae.a)().Section_MovePanel_ArrowDown_Narrator,className:Object(pn.b)("office-form-ranking-arrow",b?"office-sort-disabled-arrow":"office-form-active-arrow"),onClick:b?void 0:this.ny,title:Object(ae.a)().Section_MovePanel_ArrowDown_Narrator};m=b?Object(pn.g)(m,u):m;var v={ButtonStyle:"LightBackground",children:Object(Un.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"Down"}),HTMLAttributes:m,key:"form-down-arrow"+n},g=oe.createElement(qo.a,Object(S.__assign)({},v));o=oe.createElement("div",{className:"office-form-sort-list-arrows"},d,g)}var O=Object(ae.a)().Designer_Sections_DefaultDescriptionWithTitle.format(n+1,t.Model.Title),p=oe.createElement("div",Object(S.__assign)({},c,{"data-index":n}),oe.createElement("div",{className:"office-form-sort-item-indicator"},i),oe.createElement("p",{className:"office-form-move-control-item-content"},O),o);return oe.createElement("div",{className:"office-form-sortable-list-item-container office-form-unselectable",key:t.Model.Id},p)},n.ey=function(){this.uy(0)},n.ny=function(){this.uy(1)},n.ly=function(){var t=this;return Et.findIndex(this.state.SortedElements,(function(e){return t.ay(e.Model.Id)}))},n.uy=function(t){var e=this.ly(),n=e;0===t?(this.Zj=1,--n):(this.Zj=2,++n),this.sy(e,n)},e.createDragHandleIcon=function(){return oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24"},oe.createElement("circle",{cx:"9.5",cy:"6.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"6.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"9.5",cy:"12.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"12.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"9.5",cy:"18.5",r:"1.5",fill:"currentColor"}),oe.createElement("circle",{cx:"14.5",cy:"18.5",r:"1.5",fill:"currentColor"}))},n.iy=function(){var t=this.ly(),e=this.Yj.current;if(e){var n=e.children[t];if(n)if(0===this.Zj)n.firstElementChild.focus();else{var i=".office-form-sort-list-arrows > button:nth-child("+((1===this.Zj?0===t?1:0:n===e.lastElementChild?0:1)+1)+")";n.querySelector(i).focus()}}this.Zj=-1},n.ay=function(t){return t===this.props.Master.Model.Id},n.sy=function(t,e){var n=Et.clone(this.state.SortedElements),i=n.splice(t,1)[0];n.splice(e,0,i),this.props.setDestIndex(e),this.setState({SortedElements:n})},e}(ue.a),Vo=function(t){function e(e){var n=t.call(this,e)||this;return n.hy=-1,n.by=oe.createRef(),n.my=oe.createRef(),n.state={ShowDialogType:"None"},n.vy=n.vy.bind(n),n.gy=n.gy.bind(n),n.Oy=n.Oy.bind(n),n.py=n.py.bind(n),n.jy=n.jy.bind(n),n.wy=n.wy.bind(n),n.Sy=n.Sy.bind(n),n.Ny=n.Ny.bind(n),n.Iy=n.Iy.bind(n),n.Cy=n.Cy.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"form-designer-section-header",ref:this.my},oe.createElement("h2",{className:"designer-section-title"},Object(ae.a)().Designer_Sections_DefaultDescription.format(this.props.Ordinal)),oe.createElement("div",{className:"designer-section-action-bar",key:"ActionBar"},this.We(),"None"!==this.state.ShowDialogType?this.ky():void 0))},n.We=function(){var t={"aria-label":Object(ae.a)().SectionCard_DesignTime_Menu_Tooltip,children:Object(Un.b)({HTMLAttributes:{className:"forms-icon-size18x18"},IconName:"More"}),className:"design-question-more-options",title:Object(ae.a)().SectionCard_DesignTime_Menu_Tooltip};return oe.createElement(mo.a,{AriaLabel:Object(ae.a)().Section_More_Settings,AriaLabelForSubmenu:Object(ae.a)().Section_More_Remove_Settings,ButtonStyle:"LightBackground",ClassName:"design-section-actionbar-menu",ClassNameForContainer:"designer-section-menu-button",HTMLAttributes:t,MenuItemType:0,onMenuExpand:this.jy,ref:this.by},this.Ty())},n.xy=function(){var t=oe.createElement(vo.a,{Active:!0,key:"removeSection",onClick:this.gy},oe.createElement("div",{className:"designer-more-options-section-item"},oe.createElement("span",null,Object(ae.a)().Designer_SectionActionBar_RemoveSection))),e=this.props.Master;return[t,oe.createElement(vo.a,{Active:!0,Disabled:0===e.Form.FormElementManager.findQuestionsInSection(e).length,key:"removeAll",onClick:this.wy},oe.createElement("div",{className:"designer-more-options-section-item"},oe.createElement("span",null,Object(ae.a)().Designer_SectionActionBar_RemoveAll)))]},n.Ty=function(){var t=this,e=oe.createElement(vo.a,{Active:!0,key:"duplicateSection",onClick:this.vy},oe.createElement("div",{className:"designer-more-options-section-item"},oe.createElement("span",null,Object(ae.a)().Designer_SectionActionBar_Duplicate))),n={children:oe.createElement("div",{className:"designer-more-options-section-submenu"},oe.createElement("span",null,Object(ae.a)().Designer_SectionActionBar_Remove),oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size16x16 menu-section-item-icon"},IconName:"ChevronRight"})),className:"designer-more-options-section-item"},i=[e,oe.createElement(vo.a,{Active:!0,HTMLAttributes:n,key:"removeSectionMenu",SubMenu:!0},this.xy()),oe.createElement(vo.a,{Active:!0,Disabled:1===this.props.Master.Form.FormElementManager.SectionMasters.length,key:"moveSection",onClick:this.py},oe.createElement("div",{className:"designer-more-options-section-item"},oe.createElement("span",null,Object(ae.a)().Designer_SectionActionBar_Move)))];return Object(at.b)((function(){var e=oe.createElement(vo.a,{Active:!0,key:"addBranch",onClick:t.Cy},oe.createElement("div",{className:"designer-more-options-section-item"},oe.createElement("span",null,Object(ae.a)().Designer_MenuItemForAddBranch)));i.push(e)})),i},n.vy=function(){var t=this.props.Master,e=t.Form.FormElementManager,n=e.findQuestionsInSection(t).length,i=e.duplicateSectionAndSubElements(t);this.props.designElement(i),Object(g.b)("DesignPage.Section.Duplicate",{QuestionCount:n,questionType:t.Model.Type});var r="survey"===t.Form.Model.Type;Object(Y.c)("ProgressBarNew")&&r&&2===t.Form.totalSectionCount()&&(Object(g.b)("DesignPage.Setting.ProgressBarEnabled"),t.Form.Model.ProgressBarEnabled="true")},n.gy=function(){var t=this,n=this.props.Master,i=n.Form.FormElementManager,r=this.props.MixerRef.current;if(r&&r.state.InDesignMode){var o=i.TopElementMasters,s=o.indexOf(n),a=o[s+1];this.props.designElement(a),this.props.DesignFocus.setLocked(!0),setTimeout((function(){t.props.DesignFocus.setLocked(!1)}))}e.tryMoveNextSectionToTop(i,n),n.Deleted=!0,Object(g.b)("DesignPage.Section.Delete",{questionType:n.Model.Type}),this.Fy()},n.Fy=function(){var t=this.props.Master.Form;Object(Y.c)("ProgressBarNew")&&t.totalSectionCount()<=1&&(Object(g.b)("DesignPage.Setting.ProgressBarDisabled"),t.Model.ProgressBarEnabled="false")},e.tryMoveNextSectionToTop=function(t,e){var n=t.SectionMasters,i=n.indexOf(e),r=t.findQuestionsInSection(e,!0);0===i&&r.length>0&&n.length>1&&(n[i+1].Model.Order=e.Model.Order)},n.Oy=function(){var t=this.props.Master,e=t.Form.FormElementManager.findQuestionsInSection(t).length;t.Form.FormElementManager.deleteSectionAndSubElements(t),Object(g.b)("DesignPage.Section.DeleteWithQuestions",{QuestionCount:e,questionType:t.Model.Type}),this.Fy()},n.Ny=function(){var t=this.props.Master,e=this.hy;if(t&&e>=0){var n=t.Form.FormElementManager.SectionMasters;if(e<n.length){var i=n[e];if(t.Model.Id!==i.Model.Id){this.props.trackMoveElement();var r=t.Form.FormElementManager.findQuestionsInSection(t).length;t.Form.FormElementManager.moveSectionTo(t,i),Object(g.b)("DesignPage.Section.Move",{QuestionCount:r})}}}this.Sy()},n.Iy=function(t){this.hy=t},n.wy=function(){this.setState({ShowDialogType:"DeletedConfirm"})},n.py=function(){this.setState({ShowDialogType:"MoveSection"})},n.Sy=function(){var t=this;this.setState({ShowDialogType:"None"},(function(){var e=t.by.current;e&&e.focus()}))},n.Cy=function(){var t=this.props.Master.Model;if(t.Id){Object(_t.b)().Model.SectionElementId=t.Id;var e=this.my.current;if(e){var n=e.parentElement.getBoundingClientRect().top;Object(_t.b)().Model.RelativeScrollHeight=n}}Object(_t.b)().Model.TopView="Branch",Object(g.b)("DesignPage.Section.AddBranch",{sectionId:t.Id})},n.ky=function(){var t="MoveSection"===this.state.ShowDialogType;return oe.createElement(Go,{HTMLAttributes:{className:t?"section-move-control-dialog":void 0},onClose:this.Sy,Shown:"None"!==this.state.ShowDialogType},t?this.Py():this.Dy())},n.Dy=function(){var t={ButtonStyle:"LightBackground",HTMLAttributes:{className:"section-designer-action-button",onClick:this.Sy},Text:Object(ae.a)().Common_Cancel_Text},e=oe.createElement(Gi.a,Object(S.__assign)({},t)),n={ButtonStyle:"LightBackground",HTMLAttributes:{className:"section-designer-action-button",onClick:this.Oy},Text:Object(ae.a)().Common_Yes_Text},i=oe.createElement(Gi.a,Object(S.__assign)({},n)),r=Object(ae.a)().SectionCard_DesignTime_ConfirmDelete_Description.format(this.props.Master.Model.Title);return[oe.createElement("p",{className:"dialog-body",key:"body"},r),oe.createElement("div",{className:"dialog-action-container right",key:"footer"},e,i)]},n.Py=function(){var t={ButtonStyle:"LightBackground",HTMLAttributes:{className:"section-designer-action-button lg office-form-dark-theme-button",onClick:this.Sy},Text:Object(ae.a)().Common_Cancel_Text},e=oe.createElement(Gi.a,Object(S.__assign)({},t)),n={ButtonStyle:"LightBackground",HTMLAttributes:{className:"section-designer-action-button lg office-form-theme-button",onClick:this.Ny},Text:Object(ae.a)().DesignPage_SectionDialog_Done},i=oe.createElement(Gi.a,Object(S.__assign)({},n)),r=Object(yn.a)({ButtonStyle:"None",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"dialog-close",onClick:this.Sy},Icon:"Cancel",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().Common_Close_Text});return[oe.createElement("div",{className:"dialog-header",key:"header"},oe.createElement("h6",{className:"dialog-title"},Object(ae.a)().MoveSection_Title),r),oe.createElement("div",{className:"dialog-body section-move-control-items",key:"body"},oe.createElement(Qo,{AllElements:this.props.Master.Form.FormElementManager.SectionMasters,IsMobile:this.props.IsMobile,Master:this.props.Master,setDestIndex:this.Iy})),oe.createElement("div",{className:"dialog-action-container right",key:"footer"},e,i)]},n.jy=function(){Object(g.b)("DesignPage.Section.OpenMenu",{questionType:this.props.Master.Model.Type})},e}(ue.a),zo=n(199),Uo=n(232),$o=n(78),Wo=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ImageLoadStatus:0,ShowAltTextButton:!0},n.du=n.du.bind(n),n.fu=n.fu.bind(n),n.My=n.My.bind(n),n.Ly=n.Ly.bind(n),n.Ay=n.Ay.bind(n),n.Ry=n.Ry.bind(n),n.Ey=n.Ey.bind(n),n.By=n.By.bind(n),n.pt=n.pt.bind(n),n._y=n._y.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(_t.f)().Schema;this.props.ImageInfoMaster.observe(this._y,[t.ErrorType,t.AltText,t.ResourceUrl])},n.componentWillUnmount=function(){this.Hy(),this.props.ImageInfoMaster.unobserve(this._y);var t=this.props.ImageInfoMaster.Model;t&&t.ErrorType!==ee.a.NoError&&(t.ErrorType=ee.a.NoError)},n.render=function(){return oe.createElement("div",{className:"title-designer-image-editor"},this.Od(),this.jd())},n.Od=function(){var t=this.props.ImageInfoMaster.Model;if(t.ErrorType!==ee.a.NoError||2===this.state.ImageLoadStatus)return null;var n,i,r,o="title-designer-image design-question-title-image-hidden",s=Object(pn.b)("title-designer-image-content design-question-title-image-button office-form-theme-focus-border",this.props.ImageWidth?"inline-block-display":"");return this.sr()?(s=Object(pn.b)(s,"office-form-theme-outline"),o=Object(pn.b)(o,1===this.state.ImageLoadStatus?"design-question-title-image-gray visiable":""),n=e.createSpinner()):(o=Object(pn.b)(o,t.ResourceUrl?"visiable":""),n=this.Gy()),this.props.ImageWidth?(i=this.props.ImageWidth,r=this.props.ImageHeight):(i="100%",r="auto"),oe.createElement("div",{"aria-label":Object(ae.a)().DesignPage_Image_ImageDesigner,className:s},oe.createElement("img",{alt:t.AltText,className:o,height:r,onError:t.ResourceUrl?this.du:void 0,onLoad:this.fu,src:t.ResourceUrl?t.ResourceUrl:void 0,title:t.AltText,width:i}),n)},n.Gy=function(){var t;return this.props.Resizable&&(t=this.Qf()),oe.createElement("div",{className:"image-edit-pane-container office-form-theme-border"},t,this.zf(),this.$f())},n.Qf=function(){var t,e="image-edit-pane-inner-button office-form-theme-button-foreground",n=this.props.ImageSettingMaster.Model.Size;n===ne.c.Small&&(e=Object(pn.b)(e,"active"),t=!0);var i,r={ButtonStyle:"LightBackground",children:Object(Un.b)({HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"},IconName:"moderateIcon"}),HTMLAttributes:{"aria-label":Object(ae.a)().ImageEditPane_SmallSize_Button,className:e,disabled:t,onClick:this.Ay,title:Object(ae.a)().ImageEditPane_SmallSize_Button}},o=oe.createElement(qo.a,Object(S.__assign)({},r)),s="image-edit-pane-inner-button office-form-theme-button-foreground";n===ne.c.Large&&(s=Object(pn.b)(s,"active"),i=!0);var a={ButtonStyle:"LightBackground",children:Object(Un.b)({HTMLAttributes:{className:"image-edit-pane-inner-button-icon forms-icon-size14x14"},IconName:"intenseIcon"}),HTMLAttributes:{"aria-label":Object(ae.a)().ImageEditPane_LargeSize_Button,className:s,disabled:i,onClick:this.Ry,title:Object(ae.a)().ImageEditPane_LargeSize_Button}},c=oe.createElement(qo.a,Object(S.__assign)({},a));return oe.createElement("div",{className:"image-edit-pane-element-container office-form-theme-border",key:"size-button"},o,c)},n.Jf=function(t){var e=this.props.ImageInfoMaster.Model,n=this.props.ImageSettingMaster;Object(g.b)("DesignPage.ImageEditPane.Style",{imageId:e.ResourceId,style:t}),n.onImageStyleChange(t)},n.Ay=function(){this.Jf(ne.c.Small)},n.Ry=function(){this.Jf(ne.c.Large)},n.$f=function(){var t=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:this.pt},Icon:"Delete",IconClassName:"forms-icon-size14x14",Text:Object(ae.a)().Common_Delete_Text});return oe.createElement("div",{className:"image-edit-pane-delete",key:"delete-button"},t)},n.zf=function(){if(this.state.ShowAltTextButton){var t=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"image-edit-pane-inner-button office-form-theme-button-foreground",onClick:this.Ey},Icon:"TextField",IconClassName:"edit-pane-fieldText",Text:Object(ae.a)().ImageEditPane_AltText_Button});return oe.createElement("div",{className:"image-edit-pane-alttext-button office-form-theme-border",key:"alttext-button"},t)}var e=Object(ar.b)({AutoFocus:!0,AutoSelection:!0,MaxLength:Object(Pe.p)(),MinimalHeight:28,onValueChange:this.By,Options:{HTMLPropsForInnerElement:{onBlur:this.Ly}},Placeholder:Object(ae.a)().ImageEditPane_AltText_PlaceHolder,ref:"edit-pane-alttext",TextFieldType:0,Value:this.props.ImageInfoMaster.Model.AltText});return oe.createElement("div",{className:"image-edit-pane-alttext office-form-theme-border",key:"alttext"},e)},n.By=function(t){this.props.ImageInfoMaster.Model.AltText=t},n.Ey=function(){Object(g.b)("DesignPage.ImageEditPane.AltText",{Id:this.props.ImageInfoMaster.Model.ResourceId}),this.setState({ShowAltTextButton:!1})},n.Ly=function(){var t=this;this.qy=window.setTimeout((function(){t.qy=null,t.setState({ShowAltTextButton:!0})}),150)},n.Hy=function(){this.qy&&(window.clearTimeout(this.qy),this.qy=null)},n.du=function(){Object(g.b)("Image.ImageOnLoad.Failure",{imageSrc:this.props.ImageInfoMaster.Model.ResourceUrl,imageType:this.props.ImageSettingMaster.IsFormLogo?"Logo":"Section",location:"0"}),this.setState({ImageLoadStatus:2})},n.fu=function(){Object(g.b)("Image.ImageOnLoad.Success",{imageType:this.props.ImageSettingMaster.IsFormLogo?"Logo":"Section",location:"0"}),this.setState({ImageLoadStatus:1})},n.jd=function(){var t,n,i=this.props.ImageInfoMaster,r=i.Model;if(r.ErrorType===ee.a.NoError&&2!==this.state.ImageLoadStatus)return null;r.ErrorType===ee.a.DeleteFailError||2===this.state.ImageLoadStatus?(t=e.createOperationButton(Object(ae.a)().Common_Delete_Text,"office-form-theme-primary-foreground","Horizontal","Delete","forms-icon-size12x12",this.pt),n=e.createOperationButton(Object(ae.a)().Common_Refresh_Text,"office-form-theme-primary-foreground","Horizontal","Refresh","forms-icon-size12x12",this.My)):t=e.createOperationButton(Object(ae.a)().Common_Try_again_Text,"office-form-theme-primary-foreground","Horizontal","Photo2","forms-icon-size12x12",this.props.addImage);var o=Object(Un.b)({HTMLAttributes:{className:"image-error-frowny-icon"},IconName:"Sad"}),s=Object(xr.a)({HTMLAttributes:{className:"error-message"},Label:i.getImageErrorMessage()||Object(ae.a)().Error_Message_5205}),a={height:this.props.ImageHeight||"120px",width:this.props.ImageWidth||Object(Pe.v)()+"px"};return oe.createElement("div",{className:"design-image-error office-form-theme-border",style:a},oe.createElement("div",{className:"error-message-box"},o,s),oe.createElement("div",null,n,t))},n.pt=function(){var t=this.props.ImageInfoMaster,e=this.props.ImageSettingMaster;Object(g.b)("DesignPage.ImageEditPane.Delete",{imageKind:e.IsFormLogo?"Logo":"Section"}),t.clear().then((function(){return e.clear()}))},n.My=function(){this.setState({ImageLoadStatus:0})},e.createOperationButton=function(t,e,n,i,r,o){return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:n,HTMLAttributes:{className:e,onClick:o},Icon:i,IconClassName:r,Text:t})},n.sr=function(){return this.props.ImageInfoMaster.Model.ImageProcessingStatus!==ee.c.Idle||0===this.state.ImageLoadStatus},n._y=function(){this.forceUpdate()},e.createSpinner=function(){var t=oe.createElement($o.a,Object(S.__assign)({},{ClassName:"designPage-question-tileUploadImage-spinner",Ignorable:!1}));return oe.createElement("div",{className:"image-spinner"},t)},e}(ue.a),Ko=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ge=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.focus=function(){var t=this.ge.current;t&&t.focus()},n.render=function(){var t=Et.extend({},this.props.HTMLAttributes);return t.className=Object(pn.b)(t.className,"title-designer-container"),oe.createElement("div",Object(S.__assign)({},t),this.Nu(),this.wu())},n.Qy=function(){return"Section"===this.props.TitleContainerType?Object(ae.a)().Designer_SectionTitle:Object(ae.a)().Designer_FormTitle},n.Vy=function(){return"Section"===this.props.TitleContainerType?Object(ae.a)().Designer_SectionSubtitle:Object(ae.a)().Designer_FormSubtitle},n.Nu=function(){var t=Object(Pe.j)(),e=2;this.props.TitleHeight&&"Top"!==this.props.MediaLayout&&"Bottom"!==this.props.MediaLayout&&(e=1,t=this.props.TitleHeight);var n=Object(pn.b)("title-designer-title-box",this.props.MediaLayout.toLowerCase()),i=Object(ar.c)({AllowRichText:!0,AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"title-designer-title-editor"},MaxLength:Object(Pe.o)(),MinimalHeight:t,onValueChange:this.props.onValueChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.Qy(),className:"mixer-focus-target"}},Placeholder:Object(ae.a)().Designer_PlaceholderForFormTitle,ref:this.ge,TextFieldType:e,Value:this.props.Value},this.props.Form,"Form"!==this.props.TitleContainerType,"Form"!==this.props.TitleContainerType);return oe.createElement("div",{className:n},i,this.props.children)},n.wu=function(){return Object(ar.c)({AllowRichText:!0,AutoSelection:!0,HTMLAttributes:{className:"title-designer-subtitle-editor"},MaxLength:Object(Pe.n)(),MinimalHeight:Object(Pe.j)(),onValueChange:this.props.onSubTitleChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.Vy()}},Placeholder:Object(ae.a)().Designer_PlaceholderForFormSubtitle,TextFieldType:2,Value:this.props.SubTitle},this.props.Form,!0,"Form"!==this.props.TitleContainerType)},e}(ue.a),Jo=n(110),Xo=n(114),Zo=function(t){function e(e){var n=t.call(this,e)||this;return n.zy=oe.createRef(),n.Uy=n.Uy.bind(n),n.vg=n.vg.bind(n),n.Oe=n.Oe.bind(n),n.$y=n.$y.bind(n),n.xe=n.xe.bind(n),n.Wy=n.Wy.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.props.Master,e=ke.a.Schema;t.observe(this.Oe,[e.Title,e.Subtitle,e.ImageInfo,e.VideoInfo,e.CoAuthors]);var n=t.ImageInfoMaster,i=Object(_t.f)().Schema;n.observe(this.Oe,[i.ImageProcessingStatus,i.ErrorType,i.UploadParameters]);var r=t.ImageSettingsMaster,o=ne.b.Schema;r.observe(this.Oe,[o.NaturalWidth,o.NaturalHeight,o.Size])},n.componentWillUnmount=function(){var t=this.props.Master;t.unobserve(this.Oe),t.ImageSettingsMaster.unobserve(this.Oe),t.ImageInfoMaster.unobserve(this.Oe)},n.render=function(){var t=this.props.Master,n=t.Model,i=Et.extend({},this.props.HTMLAttributes);i.className=Object(pn.b)(i.className,"__section-title-designer__ form-designer-section-title office-form-theme-focus-border");var r,o,s="Right",a=t.ImageInfoMaster,c=t.ImageSettingsMaster,u=a.Model,l=n.VideoInfo;if(u.ImageProcessingStatus===ee.c.Picking||u.ErrorType||Object(ee.g)(u)){var h=e.calcImageInfo(c.Model);r=h.Height,s=h.ImageLayout,o=oe.createElement(Wo,{addImage:this.$y,ImageHeight:h.Height,ImageInfoMaster:a,ImageSettingMaster:c,ImageWidth:h.Width,Resizable:!0})}else if(t.hasValidVideoUrl()){var f=Object(Ki.d)(l.Url,t.Form);s="Bottom",f&&(i.className=i.className+" youTubeDisabled");var d=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"video-delete-button office-form-theme-button-foreground",onClick:this.Wy},Icon:"Delete",IconClassName:f?"forms-icon-size14x14":"forms-icon-size18x18",Text:Object(ae.a)().VideoEditPane_Delete_Button});o=oe.createElement(Uo.a,{HTMLAttributes:{className:"design-question-image-title-big-horizontal"},ClassNameForIFrame:"design-question-title-video-frame",Url:l.Url,InDesignMode:!0,IsMobile:Object(et.r)(),ShowVideoUrl:f,LocalizedStrings:Object(ae.a)()},d)}else o=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-designer-title-editor-image-picker office-form-theme-button",onClick:this.$y},Icon:"Photo2",IconClassName:"forms-icon-size20x20",key:"ImagePicker",ref:this.zy,Text:Object(ae.a)().ImagePicker_Insert_Mdeia_button});var b=ke.a.Schema;return oe.createElement(Ko,{Form:this.props.Master.Form,HTMLAttributes:i,MediaLayout:s,onHeightChange:this.props.onHeightChange,onSubTitleChange:this.vg,onValueChange:this.Uy,SubTitle:Object(Y.g)()&&t.isFieldReady(b.FormsProRTSubtitle)&&n.FormsProRTSubtitle||n.Subtitle,TitleContainerType:"Section",TitleHeight:r,Value:Object(Y.g)()&&t.isFieldReady(b.FormsProRTQuestionTitle)&&n.FormsProRTQuestionTitle||n.Title},this.Xe(),o,this.De())},n.Wy=function(){Object(g.b)("DesignPage.VideoEditPane.Delete"),this.props.Master.clearVideoInfo();var t=this.props.Master.Form;Object(Ki.a)(t)||t.Model.YouTubeMessageBarState!==Ji.a.Shown||(t.Model.YouTubeMessageBarState=Ji.a.Default)},n.De=function(){var t=this,e=this.props.Master.Model.CoAuthors;if(e&&e.length>0&&e[e.length-1].userId!==Object(u.a)().userInfo.UserId)return oe.createElement("div",{className:"question-coAuthor-notification-container-design-mode"},Et.map(e,(function(e){return t.Be(e)})))},n.Be=function(t){if(t.userId!==Object(u.a)().userInfo.UserId){var e=Object(ae.a)().DesignPage_NavBar_CoAuthor_Section_Screen_Reader.format(t.displayName||t.userId,this.props.Ordinal);return oe.createElement(Jo.a,{ariaLabel:e,displayText:Object(Xo.a)(t.displayName,t.firstName,t.lastName),email:t.email,key:t.userId,name:t.displayName,tooltip:t.displayName||t.userId})}},n.$y=function(){var t=this,e=this.props.Master,n=e.Model;Object(g.b)("DesignPage.Questions.AddImage",{questionId:n.Id,questionType:n.Type}),Object(zo.b)().then((function(t){t.Image?e.ImageInfoMaster.addImage(t.Image):t.Video&&e.setVideoUrl(t.Video,!0)})).catch((function(e){var n=t.zy.current;e&&n&&n.focus()}))},n.Xe=function(){if(Object(et.B)()&&this.props.Master.Model.VideoInfo.ShowWarningBar){var t=this.props.Master.Form.SettingMaster,e=t.Model.IsAnonymous?Object(ae.a)().Designer_QuestionTitle_StreamVideoTipForAnonymousForm:Object(ae.a)().Designer_QuestionTitle_StreamVideoTip;return Object(xi.d)({Info:e,onClose:this.xe,ShouldClose:!0,TipBarIconClassName:"ms-Icon ms-Icon--Info forms-icon-size16x16",TipBarLocation:"Up",TipBarStyle:t.Model.IsAnonymous?"RedBackground":"YellowBackground"})}},n.xe=function(t){t.stopPropagation(),t.preventDefault(),this.props.Master.Model.VideoInfo.ShowWarningBar=!1},e.calcImageInfo=function(t){return t.NaturalWidth?t.Layout===ne.a.Horizontal&&t.Size===ne.c.Large?{ImageLayout:"Bottom"}:{Height:t.ContainerHeight,ImageLayout:"Right",Width:t.ContainerWidth}:{Height:Object(Pe.u)(),ImageLayout:"Right",Width:Object(Pe.v)()}},n.Uy=function(t){var e=this.props.Master.Model;Object(Y.g)()?(e.FormsProRTQuestionTitle=Object(or.c)(t),e.Title=t&&Object(or.b)(t,!0)):e.Title=t},n.vg=function(t){var e=this.props.Master.Model;Object(Y.g)()?(e.FormsProRTSubtitle=Object(or.c)(t),e.Subtitle=t&&Object(or.b)(t,!0)):e.Subtitle=t},n.Oe=function(){var t=this;this.forceUpdate((function(){var e=t.props.onHeightChange;e&&e()}))},e}(ue.a),Yo=function(t){function e(e){var n=t.call(this,e)||this;return n.Ky=oe.createRef(),n.Jy=oe.createRef(),n.Xy=n.Xy.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){this.Zy&&(this.Yy(),this.Zy=!1)},n.render=function(){var t=this,e=this.props,n="__section__ form-designer-section";e.MergeWithHeader&&(n=Object(pn.b)(n,"form-designer-section-merge"));var i=e.Master.Model.Title||Object(ae.a)().Designer_SectionTitle;return oe.createElement("div",{className:n,ref:this.Ky},oe.createElement(Vo,{designElement:e.designElement,DesignFocus:e.DesignFocus,Master:e.Master,MixerRef:this.Jy,Ordinal:e.Ordinal,scrollToDesigner:e.scrollToDesigner,trackMoveElement:this.Xy}),oe.createElement("div",{className:"form-designer-section-content"},oe.createElement(Eo,{AutoFocus:e.AutoFocus,DesignFocus:e.DesignFocus,HTMLAttributes:{"aria-label":i},Name:e.Master.Model.Id,ref:this.Jy,scrollToDesigner:this.props.scrollToDesigner},oe.createElement(Eo.Designer,null,oe.createElement(Zo,{Master:e.Master,onHeightChange:e.onHeightChange,Ordinal:this.props.Ordinal,ref:e.TitleDesignerRef}),oe.createElement(No,{designElement:this.props.designElement,Form:e.Master.Form,Section:e.Master})),oe.createElement(Eo.Renderer,null,oe.createElement(_o.a.Consumer,null,(function(n){var i=n.LocalizedStrings;return oe.createElement(Ho.a,{Master:e.Master,LocalizedStrings:i,onHeightChange:e.onHeightChange,Ordinal:t.props.Ordinal})})))),e.children))},n.Xy=function(){this.tw=$(this.Ky.current).offset().top,this.Zy=!0},n.Yy=function(){var t=this.Ky.current;if(t){var e=$(t),n=$(t.parentElement);n.scrollTop(n.scrollTop()+(e.offset().top-this.tw))}},e}(ue.a),ts=n(150),es=n(124),ns=n(144),is=n(118),rs=n(227);function os(t){var e=0,n=!1;if(Et.forEach(t.Questions,(function(t){t.IsQuiz&&(e+=t.Point||0,n=!0)})),n&&e)return oe.createElement("span",{className:"office-form-theme-quiz-totalPoints-bar",key:"points"},Object(rs.a)(e))}var ss=n(238),as=n(125),cs=function(t){function e(e){var n=t.call(this,e)||this;return n.ew=oe.createRef(),n.zy=oe.createRef(),n.nw=n.nw.bind(n),n.iw=n.iw.bind(n),n._y=n._y.bind(n),n.Ur=n.Ur.bind(n),n.rw=n.rw.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.props.Form,e=Zt.a.Schema;t.observe(this._y,[e.Title,e.Description]);var n=t.getImageMaster(Zt.a.Schema.Logo),i=t.getImageSettingsMaster(Zt.a.Schema.LogoInfo),r=Object(_t.g)();i.observe(this._y,[r.Schema.NaturalWidth,r.Schema.NaturalHeight,r.Schema.Size]);var o=Object(_t.f)().Schema;n.observe(this.rw,[o.ImageProcessingStatus,o.ErrorType,o.UploadParameters])},n.componentDidUpdate=function(){},n.componentWillUnmount=function(){var t=this.props.Form;t.unobserve(this._y);var e=t.getImageMaster(Zt.a.Schema.Logo),n=t.getImageSettingsMaster(Zt.a.Schema.LogoInfo);e.unobserve(this.rw),n.unobserve(this._y)},n.render=function(){var t,n,i=this.props.Form,r=i.getImageMaster(Zt.a.Schema.Logo),o=i.getImageSettingsMaster(Zt.a.Schema.LogoInfo),s=Object(pn.g)(this.props.HTMLAttributes,{className:"__title-designer__ form-designer-form-title office-form-theme-focus-border"}),a="Right",c=r.Model;if(c.ImageProcessingStatus!==ee.c.Idle||c.ErrorType||Object(ee.g)(c)){var u=e.calcImageInfo(o);a=u.ImageLayout,t=u.Height,n=oe.createElement(Wo,{addImage:this.Ur,ImageHeight:t,ImageInfoMaster:r,ImageSettingMaster:o,ImageWidth:u.Width,key:"imageDesigner"})}else n=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-designer-title-editor-image-picker office-form-theme-button",onClick:this.Ur},Icon:"Photo2",IconClassName:"forms-icon-size20x20",key:"imagePicker",ref:this.zy,Text:Object(ae.a)().ImagePicker_Insert_Image_button});return oe.createElement(Ko,{Form:this.props.Form,HTMLAttributes:s,MediaLayout:a,onHeightChange:this.props.onHeightChange,onSubTitleChange:this.iw,onValueChange:this.nw,ref:this.ew,SubTitle:Object(Y.g)()&&i.Model.FormsProRTDescription||i.Model.Description,TitleContainerType:"Form",TitleHeight:t,Value:Object(Y.g)()&&i.Model.FormsProRTTitle||i.Model.Title},n)},e.calcImageInfo=function(t){if(t.Model.NaturalWidth){var e=t.calcLogoLayout(),n=e.Layout===ne.a.Vertical?"Top":"Left";return{Height:e.ActualHeight,ImageLayout:n,Width:e.ActualWidth}}return{Height:Object(Pe.u)(),ImageLayout:"Left",Width:Object(Pe.v)()}},n.nw=function(t){var e=this.props.Form;Object(Y.g)()?e.bulkEdit((function(){e.Model.FormsProRTTitle=Object(or.c)(t),e.Model.Title=t?Object(or.b)(t,!0):t})):e.Model.Title=t},n.iw=function(t){var e=this.props.Form;Object(Y.g)()?e.bulkEdit((function(){e.Model.FormsProRTDescription=Object(or.c)(t),e.Model.Description=t?Object(or.b)(t,!0):t})):e.Model.Description=t},n.Ur=function(){var t=this.props.Form,e=t.getImageMaster(Zt.a.Schema.Logo);Object(g.b)("DesignPage.Form.Logo.AddImage",{FormId:t.isFieldReady(Zt.a.Schema.Id)?t.Model.Id:""}),Object(as.b)().then((function(t){return e.addImage(t)}))},n._y=function(){var t=this;this.forceUpdate((function(){var e=t.props.onHeightChange;e&&e()}))},n.rw=function(t){var e=t.OldValues,n=t.NewValues;if(e.ImageProcessingStatus===ee.c.Deleting&&n.ImageProcessingStatus===ee.c.Idle&&n.ErrorType!==ee.a.DeleteFailError){var i=this.ew.current;i&&i.focus()}this._y()},e}(ue.a),us=n(35),ls=n(195),hs=n(196),fs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ge=oe.createRef(),e.ow=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.Oe=function(){return t.forceUpdate()};var e=Zt.a.Schema,n=[e.Title,e.Description,e.HasValidBranching];n=Object(us.a)(n),this.props.Form.observe(this.Oe,n),this.props.Form.SettingMaster.Model.IsQuizMode&&this.props.Form.observe(this.Oe,[e.Questions]);var i=this.props.Form.getImageSettingsMaster(Zt.a.Schema.LogoInfo),r=Object(_t.g)().Schema;i.observe(this.Oe,[r.NaturalWidth,r.NaturalHeight]);var o=this.props.Form.getImageMaster(Zt.a.Schema.Logo),s=Object(_t.f)().Schema;o.observe(this.Oe,[s.ImageProcessingStatus,s.UploadParameters])},n.componentDidMount=function(){},n.componentWillUnmount=function(){this.props.Form.unobserve(this.Oe),this.props.Form.getImageSettingsMaster(Zt.a.Schema.LogoInfo).unobserve(this.Oe),this.props.Form.getImageMaster(Zt.a.Schema.Logo).unobserve(this.Oe)},n.render=function(){var t,n=this.props.Form,i=n.Model,r=Object(pn.g)(this.props.HTMLAttributes,{"aria-label":i.Title+" "+Object(ae.a)().Designer_FormTitle_Label,className:Object(at.c)((function(){return"__title-designer__ form-designer-title-view"}),at.f)}),o="Left";if(!this.props.HideMedia){var s=n.getImageMaster(Zt.a.Schema.Logo),a=n.getImageSettingsMaster(Zt.a.Schema.LogoInfo),c=s.Model;if(!c.ErrorType&&(c.ImageProcessingStatus!==ee.c.Idle||Object(ee.g)(c))){var u=e.calcImageLayout(a);o=u.ImageLayout,t=oe.createElement(ls.a,{ImageWidth:u.Width,ImageHeight:u.Height,ImageInfoMaster:s,ImageSettingMaster:a,ImageType:"Logo"})}}var l=[os(this.props.Form.Model),this.sw()],h=this.props.FormLocalizedItemMaster,f=(null==h?void 0:h.Model.title)||i.Title,d=(null==h?void 0:h.Model.subtitle)||i.Description;return Object(Y.g)()&&(d=(null==h?void 0:h.Model.formsprortlocalesubtitle)||i.FormsProRTDescription||d,f=(null==h?void 0:h.Model.formsprortlocaletitle)||i.FormsProRTTitle||f,d=Object(or.c)(d),f=Object(or.c)(f)),f=Object(us.m)(f,!0),d=Object(us.m)(d,!0),oe.createElement(hs.a,{HTMLAttributes:r,HTMLPropsForInnerElement:{children:l},MediaLayout:o,SubTitle:d,Title:f},t)},n.sw=function(){if(this.props.Form.Model.HasValidBranching){return oe.createElement("div",{className:Object(at.c)((function(){return"office-form-branching-icon office-form-theme-primary-foreground"}),at.f),ref:this.ow},Object(Un.b)({HTMLAttributes:{className:"forms-icon-size24x24"},IconName:"BranchMerge",key:"branch-icon"}))}},e.calcImageLayout=function(t){if(t.Model.NaturalWidth){var e=t.calcLogoLayout();return{Height:e.ActualHeight,ImageLayout:e.Layout===ne.a.Vertical?"Top":"Left",Width:e.ActualWidth}}return{Height:Object(Pe.v)(),ImageLayout:"Left",Width:Object(Pe.u)()}},e}(ue.a);function ds(t){return Object(Ht.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")&&Object(u.a)().userInfo.IsMsa?oe.createElement(bs,t):function(t){return oe.createElement(Eo,{DesignFocus:t.DesignFocus,Name:"__title",scrollToDesigner:t.scrollToDesigner,IsDesignModeDisabled:Object(at.c)((function(){return!1}),at.f)},oe.createElement(Eo.Designer,null,oe.createElement(cs,{Form:t.Form,HTMLAttributes:t.HTMLAttributes,onHeightChange:t.onHeightChange}),oe.createElement(So,{Form:t.Form,designElement:t.designElement})),oe.createElement(Eo.Renderer,null,oe.createElement(fs,{Form:t.Form,HTMLAttributes:t.HTMLAttributes,onHeightChange:t.onHeightChange})))}({Form:t.Form,designElement:t.designElement,DesignFocus:t.DesignFocus,onHeightChange:t.onHeightChange,scrollToDesigner:t.scrollToDesigner})}var bs=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate((function(){n.props.onHeightChange()}))};var i=Zt.a.Schema;return n.props.Form.observe(n.Oe,[i.Title,i.Description,i.Logo,i.LogoInfo,i.HasValidBranching]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.Form.unobserve(this.Oe)},n.componentDidMount=function(){Object(ns.a)($(".form-designer-subtitle-editor textarea")),window.setTimeout(this.Oe,0)},n.render=function(){var t=Eo;return oe.createElement(t,{DesignFocus:this.props.DesignFocus,Name:"__title",scrollToDesigner:this.props.scrollToDesigner},oe.createElement(t.Designer,null,this.aw(),this.cw()),oe.createElement(t.Renderer,null,this.uw()))},n.aw=function(){var t,e,n,i,r=this.props.Form,o=r.getImageMaster(Zt.a.Schema.Logo),s=o.Model,a=r.getImageSettingsMaster(Zt.a.Schema.LogoInfo),c=a.Model,u=s.ImageProcessingStatus===ee.c.Picking,l=s.ImageProcessingStatus===ee.c.Uploading,h=Object(ee.g)(s),f=s.ErrorType!==ee.a.NoError;u||f||h?(t=Object(ss.a)({HTMLAttributes:{className:"horizontal"},ImageMaster:o,ImageSettingsMaster:a,IsFormLogo:!0}),n=c.ContainerHeight,i=c.ContainerWidth,(u||l||h)&&(n=Object(Pe.u)(),i=Object(Pe.v)(),c.ContainerWidth=i,c.ContainerHeight=n)):e=Object(yn.a)({HTMLAttributes:{className:"form-designer-title-editor-image-picker office-form-theme-button",onClick:function(){Object(g.b)("DesignPage.Form.Logo.AddImage",{FormId:r.isFieldReady(Zt.a.Schema.Id)?r.Model.Id:""}),Object(as.b)().then((function(t){return o.addImage(t)}))}},Icon:"Photo2",IconClassName:"forms-icon-size20x20",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(ae.a)().ImagePicker_Insert_Image_button,ref:"imagePicker"});var d="form-designer-title-editor";e&&(d=Object(pn.b)(d,"image"));var b=Object(ar.c)({AutoFocus:!0,Placeholder:Object(ae.a)().Designer_PlaceholderForFormTitle,Options:{HTMLPropsForInnerElement:{className:"mixer-focus-target"}},Value:Object(Y.g)()&&r.Model.FormsProRTTitle||r.Model.Title,TextFieldType:t?1:2,MinimalHeight:t?n:40,AutoSelection:!0,HTMLAttributes:{className:d,style:t?{width:"calc(100% - {0}px)".format(i+10)}:void 0},MaxLength:Object(Pe.o)(),onValueChange:function(t){Object(Y.g)()?(r.Model.Title=t?Object(or.b)(t,!0):t,r.Model.FormsProRTTitle=Object(or.c)(t)):r.Model.Title=t}},this.props.Form,!1),m=Object(ar.c)({Placeholder:Object(ae.a)().Designer_PlaceholderForFormSubtitle,Options:{HTMLPropsForInnerElement:{className:"mixer-focus-target"}},Value:Object(Y.g)()&&r.Model.FormsProRTDescription||r.Model.Description,TextFieldType:2,MinimalHeight:40,HTMLAttributes:{className:"form-designer-subtitle-editor"},MaxLength:Object(Pe.n)(),onValueChange:function(t){Object(Y.g)()?(r.Model.Description=t?Object(or.b)(t,!0):t,r.Model.FormsProRTDescription=Object(or.c)(t)):r.Model.Description=t}},this.props.Form,!0),v=Object(pn.g)(this.props.HTMLAttributes,{className:"__title-designer__ form-designer-form-title office-form-theme-focus-border"});return oe.createElement("div",v,t,b,e,m)},n.cw=function(){return oe.createElement(So,{designElement:this.props.designElement,Form:this.props.Form})},n.uw=function(){var t,e=this.props.Form,n=e.Model,i=Object(pn.g)(this.props.HTMLAttributes,{"aria-expanded":!1,"aria-label":n.Title+" "+Object(ae.a)().Designer_FormTitle_Label,className:"__title-designer__ form-designer-title-view"});return n.Logo&&n.Logo.ResourceUrl?t=oe.createElement("div",{className:"logo-image-container old"},Object(is.b)({Image:e.getImageMaster(Zt.a.Schema.Logo),ImageSettings:e.getImageSettingsMaster(Zt.a.Schema.LogoInfo),ImageType:"Logo"}),Object(is.c)(e.getImageMaster(Zt.a.Schema.Logo).Model)):n.Logo.ImageProcessingStatus!==ee.c.Uploading&&n.Logo.ImageProcessingStatus!==ee.c.Picking&&n.Logo.ErrorType===ee.a.NoError||(t=oe.createElement("div",{className:"logo-image-container old",style:{height:Object(Pe.z)()+"px",width:Object(Pe.z)()+"px"}},Object(is.c)())),oe.createElement("div",i,t,oe.createElement("div",{className:"office-form-title heading-1"},oe.createElement("div",null,oe.createElement("span",null,n.Title),os(this.props.Form.Model),this.sw())),oe.createElement("div",{className:"office-form-subtitle heading-1"},n.Description))},n.sw=function(){if(this.props.Form.Model.HasValidBranching)return oe.createElement("div",{className:"office-form-branching-icon office-form-theme-primary-foreground"},Object(Un.b)({HTMLAttributes:{className:"forms-icon-size24x24"},key:"branch-icon",IconName:"BranchMerge"}))},e}(ue.a),ms=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.lw=0,n.hw=new Ui,n.fw=oe.createRef(),n.me=[],n.dw={},n.state={ReputationTier:n.props.Form.Model.ReputationTier},n.bw=n.bw.bind(n),n.mw=n.mw.bind(n),n.Oj=n.Oj.bind(n),n.vw=n.vw.bind(n),n.gw=n.gw.bind(n),n.Oe=n.Oe.bind(n),n.Ow=n.Ow.bind(n),n.pw=n.pw.bind(n),(Object(Ri.a)(n.props.Form,"DisableEditForm")||Object(Oo.e)(n.state.ReputationTier))&&n.hw.setLocked(!0),n.pw(),n.props.Form.observe(n.Oe,[Zt.a.Schema.ReputationTier]),n.props.Form.observe(n.Ow,[Zt.a.Schema.Title,Zt.a.Schema.Settings.IsAnonymous]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){if(Object(kn.a)(),Object(Xi.c)(),Object(Y.c)("IntelligenceUseMemoryCache")){var t=Object(u.a)().userInfo;t&&t.TenantId&&t.UserId&&Object(Me.g)(t.TenantId,t.UserId)}this.jw(),!Object(st.k)()&&Object(M.f)()||Object(u.a)().userInfo.IsMsa||Object(st.b)(),this.yw(),this.ww()},n.componentDidUpdate=function(){this.yw()},n.componentWillUnmount=function(){var t=this;this.ce=!1;var e=this.props.Form;$("#body-scrollable-content").unbind("scroll"),Wt.a.getCollectionMasterFromModel(e.Model.Questions).unobserve(this.vw),Wt.a.getCollectionMasterFromModel(e.Model.DescriptiveElements).unobserve(this.vw),Et.keys(this.dw).forEach((function(e){return t.dw[e].release()})),this.props.Form.observe(this.Oe),this.props.Form.unobserve(this.Ow)},n.shouldComponentUpdate=function(t){return this.props.Form!==t.Form},n.render=function(){var t=this,e=Et.extend({},this.props.HTMLAttributes);e.id="form-designer-container",e.onMouseDown=function(e){var n=e.target;!n||"form-designer-container"!==n.id&&"form-designer"!==n.id||t.endCurrentDesignMode()};return oe.createElement("div",Object(S.__assign)({},this.props.HTMLAttributes,{id:"design-view"}),oe.createElement("div",Object(S.__assign)({},e,{tabIndex:-1,"aria-label":this.props.Form.Model.Title,role:"main"}),this.Fh(),oe.createElement("div",{id:"form-designer"},this.Sw()),null,null))},n.endCurrentDesignMode=function(){this.hw.getDefaultGrabber().grab()},n.Nw=function(t){this.me.push(t)},n.Iw=function(t){var e=this,n=this.props.Form,i=0===n.FormElementManager.SectionMasters.length;return oe.createElement("div",{key:"headerTopQuestions",className:"form-designer-section"},ds({Form:n,designElement:this.mw,DesignFocus:this.hw,onHeightChange:this.bw,scrollToDesigner:this.gw}),n.FormElementManager.HeaderTopQuestionMasters.map((function(n,i){return e.Cw(n,i,t)})),i&&this.kw())},n.Sw=function(){var t=this,e=this.props.Form,n=e.FormElementManager.TopElementMasters,i=e.FormElementManager.TopQuestionMasters,r=e.FormElementManager.SectionMasters,o=0===e.FormElementManager.HeaderTopQuestionMasters.length&&r.length>=1&&r[0],s=[this.Iw(n),oe.createElement(es.a,{key:"themeRender",ThemeMaster:e.ThemeMaster})];return r&&r.length&&(s=s.concat(r.map((function(e,s){return t.Tw(e,s,r,i,n,e===o)})))),s},n.Fh=function(){if(!(!Object(st.k)()&&Object(M.f)()||Object(u.a)().userInfo.IsMsa))return oe.createElement(Mo.a,{FormMaster:this.props.Form,HTMLAttributes:{className:"form-designer-classification-label"},DesignTimeView:!0})},n.Cw=function(t,e,n){var i=Eo,r=this.xw===t;r&&(this.xw=null);var o=!!t.getErrorMessage();return oe.createElement(i,{AutoFocus:r,DesignFocus:this.hw,Name:t.Model.Id,key:t.Model.Id,scrollToDesigner:this.gw,IsDesignModeDisabled:!1,ShowWarning:o},oe.createElement(i.Designer,null,Rr({DesignFocus:this.hw,designElement:this.mw,focusOnAddButton:this.Oj,Master:t,Ordinal:e+1,IsFirstElement:this.Fw(n,t),IsLastElement:n[n.length-1]===t,ref:this.fw}),oe.createElement(Io,{designElement:this.mw,Form:this.props.Form,Question:t})),oe.createElement(i.Renderer,null,Object(ts.a)({Master:this.Pw(t),LocalizedStrings:Object(ae.a)(),Ordinal:e+1,DisableShuffle:!0,Disabled:!0,onHeightChange:this.bw,ShowDesignInfo:!0,designElement:this.mw})))},n.Fw=function(t,e){return t[0]===e||!!(t.length>=2&&t[1]===e&&Yt.a.isSection(t[0].Model.Type))},n.Tw=function(t,e,n,i,r,o){var s=this,a=this.xw===t;a&&(this.xw=null);var c=this.props.Form.FormElementManager.findQuestionsInSection(t),u=Et.indexOf(i,c[0]),l=e===n.length-1;return oe.createElement(Yo,{AutoFocus:a,designElement:this.mw,DesignFocus:this.hw,key:t.Model.Id+"-section-designer",Master:t,MergeWithHeader:o,onHeightChange:this.bw,Ordinal:e+1,scrollToDesigner:this.gw,TitleDesignerRef:this.fw},c.map((function(t,e){return s.Cw(t,e+u,r)})),l&&this.kw())},n.kw=function(){return oe.createElement(Bo,{DesignFocus:this.hw,Form:this.props.Form,designElement:this.mw})},n.Pw=function(t){var e=this.dw[t.Model.Id];return e||(e=new Zi.a(t,null),this.dw[t.Model.Id]=e),e},n.mw=function(t){var e=this.props.Form;if(!Object(Ri.a)(e,"DisableEditForm"))if(t){var n=this.hw.getGrabberByName(t.Model.Id);n?n.grab():(this.Nw(this.gw),this.xw=t,this.forceUpdate())}else this.hw.getDefaultGrabber().grab()},n.Oj=function(){var t=this.props.Form;Object(Ri.a)(t,"DisableEditForm")||this.hw.getDefaultGrabber().focus()},n.vw=function(t){var e=this;(t.AddedModels.length||t.RemovedModels.length||Et.contains(t.FieldSchemas,t.Master.Schema[0].Order))&&(this.forceUpdate((function(){e.props.Form.FormElementManager.getElementMasterById(e.hw.getCurrentOwner().getName())&&e.bw(),e.pe()})),this.ww())},n.Dw=function(){var t=this.fw.current;if(t){var e=Ln.findDOMNode(t);e&&(this.lw=$(e).offset().top)}},n.gw=function(){var t=this.fw.current;if(t){var n=Ln.findDOMNode(t);if(n){var i=$(n);e.scrollToElement(i),this.lw=i.offset().top}}},e.scrollToElement=function(t){var e=$("#body-scrollable-content"),n=.03*e.outerHeight(),i=Math.max(.15*e.outerHeight(),50);Object(pn.j)(t,e,n,i)},n.bw=function(){var t=this.fw.current;if(t){var e=Ln.findDOMNode(t);if(e){var n=$("#body-scrollable-content"),i=n.scrollTop()+($(e).offset().top-this.lw);n.scrollTop(i),this.lw=$(e).offset().top}}},n.jw=function(){var t=this,e=this.props.Form;$("#body-scrollable-content").bind("scroll",(function(){t.Dw()})),Wt.a.getCollectionMasterFromModel(e.Model.Questions).observe(this.vw),Wt.a.getCollectionMasterFromModel(e.Model.DescriptiveElements).observe(this.vw),$("#form-designer-container").focus()},n.pe=function(){var t=this.me;this.me=[],this.forceUpdate((function(){t.forEach((function(t){return t()}))}))},n.Oe=function(){this.ce&&(this.setState({ReputationTier:this.props.Form.Model.ReputationTier}),Object(Oo.e)(this.props.Form.Model.ReputationTier)?this.hw.setLocked(!0):this.hw.setLocked(!1))},n.Ow=function(){this.forceUpdate()},n.yw=function(){var t=Object(_t.b)().Model,e=this.props.Form.FormElementManager.QuestionMasters,n=Et.find(e,(function(t){return!!t.getErrorMessage()}));t.ErrorBarMessage=n?n.getErrorMessage():null},n.ww=function(){var t=this.props.Form.Model.YouTubeMessageBarState;Object(Ki.a)(this.props.Form)?t===Ji.a.Default&&(this.props.Form.Model.YouTubeMessageBarState=Ji.a.Shown):t===Ji.a.Shown&&(this.props.Form.Model.YouTubeMessageBarState=Ji.a.Default)},n.pw=function(){if(Object(Ki.a)(this.props.Form)){var t=Object(O.b)().getItem(Ki.c),e=void 0;t&&(e=JSON.parse(t)),e&&this.props.Form.isFieldReady(Zt.a.Schema.Id)&&e.indexOf(this.props.Form.Model.Id)?this.props.Form.Model.YouTubeMessageBarState=Ji.a.Closed:this.props.Form.Model.YouTubeMessageBarState=Ji.a.Default}},e}(ue.a),vs=n(252),gs=function(t){function e(e){var n=t.call(this,e)||this;return n.Mw=n.Mw.bind(n),n.Lw=n.Lw.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){this.Aw=this.props.Selected;var t="navbar-button";this.props.Disabled&&(t=Object(pn.b)(t,"disabled","highContrast-text-disabled"));var e=Et.extend({},this.props.HTMLAttributes);return oe.createElement("div",Object(S.__assign)({},e),oe.createElement("div",{"aria-disabled":this.props.Disabled,"aria-label":this.props.TabName,"aria-posinset":this.props.Index+1,"aria-selected":this.Aw,"aria-setsize":this.props.TotalItems,className:t,id:"navi-item-index-"+this.props.Index,onClick:this.Mw,onKeyDown:this.Lw,role:"tab",tabIndex:this.Aw?0:-1,title:this.props.ButtonTitle},this.props.TabName,this.props.NotificationShowedOnTab))},n.Mw=function(){this.props.Disabled||this.props.onClick(this.props.Index)},n.Lw=function(t){39===t.keyCode&&this.props.Index+1<this.props.TotalItems?Os(t,"navi-item-index-"+this.props.Index,"navi-item-index-"+(this.props.Index+1)):37===t.keyCode&&this.props.Index-1>=0?Os(t,"navi-item-index-"+this.props.Index,"navi-item-index-"+(this.props.Index-1)):13!==t.keyCode&&32!==t.keyCode||this.Mw()},e}(ue.a);function Os(t,e,n){t.stopPropagation(),t.preventDefault();var i=document.getElementById(e),r=document.getElementById(n);r&&(r.focus(),$(r).attr("tabindex",0),$(i).attr("tabindex",-1))}var ps=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){return this.props.children},e}(ue.a),js=function(t){function e(e){var n=t.call(this,e)||this;return n.Rw=n.Rw.bind(n),n.state={SelectIndex:n.props.DefaultSelectIndex||0},n}Object(S.__extends)(e,t);var n=e.prototype;return e.getNavBarContainer=function(){return $(".navbar-content")},n.componentWillReceiveProps=function(t){t.DefaultSelectIndex!==this.props.DefaultSelectIndex&&this.setState({SelectIndex:t.DefaultSelectIndex})},n.render=function(){var t,e=this,n=oe.Children.toArray(this.props.children).filter((function(t){return t&&t.type===ps})),i=n.map((function(t,i){var r={className:"navbar-item"},o=e.state.SelectIndex===i;return o&&"ThemeBackground"!==e.props.Style&&(r.className=Object(pn.b)(r.className,"office-form-theme-border-top","office-form-theme-shadow","office-form-theme-primary-foreground is-active")),"ThemeBackground"===e.props.Style&&(r.className=Object(pn.b)(r.className,"office-form-theme-primary-foreground",o&&"office-form-theme-border-bottom-for-mobile is-active")),oe.createElement(gs,{ButtonTitle:t.props.ButtonTitle,Disabled:t.props.Disabled,HTMLAttributes:r,Index:i,key:"tab-control-button-"+i,NotificationShowedOnTab:t.props.NotificationShowedOnTab,onClick:e.Rw,Selected:o,TabName:t.props.TabName,TotalItems:n.length})})),r=this.state.SelectIndex||0,o="navbar-content office-form-page-padding";return"ThemeBackground"===this.props.Style&&(o=Object(pn.b)(o,"office-form-nav-bottom-shadow","office-form-theme-primary-foreground")),r>=0&&r<n.length&&(t=n[r]),oe.createElement(oe.Fragment,null,oe.createElement("div",{className:o,role:"navigation"},oe.createElement("div",{className:"navbar-items",role:"tablist"},i)),t)},n.Rw=function(t){this.props.onSelectTabChange(t),this.setState({SelectIndex:t})},e}(ue.a);vs.a.getNavBarContainer=js.getNavBarContainer;var ys=function(){function t(){}return t.GoBackToReleaseResults="GoBackToReleaseResults",t.GoBackToAnalysis="GoBackToAnalysis",t.ByStudent={View:"Student",Index:0,GoBackToView:t.GoBackToAnalysis},t.ByQuestion={View:"Question",Index:0,GoBackToView:t.GoBackToAnalysis},t}(),ws=function(){function t(){}t.prototype;return t}(),Ss=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){if(t){var n=this.Ew(t);e.NPSQuestionAggregation={Promoters:n.promoters,Passives:n.passives,Detractors:n.detractors,ResponseCount:t.npsData.count}}else this.setDefaultAggregateToModel(e)},n.setDefaultAggregateToModel=function(t){t.NPSQuestionAggregation={Promoters:0,Passives:0,Detractors:0,ResponseCount:0}},n.Ew=function(t){var e=t.npsData.distributed;return{promoters:0+e[9]+e[10],passives:0+e[7]+e[8],detractors:t.npsData.distributed.slice(0,7).reduce((function(t,e){return t+e}),0)}},e}(ws),Ns={QuestionId:Kt.a.create(Kt.a.string(),{IsKeyField:!0}),IsAggregationReady:Kt.a.boolean(),IsAggregationFailed:Kt.a.boolean(),IsMathQuestion:Kt.a.boolean(),ChoiceQuestionAggregation:Kt.a.create({ChoiceSummary:Kt.a.collectionOf({Choice:Kt.a.string(),Count:Kt.a.number(),IsFormula:Kt.a.boolean()})}),TextQuestionAggregation:Kt.a.create({TopAnswers:Kt.a.collectionOf({Id:Kt.a.number(),Answer:Kt.a.string(),IsMath:Kt.a.boolean()}),ResponseCount:Kt.a.number(),TextSummary:Kt.a.collectionOf({Text:Kt.a.string(),Count:Kt.a.number(),IsMath:Kt.a.boolean()})}),RatingQuestionAggregation:Kt.a.create({AverageRating:Kt.a.number(),ResponseCount:Kt.a.number()}),DateQuestionAggregation:Kt.a.create({TopDate:Kt.a.collectionOf({Id:Kt.a.number(),Answer:Kt.a.reference()}),ResponseCount:Kt.a.number()}),RankingQuestionAggregation:Kt.a.collectionOf({Id:Kt.a.number(),Name:Kt.a.string(),Statistics:Kt.a.collectionOf(Kt.a.number()),Weight:Kt.a.number()}),LikertQuestionAggregation:Kt.a.create({Options:Kt.a.collectionOf(Kt.a.string()),LikertResults:Kt.a.collectionOf({SubQuestionId:Kt.a.string(),SubQuestionName:Kt.a.string(),Statistics:Kt.a.collectionOf(Kt.a.number())})}),FileUploadQuestionAggregation:Kt.a.create({RecentFile:Kt.a.collectionOf({Answer:Kt.a.string()}),ResponseCount:Kt.a.number()}),NPSQuestionAggregation:Kt.a.create({Promoters:Kt.a.number(),Passives:Kt.a.number(),Detractors:Kt.a.number(),ResponseCount:Kt.a.number()}),GradeStatistics:Kt.a.create({CorrectCount:Kt.a.number(),WrongCount:Kt.a.number()})};function Is(t){return Wt.a.getObjectMasterFromModel(t)}var Cs,ks=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getIoCQuestionMaster=function(){throw new Error("Method not implemented.")},n.aggregate=function(t){var e=this;this.bulkEdit((function(){var n=e.FormMaster.Model.Settings.IsQuizMode?Cs.Quiz:Cs.Survey;(function(t,e){var n=function(t,e){if(t===Cs.Quiz)switch(e){case"Question.Choice":return xs;case"Question.DateTime":return Ps;case"Question.FileUpload":return Ms;case"Question.MatrixChoiceGroup":return As;case"Question.Ranking":return Es;case"Question.Rating":return _s;case"Question.TextField":return Gs;case"Question.NPS":return Ss}else if(t===Cs.Survey)switch(e){case"Question.Choice":return qs;case"Question.DateTime":return Qs;case"Question.FileUpload":return Vs;case"Question.MatrixChoiceGroup":return zs;case"Question.Ranking":return Us;case"Question.Rating":return $s;case"Question.TextField":return Ws;case"Question.NPS":return Ss}}(e,t);if(!n)throw Error(t+" is not supported");return new n})(e.QuestionType,n).aggregate(t,e.Model)}))},Object.defineProperty(n,"FormMaster",{get:function(){return this.Parent.Parent.FormMaster},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionMaster",{get:function(){return this.FormMaster.getQuestionById(this.Model.QuestionId)},enumerable:!1,configurable:!0}),Object.defineProperty(n,"QuestionType",{get:function(){return this.QuestionMaster.Model.Type},enumerable:!1,configurable:!0}),e}(Wt.a.createObjectMasterClass("QuestionAggregation",Ns)),Ts=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Bw="answer_other",e}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){t?this.aggregateInternal(t,e):this.setDefaultAggregateToModel(e)},n.aggregateInternal=function(t,e){var n=Is(e).QuestionMaster,i=e.ChoiceQuestionAggregation;i.ChoiceSummary=Wt.a.convertToArray(n.Model.Choices).map((function(e){var n=Et.find(t.formChoiceData,(function(t){return t.id===e.Description}));return{Choice:e.Description,Count:null==n?0:n.count,IsFormula:e.IsMathOption}}));var r=Et.find(t.formChoiceData,(function(t){return"_Other"==t.id}));(r||Is(e).QuestionMaster.Model.AllowOtherAnswer)&&Wt.a.Collection.addItems(i.ChoiceSummary,[{Choice:this.Bw,Count:r?r.count:0,IsFormula:!1}])},n.setDefaultAggregateToModel=function(t){var e=Is(t).QuestionMaster,n=t.ChoiceQuestionAggregation;n.ChoiceSummary=Wt.a.convertToArray(e.Model.Choices).map((function(t){return{Choice:t.Description,Count:0,IsFormula:t.IsMathOption}})),Is(t).QuestionMaster.Model.AllowOtherAnswer&&Wt.a.Collection.addItems(n.ChoiceSummary,[{Choice:this.Bw,Count:0,IsFormula:!1}])},e}(ws),xs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.aggregateInternal=function(e,n){t.prototype.aggregateInternal.call(this,e,n);var i=e.correctCount,r=e.totalCount;n.GradeStatistics={CorrectCount:i,WrongCount:r-i}},e}(Ts),Fs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){var n=this;if(t){var i=e.DateQuestionAggregation;i.ResponseCount=t.dateData.count,i.TopDate=t.dateData.recentValues.filter((function(t){return null!=t})).map((function(t){return{Id:void 0,Answer:n._w(t)}}))}else this.setDefaultAggregateToModel(e)},n.setDefaultAggregateToModel=function(t){var e=t.DateQuestionAggregation;e.ResponseCount=0,e.TopDate=null},n._w=function(t){var e=Object(Pe.f)();return t.length>e.length?Date.parseDate(t,"MM/dd/yyyy hh:mm:ss tt",Object(u.a)().cultureInfo):Date.parseDate(t,e,Object(u.a)().cultureInfo)},e}(ws),Ps=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Fs),Ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){t?this.aggregateInternal(t,e):this.setDefaultAggregateToModel(e)},n.setDefaultAggregateToModel=function(t){var e=t.FileUploadQuestionAggregation;e.ResponseCount=0,e.RecentFile=null},e}(ws),Ms=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.aggregateInternal=function(t,e){var n=e.FileUploadQuestionAggregation,i=t.longTextData;n.ResponseCount=i.count;var r=[];i.recentValues.filter((function(t){return null!=t})).forEach((function(t){t&&JSON.parse(t).reverse().forEach((function(t){r.length<3&&r.push({Answer:t})}))})),n.RecentFile=r},e}(Ds),Ls=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.choiceIdsIndex={},e.likertStatistics={},e}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){t?(this.initializeDelegator(e),this.aggregateInternal(t,e)):this.setDefaultAggregateToModel(e)},n.initializeDelegator=function(t){var e=this;this.questionMaster=Is(t).QuestionMaster,this.subQuestions=Et.pluck(this.questionMaster.SubQuestionMasters,"Model"),this.choiceGroup=this.questionMaster.Model.ChoiceGroup;var n=[];Et.forEach(this.choiceGroup,(function(t,i){e.choiceIdsIndex[t.Id]=i,n.push(0)})),Et.forEach(this.subQuestions,(function(t){e.likertStatistics[t.Id]={Name:t.Title,Statistics:n.slice()}}))},n.aggregateInternal=function(t,e){var n=this;t.likertChoiceData.forEach((function(t){t.subQuestionData.forEach((function(e){n.likertStatistics[t.subQuesionId].Statistics[n.choiceIdsIndex[e.id]]=e.count}))})),e.LikertQuestionAggregation={Options:Et.pluck(this.choiceGroup,"Description"),LikertResults:this.getLikertStatistics()}},n.setDefaultAggregateToModel=function(t){},n.getLikertStatistics=function(){var t=this;return Et.map(this.subQuestions,(function(e){return{SubQuestionId:e.Id,SubQuestionName:t.likertStatistics[e.Id].Name,Statistics:t.likertStatistics[e.Id].Statistics}}))},e}(ws),As=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Ls),Rs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){t?(this.questionMaster=Is(e).QuestionMaster,this.choiceGroup=this.questionMaster.Model.ChoiceGroup,this.aggregateInternal(t,e)):this.setDefaultAggregateToModel(e)},n.aggregateInternal=function(t,e){var n=this;e.RankingQuestionAggregation=Et.map(this.choiceGroup,(function(e){var i=Et.find(t.rankingData,(function(t){return t.id===e.Id}));return i=i||{id:e.Id,rankingCount:[]},{Id:e.Id,Name:e.Description,Statistics:n.getRankerStatistics(i),Weight:n.getRankerWeight(i)}})).sort((function(t,e){return e.Weight-t.Weight}))},n.setDefaultAggregateToModel=function(t){},e}(ws),Es=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Hw=[],e}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregateInternal=function(e,n){this.Gw(),t.prototype.aggregateInternal.call(this,e,n);var i=e.correctCount,r=e.totalCount;n.GradeStatistics={CorrectCount:i,WrongCount:r-i}},n.Gw=function(){var t=this,e=JSON.parse(this.questionMaster.Model.GradingBasis);this.Hw=Et.map(Array.apply(null,Array(e.length)),Number.prototype.valueOf,0),Et.forEach(this.choiceGroup,(function(n){return t.Hw[e.indexOf(n.Key)]=n.Id}))},n.getRankerStatistics=function(t){var e=this.Hw.indexOf(t.id)+1,n=Et.find(t.rankingCount,(function(t){return t.rank===e})),i=n?n.count:0;return[i,t.rankingCount.map((function(t){return t.count})).reduce((function(t,e){return t+e}),0)-i]},n.getRankerWeight=function(t){return this.Hw.indexOf(t.id)},e}(Rs),Bs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){if(t){var n=e.RatingQuestionAggregation;n.ResponseCount=t.numberData.count,n.AverageRating=t.numberData.average}else this.setDefaultAggregateToModel(e)},n.setDefaultAggregateToModel=function(t){var e=t.RatingQuestionAggregation;e.ResponseCount=0,e.AverageRating=0},e}(ws),_s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Bs),Hs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t,e){t?this.aggregateInternal(t,e):this.setDefaultAggregateToModel(e)},n.setDefaultAggregateToModel=function(t){},e}(ws),Gs=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Bw="answer_other",e}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregateInternal=function(t,e){var n=Is(e).QuestionMaster;n.Model.Multiline||!n.hasCorrectAnswers()?this.qw(t,e):this.Qw(t,e);var i=t.correctCount,r=t.totalCount;e.GradeStatistics={CorrectCount:i,WrongCount:r-i}},n.qw=function(t,e){var n=e.TextQuestionAggregation,i=Et.first(t.quizTextData).surveyData;n.ResponseCount=i.count,n.TopAnswers=i.recentValues.filter((function(t){return null!=t})).map((function(t){var n;if(e.IsMathQuestion&&"_Other"!=t){var i=Object(et.G)(t);t=null==i.Answer?t:i.Answer,n=i.IsMath}return{Id:void 0,Answer:t,IsMath:n}}))},n.Qw=function(t,e){var n=this;e.TextQuestionAggregation.TextSummary=t.quizTextData.map((function(t){var i,r=t.quizData.id;if(e.IsMathQuestion&&"_Other"!=r){var o=Object(et.G)(r);r=null==o.Answer?r:o.Answer,i=o.IsMath}return{Text:"_Other"==r?n.Bw:r,Count:t.quizData.count,IsMath:i}})).sort((function(t,e){return e.Text==n.Bw?-1:e.Count-t.Count}))},e}(Hs),qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Ts),Qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Fs),Vs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.aggregateInternal=function(t,e){var n=e.FileUploadQuestionAggregation;n.ResponseCount=t.longTextData.count;var i=[];t.longTextData.recentValues.filter((function(t){return null!=t})).forEach((function(t){t&&JSON.parse(t).reverse().forEach((function(t){i.length<3&&i.push({Answer:t})}))})),n.RecentFile=i},e}(Ds),zs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Ls),Us=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.Vw=function(t,e){var n=Et.times(e,Et.constant(0));return t.forEach((function(t){t.rank>e?Object(g.c)("InvalidServerAggregatePayload","Fatal Error: RankingAggregationDelegatorBase.calculateRankerRenct ranker key shouldn't large than rankers count"):n[t.rank-1]=t.count})),n},n.getRankerStatistics=function(t){return this.Vw(t.rankingCount,this.choiceGroup.length)},n.getRankerWeight=function(t){var e=this.choiceGroup.length;return t.rankingCount.map((function(t){return t.count*(e-t.rank)})).reduce((function(t,e){return t+e}),0)},e}(Rs),$s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e}(Bs),Ws=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.aggregateInternal=function(t,e){var n=e.TextQuestionAggregation;n.ResponseCount=t.textData.count,n.TopAnswers=t.textData.recentValues.filter((function(t){return null!=t})).map((function(t){return{Id:void 0,Answer:t,IsMath:void 0}}))},e}(Hs);!function(t){t.Survey="Survey",t.Quiz="Quiz"}(Cs||(Cs={}));var Ks=n(226),Js=function(){function t(){}t.prototype;return Object.defineProperty(t,"fieldPrefix",{get:function(){return"field_"},enumerable:!1,configurable:!0}),t.createAnalyzeViewData=function(e){return new Promise((function(n,i){Et.defer((function(){var i=e.FormElementManager.TopQuestionMasters.map((function(e,n){return{Index:n,Field:t.createIQuestionInfoField(e.Model),Model:e.Model,Master:e}})),r=Et.map(e.Model.Responses,(function(n,i){var r=t.getResponseWithIndexableQuestion(n,e);return r.field_created_time=n.StartDate.toString(),r.field_modified_time=n.SubmitDate.toString(),r.field_responder=n.Responder,r.field_responder_name=n.ResponderName?n.ResponderName:n.Responder,r}));n({Questions:i,Answers:r,Analyses:t.analyzeReponse(i,r),Changed:!0})}))}))},t.createIQuestionInfoField=function(e){return t.fieldPrefix+e.Id.replace(/-/g,"")},t.getResponseWithIndexableQuestion=function(t,e){var n={};return Et.forEach(t.Answers,(function(t){var i=e.getQuestionById(t.QuestionId);if(i){var r="field_"+t.QuestionId.replace(/-/g,"");n[r]=t.Answer;var o=i.Model.Type;if(o===Gr.a.getElementTypeName()&&t.Answer){var s=Date.parseDate(t.Answer,Object(Pe.f)(),Object(u.a)().cultureInfo);n[r]=s.toDateShortString(Object(u.a)().cultureInfo)}else if(i.isNumberType())n[r]=Object(et.G)(t.Answer);else if((o===Lr.a.getElementTypeName()||o===_r.a.getElementTypeName())&&i.Model.IsMathQuiz){n[r+"_math"]=t.IsMathAnswer}}})),n.field_id=t.Id,n},t.analyzeReponse=function(e,n){var i=this,r={};return e.forEach((function(e){switch(e.Model.Type){case"Question.Choice":var o=new Object,s=new Object,a={correct:0,wrong:0};Et.forEach(e.Model.Choices,(function(t){o[t.Description]=0,s[t.Description]=t.IsMathOption}));var c=Et.filter(e.Model.Choices,(function(t){return t.IsAnswerKey})).map((function(t){return t.Description})).sort();n.map((function(t){return t[e.Field]})).map((function(t){var n=Object(_r.b)(t,e.Model);n.IsLegacyChoiceAnswer&&Object(g.b)("DesignPage.Responses.MeetLegacyChoiceAnswer"),n.SelectedOptions.forEach((function(t){o[t]=o[t]||0,++o[t]})),Et.isEqual(c,n.SelectedOptions.sort())?++a.correct:++a.wrong}));var u=[];for(var l in o)l&&u.push({Title:l,Data:o[l],IsMath:s[l]});r[e.Field]={options:i.calculateOthers(u),gradeResults:a};break;case"Question.Rating":var h,f=0,d=0;n.forEach((function(t){t[e.Field]&&(f++,d+=t[e.Field])})),h=0===f?0:Math.round(d/f*100)/100,r[e.Field]={count:f,averageRating:h};break;case"Question.TextField":if(e.Master.hasCorrectAnswers()){var b=new lr.a(e.Model),m=new Object,v={correct:0,wrong:0};Et.forEach(b.getAnswers(),(function(t){m[t.answer]=0}));var O=[];n.forEach((function(n){if(t.hasValidAnswer(n,e)){var i=String(n[e.Field]);O.push(i)}})),O.map((function(t){m[t]=m[t]||0,m[t]++,b.isCorrect(t)?++v.correct:++v.wrong}));var p=[];for(var j in m)m.hasOwnProperty(j)&&j&&p.push({Title:j,Data:m[j],IsMath:!1});r[e.Field]={options:i.calculateOthers(p),gradeResults:v};break}var y,w,S,N=[],I=0,C=0;n.forEach((function(n){t.hasValidAnswer(n,e)&&(e.Model.IsNumber&&Et.isNumber(n[e.Field])&&(C++,I+=n[e.Field]),N.push(n[e.Field]))})),y=N.length,S=0===C?0:I/C,w=y<=3?N:N.slice(y-3),r[e.Field]={count:y,recentAnswers:w,averageResult:Math.round(100*S)/100};break;case"Question.DateTime":var k,T,x=[];n.forEach((function(t){t[e.Field]&&x.push(t[e.Field])})),T=(k=x.length)<=3?x:x.slice(k-3),r[e.Field]={count:k,recentAnswers:T};break;case"Question.Ranking":var F,P=e.Master.Model.ChoiceGroup,D={},M=P.length,L=[],A={correct:0,wrong:0},R=e.Model.GradingBasis;e.Model.IsQuiz?(F=JSON.parse(R),Et.forEach(P,(function(t,e){var i=t.Id;L.push(i),D[i]={description:t.Description,total:n.length,data:Et.map(Array.apply(null,Array(M)),Number.prototype.valueOf,0),score:0},F[F.indexOf(t.Key)]=i}))):Et.forEach(P,(function(t){var e=t.Id;L.push(e),D[e]={description:t.Description,total:n.length,data:Et.map(Array.apply(null,Array(M)),Number.prototype.valueOf,0),score:0}})),n.map((function(t){var n=t[e.Field];if(n&&n.length>0){var i=n.sort((function(t,e){return t.answerOrder-e.answerOrder})).map((function(t){return t.id}));Et.isEqual(F,i)?++A.correct:++A.wrong,i.forEach((function(t,e){var n=D[t];n&&e<M&&(n.data[e]++,n.score+=M-e)}))}else++A.wrong}));var E=[];if(e.Model.IsQuiz)for(var B=0;B<F.length;B++)E.push({Title:D[F[B]].description,Data:D[F[B]].data,Score:D[F[B]].score,Total:D[F[B]].total});else for(var _ in D)E.push({Title:D[_].description,Data:D[_].data,Score:D[_].score,Total:D[_].total});r[e.Field]={rankResults:E,gradeResults:A};break;default:r[e.Field]=void 0}})),r},t.calculateOthers=function(t){var e=0;if((t=t.sort((function(t,e){return e.Data-t.Data}))).length>10){var n=t.length-10+1;t.splice(9).forEach((function(t){return e+=t.Data})),t.push({Title:Object(ae.a)().AnalyzeView_Chart_Others.format(n),Data:e,IsMath:!1})}return t},t.hasValidAnswer=function(t,e){var n=function(e){return null!=t[e]&&""!==t[e]&&t[e].toString().length},i=e.Master.SubQuestionMasters;if(i.length>0){var r=Et.map(i,(function(t){return"field_"+t.Model.Id}));return Et.filter(r,n).length>0}return n(e.Field)},t.getBranchedQuestions=function(e,n){var i=e.FormElementManager.QuestionMasters;if(i&&n&&i[0])return n.map((function(n){var i=t.getBranchedQuestionsV2(e,n);return{field_id:n.field_id,branchedQuestions:i.map((function(t){return t.Model}))}}))},t.getBranchedQuestionsV2=function(t,e){var n=t.FormElementManager.getSectionNodes(),i=[];return Ks.a.getBranchedSections(n,(function(t,n){var i=n.indexOf(t)+1,r=n[i];return t.getBranchedResult(e["field_"+t.Model.Id],r)})).forEach((function(t){t.TopQuestionMasters.forEach((function(t){i.push(t),t.SubQuestionMasters.forEach((function(t){i.push(t)}))}))})),i},t}(),Xs=n(161),Zs=n(160),Ys=n(205);function ta(t,e){return{Name:e,Type:t}}function ea(t){return Et.filter(t.Model.PermissionTokens,(function(t){return"AnalyzerToken"===t.Type&&t.Name===Object(Pe.a)()}))[0]}var na=n(119),ia=function(){function t(){}t.prototype;return t}(),ra=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.aggregate=function(t,e){var n,i=aa(e),r=null===(n=t)||void 0===n?void 0:n.quizSummaryData;i&&i.isAverageResultEnabled?e.AverageScore=null==r?void 0:r.averageScore:e.AverageSubmitTime=1e3*r.averageSubmitTimeSeconds,e.IsAggregationReady=!0},e}(ia),oa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.aggregate=function(t,e){var n,i=null===(n=t)||void 0===n?void 0:n.summaryData;e.AverageSubmitTime=1e3*(null==i?void 0:i.averageSubmitTimeSeconds),e.IsAggregationReady=!0},e}(ia),sa={AverageSubmitTime:Kt.a.number(),FormStatus:Kt.a.enumeration((function(){return na.a})),IsAggregationReady:Kt.a.boolean(),IsAggregationFailed:Kt.a.boolean(),TotalResponseCount:Kt.a.number(),BranchPoint:Kt.a.number(),AverageScore:Kt.a.number()};function aa(t){return Wt.a.getObjectMasterFromModel(t)}var ca=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.aggregate=function(t){var e=this;this.bulkEdit((function(){(function(t){if(t)return ia.formMaster=t,t.SettingMaster.Model.IsQuizMode?new ra:new oa})(e.FormMaster).aggregate(t,e.Model),e.Model.TotalResponseCount=e.FormMaster.Model.ResponsesCount,e.Model.FormStatus=e.FormMaster.SettingMaster.getFormStatus(),e.Model.IsAggregationReady=!0}))},Object.defineProperty(n,"isAverageResultEnabled",{get:function(){var t=0;return Et.forEach(this.FormMaster.Model.Questions,(function(e){e.IsQuiz&&e.Point&&(t+=e.Point)})),this.FormMaster.Model.QuizQuestionsCount>0&&t},enumerable:!1,configurable:!0}),Object.defineProperty(n,"FormMaster",{get:function(){return this.Parent.FormMaster},enumerable:!1,configurable:!0}),e}(Wt.a.createObjectMasterClass("FormSummaryAggregation",sa));var ua={SummaryAggregation:Kt.a.fromMasterClass((function(){return ca})),QuestionAggregations:Kt.a.collectionOf((function(){return ks}))};function la(t){return{SummaryAggregation:{AverageSubmitTime:0,FormStatus:t.SettingMaster.getFormStatus(),IsAggregationReady:!1,TotalResponseCount:t.Model.ResponsesCount},QuestionAggregations:Et.map(t.Model.Questions,(function(t){return{IsAggregationReady:!1,QuestionId:t.Id,IsMathQuestion:t.IsMathQuiz}}))}}var ha=function(t){function e(e){var n=t.call(this,{InitialData:la(e)})||this;return n.zw=[],n.Uw=new tt.a("Perf.ResponseTab"),n.$w=function(){return n.Ww()},n.Kw=function(t){n.bulkEdit((function(){var e,i=[];Wt.a.convertToArray(t.RemovedModels).forEach((function(t){var e=Wt.a.Collection.getItemWithKeyFields(n.Model.QuestionAggregations,{QuestionId:t.Id});i.push(e)})),Wt.a.Collection.deleteItems(n.Model.QuestionAggregations,i);var r=Wt.a.convertToArray(t.AddedModels).map((function(t){return t.Id}));e=Wt.a.convertToArray(la(n.FormMaster).QuestionAggregations).filter((function(t){return r.some((function(e){return e===t.QuestionId}))})),Wt.a.Collection.addItems(n.Model.QuestionAggregations,e)})),n.FormMaster.Model.Settings.IsQuizMode&&t.RemovedModels.length?n.Ww():(t.RemovedModels.length||t.AddedModels.length)&&n.Jw()},n.Xw=function(){return n.Jw()},n.Zw=function(){return n.Ww()},n.Uw.start(),n.Yw=new Pt,n.O=e,n.tS().then((function(t){Object(Oo.f)(t)||n.eS(t)})),n.zw.length>0&&(n.zw=[]),n.nS(),n}Object(S.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"FormMaster",{get:function(){return this.O},enumerable:!1,configurable:!0}),n.terminateSync=function(){this.zw=[]},n.release=function(){var t=this;this.FormMaster&&(this.FormMaster.unobserve(this.$w),Wt.a.getCollectionMasterFromModel(this.FormMaster.Model.Questions).unobserve(this.Kw),Et.forEach(this.FormMaster.Model.Questions,(function(e){var n=t.FormMaster.getQuestionById(e.Id);n.unobserve(t.Zw),n.unobserve(t.Xw)})))},n.iS=function(t){this.Yw.stop(),this.Uw.ExtraData={visiToggleTime:this.Yw.visiToggleTime?this.Yw.visiToggleTime.getTime():0},this.Uw.end({resultType:t})},n.tS=function(){var t=this;return Object(g.b)(this.FormMaster.SyncContext===ro.a.AnalysisTimeForm?"AnalysisPage.Responses.StartGetResponses":"DesignPage.Responses.StartGetResponses",{RegionNumber:this.FormMaster.Model.ResponsesCount/1e3+1}),ln(Object(rt.b)()),this.FormMaster.existingOnServerSide().then((function(){return t.serverAggregateAPI(t.FormMaster.Model.Id)})).then((function(e){return t.rS=e,t.oS(),e})).catch((function(e){return t.iS("Failure"),ln(null),Object(g.c)("ResposnesAggregateFailure",{Message:"FormAggregationMaster.getAggregateData: get aggregate data failed: "+e}),Object(Oo.f)(e)?e:(Object(Hn.d)("Aggregate",e,t.FormMaster.Model.Id),t.sS(),null)}))},Object.defineProperty(n,"serverAggregateAPI",{get:function(){return this.FormMaster.SyncContext==ro.a.AnalysisTimeForm?this.FormMaster.Model.Settings.IsQuizMode?Me.k:Me.l:this.FormMaster.Model.Settings.IsQuizMode?Me.b:Me.c},enumerable:!1,configurable:!0}),n.sS=function(){aa(this.Model.SummaryAggregation).Model.IsAggregationFailed=!0,Et.each(this.Model.QuestionAggregations,(function(t){t.IsAggregationFailed=!0}))},n.oS=function(){aa(this.Model.SummaryAggregation).Model.IsAggregationFailed=!1,Et.each(this.Model.QuestionAggregations,(function(t){t.IsAggregationFailed=!1}))},n.eS=function(t){var e=this,n=Et.find(t,(function(t){return"quizSummaryData"===t.aggregationDataType||"summaryData"===t.aggregationDataType})),i=aa(this.Model.SummaryAggregation);i.Model.IsAggregationFailed||i.aggregate(n),Et.each(this.Model.QuestionAggregations,(function(i){var r=e.FormMaster.getQuestionById(i.QuestionId);if(!i.IsAggregationFailed){if(!r.Model.GroupId){var o=void 0;if(o="Question.MatrixChoiceGroup"===r.Model.Type?e.aS(r,t):Et.find(t,(function(t){return t.columnPropertyName===i.QuestionId})),"Question.TextField"==r.Model.Type&&r.Model.IsMathQuiz){o=e.cS(r,o);var s=n,a=o;a&&(a.quizSummaryData.averageScore/=s.quizSummaryData.count,s.quizSummaryData.averageScore+=a.quizSummaryData.averageScore,e.Model.SummaryAggregation.AverageScore=s.quizSummaryData.averageScore)}Is(i).aggregate(o)}i.IsAggregationReady=!0}})),this.iS("Success");var r=hn();if(r){var o=this.FormMaster.SyncContext===ro.a.AnalysisTimeForm?"Share":"Survey";Object(g.f)("Endpoint."+o+"AnalysisPage",{timeToSpin:window.performance.timing.domInteractive-window.performance.timing.navigationStart,timeToChrome:an,timeToContentReady:Object(rt.b)()-r,RegionNumber:this.FormMaster.Model.ResponsesCount/1e3+1}),ln(null)}},n.aS=function(t,e){var n=t.SubQuestionMasters.map((function(t){return t.Model.Id})),i=e.filter((function(t){return-1!==n.indexOf(t.columnPropertyName)}));if(i.length)return i[0].likertChoiceData=[],i.reduce((function(t,e){var n={subQuesionId:e.columnPropertyName,subQuestionData:e.choiceData};return t.likertChoiceData.push(n),t}),i[0])},n.cS=function(t,e){var n=new lr.a(t.Model).getAnswers(),i=e;if(i&&i.quizTextData&&n.length>0&&!t.Model.Multiline){var r=[];i.quizTextData.forEach((function(t){if(t.quizData&&t.quizData.id){var e=Object(et.G)(t.quizData.id),n=null==e.Answer?t.quizData.id:e.Answer;if(r.length>0){var i=Et.find(r,(function(t){if(t.quizData&&t.quizData.id){var e=Object(et.G)(t.quizData.id),i=null==e.Answer?t.quizData.id:e.Answer;if(n.trim().toUpperCase()===i.trim().toUpperCase())return t}}));null!=i?i.quizData.count+=t.quizData.count:r.push(t)}else r.push(t)}})),i.correctCount=0,i.quizSummaryData.averageScore=0;var o=r.filter((function(e){if(e.quizData&&e.quizData.id){var r=Object(et.G)(e.quizData.id),o=null==r.Answer?e.quizData.id:r.Answer;return""===o?(i.totalCount-=e.quizData.count,!1):(null!=Et.find(n,(function(t){return t.answer.trim().toUpperCase()===o.trim().toUpperCase()}))&&(i.correctCount+=e.quizData.count,i.quizSummaryData.averageScore+=e.quizData.count*t.Model.Point),!0)}}));i.quizTextData=o}return i},n.Jw=function(){var t=this;null!=this.rS&&(this.bulkEdit((function(){t.Model=la(t.O)})),this.eS(this.rS))},n.Ww=function(){var t=this;this.FormMaster.SyncContext!=ro.a.AnalysisTimeForm&&(this.zw.length>0||this.zw.push(this.uS().then((function(){return t.zw.pop()}))))},n.uS=function(){var t=this;return new Promise((function(n){window.setTimeout((function(){t.bulkEdit((function(){t.Model=la(t.O)})),t.tS().then((function(e){return t.eS(e)})),n()}),e.freezingTime)}))},n.nS=function(){var t=this;Object(Y.c)("RemoveRedundantAggregateAPI")?this.FormMaster.observe(this.$w,[this.FormMaster.Schema.ResponsesCount]):this.FormMaster.observe(this.$w,[this.FormMaster.Schema.ResponsesCount,this.FormMaster.Schema.Responses]),Wt.a.getCollectionMasterFromModel(this.FormMaster.Model.Questions).observe(this.Kw);var e=Object(_t.i)();Et.forEach(this.FormMaster.Model.Questions,(function(n){var i=t.FormMaster.getQuestionById(n.Id);switch(i.observe(t.Xw,[e.Schema.Title]),i.Model.Type){case"Question.Choice":i.observe(t.FormMaster.Model.Settings.IsQuizMode?t.Zw:t.Xw,[e.Schema.Choices,e.Schema.AllowOtherAnswer,e.Schema.ChoiceType]);break;case"Question.Ranking":i.observe(t.Zw,[e.Schema.ChoiceGroup])}}))},e.freezingTime=2e3,e}(Wt.a.createObjectMasterClass("FormAggregation",ua));var fa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lS=function(){return e.forceUpdate()},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){Object(Ei.c)().observe(this.lS,[Ei.b.Schema.ExportToExcelCalloutVersion])},n.componentWillUnmount=function(){Object(Ei.c)().unobserve(this.lS)},n.render=function(){var t=Object(Ei.c)().Model;if(Object(Ei.d)(t.ExportToExcelCalloutVersion)){var e=Object(_i.g)(Object(ae.a)().TeachingUI_Export_To_Excel),n=Object(_i.f)(Object(On.b)("/Images/export-to-excel.gif")),i=Object(_i.e)((function(){return t.ExportToExcelCalloutVersion=Ei.a.toString()}));return Object(_i.d)(e,n,i,"teachingCallout-exportToExcel","teachingCallout-exportToExcel-direction")}return null},e}(ue.a);var da=function(){function t(t,e){if(this.hS="DownloadExcel",this.fS="DownloadFileSize",this.dS=1500,this.bS=5e3,this.form=t,this.mS=[],this.vS=!1,this.gS()){var n=parseInt(Object(d.d)()[this.fS]);this.bS=n}else if(this.form.isFieldReady(this.form.Schema.Id)){var i=parseInt(Object(O.c)().getItem(this.hS+"-"+this.form.Model.Id));i&&(this.bS=i)}e&&(this.OS=e)}var e=t.prototype;return Object.defineProperty(e,"TotalFileCount",{get:function(){return this.pS},enumerable:!1,configurable:!0}),e.start=function(){this.jS()?this.yS({innerCode:10204,failureType:"ExpectedFailure"}):this.vS||(Object(g.b)("DesignPage.Responses.DownloadExcelFileStart",{totalResponseCountRange:Math.ceil(this.form.Model.ResponsesCount/this.bS),isQuiz:this.form.SettingMaster.Model.IsQuizMode,isIos:this.jS()}),this.vS=!0,this.Cn=(new Date).getTime(),this.wS())},e.logDownloadStatus=function(t,e){Object(g.b)(t,{ErrorCode:e,fileCount:Math.ceil(this.form.Model.ResponsesCount/this.bS),timeCost:(new Date).getTime()-this.Cn,isQuiz:this.form.SettingMaster.Model.IsQuizMode})},e.stop=function(){this.vS=!1,this.mS=[],this.SS&&this.SS()},e.downloadAllResponses=function(){this.NS(),this.start()},e.observeEveryDownloadComplete=function(t){this.IS=t},e.observeStop=function(t){this.SS=t},e.shouldForceToDownloadExcel=function(){return this.gS()},e.NS=function(){var t=this.form.Model.ResponsesCount;this.pS=Math.ceil(t/this.bS),this.finishedDownloadFileCount=0,this.mS=[];for(var e=1;e<=t;e+=this.bS)this.mS.push({minResponseId:e,maxResponseId:Math.min(e+this.bS-1,t)})},e.gS=function(){var t=parseInt(Object(d.d)()[this.fS]);return!isNaN(t)&&t>0},e.wS=function(){var t=this;if(this.vS)if(this.pS>this.mS.length&&this.IS&&(this.finishedDownloadFileCount=this.pS-this.mS.length,this.IS()),this.mS.length>0){var e=this.mS.shift();window.setTimeout((function(){return t.CS(e.minResponseId,e.maxResponseId)}))}else this.logDownloadStatus("DesignPage.Responses.DownloadExcelFileSuccess",10220),this.stop()},e.kS=function(t){!this.gS()&&t>=1e3&&this.form.isFieldReady(this.form.Schema.Id)&&(this.bS=100*Math.ceil(t/200),Object(O.c)().setItem(this.hS+"-"+this.form.Model.Id,this.bS.toString()))},e.CS=function(e,n){var i=this;Object(g.b)("DesignPage.Responses.DownloadOnePagingExcelFile"),Object(Hn.a)("DownloadExcelFile"),window.clearTimeout(t.hideErrorBarMessageTimeout),t.hideErrorBarMessageTimeout=null,this.form.downloadExcelFile(e,n).then((function(){Object(Hn.a)("DownloadExcelFile"),i.wS()})).catch((function(t){switch(i.stop(),i.logDownloadStatus("DesignPage.Responses.DownloadExcelFileFailed",t.innerCode),t.innerCode){case 10206:i.bS=i.dS,i.yS(t);break;case 10208:i.OS?i.OS(2):i.TS("DownloadExcelLimitReached");break;case 10209:if(i.OS){i.OS(3),window.setTimeout((function(){i.OS(0)}),5e3)}else{var r=Object(Tt.c)("DownloadExcelThrottleMessageBarDelayTime",3e3);window.setTimeout((function(){i.TS("DownloadExcelVMLimitReached")}),r)}break;case 10210:i.kS(n-e+1),t.innerCode=10203,i.yS(t);break;default:i.yS(t)}}))},e.yS=function(e){Object(Hn.d)("DownloadExcelFile",e&&{statusCode:parseInt(e.statusCode),statusText:e.statusText,type:e.failureType,innerCode:e.innerCode,innerMessage:e.innerMessage,correlationId:e.correlationId,isServerError:!0}),t.hideErrorBarMessageTimeout=window.setTimeout((function(){Object(Hn.a)("DownloadExcelFile"),t.hideErrorBarMessageTimeout=null}),1e4)},e.TS=function(e){Object(Hn.e)(e),t.hideErrorBarMessageTimeout=window.setTimeout((function(){Object(Hn.c)(),t.hideErrorBarMessageTimeout=null}),5e3)},e.jS=function(){var t=window.navigator.platform.toLocaleLowerCase(),e=window.navigator.userAgent.toLocaleLowerCase();return t.match(/iphone|ipod|ipad/)||e.match(/iphone|ipod|ipad/)},t}(),ba=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.Ac=Object(_t.b)(),e.xS=function(){e.state.IsPreparingFile&&e.forceUpdate()},e.FS=function(){e.props.Form.ensureFieldsReady([Zt.a.Schema.XlExportingLocalTag]).then((function(){var t=!1;e.props.Form.IsExporting()?t=!0:e.props.Form.IsExportingFailed()&&e.state.IsPreparingFile&&Object(Hn.d)("ReexportToExcelFile",{innerCode:10205}),e.setState({IsPreparingFile:t})}))},e.PS=function(){return e.setState({IsPreparingFile:!1})},e.DS=function(){return e.forceUpdate()},e.MS=function(){return e.LS()},e.AS=function(){return e.RS()},e.ES=function(){return e.BS()},e._S=function(t){return e.HS(t)},e}Object(S.__extends)(e,t);var n=e.prototype;return n.showExcelThrottleDialog=function(t){this.props.showExcelThrottleDialog(t)},n.componentDidMount=function(){var t=this;this.GS=this.GS.bind(this),this.props.Form.ensureFieldsReady([Zt.a.Schema.Id]).then((function(){t.DownloadExcelProcessor.observeEveryDownloadComplete(t.xS),t.DownloadExcelProcessor.observeStop(t.PS)}));var e=Zt.a.Schema;this.props.Form.observe(this.FS,[e.XlExportingLocalTag]),this.props.Form.observe(this.DS,[e.XlFileUnsynced]),this.Ac.observe(this.GS,[this.Ac.Schema.ExecuteDownloadExcel])},n.componentWillUnmount=function(){this.props.Form.unobserve(this.FS),this.Ac.unobserve(this.GS),Object(Hn.a)("ReexportToExcelFile")},n.render=function(){return oe.createElement("div",null,this.qS(),this.QS(),this.VS(),this.zS())},n.qS=function(){var e,n,i,r=this;if(this.state.IsPreparingFile)return null;var o=t.prototype.shouldExportExcelToOneDrive.call(this);this.props.Form.Model.XlFileUnsynced&&o?(e=oe.createElement("span",{key:"alert",className:"export-to-excel-button-alert"}),n=this.MS,i=Object(ae.a)().AnalyzeView_Export_Excel_File_Unsynced_Alert):(n=function(){return r.US(r.AS)},i=Object(ae.a)().AnalyzeView_Export_Excel);var s={title:i,className:"analyze-view-export-button-container",onClick:n,disabled:!this.props.Form.isFieldReady(Zt.a.Schema.Id)||this.props.Form.Model.ResponsesCount<=0&&!o};return Object(yn.a)({HTMLAttributes:s,Icon:o?"exportOnedriveIcon":"ExcelLogo",IconClassName:"forms-icon-size24x24",Text:Object(ae.a)().AnalyzeView_Export_Excel,TextClassName:"analyze-view-export-button-label",ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",children:e})},n.US=function(t){var e=Object(Tt.c)("DownloadExcelThrottleLevel",0);this.shouldExportExcelToOneDrive()||1!==e?t():this.showExcelThrottleDialog(1)},n.VS=function(){return!this.state.IsPreparingFile&&this.shouldExportExcelToOneDrive()?(t={},oe.createElement(fa,Object(S.__assign)({},t))):null;var t},n.zS=function(){return this.state.IsPreparingFile?(e=t.prototype.shouldExportExcelToOneDrive.call(this)?Object(ae.a)().ReExportToExcel_Loading_Message:this.DownloadExcelProcessor.TotalFileCount>1?Object(ae.a)().DownloadExcel_Preparing_For_Multiple_File.format(this.DownloadExcelProcessor.finishedDownloadFileCount,this.DownloadExcelProcessor.TotalFileCount):Object(ae.a)().DownloadExcel_Preparing_For_Single_File,oe.createElement("div",{role:"alert"},this.$S(),oe.createElement("span",{className:"download-excel-progress-description"},e))):null;var e},n.$S=function(){return oe.createElement($o.a,Object(S.__assign)({},{ClassName:"download-excel-loading-container"}))},n.QS=function(){if(this.state.ShowAlertCallout){var t=Object(ae.a)();return oe.createElement("div",{className:"export-button-alert-callout",onBlur:this._S,ref:"alert-callout",tabIndex:-1},oe.createElement("div",{className:"unsynced-message"},t.AnalyzeView_Export_Excel_File_Unsynced_Alert),oe.createElement("button",{className:"analyze-view-link-button reexport-link",onClick:this.ES,ref:"alert-link"},oe.createElement("span",null,t.AnalyzeView_Export_Excel_File_Reexport)))}},n.LS=function(){Object(_t.b)().Model.ShowXLUnsyncedDialog=!0},n.GS=function(){this.Ac.Model.ExecuteDownloadExcel&&(this.RS(),this.Ac.Model.ExecuteDownloadExcel=!1)},n.RS=function(){this.shouldExportExcelToOneDrive()||this.setState({IsPreparingFile:!0}),t.prototype.onExportExcel.call(this)},n.HS=function(t){var e=Object(pn.d)(t),n=Ln.findDOMNode(this.refs["alert-callout"]);n&&!n.contains(e)&&this.setState({ShowAlertCallout:!1})},n.BS=function(){Object(pi.b)(this.props.Form.Model.Id),this.setState({ShowAlertCallout:!1,IsPreparingFile:!0})},e}(function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"DownloadExcelProcessor",{get:function(){return this.WS=this.WS||(t=this.props.Form,e=this.props.showExcelThrottleDialog,new da(t,e));var t,e},enumerable:!1,configurable:!0}),n.shouldExportExcelToOneDrive=function(){return!(Object(st.j)()&&!Object(Ht.a)().Flighting.isEnabled("EnableOnlineExcelForMSA"))&&(!this.props.Form.Model.Settings.IsQuizMode&&(!this.DownloadExcelProcessor.shouldForceToDownloadExcel()&&(Object(je.c)()||!!this.props.Form.Model.XlWorkbookId)))},n.onExportExcel=function(){Object(g.b)("DesignPage.Responses.OpenInExcel",{xlworkbookid:this.props.Form.Model.XlWorkbookId}),this.shouldExportExcelToOneDrive()?(this.KS(),Object(Ei.c)().Model.ExportToExcelCalloutVersion=_i.a.toString()):(Object(g.b)("DesignPage.Responses.DownloadMultipleExcelFiles"),this.DownloadExcelProcessor.downloadAllResponses())},n.KS=function(){var t=this;Object(g.b)("DesignPage.Responses.OpenExcelInOneDrive"),this.props.Form.ensureFieldsReady([Zt.a.Schema.Id]).then((function(){Object(pi.a)(t.props.Form.Model.Id)}))},e}(ue.a));var ma=function(t){function e(e){var n=t.call(this,e)||this;return n.JS=Object(_t.b)().Model,n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){switch(this.props.throttleDialogType){case 1:return this.XS();case 2:return this.ZS();case 3:return oe.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-message-container"},(t=Object(ae.a)().XLThrottleDialog_VMReachedLimitation_Message,e=Object(Un.b)({HTMLAttributes:{className:"openinexcel-throttle-vmlimitation-alart-icon forms-icon-size16x16"},IconName:"Warning"}),oe.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-title-container",role:"alert"},e,oe.createElement("span",{className:"openinexcel-throttle-reachvmlimitation-title"},t))),oe.createElement("div",{className:"openinexcel-throttle-reachvmlimitation-linebreak"}));default:return null}var t,e},n.XS=function(){return 1===Object(Tt.c)("DownloadExcelThrottleLevel",0)?oe.createElement("div",{className:"openinexcel-throttle-predialog-container"},this.YS()):null},n.ZS=function(){return oe.createElement("div",{className:"openinexcel-throttle-predialog-container"},this.tN())},n.YS=function(){var t=this,e={ButtonsProps:[{ClassName:"openinexcel-throttle-continue-button",GlyphButtonStyle:"Horizontal",Key:"continueItem",onClick:function(){t.props.showExcelThrottleDialog(0),t.JS.ExecuteDownloadExcel=!0},Text:Object(ae.a)().Common_Yes_Text,Title:Object(ae.a)().Common_Yes_Text},{ClassName:"openinexcel-throttle-cancel-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){t.props.showExcelThrottleDialog(0)},Text:Object(ae.a)().XLThrottleDialog_StrictMode_CancelButton,Title:Object(ae.a)().Designer_Cancel_Text}],ClassName:"openinexcel-throttle-button-container",Description:Object(ae.a)().XLThrottleDialog_StrictMode_Content,key:"deleteConfirmDialog",ShowDialog:!0};return oe.createElement("div",{className:"openinexcel-throttle-dialog-container"},va(!0),this.eN(),Object(ce.b)(e))},n.tN=function(){var t=this,e={ButtonsProps:[{ClassName:"openinexcel-throttle-gotit-button",GlyphButtonStyle:"Horizontal",Key:"gotItItem",onClick:function(){t.props.showExcelThrottleDialog(0)},Text:Object(ae.a)().TeachingUi_GotIt,Title:Object(ae.a)().TeachingUi_GotIt}],ClassName:"openinexcel-throttle-button-container",Description:Object(ae.a)().XLThrottleDialog_OwnerReachedLimitation_Content,key:"deleteConfirmDialog",ShowDialog:!0};return oe.createElement("div",{className:"openinexcel-throttle-dialog-container"},va(!1),this.nN(),Object(ce.b)(e))},n.eN=function(){var t=this;return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"openinexcel-throttle-dialog-close-button",onClick:function(){t.props.showExcelThrottleDialog(0)}},Icon:"Cancel",IconClassName:"openinexcel-throttle-dialog-close-icon forms-icon-size16x16",Text:Object(ae.a)().Common_Close_Text})},n.nN=function(){var t=this;return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"openinexcel-throttle-dialog-close-button",onClick:function(){t.props.showExcelThrottleDialog(0)},title:Object(ae.a)().Common_Close_Text},Icon:"Cancel",IconClassName:"openinexcel-throttle-dialog-close-icon forms-icon-size16x16"})},e}(ue.a);function va(t){var e=Object(ae.a)().XLThrottleDialog_OwnerReachedLimitation_Title,n="openinexcel-throttle-reachlimitation-title";t&&(e=Object(ae.a)().XLThrottleDialog_StrictMode_Title,n="openinexcel-throttle-strictmodeconfirm-title");var i=Object(Un.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size20x20"},IconName:"Warning"});return oe.createElement("div",{className:"openinexcel-throttle-reachlimitation-title-container",role:"alert"},t?null:i,oe.createElement("span",{className:n},e))}var ga=n(48),Oa=n(130);function pa(t,e){return Et.isEqual(t.labelName,e.labelName)&&Et.isEqual(t.lableClass,e.lableClass)&&Et.isEqual(t.labelData,e.labelData)}var ja=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iN=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],e.rN=[],e}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return this.oN()?oe.createElement("div",{"aria-label":Object(ae.a)().ChartControl_GroupContainer,className:"chart-control-container"},this.sN(),this.aN()):null},n.componentDidMount=function(){this.cN()},n.shouldComponentUpdate=function(t){return!function(t,e){if(!(Et.isEqual(t.Animation,e.Animation)&&Et.isEqual(t.Data,e.Data)&&Et.isEqual(t.HasLegend,e.HasLegend)&&Et.isEqual(t.TagLabels,e.TagLabels)&&Et.isEqual(t.Type,e.Type)))return!1;if(!t.Labels&&!e.Labels)return!0;if(t.Labels&&e.Labels&&t.Labels.length===e.Labels.length){for(var n=0;n<t.Labels.length;n++)if(!pa(t.Labels[n],e.Labels[n]))return!1;return!0}return!1}(this.props,t)||!this.uN},n.componentDidUpdate=function(){this.cN()},n.componentWillUnmount=function(){this.lN()},n.oN=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.data.length&&this.props.Labels.length>0},n.lN=function(){this.hN&&(this.hN.destroy(),this.hN=null)},n.cN=function(){if(this.oN()){var t=Ln.findDOMNode(this.refs.canvas);if(this.uN=$(t).is(":visible"),this.uN){var e=t.getContext("2d");switch(this.fN(),this.props.Type){case 0:this.dN(e),this.bN();break;case 1:this.mN(e),this.bN()}}}},n.vN=function(){if(this.props.Labels)return this.props.Labels.map((function(t,e){return null!=t.labelName?Object(Oa.b)(t.labelName):Object(ae.a)().Designer_Choices_DefaultDescription.format(e+1)}))},n.dN=function(t){var e="'wf_segoe-ui_light', 'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",n={responsive:!1,layout:{padding:{left:10}},animation:{duration:1e3},scales:{yAxes:[{ticks:{fontSize:10,min:0,fontFamily:e,fontColor:"#000000",callback:function(t){if(t%1==0)return t}}}],xAxes:[{ticks:{fontSize:10,fontFamily:e,fontColor:"#000000",callback:function(){return""}}}]},legend:{display:!1}};this.lN(),this.hN=new Chart(t,{type:"bar",data:this.gN(),options:n})},n.fN=function(){var t=this;this.ON=this.props.Data.data.map((function(e,n){var i=t.iN[n%t.iN.length];return t.rN.push(t.pN(i,10)),i}))},n.gN=function(){return{labels:this.vN(),datasets:[{backgroundColor:this.ON,data:this.props.Data.data,hoverBackgroundColor:this.rN}]}},n.mN=function(t){var e={responsive:!1,animation:{duration:1e3},cutoutPercentage:0,tooltips:{callbacks:{label:function(t,e){return e.labels[t.index]+": "+e.datasets[t.datasetIndex].data[t.index]+" ("+Math.round(this._active[0]._view.circumference/6.283*100)+"%)"}}},legend:{display:!1}};this.lN(),this.hN=new Chart(t,{type:"pie",data:this.gN(),options:e})},n.pN=function(t,e){var n=parseInt(t.slice(1),16),i=Math.round(2.55*e),r=(n>>16)+i,o=(n>>8&255)+i,s=(255&n)+i;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)},n.bN=function(){var t=this;if(this.props.HasLegend){var e=Ln.findDOMNode(this.refs["legend-table"]),n=Ln.findDOMNode(this.refs["legend-table-tbody"]).childNodes;n&&n.length>0&&(Et.each(n,(function(e,n){Chart.helpers.addEvent(e,"mouseover",(function(){t.jN("mouseover",n)}));var i=e.getElementsByClassName("chart-control-legend-canvas-color");if(i){var r=i[0].getContext("2d");r.fillStyle=t.hN.data.datasets[0].backgroundColor[n],r.beginPath(),r.arc(7.5,7.5,7.5,0,2*Math.PI,!0),r.closePath(),r.fill()}})),Chart.helpers.addEvent(e,"mouseout",(function(){t.jN("mouseout",0)})))}},n.jN=function(t,e){this.hN.active="mouseout"===t?[]:[this.hN.getDatasetMeta(0).data[e]],this.hN.lastActive=this.hN.lastActive||[],this.hN.lastActive.length&&this.hN.updateHoverStyle(this.hN.lastActive,this.hN.options.hover.mode,!1),this.hN.active.length&&this.hN.updateHoverStyle(this.hN.active,this.hN.options.hover.mode,!0);var n=!Chart.helpers.arrayEquals(this.hN.active,this.hN.lastActive);if(n){this.hN.lastActive=this.hN.active;var i=this.hN.tooltip;i._active=this.hN.active,i._lastActive=i._lastActive||[],i.update(!0),i.pivot();var r=this.hN._bufferedRequest;r?this.hN.render(r.duration,r.lazy):n&&!this.hN.animating&&(this.hN.stop(),this.hN.render(this.hN.options.hover.animationDuration,!0)),this.hN._bufferedRender=!1,this.hN._bufferedRequest=null}},n.sN=function(){var t=this;if(this.props.HasLegend)return oe.createElement("div",{"aria-label":Object(ae.a)().ChartControl_LegendGroup,className:"chart-control-legend",tabIndex:-1},oe.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},oe.createElement("tbody",{ref:"legend-table-tbody"},this.props.Labels.map((function(e,n){return oe.createElement("tr",{className:"chart-control-legend-table-row "+e.lableClass,key:n},oe.createElement("td",{role:"presentation"},oe.createElement("canvas",{role:"presentation",className:"chart-control-legend-canvas-color",width:"15px",height:"15px"})),oe.createElement("td",{role:"presentation",className:"chart-control-legend-label"},null!=e.displayElement?e.displayElement:oe.createElement(ga.a,{Text:e.labelName,RenderMode:"RichText"})),oe.createElement("td",{role:"presentation",className:"chart-control-legend-value",onClick:e.onClick},e.labelData),t.yN(e.labelName))})))))},n.aN=function(){var t,e={className:"chart-control",tabIndex:-1,"aria-label":Object(ae.a)().ChartControl_ChartGroup},n=Object(pn.e)()<400||Object(et.r)(),i=n?187:250,r=n?300:400;return t=0===this.props.Type?{role:"presentation",className:"chart-control-canvas",width:r,height:i,ref:"canvas"}:{role:"presentation",className:"",width:300,height:150,ref:"canvas"},oe.createElement("div",Object(S.__assign)({},e),oe.createElement("canvas",Object(S.__assign)({},t)))},n.yN=function(t){var e,n={role:"presentation",className:"chart-control-legend-table-correct",title:this.props.TagLabels[t]?Object(ae.a)().Quiz_CorrectAnswer:void 0};return this.props.TagLabels[t]&&(e=oe.createElement(Un.a,{IconName:"CheckMark",HTMLAttributes:{className:"forms-icon-size14x14"}})),oe.createElement("td",Object(S.__assign)({},n),e)},e}(ue.a);function ya(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,1127))];case 1:return[2,{default:t.sent().InsightsPinedView}]}}))}))}function wa(t){var e=Object(Pi.a)(wa,ya);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}function Sa(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,1128))];case 1:return[2,{default:t.sent().InsightsExploreView}]}}))}))}function Na(t){var e=Object(Pi.a)(Na,Sa);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}function Ia(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(4).then(n.bind(null,1129))];case 1:return[2,{default:t.sent().SurveyAnalyzeViewSummaryInsightPanel}]}}))}))}function Ca(t){var e=Object(Pi.a)(Ca,Ia);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}var ka=function(t){function e(e){var n=t.call(this,e)||this;return n.cn=n.cn.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=!(this.props.FormInsightMaster.FormMaster.SyncContext===ro.a.AnalysisTimeForm),e=this.props.Index+1;if(t&&this.props.FormInsightMaster.Model.IsReady&&this.wN()&&!Object(v.u)()){var n={"aria-label":"View insights for question "+e,className:this.props.Clicked?"analyze-view-detail-show-insight-button clicked optional-button":"analyze-view-detail-show-insight-button optional-button",onClick:this.cn};return Object(yn.a)({HTMLAttributes:n,Icon:"Lightbulb",IconClassName:"forms-icon-size14x14 analyze-view-insight-button-icon",Text:"Insights",TextClassName:"analyze-view-insight-button-label",ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal"})}return null},n.cn=function(){this.props.FormInsightMaster.logEngage("Explore"),this.props.openInsightExploreView()},n.wN=function(){var t=this.props.QuestionMaster;return this.props.FormInsightMaster.Insights.filter((function(e){return e.CalculationQuestion.Id===t.Model.Id&&e.IsStatisticSignificant})).length>0},e}(ue.a),Ta=n(200),xa=n(128),Fa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SN=oe.createRef(),e.NN=oe.createRef(),e.IN=oe.createRef(),e.CN=oe.createRef(),e.kN=function(){e.ce&&e.forceUpdate()},e.state={PagingIndex:0,QuestionIndex:-1,ShowErrorMessage:!1,ShowOpenFolderSpinner:!1},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.props.QuestionDetailMaster&&(this.props.QuestionDetailMaster.observe(this.kN,[Ta.a.Schema.Answers,Ta.a.Schema.IsPagingReady]),this.props.QuestionDetailMaster.syncData(0)),this.setState({QuestionIndex:this.props.Index})},n.componentDidMount=function(){this.ce=!0,this.SN.current&&this.SN.current.focus(),Object(yr.g)(Ln.findDOMNode(this)),this.TN(),this.xN()},n.componentDidUpdate=function(){this.TN(),this.xN()},n.componentWillUnmount=function(){this.props.QuestionDetailMaster&&this.props.QuestionDetailMaster.unobserve(this.kN),this.ce=!1},n.render=function(){var t=this;if(this.props.QuestionDetailMaster&&this.state.QuestionIndex>=0)return oe.createElement("div",{className:"response-dialog-container",onKeyDown:function(e){(8===e.keyCode||37===e.keyCode&&e.altKey)&&(e.stopPropagation(),e.preventDefault()),27===e.keyCode&&t.props.onClose&&t.props.onClose()}},this.FN(),this.PN(),this.DN())},n.FN=function(){var t=this,e=this.props.QuestionDetailMaster.Model.TopLevelQuestions.length;if(this.state.QuestionIndex>0&&this.state.QuestionIndex<e){var n={HTMLAttributes:{className:"response-dialog-previous-button",onClick:function(){Object(g.b)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"PreviouseQuestion"}),t.setState({QuestionIndex:t.state.QuestionIndex-1})}},Icon:"ChevronLeft",GlyphButtonStyle:"GlyphOnly",ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_DetailResponses_Previous_Button};return Object(yn.a)(n)}},n.DN=function(){var t=this,e=this.props.QuestionDetailMaster.Model.TopLevelQuestions.length;if(this.state.QuestionIndex>=0&&this.state.QuestionIndex<e-1){var n={HTMLAttributes:{className:"response-dialog-next-button",onClick:function(){Object(g.b)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"NextQuestion"}),t.setState({QuestionIndex:t.state.QuestionIndex+1})}},Icon:"ChevronRight",GlyphButtonStyle:"GlyphOnly",ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_DetailResponses_Next_Button};return Object(yn.a)(n)}},n.PN=function(){var t=Object(ae.a)().AnalyzeView_Detail_DialogTitle.format(this.state.QuestionIndex+1);return oe.createElement("div",{"aria-label":t,className:"response-dialog",role:"dialog",ref:this.CN},oe.createElement("div",{ref:this.IN},this.qc(),this.MN(),this.LN()),this.$S(),this.AN())},n.qc=function(){var t={HTMLAttributes:{onClick:this.props.onClose,className:"response-dialog-close-button"},Icon:"Cancel",IconClassName:"forms-icon-size16x16",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(ae.a)().Common_Close_Text,ref:this.SN};return Object(yn.a)(t)},n.MN=function(){var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Title;return oe.createElement("div",{className:"response-dialog-title"},oe.createElement(ga.a,{Text:Object(ae.a)().AnalyzeView_QuestionTitle.format(this.state.QuestionIndex+1,t),RenderMode:"RichText"}))},n.LN=function(){var t,e,n=this,i=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Id,r="Question.FileUpload"===this.props.QuestionDetailMaster.getQuestionType(i),o=this.RN(),s=Object(ae.a)().Common_Responses_Text;if(r&&o.length>0&&(s=Object(ae.a)().UploadFile_Files_DetailPage_Subtitle,t=Object(Gi.b)({HTMLAttributes:{className:"survey-response-dialog-folder-button office-form-theme-button",disabled:this.state.ShowOpenFolderSpinner,onClick:function(){n.setState({ShowOpenFolderSpinner:!0}),n.props.QuestionDetailMaster.getFileUploadFolder(i).then((function(t){n.ce&&n.setState({ShowOpenFolderSpinner:!1}),Object(g.b)("DesignPage.Responses.OpenFileFolder"),Object(Rn.a)(t)})).catch((function(t){t&&t.response&&404===t.response.statusCode&&n.setState({ShowErrorMessage:!0,ShowOpenFolderSpinner:!1})}))}},ButtonStyle:"LightBackground",Text:Object(ae.a)().UploadFile_OpenFolder_Button}),e=this.state.ShowErrorMessage&&oe.createElement("div",{className:"response-dialog-folder-button-error-message"},Object(ae.a)().UploadFile_FolderNotExist_ErrorMessage)),this.props.QuestionDetailMaster.getAnswersCount()<this.props.QuestionDetailMaster.Model.PagingSize)return o.length>0?oe.createElement("div",null,oe.createElement("div",{className:"survey-response-dialog-summary"},oe.createElement("div",{className:"survey-response-dialog-container"},oe.createElement("span",{className:"survey-response-dialog-response-count office-form-theme-primary-foreground"},o.length),s),oe.createElement("div",null,t,this.vf())),e):void 0;var a=this.props.QuestionDetailMaster.getPagingRegion(this.state.PagingIndex),c=a.Start.toString(),u=a.End.toString(),l=this.props.QuestionDetailMaster.getAnswersCount().toString();return oe.createElement("div",{className:"survey-response-dialog-paging-summary"},oe.createElement("div",{className:"survey-response-dialog-paging-info-container"},oe.createElement("span",{className:"survey-response-dialog-region-info"},Object(ae.a)().AnalyzeView_DetailResponses_PagingRegion_Message.format(c,u)),oe.createElement("span",{className:"survey-response-dialog-region-separator"},"|"),l),this.EN(),this.BN())},n.vf=function(){if(this.state.ShowOpenFolderSpinner){return oe.createElement("div",{className:"open-folder-spinner"},oe.createElement("div",{className:"common-spinner-circle"},oe.createElement(xa.a,{HTMLAttributes:{className:"screenReaderVisible"},LazyRendering:!0,Role:"Log"},Object(ae.a)().Design_Page_Open_OneDrive_Folder)))}},n.AN=function(){return this.props.QuestionDetailMaster.getAnswersCount()>0?oe.createElement("div",{className:"response-dialog-content",ref:this.NN},oe.createElement("div",{className:"response-dialog-table-container"},oe.createElement("table",{className:"response-dialog-table hover stripe cell-border"}))):oe.createElement("div",{className:"response-dialog-no-responses-message"},Object(ae.a)().AnalyzeView_DetailResponses_NoResponses_Message)},n.xN=function(){if(this.props.QuestionDetailMaster.getAnswersCount()>0){var t=$(this.CN.current).height()-$(this.IN.current).outerHeight(!0);$(this.NN.current).outerHeight(t)}},n.EN=function(){var t=this,e={className:"question-detail-page-previous-button",disabled:0===this.state.PagingIndex,onClick:function(){t.state.PagingIndex>0&&(Object(g.b)("DesignPage.Responses.DetailDialogPaging",{entry:"PreviousPage"}),t.props.QuestionDetailMaster.SyncPreviousPageData(),t.setState({PagingIndex:t.state.PagingIndex-1}))}};return Object(yn.a)({ButtonStyle:"DarkBackGround",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,Icon:"PageLeft",Text:Object(ae.a)().AnalyzeView_DetailResponses_PreviousPage})},n.BN=function(){var t=this,e=this.props.QuestionDetailMaster.Model.PagingSize,n=this.props.QuestionDetailMaster.getAnswersCount(),i=(this.state.PagingIndex+1)*e>=n,r={className:"question-detail-page-next-button",disabled:i,onClick:function(){t.state.PagingIndex>=0&&!i&&(Object(g.b)("DesignPage.Responses.DetailDialogPaging",{entry:"NextPage"}),t.props.QuestionDetailMaster.SyncNextPageData(),t.setState({PagingIndex:t.state.PagingIndex+1}))}};return Object(yn.a)({ButtonStyle:"DarkBackGround",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:r,Icon:"PageRight",Text:Object(ae.a)().AnalyzeView_DetailResponses_NextPage})},n.$S=function(){if(this.props.QuestionDetailMaster.getAnswersCount()>0&&!this.props.QuestionDetailMaster.Model.IsPagingReady){this._N();var t={ClassName:"survey-reponse-detail-loading-container survery-response-more-detail-message-container",LoadingDescription:Object(ae.a)().Common_Loading_Text};return oe.createElement($o.a,Object(S.__assign)({},t))}},n.TN=function(){if(this.props.QuestionDetailMaster.getAnswersCount()>0&&this.props.QuestionDetailMaster.Model.IsPagingReady){this._N();var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex].Id;this.HN=$(".response-dialog-table").DataTable({data:this.GN(t),columns:this.qN(t),columnDefs:[{targets:2,createdCell:function(t){$(t).attr("aria-disabled","true")}}],searching:!1,paging:!1,info:!1,autoWidth:!0})}},n.qN=function(t){var e=[Object(ae.a)().AnalyzeView_Sort_First,Object(ae.a)().AnalyzeView_Sort_Second,Object(ae.a)().AnalyzeView_Sort_Third,Object(ae.a)().AnalyzeView_Sort_Fourth,Object(ae.a)().AnalyzeView_Sort_Fifth,Object(ae.a)().AnalyzeView_Sort_Sixth,Object(ae.a)().AnalyzeView_Sort_Seventh,Object(ae.a)().AnalyzeView_Sort_Eighth,Object(ae.a)().AnalyzeView_Sort_Ninth,Object(ae.a)().AnalyzeView_Sort_Tenth],n=[Object(ae.a)().Common_Responses_Text],i=[{title:Object(ae.a)().AnalyzeView_Response_ID},{title:Object(ae.a)().AnalyzeView_ExcelHeader_ResponderName}];this.props.EnableSubmitLanguage&&i.push({title:Object(ae.a)().AnalyzeView_ExcelHeader_Language});var r=[],o=this.props.QuestionDetailMaster.getAnswerColumnCount(t),s=60/o+"%";switch(this.props.QuestionDetailMaster.getQuestionType(t)){case"Question.Ranking":$(".response-dialog-table").addClass("response-dialog-table-ranking"),r=Et.first(e,o);break;case"Question.MatrixChoiceGroup":$(".response-dialog-table").removeClass("response-dialog-table-ranking");for(var a=1;a<o;a++)n.push("");r=n;break;case"Question.NPS":$(".response-dialog-table").removeClass("response-dialog-table-ranking"),r=[Object(ae.a)().AnalyzeView_NPS_Score,Object(ae.a)().AnalyzeView_NPS_Category];break;default:r=n}return r=Et.map(r,(function(t){return{title:t,width:s}})),i.concat(r)},n.GN=function(t){var e,n=this,i=this.props.QuestionDetailMaster.getPagingRegion(this.state.PagingIndex).Start,r=this.RN();switch(this.props.QuestionDetailMaster.getQuestionType(t)){case"Question.Ranking":e=Et.map(r,(function(t,e){return n.QN(i+e,t).concat(JSON.parse(t.Answer).map((function(t){return n.VN(t)})))}));break;case"Question.MatrixChoiceGroup":e=Et.map(r,(function(t,e){return n.QN(i+e,t).concat(t.Answer.map((function(t){return n.VN(t)})))}));var o=Et.filter(this.props.QuestionDetailMaster.Model.Questions,(function(e){return e.GroupId===t})),s=Et.map(o,(function(t){return n.VN(t.Title)}));this.props.EnableSubmitLanguage?e.length&&e.splice(0,0,["","",""].concat(s)):e.length&&e.splice(0,0,["",""].concat(s));break;case"Question.NPS":e=Et.map(r,(function(t,e){var r=t.Answer;return n.QN(i+e,t).concat([r,Object(Cr.b)(r)])}));break;case"Question.FileUpload":e=[],Et.forEach(r,(function(t,r){if(t.Answer){var o=JSON.parse(t.Answer);if(o.length>0){var s=o,a=n.QN(i+r,t),c="";s.forEach((function(t,e){var i=Object(qe.e)(t.name),r=n.zN(t.name),o=t.link.split('"')[0];e+1!==s.length?c+=i+'<a href="'+o+'" target="_blank" class="response-dialog-fileName">'+r+"</a></br>":c+=i+'<a href="'+o+'" target="_blank" class="response-dialog-fileName">'+r+"</a>"})),e.push(a.concat(c))}}}));break;default:e=Et.map(r,(function(t,e){return n.QN(i+e,t).concat([n.VN(t.Answer)])}))}return e},n.zN=function(t){return t&&Object(pn.c)(""+t,!0)},n.QN=function(t,e){var n=[t,this.zN(e.ResponderName)];return this.props.EnableSubmitLanguage&&(n=n.concat(e.Language)),n},n._N=function(){this.HN&&($(".dataTables_wrapper").remove(),$(".response-dialog-table").remove(),$(".response-dialog-table-container").append('<table class="response-dialog-table hover stripe cell-border"></table>'),this.HN.destroy(),this.HN=void 0)},n.VN=function(t){return Object(Oa.a)(t)},n.RN=function(){var t=this.props.QuestionDetailMaster.Model.TopLevelQuestions[this.state.QuestionIndex],e=t?t.Id:void 0;if("Question.MatrixChoiceGroup"===t.Type){var n=Et.pluck(Et.filter(this.props.QuestionDetailMaster.Model.Questions,(function(t){return t.GroupId===e})),"Id");return this.props.QuestionDetailMaster.getQuestionsAnswers(n)}return this.props.QuestionDetailMaster.getQuestionAnswers(e)},e}(ue.a),Pa=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.UN=function(){return e.forceUpdate()},e.$N=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){if(this.WN=this.WN.bind(this),this.props.AggregationMaster.observe(this.UN,[ks.Schema.IsAggregationReady,ks.Schema.IsAggregationFailed]),Object(Y.c)("PersonalContextInsight")){this.Oe=this.Oe.bind(this),this.KN=this.KN.bind(this),this.JN=this.JN.bind(this);var t=this.props.AggregationMaster.QuestionMaster,e=this.props.QuestionViewInsight.FormInsightMaster,n=e.FormMaster;t.observe(this.Oe,[t.Schema.InsightsInfo]),e.observe(this.Oe,[e.Schema.InsightCount]),n.observe(this.Oe,[n.Schema.FormsInsightsInfo])}},n.render=function(){if(this.props.AggregationMaster)return oe.createElement("div",{className:"analyze-view-detail"},this.XN(this.props.Index),this.ZN(),oe.createElement("div",{className:"analyze-view-detail-linebreak"}))},n.componentWillUnmount=function(){this.props.AggregationMaster.unobserve(this.UN,[ks.Schema.IsAggregationReady]),Object(Y.c)("PersonalContextInsight")&&(this.props.AggregationMaster.QuestionMaster.unobserve(this.Oe),this.props.QuestionViewInsight.FormInsightMaster.unobserve(this.Oe),this.props.QuestionViewInsight.FormInsightMaster.FormMaster.unobserve(this.Oe))},n.Oe=function(){this.forceUpdate()},n.XN=function(t){return oe.createElement("div",{className:"analzye-view-detail-question"},oe.createElement("div",{className:"analzye-view-detail-ordinal"},t+1+"."),this.createQuestionTitleContent())},n.ZN=function(){return oe.createElement("div",{className:"survey-analyze-view-detail-container"},this.YN(this.props.Index),this.tI(this.props.Index),this.eI(),this.nI(),this.iI(),this.rI(),this.oI())},n.YN=function(t){var e=t+1;if(this.props.onShowQuestionDetail&&!Object(v.u)()){var n={className:"analyze-view-link-button analyze-view-detail-show-responses-data-button",title:Object(ae.a)().AnalyzeView_ShowDetailResponses_Button.format(t+1),onClick:this.WN,ref:this.$N};return oe.createElement("div",{className:"question-view-detail-label"},oe.createElement("button",Object(S.__assign)({},n,{"aria-label":Object(ae.a)().QuestionView_Detail_Label_Index?Object(ae.a)().QuestionView_Detail_Label_Index.format(e):""}),oe.createElement("span",{className:"analyze-view-detail-show-responses-data-text"},Object(ae.a)().QuestionView_Detail_Label)))}},n.eI=function(){if(this.props.AggregationMaster.Model.IsAggregationReady)return oe.createElement("div",{className:"question-view-content-container"},this.createQuestionViewContent())},n.nI=function(){if(!this.props.AggregationMaster.Model.IsAggregationReady&&!this.props.AggregationMaster.Model.IsAggregationFailed)return oe.createElement("div",{className:"question-view-loading-content-container"},this.sI(),this.$S())},n.iI=function(){if(this.props.AggregationMaster.Model.IsAggregationFailed)return oe.createElement("div",{className:"question-view-loading-content-container"},this.sI())},n.sI=function(){var t=Object(On.b)("/Images/question_backgrounds/"+this.getPreviewImageName());return oe.createElement("div",{className:"question-view-background-image"},oe.createElement("img",{src:t}))},n.$S=function(){return oe.createElement($o.a,Object(S.__assign)({},{ClassName:"question-view-loading-spinner-container",Ignorable:!1}))},n.WN=function(){var t=this;Object(yr.f)(Fa.name,(function(){t.$N.current&&t.$N.current.focus()})),this.props.onShowQuestionDetail&&this.props.onShowQuestionDetail()},n.shouldShowInsightEntryPoint=function(){return!1},n.tI=function(t){if(Object(Y.c)("PersonalContextInsight")&&!Object(v.u)()){var e=this.props.QuestionViewInsight.InsightExploreViewOpened&&this.props.QuestionViewInsight.InsightExploreViewIndex===this.props.Index,n=this.shouldShowInsightEntryPoint();return oe.createElement(ka,{openInsightExploreView:this.JN,Clicked:e,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,Index:t,QuestionMaster:this.props.AggregationMaster.QuestionMaster,ShowEntryPoint:n})}},n.oI=function(){if(Object(Y.c)("PersonalContextInsight")&&!Object(v.u)())return wa({FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,QuestionMaster:this.props.AggregationMaster.QuestionMaster})},n.rI=function(){if(Object(Y.c)("PersonalContextInsight")&&!Object(v.u)()&&this.props.QuestionViewInsight.InsightExploreViewOpened&&this.props.QuestionViewInsight.InsightExploreViewIndex===this.props.Index)return Na({closeInsightExploreView:this.KN,FormInsightMaster:this.props.QuestionViewInsight.FormInsightMaster,QuestionMaster:this.props.AggregationMaster.QuestionMaster})},n.KN=function(){this.props.QuestionViewInsight.onCloseInsightExploreView()},n.JN=function(){this.props.QuestionViewInsight.onClickInsightButton()},e}(ue.a),Da=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return this.props.AggregationMaster.QuestionMaster.Model.Choices.length<=5?"pie.png":"bar.png"},n.createQuestionViewContent=function(){return[this.aI()]},n.aI=function(){var t=this,e=Wt.a.convertToArray(this.props.AggregationMaster.Model.ChoiceQuestionAggregation.ChoiceSummary),n=Et.map(e,(function(e){return{labelName:"answer_other"===e.Choice?Object(ae.a)().Designer_OtherAnswer:e.Choice,displayElement:t.createDisplayElement(e),labelData:t.cI(e)?e.Count+" >":e.Count,lableClass:t.cI(e)?"choice-chart-control-legend-label":void 0,onClick:t.cI(e)?t.props.onShowQuestionDetail:void 0}})),i={Animation:this.props.AggregationMaster.Model.IsAggregationReady,Data:{data:e.map((function(t){return t.Count}))},Labels:n,HasLegend:!0,TagLabels:this.CorrectOptions,Type:e.length<=5?1:0};return oe.createElement(ja,Object(S.__assign)({},i,{key:"chartControl"}))},n.cI=function(t){return Object(v.u)()&&"answer_other"===t.Choice&&t.Count>0},e}(Pa),Ma=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",null,this.Nu(),this.Le(),this.uI())},n.Nu=function(){return oe.createElement("div",{className:"analzye-view-detail-title"},oe.createElement(ga.a,{Text:this.QuestionMaster.Model.Title,RenderMode:"RichText"}),this.lI())},n.lI=function(){if(this.IsShowPointsEnabled){var t=this.QuestionMaster.Model.Point,e=t<=1?Object(ae.a)().Quiz_Points_LowerText:Object(ae.a)().Quiz_Points_LowerTextPlural;return oe.createElement("span",{className:"analyze-view-quiz-point"},"("+t+" "+e+")")}},n.Le=function(){if(this.IsShowSubtitleEnabled)return oe.createElement("div",{className:"analyze-view-question-title-formula"},Object(rr.c)({Formula:this.SubtitleContext}))},n.uI=function(){if(this.IsStatisticsEnabled){var t=this.props.AggregationMaster.Model.GradeStatistics,e=t.CorrectCount,n=t.WrongCount;return oe.createElement("div",{className:"analyze-details-quiz-results"},Object(ae.a)().AnalyzeView_QuizResults.format((e/(e+n)*100).toFixed(0),e,e+n))}},n.hI=function(t){return null!=t},Object.defineProperty(n,"QuestionMaster",{get:function(){return this.props.AggregationMaster.QuestionMaster},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsShowPointsEnabled",{get:function(){return this.QuestionMaster.Model.IsQuiz&&this.QuestionMaster.Model.Point},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsShowSubtitleEnabled",{get:function(){return this.QuestionMaster&&this.QuestionMaster.Model.IsMathQuiz&&!this.QuestionMaster.Model.IsPlainTextInMathField&&this.QuestionMaster.Model.ShowSubtitle&&this.SubtitleContext},enumerable:!1,configurable:!0}),Object.defineProperty(n,"SubtitleContext",{get:function(){return this.QuestionMaster.Model.Subtitle},enumerable:!1,configurable:!0}),Object.defineProperty(n,"IsStatisticsEnabled",{get:function(){var t=this.props.AggregationMaster.Model.GradeStatistics;return this.QuestionMaster.Model.IsQuiz&&this.QuestionMaster.hasCorrectAnswers()&&this.hI(t.CorrectCount)&&this.hI(t.WrongCount)&&(t.CorrectCount||t.WrongCount)},enumerable:!1,configurable:!0}),e}(ue.a),La=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},Object.defineProperty(n,"CorrectOptions",{get:function(){var t={},e=Et.filter(this.props.AggregationMaster.QuestionMaster.Model.Choices,(function(t){return t.IsAnswerKey}));return Et.forEach(e,(function(e){return t[e.Description]=!0})),t},enumerable:!1,configurable:!0}),n.createDisplayElement=function(t){return t.IsFormula?Object(rr.c)({Formula:t.Choice,DisableLinebreaks:!0}):Object(ga.b)({Text:"answer_other"===t.Choice?Object(ae.a)().Designer_OtherAnswer:t.Choice,RenderMode:"RichText"})},e}(Da),Aa=n(122),Ra=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"text.png"},n.createQuestionViewContent=function(){return[this.fI(),this.dI()]},n.fI=function(){var t={Data:this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount,Description:Object(ae.a)().Common_Responses_Text,Ignorable:!1,IsReady:!0};return oe.createElement(Aa.a,Object(S.__assign)({},t,{key:"responseCount"}))},n.dI=function(){var t=this.props.AggregationMaster.Model.DateQuestionAggregation.ResponseCount,e=Object(v.u)()&&t>0&&h.a.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailEntrance(this.props.onShowQuestionDetail);return oe.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},oe.createElement("div",{className:"analyze-view-summary-status-label"},Object(ae.a)().Analyze_View_Text_Recent_Responses),this.bI(),e)},n.bI=function(){var t=Et.pluck(Wt.a.convertToArray(this.props.AggregationMaster.Model.DateQuestionAggregation.TopDate),"Answer");return Et.map(t,(function(t,e){var n=t&&t.toDateShortString(Object(u.a)().cultureInfo);return oe.createElement("div",{className:"analyze-view-detail-text-lines",key:e},'"'+n+'"')}))},e}(Pa),Ea=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},e}(Ra),Ba=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"text.png"},n.createQuestionViewContent=function(){return[this.fI(),this.mI()]},n.fI=function(){var t={Data:this.props.AggregationMaster.Model.FileUploadQuestionAggregation.ResponseCount,Description:Object(ae.a)().Common_Responses_Text,Ignorable:!1,IsReady:!0};return oe.createElement(Aa.a,Object(S.__assign)({},t,{key:"responseCount"}))},n.mI=function(){return oe.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},oe.createElement("div",{className:"analyze-view-summary-status-label"},Object(ae.a)().Analyze_View_Text_Recent_Responses),this.vI())},n.vI=function(){var t=Et.pluck(Wt.a.convertToArray(this.props.AggregationMaster.Model.FileUploadQuestionAggregation.RecentFile),"Answer");return Et.map(t,(function(t,e){if(t){var n=t.name,i=Object(qe.d)(n);return oe.createElement("div",{className:"analyze-view-detail-text-lines",key:e},i,oe.createElement("span",{className:"analyze-view-detail-fileName"},n))}}))},e}(Pa),_a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},e}(Ba),Ha=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iN=["#FF7F0E","#FF993E","#FFB26E","#FFCC9F","#FFE5CF","#E5E5E5","#D2E4F0","#A5C9E1","#79ADD2","#4C92C3","#1F77B4"],e}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){if(this.oN()){var t={className:"chart-control-container chart-likert-control-container",tabIndex:-1};return t["aria-label"]=Object(ae.a)().ChartControl_GroupContainer,oe.createElement("div",Object(S.__assign)({},t),this.gI(),oe.createElement("div",{className:"chart-likert-body-control-container"},this.sN(),this.aN()))}return null},n.componentWillMount=function(){this.OI()},n.componentDidMount=function(){this.cN()},n.shouldComponentUpdate=function(t){return!Et.isEqual(this.props,t)||!this.uN},n.componentDidUpdate=function(){this.cN()},n.componentWillUnmount=function(){this.lN()},n.oN=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},n.lN=function(){this.hN&&(this.hN.destroy(),this.hN=null)},n.cN=function(){if(this.oN()){var t=Ln.findDOMNode(this.refs.canvas);if(this.uN=$(t).is(":visible"),this.uN){var e=t.getContext("2d");this.pI(e),this.bN()}}},n.jI=function(){var t=this,e="'wf_segoe-ui_light', 'Segoe UI Light','Segoe WP Light','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif";return{responsive:!1,scales:{xAxes:[{gridLines:{display:!0,drawTicks:!1,drawBorder:!0,zeroLineColor:"#ECECEC",zeroLineWidth:1,zeroLineBorderDash:[5]},ticks:{display:!0,beginAtZero:!0,fontFamily:e,fontSize:12,min:-100,max:100,maxTicksLimit:3,callback:function(t,e,n){return Math.abs(t)+"%"}},stacked:!0}],yAxes:[{barPercentage:.67,categoryPercentage:1,gridLines:{display:!1,drawTicks:!1,drawBorder:!1},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!1,mode:"nearest",intersect:!0,bodyFontSize:12,bodyFontFamily:e,custom:function(e){var n=t.hN.canvas.parentNode,i=n.getElementsByClassName("chart-custom-tooltip")[0];if(i||((i=document.createElement("div")).className="chart-custom-tooltip",i.innerHTML="<table></table>",n.appendChild(i)),0!==e.opacity){if(e.body){var r=e.body.map((function(t){return t.lines}));if(r.length>1){var o=r.length/2;t.yI&&(r.splice(o,1),e.labelColors.splice(o,1));var s=r.splice(0,o).reverse();s=s.concat(r);var a=e.labelColors.splice(0,o).reverse();a=a.concat(e.labelColors),r=[];var c=[];s.forEach((function(t,e){/\:\s0%$/g.test(t[0].xLabel)||(r.push(t),c.push(a[e]))})),e.labelColors=c}var u="";r.forEach((function(t,n){var i=Object(pn.c)(""+t[0].xLabel,!0),r=Object(pn.c)(""+t[0].yLabel,!0),o=e.labelColors[n],s="background:"+o.backgroundColor+";border-color:"+o.borderColor+"; border-width: 2px;";u+="<tr><td>"+('<span class="chart-custom-tooltip-statement-text">'+r+"</span>")+"</td></tr>",u+="<tr><td>"+('<span class="chart-custom-tooltip-box" style="'+s+'"></span>')+('<span class="chart-custom-tooltip-text">'+i+"</span>")+"</td></tr>"})),u+="</tbody>",i.querySelector("table").innerHTML=u}var l=t.hN.canvas.offsetTop,h=t.hN.canvas.offsetLeft;i.style.opacity="1",i.style.left=h+e.caretX+"px",i.style.top=l+e.caretY+"px",i.style.fontFamily=e._bodyFontFamily,i.style.fontSize=e._bodyFontSize,i.style.fontStyle=e._fontStyle,i.style.padding=e.yPadding+"px "+e.xPadding+"px"}else i.style.opacity="0"},callbacks:{label:function(e,n){var i=n.datasets[e.datasetIndex].label+": ",r=e.xLabel;return t.yI&&(0!==e.datasetIndex&&n.datasets.length/2!==e.datasetIndex||(r*=2)),{yLabel:e.yLabel,xLabel:i+Math.abs(r)+"%"}}}},legend:{display:!1}}},n.pI=function(t){var e,n,i=Math.floor(this.wI.length/2);if(this.wI.length%2==0){this.yI=!1,(r=this.wI.splice(0,i)).reverse().forEach((function(t,e){t.data=t.data.map((function(t){return-t}))})),(e=this.wI).splice.apply(e,Object(S.__spreadArrays)([0,0],r))}else{var r;this.yI=!0,(r=this.wI.splice(0,i+1)).reverse(),r[0].data=r[0].data.map((function(t){return t/2}));var o=Et.clone(r[0]);r.forEach((function(t){t.data=t.data.map((function(t){return-t}))})),r.push(o),(n=this.wI).splice.apply(n,Object(S.__spreadArrays)([0,0],r))}var s={labels:this.props.Labels,datasets:this.wI},a=this.jI();this.lN(),this.hN=new Chart(t,{type:"horizontalBar",data:s,options:a})},n.OI=function(){for(var t=this,e=[],n=function(t){e.push(i.props.Data.reduce((function(e,n){return e+n.data[t]}),0))},i=this,r=0;r<this.props.Data[0].data.length;r++)n(r);var o=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.ON=o[Math.min(this.props.Data.length,o.length)-1].map((function(e){return t.iN[e]})),this.wI=this.props.Data.map((function(n,i){var r=n.backgroundColor?n.backgroundColor:t.ON[i%t.ON.length];return{label:n.label,backgroundColor:r,hoverBackgroundColor:t.pN(r,10),data:n.data.map((function(t,n){return e[n]?Math.round(1e3*t/e[n])/10:0}))}}))},n.pN=function(t,e){return Et.isArray(t)?t.map((function(t){return n(t,e)})):n(t,e);function n(t,e){var n=parseInt(t.slice(1),16),i=Math.round(2.55*e),r=(n>>16)+i,o=(n>>8&255)+i,s=(255&n)+i;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)}},n.bN=function(){var t=this;if(this.props.HasLegend){var e=Ln.findDOMNode(this.refs["legend-contaner"]),n=e.childNodes;n&&n.length>0&&(Et.each(n,(function(e,n){Chart.helpers.addEvent(e,"mouseover",(function(){t.jN("mouseover",n)}))})),Chart.helpers.addEvent(e,"mouseout",(function(){t.jN("mouseout",0)})));var i=Ln.findDOMNode(this.refs["stacked-detail-container"]).getElementsByClassName("chart-control-detail-canvas");i&&i.length>0&&Et.each(i,(function(e,n){var i=e.getContext("2d");i.fillStyle=t.props.Data[n].backgroundColor?t.props.Data[n].backgroundColor:t.ON[n%t.ON.length],i.beginPath(),i.fillRect(0,0,8,8),i.closePath(),i.fill()}))}},n.jN=function(t,e){var n=this;this.hN.active="mouseout"===t?[]:this.hN.data.datasets.map((function(t,i){return n.hN.getDatasetMeta(i).data[e]})),this.hN.lastActive=this.hN.lastActive||[],this.hN.lastActive.length&&this.hN.updateHoverStyle(this.hN.lastActive,this.hN.options.hover.mode,!1),this.hN.active.length&&this.hN.updateHoverStyle(this.hN.active,this.hN.options.hover.mode,!0);var i=!Chart.helpers.arrayEquals(this.hN.active,this.hN.lastActive);if(i){this.hN.lastActive=this.hN.active;var r=this.hN.tooltip;r._active=this.hN.active,r._lastActive=r._lastActive||[],r.update(!0),r.pivot();var o=this.hN._bufferedRequest;o?this.hN.render(o.duration,o.lazy):i&&!this.hN.animating&&(this.hN.stop(),this.hN.render(this.hN.options.hover.animationDuration,!0)),this.hN._bufferedRender=!1,this.hN._bufferedRequest=null}},n.sN=function(){if(this.props.HasLegend){var t={className:"chart-likert-control-legend",tabIndex:-1,ref:"legend-contaner"};t["aria-label"]=Object(ae.a)().ChartControl_LegendGroup;var e=this.props.Labels.map((function(t,e){return oe.createElement("div",{className:"chart-likert-control-legend-row",key:e},oe.createElement("span",{className:"chart-likert-control-legend-label",title:t.toString()},t))}));return oe.createElement("div",Object(S.__assign)({},t),e)}},n.aN=function(){var t={className:"chart-likert-control",tabIndex:-1};t["aria-label"]=Object(ae.a)().ChartControl_ChartGroup;var e=Object(pn.e)()<400||Object(et.r)(),n=e?300:432,i=18+48*this.props.Labels.length,r={role:"presentation",className:"chart-control-canvas",width:n,height:i=e?300*i/350:i,ref:"canvas"};return oe.createElement("div",Object(S.__assign)({},t),oe.createElement("canvas",Object(S.__assign)({},r)))},n.gI=function(){return oe.createElement("div",{className:"chart-likert-control-detail-container",ref:"stacked-detail-container"},this.props.Data.map((function(t){return oe.createElement("div",{className:"chart-likert-control-detail-item","aria-label":t.label,key:t.label},oe.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"8",height:"8"}),oe.createElement("span",null,t.label))})))},e}(ue.a),Ga=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"bar.png"},n.createStackedBarControlContainer=function(){var t=this.props.AggregationMaster.Model.LikertQuestionAggregation;if(t.LikertResults.length&&t.Options.length){for(var e=Wt.a.convertToArray(t.Options),n=[],i=function(i){n[i]={label:e[i],data:Et.map(t.LikertResults,(function(t){return t.Statistics[i]}))}},r=0;r<t.Options.length;r++)i(r);var o={Data:n,Type:2,Labels:Et.map(t.LikertResults,(function(t){return t.SubQuestionName})),HasLegend:!0};return oe.createElement(Ha,Object(S.__assign)({},o,{key:"likertChartControl"}))}},n.createQuestionViewContent=function(){return[this.createStackedBarControlContainer()]},e}(Pa),qa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},e}(Ga),Qa={ArrowAngle:60,ArrowHeight:12,BackgroundColor:"#F2F2F2",BorderColors:["#FF9224","#008272"],BorderWidth:12,Bottom:0,CircleMargin:3,Color:"#333333",FontFamily:"'wf_segoe-ui_normal','Segoe UI','Segoe WP',Tahoma,Arial,sans-serif",FontSize:12,LabelSize:15,ScoreColors:["#B15509","#333333","#008272"],ScoreFontFamily:"'wf_segoe-ui_semibold','Segoe UI Semibold','Segoe WP Semibold','Segoe UI','Segoe WP',Tahoma, Arial, sans-serif",ScoreFontSizes:[38,45],Top:16},Va=10*Math.PI/180,za=45*Math.PI/180,Ua=function(){function t(t,e,n){this.SI=t,this.yd(e,n),this.NI(t)}var e=t.prototype;return e.destroy=function(){this.SI.clearRect(0,0,this.SI.canvas.width,this.SI.canvas.height)},e.yd=function(t,e){this.II=Et.extend({},Qa,e);var n=this.II,i=n.Color,r=n.FontSize,o=n.Top,s=n.Bottom,a=n.CircleMargin,c=n.BorderWidth,u=n.FontFamily;this.SI.font=r+"px "+u,this.SI.fillStyle=i,this.SI.textAlign="center",this.SI.textBaseline="middle";var l=this.SI.canvas.width,h=this.SI.canvas.height;this.CI=Math.min((l-2*(c+a))/2,(h-o-c-2*a-s)/2);var f=this.CI+o+a+c;this.SI.translate(this.SI.canvas.width/2,f),this.kI=this.CI+a+c,this.TI=t},e.NI=function(t){this.xI(t),this.FI(t),this.DI(t)},e.FI=function(e){e.save();var n=Math.sin(Va)*this.kI,i=this.kI+2;t.drawText(e,i,n,"+100","start","middle"),t.drawText(e,0,-i,"0","center","bottom"),t.drawText(e,-i,n,"-100","end","middle"),e.restore()},e.DI=function(e){var n,i,r,o=this.II,s=o.ScoreColors,a=o.ScoreFontSizes;this.TI>=0?(i=0!==this.TI?s[2]:s[1],n=this.TI-90):(i=s[0],n=this.TI-90),r=100===Math.abs(this.TI)?a[0]:a[1];var c=t.fitScoreText(this.SI,"100",this.CI/Math.cos(za));r=Math.min(r,c);var u=Math.tan(this.II.ArrowAngle/2*Math.PI/180)*this.II.ArrowHeight;this.MI(e,this.TI.toString(),n,this.CI,this.II.ArrowHeight,u,r,i)},e.MI=function(e,n,i,r,o,s,a,c){t.drawDial(e,i,r,o,s,this.II.BackgroundColor),e.save(),t.drawText(e,0,this.CI/2,"NPS",void 0,void 0,this.II.LabelSize+"px "+this.II.FontFamily),e.fillStyle=c,t.drawText(e,0,-.25*a,n,void 0,void 0,"bold "+a+"px "+this.II.ScoreFontFamily),e.restore()},t.drawDial=function(t,e,n,i,r,o){var s=n+i;t.save(),t.fillStyle=o,t.rotate(e*Math.PI/180),t.beginPath(),t.moveTo(s,0);var a=r/n,c=Math.asin(a);t.arc(0,0,n,-c,c,!0),t.fill(),t.restore()},e.xI=function(e){var n=this.II,i=n.BorderWidth,r=n.BorderColors;t.drawDoughnut(e,0,0,Va,-90*Math.PI/180,this.kI,i,r[1],!0),t.drawDoughnut(e,0,0,-90*Math.PI/180,-190*Math.PI/180,this.kI,i,r[0],!0),e.clearRect(-1,-this.kI,2,i)},t.fitScoreText=function(t,e,n){t.save();var i=14;for(t.font="bold "+i+"px Arial";t.measureText(e).width<n;)i++,t.font="bold "+i+"px Arial";return t.restore(),i},t.drawDoughnut=function(t,e,n,i,r,o,s,a,c){t.save(),t.beginPath(),t.fillStyle=a,t.arc(e,n,o,i,r,c),t.save(),t.rotate(r),t.lineTo(o-s,0),t.restore(),t.arc(e,n,o-s,r,i,!c),t.fill(),t.restore()},t.drawText=function(t,e,n,i,r,o,s){r&&(t.textAlign=r),o&&(t.textBaseline=o),s&&(t.font=s),t.fillText(i,e,n)},t}(),$a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.LI=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){if(this.oN()){var t={className:"chart-control-container",tabIndex:-1};return t["aria-label"]=Object(ae.a)().ChartControl_GroupContainer,oe.createElement("div",Object(S.__assign)({},t),this.sN(),this.aN())}return null},n.componentDidMount=function(){this.cN()},n.shouldComponentUpdate=function(t){return!Et.isEqual(this.props,t)||!this.uN},n.componentDidUpdate=function(){this.cN()},n.componentWillUnmount=function(){this.lN()},n.oN=function(){return this.props.Labels&&this.props.Data&&this.props.Labels.length===this.props.Data.length&&this.props.Labels.length>0},n.lN=function(){this.hN&&(this.hN.destroy(),this.hN=null)},n.cN=function(){if(this.oN()){var t=this.LI.current;if(this.uN=$(t).is(":visible"),this.uN){var e=t.getContext("2d");this.lN(),this.hN=new Ua(e,this.props.Score,{BorderColors:["#FF9224","#008272"],ScoreColors:["#B15509","#333333","#008272"]})}}},n.sN=function(){if(this.props.HasLegend){var t={className:"chart-control-legend",tabIndex:-1};return t["aria-label"]=Object(ae.a)().ChartControl_LegendGroup,oe.createElement("div",Object(S.__assign)({},t),oe.createElement("table",{className:"chart-control-legend-table"},oe.createElement("tbody",null,this.AI())))}},n.AI=function(){var t=this;return this.props.Labels.map((function(e,n){return oe.createElement("tr",{className:"nps-chart-control-legend-table-row",key:n},oe.createElement("td",{role:"presentation",className:"chart-control-legend-label"},t.props.Labels[n]),oe.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.props.Data[n]))}))},n.aN=function(){var t={className:"chart-control",tabIndex:-1};t["aria-label"]=Object(ae.a)().ChartControl_ChartValueForNPS.format(this.props.Score);var e={height:150,ref:this.LI,role:"presentation",width:300};return oe.createElement("div",Object(S.__assign)({},t),oe.createElement("canvas",Object(S.__assign)({},e)))},e}(ue.a),Wa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"nps.png"},n.createQuestionViewContent=function(){var t=this.props.AggregationMaster.Model.NPSQuestionAggregation,e=t.ResponseCount,n=[t.Promoters,t.Passives,t.Detractors],i=n.map((function(t){return t&&Math.round(100*t/e)})),r=[Object(ae.a)().NPS_Promoters,Object(ae.a)().NPS_Passives,Object(ae.a)().NPS_Detractors];return[oe.createElement($a,{key:"chartControl",Data:n,HasLegend:!0,Labels:r,Percentage:i,Score:i[0]-i[2]})]},e}(Pa),Ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},e}(Wa),Ja=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.iN=["#FF7F0E","#FF993E","#FFB26E","#FFCC9F","#FFE5CF","#E5E5E5","#D2E4F0","#A5C9E1","#79ADD2","#4C92C3","#1F77B4"],e}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){if(this.oN()){var t={className:"chart-control-container chart-stacked-control-container",tabIndex:-1};return t["aria-label"]=Object(ae.a)().ChartControl_GroupContainer,oe.createElement("div",Object(S.__assign)({},t),this.sN(),this.aN())}return null},n.componentWillMount=function(){this.OI()},n.componentDidMount=function(){this.cN()},n.shouldComponentUpdate=function(t){return!Et.isEqual(this.props,t)||!this.uN},n.componentDidUpdate=function(){this.cN()},n.componentWillUnmount=function(){this.lN()},n.oN=function(){return this.props.Labels&&this.props.Labels.length>0&&this.props.Data&&this.props.Data.length>0},n.lN=function(){this.hN&&(this.hN.destroy(),this.hN=null)},n.cN=function(){if(this.oN()){var t=Ln.findDOMNode(this.refs.canvas);if(this.uN=$(t).is(":visible"),this.uN){var e=t.getContext("2d");this.pI(e),this.bN()}}},n.jI=function(){return{responsive:!1,scales:{xAxes:[{gridLines:{display:!1,drawTicks:!0,drawBorder:!0},ticks:{display:!1,min:0,max:100},stacked:!0}],yAxes:[{gridLines:{display:!1,drawTicks:!1,drawBorder:!0},ticks:{display:!1},stacked:!0}]},tooltips:{enabled:!0,filter:function(t){return 0!==t.xLabel},callbacks:{title:function(t){return t.length?t[0].yLabel:""},label:function(t,e){return e.datasets[t.datasetIndex].label+": "+t.xLabel+"%"}}},legend:{display:!1}}},n.pI=function(t){var e={labels:this.props.Labels,datasets:this.wI},n=this.jI();this.lN(),this.hN=new Chart(t,{type:"horizontalBar",data:e,options:n})},n.OI=function(){for(var t=this,e=[],n=function(t){e.push(i.props.Data.reduce((function(e,n){return e+n.data[t]}),0))},i=this,r=0;r<this.props.Data[0].data.length;r++)n(r);var o=[[0],[0,10],[0,5,10],[0,2,8,10],[0,2,5,8,10],[0,2,4,6,8,10],[0,2,4,5,6,8,10],[0,2,3,4,6,7,8,10],[0,2,3,4,5,6,7,8,10],[0,1,2,3,4,6,7,8,9,10]];this.ON=o[Math.min(this.props.Data.length,o.length)-1].map((function(e){return t.iN[e]})),this.wI=this.props.Data.map((function(n,i){var r=n.backgroundColor?n.backgroundColor:t.ON[i%t.ON.length];return{label:n.label,borderWidth:1,borderColor:"#FFFFFF",backgroundColor:r,hoverBackgroundColor:t.pN(r,10),data:n.data.map((function(t,n){return e[n]?Math.round(1e3*t/e[n])/10:0}))}}))},n.pN=function(t,e){return Et.isArray(t)?t.map((function(t){return n(t,e)})):n(t,e);function n(t,e){var n=parseInt(t.slice(1),16),i=Math.round(2.55*e),r=(n>>16)+i,o=(n>>8&255)+i,s=(255&n)+i;return"#"+(16777216+65536*(r<255?r<1?0:r:255)+256*(o<255?o<1?0:o:255)+(s<255?s<1?0:s:255)).toString(16).slice(1)}},n.bN=function(){var t=this;if(this.props.HasLegend){var e=Ln.findDOMNode(this.refs["legend-table"]),n=Ln.findDOMNode(this.refs["legend-table-tbody"]).childNodes;n&&n.length>0&&(Et.each(n,(function(e,n){Chart.helpers.addEvent(e,"mouseover",(function(){t.jN("mouseover",n)}))})),Chart.helpers.addEvent(e,"mouseout",(function(){t.jN("mouseout",0)})));var i=Ln.findDOMNode(this.refs["stacked-detail-container"]).getElementsByClassName("chart-control-detail-canvas");i&&i.length>0&&Et.each(i,(function(e,n){var i=e.getContext("2d");i.fillStyle=t.wI[n].backgroundColor,i.beginPath(),i.fillRect(0,0,10,10),i.closePath(),i.fill()}))}},n.jN=function(t,e){var n=this;this.hN.active="mouseout"===t?[]:this.hN.data.datasets.map((function(t,i){return n.hN.getDatasetMeta(i).data[e]})),this.hN.lastActive=this.hN.lastActive||[],this.hN.lastActive.length&&this.hN.updateHoverStyle(this.hN.lastActive,this.hN.options.hover.mode,!1),this.hN.active.length&&this.hN.updateHoverStyle(this.hN.active,this.hN.options.hover.mode,!0);var i=!Chart.helpers.arrayEquals(this.hN.active,this.hN.lastActive);if(i){this.hN.lastActive=this.hN.active;var r=this.hN.tooltip;r._active=this.hN.active,r._lastActive=r._lastActive||[],r.update(!0),r.pivot();var o=this.hN._bufferedRequest;o?this.hN.render(o.duration,o.lazy):i&&!this.hN.animating&&(this.hN.stop(),this.hN.render(this.hN.options.hover.animationDuration,!0)),this.hN._bufferedRender=!1,this.hN._bufferedRequest=null}},n.sN=function(){var t=this;if(this.props.HasLegend){var e={className:"chart-control-legend",tabIndex:-1};e["aria-label"]=Object(ae.a)().ChartControl_LegendGroup;var n=void 0,i=void 0;return 0===this.props.Type?(n=oe.createElement("tr",{className:"chart-control-legend-table-title"},oe.createElement("th",{className:"chart-control-legend-label"},""),oe.createElement("th",{className:"chart-control-legend-value"},"")),i=this.props.Labels.map((function(e,n){return oe.createElement("tr",{className:"chart-control-legend-table-row",key:n},oe.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:e.toString()},e),oe.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.wI[0].data[n]+"%"))}))):(n=oe.createElement("tr",{className:"chart-control-legend-table-title"},oe.createElement("th",{role:"presentation",className:"chart-control-legend-value"},Object(ae.a)().AnalyzeView_Chart_Rank),oe.createElement("th",{role:"presentation",className:"chart-control-legend-label"},Object(ae.a)().AnalyzeView_Chart_Options)),i=this.props.Labels.map((function(e,n){return oe.createElement("tr",{className:"chart-control-legend-table-row",key:n},oe.createElement("td",{role:"presentation",className:"chart-control-legend-value"},t.props.yLabels[n]),oe.createElement("td",{role:"presentation",className:"chart-control-legend-label",title:e.toString()},e))}))),oe.createElement("div",Object(S.__assign)({},e),oe.createElement("table",{className:"chart-control-legend-table",ref:"legend-table"},oe.createElement("thead",null,n),oe.createElement("tbody",{ref:"legend-table-tbody"},i)))}},n.aN=function(){var t={"aria-label":Object(ae.a)().ChartControl_ChartGroup,className:"chart-control chart-control-stacked",tabIndex:-1},e=Object(pn.e)()<400||Object(et.r)(),n=e?300:350,i=10+31*this.props.Labels.length,r={role:"presentation",className:"chart-control-canvas",width:n,height:i=e?300*i/350:i,ref:"canvas"};return oe.createElement("div",Object(S.__assign)({},t),this.gI(),oe.createElement("canvas",Object(S.__assign)({},r)))},n.gI=function(){var t=this;if(1===this.props.Type){var e=Object(ae.a)().AnalyzeView_Chart_Pick;return oe.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Labels.map((function(n,i){return 0===i?oe.createElement("div",{className:"chart-control-stacked-detail-item",key:i.toString()},oe.createElement("span",null,e.format(Object(ae.a)().Ordinal_Numera_First)),oe.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"})):i===t.props.Labels.length-1?oe.createElement("div",{className:"chart-control-stacked-detail-item",key:i.toString()},oe.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),oe.createElement("span",null,e.format(Object(ae.a)().Ordinal_Numera_Last))):oe.createElement("div",{className:"chart-control-stacked-detail-item",key:i.toString()},oe.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}))})))}return oe.createElement("div",{className:"chart-control-stacked-detail-container",ref:"stacked-detail-container"},this.props.Data.map((function(t){return oe.createElement("div",{className:"chart-control-stacked-detail-item",key:t.label},oe.createElement("canvas",{role:"presentation",className:"chart-control-detail-canvas",width:"10",height:"10"}),oe.createElement("span",null,t.label))})))},e}(ue.a),Xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"bar.png"},n.createQuestionViewContent=function(){return[this.createStackedBarControlContainer()]},e}(Pa),Za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},n.createStackedBarControlContainer=function(){var t=Wt.a.convertToArray(this.props.AggregationMaster.Model.RankingQuestionAggregation);if(t&&t.length>0){var e=[],n=[];t.forEach((function(t,i){e.push(t.Statistics[0]),n.push(t.Statistics[1])}));var i=[{backgroundColor:"#06B65F",label:Object(ae.a)().AnalyzeView_Correct,data:e},{backgroundColor:"#FF1225",label:Object(ae.a)().AnalyzeView_InCorrect,data:n}];return oe.createElement(Ja,{Type:0,Labels:t.map((function(t){return t.Name})),Data:i,HasLegend:!0,key:"rankingChartControl"})}},e}(Xa),Ya=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"rating.png"},n.createQuestionViewContent=function(){return[this.fI(),this.RI()]},n.componentDidMount=function(){this.EI()},n.componentDidUpdate=function(){this.EI()},n.EI=function(){$(".rateit").rateit();var t=Ln.findDOMNode(this.refs.star);t&&$(t).rateit("value",this.BI())},n.fI=function(){var t={Data:this.props.AggregationMaster.Model.RatingQuestionAggregation.ResponseCount,Description:Object(ae.a)().Common_Responses_Text,Ignorable:!1,IsReady:!0};return oe.createElement(Aa.a,Object(S.__assign)({},t,{key:"responseCount"}))},n.RI=function(){switch(this.props.AggregationMaster.QuestionMaster.Model.RatingShape){case te.f.Number:return this._I();case te.f.Star:default:return this.HI()}},n._I=function(){return oe.createElement("div",{className:"survey-analyze-view-rating-container",key:"numberAverage"},oe.createElement("div",{className:"simple-data-control-content office-form-theme-primary-foreground"},this.BI()),oe.createElement("div",{className:"analyze-view-summary-status-label"},Object(ae.a)().AnalyzeView_Average_Result))},n.HI=function(){var t=Object(Fr.a)({Disabled:!0,HTMLAttributes:{className:"analyze-view-details-rating office-form-theme-primary-foreground",title:this.BI().toFixed(2).toString()},Length:this.props.AggregationMaster.QuestionMaster.Model.Length,onValueChange:void 0,ShowRatingLabel:!1,Value:this.BI(),key:"rateit"});return oe.createElement("div",{className:"survey-analyze-view-rating-container",key:"starAverage"},t,oe.createElement("div",{className:"analyze-view-summary-status-label"},Object(ae.a)().AnalyzeView_Average_Rating.format(this.BI().toFixed(2))))},n.BI=function(){var t=this.props.AggregationMaster.Model.RatingQuestionAggregation.AverageRating;return t?Math.round(100*t)/100:0},e}(Pa),tc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},e}(Ya),ec=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getPreviewImageName=function(){return"text.png"},n.createQuestionViewContent=function(){return[this.createResponsesCountLabel(),this.createLatestTextsView()]},n.createResponsesCountLabel=function(){var t={Data:this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount,Description:Object(ae.a)().Common_Responses_Text,Ignorable:!1,IsReady:!0};return oe.createElement(Aa.a,Object(S.__assign)({},t,{key:"responseCount"}))},n.createLatestTextsView=function(){var t=this.props.AggregationMaster.Model.TextQuestionAggregation.ResponseCount,e=Object(v.u)()&&t>0&&h.a.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailEntrance(this.props.onShowQuestionDetail);return oe.createElement("div",{className:"survey-analyze-view-detail-text-recent",key:"latestResponses"},oe.createElement("div",{className:"analyze-view-summary-status-label"},Object(ae.a)().Analyze_View_Text_Recent_Responses),this.vI(),e)},n.vI=function(){var t=this,e=Wt.a.convertToArray(this.props.AggregationMaster.Model.TextQuestionAggregation.TopAnswers);return Et.map(e,(function(e,n){if(!(t.props.AggregationMaster.Model.IsMathQuestion&&e.Answer.length>120)){if(e.IsMath){var i=Object(rr.c)({Formula:'"'+e.Answer+'"'});return oe.createElement("div",{className:"analyze-view-detail-text-lines",key:n},i)}return oe.createElement("div",{className:"analyze-view-detail-text-lines",key:n},'"'+e.Answer+'"')}}))},e}(Pa),nc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(Ma,{AggregationMaster:this.props.AggregationMaster})},n.createQuestionViewContent=function(){return this.props.AggregationMaster.QuestionMaster.hasCorrectAnswers()?[this.aI()]:[t.prototype.createResponsesCountLabel.call(this),t.prototype.createLatestTextsView.call(this)]},n.aI=function(){var t=this.GI(),e=Et.map(t,(function(t){var e;return e=t.IsMath?Object(rr.c)({Formula:t.Text}):Object(ga.b)({Text:t.Text,RenderMode:"RichText"}),{labelData:t.Count,labelName:t.Text,displayElement:e}})),n={Animation:this.props.AggregationMaster.Model.IsAggregationReady,Data:{data:t.map((function(t){return t.Count}))},Labels:e,HasLegend:!0,TagLabels:this.qI(),Type:t.length<=5?1:0};return oe.createElement(ja,Object(S.__assign)({},n,{key:"chartControl"}))},n.GI=function(){var t=Wt.a.convertToArray(this.props.AggregationMaster.Model.TextQuestionAggregation.TextSummary),e=Et.last(t);return e&&"answer_other"===e.Text&&(t[t.length-1].Text=Object(ae.a)().AnalyzeView_Chart_Others.format(e.Count)),t},n.qI=function(){var t={},e=new lr.a(this.props.AggregationMaster.QuestionMaster.Model);return Et.forEach(e.getAnswers(),(function(e){return t[e.answer]=!0})),t},e}(ec),ic=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"analzye-view-detail-title"},oe.createElement(ga.a,{Text:this.QuestionMaster.Model.Title,RenderMode:"RichText"}))},Object.defineProperty(n,"QuestionMaster",{get:function(){return this.props.AggregationMaster.QuestionMaster},enumerable:!1,configurable:!0}),e}(ue.a),rc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},Object.defineProperty(n,"CorrectOptions",{get:function(){return{}},enumerable:!1,configurable:!0}),n.createDisplayElement=function(t){return null},n.shouldShowInsightEntryPoint=function(){return!0},e}(Da),oc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},e}(Ra),sc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},e}(Ba),ac=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},e}(Ga),cc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},e}(Wa),uc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},n.createStackedBarControlContainer=function(){var t=Wt.a.convertToArray(this.props.AggregationMaster.Model.RankingQuestionAggregation);if(t&&t.length>0){for(var e=t.length,n=[Object(ae.a)().AnalyzeView_Sort_First,Object(ae.a)().AnalyzeView_Sort_Second,Object(ae.a)().AnalyzeView_Sort_Third,Object(ae.a)().AnalyzeView_Sort_Fourth,Object(ae.a)().AnalyzeView_Sort_Fifth,Object(ae.a)().AnalyzeView_Sort_Sixth,Object(ae.a)().AnalyzeView_Sort_Seventh,Object(ae.a)().AnalyzeView_Sort_Eighth,Object(ae.a)().AnalyzeView_Sort_Ninth,Object(ae.a)().AnalyzeView_Sort_Tenth],i=Object(ae.a)().AnalyzeView_Chart_Pick,r=[],o=0;o<e;o++)r[o]={label:i.format(n[o]||o+1),data:[]};var s=[],a=t[0].Weight,c=1;Et.forEach(t,(function(t,e){a!==t.Weight&&c++,s.push(c),a=t.Weight,Et.forEach(t.Statistics,(function(n,i){r[i].data[e]=t.Statistics[i]}))}));var u={Type:1,Labels:t.map((function(t){return t.Name})),Data:r,HasLegend:!0,yLabels:s};return oe.createElement(Ja,Object(S.__assign)({},u,{key:"rankingChartControl"}))}},e}(Xa),lc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},n.shouldShowInsightEntryPoint=function(){return!0},e}(Ya),hc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.createQuestionTitleContent=function(){return oe.createElement(ic,{AggregationMaster:this.props.AggregationMaster})},n.shouldShowInsightEntryPoint=function(){return!0},e}(ec);function fc(t,e){var n=e+t.AggregationMaster.QuestionType,i=function(t,e){if(t===Cs.Survey)switch(e){case"Question.NPS":return cc;case"Question.FileUpload":return sc;case"Question.TextField":return hc;case"Question.MatrixChoiceGroup":return ac;case"Question.Rating":return lc;case"Question.Choice":return rc;case"Question.DateTime":return oc;case"Question.Ranking":return uc}else if(t===Cs.Quiz)switch(e){case"Question.NPS":return Ka;case"Question.FileUpload":return _a;case"Question.TextField":return nc;case"Question.MatrixChoiceGroup":return qa;case"Question.Rating":return tc;case"Question.Choice":return La;case"Question.DateTime":return Ea;case"Question.Ranking":return Za}}(e,t.AggregationMaster.QuestionType);if(i)return t.key=t.key||t.AggregationMaster.Model.QuestionId,oe.createElement(i,t);throw Error('Type "'+n+'" has not been registered.')}var dc=function(t){function e(e){var n=t.call(this,e)||this;return n.kN=function(){n.isComponentMounted&&n.forceUpdate()},n.QI=function(){var t=null,e=n.props.FormMaster.Model.PermissionTokens;if(e.length>0){var i=Et.filter(e,(function(t){return"AnalyzerToken"===t.Type&&t.Name===Object(Pe.a)()}))[0];if(i)Wt.a.getObjectMasterFromModel(i).Synchronizer.existingInDataSource().then((function(){t=e[0].PrincipalId,n.setState({ShareResultToken:t})}))}else n.setState({ShareResultToken:t})},n.VI=n.VI.bind(n),n.zI=n.zI.bind(n),n.OS=n.OS.bind(n),n.UI=n.UI.bind(n),n.$I=n.$I.bind(n),n.WI=n.WI.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.initialize(),this.registerObservers(),this.KI(),this.props.FormMaster.observe(this.VI,[Zt.a.Schema.ReputationTier]),Object(Y.c)("PersonalContextInsight")&&this.formInsightMaster.observe(this.$I,[Zs.a.Schema.IsReady])},n.render=function(){var t=Object(v.u)()&&this.state.DetailDialogQuestionIndex>=0;return oe.createElement("div",{className:"analyze-view-container",id:"analyzeViewPrintContainer",role:"main"},this.Fh(),this.JI(),this.createOpenInExcelThrottleDialog(),this.createQuestionDetailDialog(),t&&this.XI(),this.createInsightViewContainer(),this.ZI(),oe.createElement(es.a,{ThemeMaster:this.props.FormMaster.ThemeMaster}))},n.componentDidMount=function(){var t,e,n=this;if(this.isComponentMounted=!0,this.YI(),t=Object(rt.b)()-hn(),an=t,this.props.FormMaster.SyncContext===ro.a.DesignTimeForm)Object(g.b)("DesignPage.Responses.Navigate"),(e=this.props.FormMaster,e.Synchronizer.existingInDataSource().then((function(){var t=ea(e);if(!t)return null;var n=Object(Ys.b)(t);return n?n.Synchronizer.existingInDataSource().then((function(){return n.Model.PrincipalId})):void 0}))).then((function(t){n.setState({ShareResultToken:t})})).catch((function(){n.setState({ShareResultToken:null})}));else if(this.props.FormMaster.SyncContext!==ro.a.AnalysisTimeForm){var i="Fatal Error: AnalyzeViewBase.componentDidMount SyncContext: ["+this.props.FormMaster.SyncContext+"] shouldn't come to analyize view";throw Object(g.c)("InvalidServerAggregatePayload",i),Error(i)}Object(Xs.b)(this.props.FormMaster)},n.componentDidUpdate=function(){this.YI(),window.setTimeout(Xs.a,0)},n.componentWillUnmount=function(){this.unregisterObservers(),this.formAggregationMaster&&(this.formAggregationMaster.terminateSync(),this.formAggregationMaster.release()),this.props.FormMaster.unobserve(this.VI),Object(Y.c)("PersonalContextInsight")&&this.formInsightMaster.unobserve(this.$I)},n.initialize=function(){this.formAggregationMaster=new ha(this.props.FormMaster),Object(Y.c)("PersonalContextInsight")&&(this.formInsightMaster=new Zs.a(this.props.FormMaster),this.props.FormMaster.SyncContext!==ro.a.AnalysisTimeForm&&this.formInsightMaster.loadInsight("CachedInsights"))},n.registerObservers=function(){if(this.formAggregationMaster.observe(this.kN,[ha.Schema.SummaryAggregation]),this.props.FormMaster.SyncContext!==ro.a.AnalysisTimeForm){var t=Wt.a.getCollectionMasterFromModel(this.props.FormMaster.Model.PermissionTokens);t.observe(this.QI,[t.Schema[0].PrincipalId])}},n.unregisterObservers=function(){this.formAggregationMaster&&this.formAggregationMaster.unobserve(this.kN),this.props.FormMaster.SyncContext!==ro.a.AnalysisTimeForm&&Wt.a.getCollectionMasterFromModel(this.props.FormMaster.Model.PermissionTokens).unobserve(this.QI)},n.KI=function(){var t=this;Promise.all([Object(An.a)("DataTables"),Object(An.a)("Chart"),Object(An.a)("D3")]).then((function(){t.setState({LibraryLoaded:!0})}))},Object.defineProperty(n,"SummaryPanelProps",{get:function(){var t,e=this;return this.tC()&&(t=function(){return e.eC()}),{AggregationMaster:aa(this.formAggregationMaster.Model.SummaryAggregation),Form:this.props.FormMaster,onDeleteResponses:function(){return e.nC()},onExportExcel:t,onPrint:function(){return e.iC()},onCreatePermissionToken:function(){return e.rC()},onDeletePermissionToken:function(){return e.oC()},PermissionToken:this.state.ShareResultToken}},enumerable:!1,configurable:!0}),n.createInsightViewContainer=function(){return null},Object.defineProperty(n,"FocusRef",{set:function(t){this.sC=t},enumerable:!1,configurable:!0}),n.JI=function(){var t=this;return Object(at.c)((function(){return oe.createElement("div",{className:"analyze-view-content",id:"analyzeViewPrintChildContainer"},t.aC(),t.createSummaryPanel(),t.Yr(),t.createOpenInExcelThrottleMessage(),t.cC())}),at.f)},n.XI=function(){var t=this.props.FormMaster,e=this.state.DetailDialogQuestionIndex,n=t.FormElementManager.TopQuestionMasters[e];return h.a.Resolve("IMobileDesignPageUXFactory").createMobileResponseDetailPage({FormId:t.Model.Id,onBack:this.zI,QuestionId:n.Model.Id,QuestionOrder:e+1,QuestionType:n.Model.Type,ResponseCount:t.Model.ResponsesCount,FormAggregationMaster:this.formAggregationMaster})},n.aC=function(){return!Object(v.u)()&&oe.createElement("div",{className:"analyze-view-formname"},this.props.FormMaster.Model.Title)},n.Fh=function(){if((Object(b.e)()||!Object(M.f)())&&!this.props.isDesignTimeView)return oe.createElement(Mo.a,{FormMaster:this.props.FormMaster,HTMLAttributes:{className:"analyze-view-dataclassification-label"},DesignTimeView:this.props.isDesignTimeView})},n.Yr=function(){var t;if(Object(v.u)()||(t=this.uC()),this.formAggregationMaster.FormMaster.SyncContext!==ro.a.AnalysisTimeForm)return oe.createElement("div",{className:"analyze-view-nav-bar"},this.createExtensionReviewContent(),t)},n.OS=function(t){this.setState({ShowExcelThrottleDialog:t})},n.createOpenInExcelThrottleDialog=function(){return function(t){switch(t.throttleDialogType){case 2:case 1:return oe.createElement(ma,Object(S.__assign)({},t));default:return null}}({throttleDialogType:this.state.ShowExcelThrottleDialog,showExcelThrottleDialog:this.OS})},n.createOpenInExcelThrottleMessage=function(){var t,e={throttleDialogType:this.state.ShowExcelThrottleDialog,showExcelThrottleDialog:this.OS};return 3===(t=e).throttleDialogType?oe.createElement(ma,Object(S.__assign)({},t)):null},n.uC=function(){return oe.createElement("div",{className:"analyze-view-export-to-excel-button"},oe.createElement(ba,{Form:this.formAggregationMaster.FormMaster,showExcelThrottleDialog:this.OS}))},n.cC=function(){if(this.state.LibraryLoaded)return oe.createElement("div",{className:"analyze-view-detail-content"},this.lC(),this.hC())},n.lC=function(){return this.props.FormMaster.Model.ResponsesCount>0?this.fC():null},n.fC=function(){var t=this,e=Wt.a.convertToArray(this.formAggregationMaster.Model.QuestionAggregations),n=0;return e.map((function(e,i){var r,o,s=Is(e);if(!(s&&s.QuestionMaster&&s.QuestionMaster.Model.GroupId)){if(t.formAggregationMaster.FormMaster.SyncContext!==ro.a.AnalysisTimeForm){var a=n;r=function(){t.onDetailViewLinkClick(a)},o=function(){t.UI(a)}}return fc({AggregationMaster:s,Index:n++,QuestionViewInsight:{FormInsightMaster:t.formInsightMaster,InsightExploreViewOpened:t.state.InsightExploreViewOpened,InsightExploreViewIndex:t.state.InsightExploreViewIndex,InsightReady:t.state.InsightReady,onClickInsightButton:o,onCloseInsightExploreView:t.WI},onShowQuestionDetail:r},t.QuestionClassType)}}))},n.hC=function(){if(this.props.FormMaster.Model.ResponsesCount>0)return oe.createElement("div",{className:"analyze-view-detail-noresponses-container",key:"empty-questions-view",role:"status"});var t=Object(ae.a)().Analysis_Page_No_Responses_Message;return oe.createElement("div",{className:"analyze-view-detail-noresponses-container",key:"empty-questions-view",role:"status"},oe.createElement("div",{className:"analyze-view-warning-icon"},oe.createElement(Un.a,{IconName:"Sad"})),oe.createElement("div",{className:"analyze-view-detail-noresponse-message","aria-label":t},t),oe.createElement("div",{className:"analyze-view-detail-noresponse-detail"},Object(ae.a)().Analysis_Page_No_Responses_Details))},n.ZI=function(){if(this.state.ShowPhishingWarningMessage&&Object(b.d)()&&this.props.FormMaster.SyncContext===ro.a.DesignTimeForm)return Object(xi.b)({formId:this.props.FormMaster.Model.Id})},n.nC=function(){var t=this;Object(g.b)("DesignPage.Responses.DeleteAllResponses"),this.props.FormMaster.deleteAllResponses().then((function(){Object(Hn.a)("DeleteAllResponses",t.props.FormMaster.Model.Id),t.props.FormMaster.refreshFormResponsesCount()})).catch((function(e){Object(Hn.d)("DeleteAllResponses",e,t.props.FormMaster.Model.Id)}))},n.tC=function(){return!Object(v.u)()&&this.props.FormMaster.SyncContext!==ro.a.AnalysisTimeForm&&this.props.FormMaster.isFieldReady(Zt.a.Schema.XlWorkbookId)&&!!this.props.FormMaster.Model.XlWorkbookId},n.eC=function(){Object(g.b)("DesignPage.Responses.OpenInExcel"),Object(pi.b)(this.props.FormMaster.Model.Id)},n.iC=function(){var t=$("#analyzeViewPrintChildContainer").appendTo($("body")),e=$("#content-root");e.hide(),Object(et.c)((function(){t.appendTo($("#analyzeViewPrintContainer")),e.show()}))},n.rC=function(){var t,e,n,i,r,o=this;return(t=this.props.FormMaster,e="AnalyzerToken",n=Object(Pe.a)(),i=Wt.a.Collection.addItems(t.Model.PermissionTokens,[ta(e,n)]),r=Object(Ys.b)(i[0]),r.Synchronizer.existingInDataSource().then((function(){return r.Model.PrincipalId}))).then((function(t){return Object(g.b)("DesignPage.Share.CreateAnalysisResulttLink"),o.setState({ShareResultToken:t}),t}))},n.oC=function(){var t=this,e=this.props.FormMaster,n=ea(e);n&&function(t,e){if(e)return Wt.a.Collection.deleteItems(t.Model.PermissionTokens,[e]),Object(Ys.b)(e).Synchronizer.deletedFromDataSource().then()}(e,n).then((function(){Object(g.b)("DesignPage.Share.DeleteAnalysisResultLink"),t.setState({ShareResultToken:null})}))},n.onDetailViewLinkClick=function(t){Object(g.b)("DesignPage.Responses.ShowResponsesDetail"),this.setState({DetailDialogQuestionIndex:t})},n.YI=function(){var t=Ln.findDOMNode(this);if($(t).is(":visible")&&!this.dC){var e=Ln.findDOMNode(this.refs[this.sC]);this.sC=void 0,e&&e.focus()}this.dC=$(t).is(":visible")},n.VI=function(){var t=this.props.FormMaster.Model;this.setState({ShowPhishingWarningMessage:Object(Oo.d)(t.ReputationTier)})},n.zI=function(){this.setState({DetailDialogQuestionIndex:-1})},n.$I=function(){this.formInsightMaster.Model.InsightCount>0?this.setState({InsightReady:!0}):this.setState({InsightReady:!1})},n.UI=function(t){this.setState({InsightExploreViewOpened:!0,InsightExploreViewIndex:t})},n.WI=function(){this.setState({InsightExploreViewOpened:!1})},e}(ue.a),bc=n(216),mc=function(){function t(){}t.prototype;return t.isAutogradableQuestion=function(t){var e=Et.some(t.Choices,(function(t){return t.IsAnswerKey})),n="Question.TextField"===t.Type&&!t.Multiline&&new lr.a(t).areAnyAnswersDefined(),i="Question.Ranking"===t.Type&&0!==JSON.parse(t.GradingBasis).length;return t.IsQuiz&&(e||n||i)},t.isCorrectAnswer=function(t,e){return t.Master.isCorrectAnswer(e[t.Field])},t.onDeleteCurrentResponse=function(t,e){Object(g.b)("DesignPage.Responses.DeleteSingleResponse"),t.bulkEdit((function(){t.Model.Responses=Et.without(t.Model.Responses,Et.findWhere(t.Model.Responses,{Id:e}))}))},t}();function vc(t){return oe.createElement(gc,t)}var gc=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.SN=oe.createRef(),e.IN=oe.createRef(),e.CN=oe.createRef(),e.NN=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.SN.current&&this.SN.current.focus(),Object(yr.g)(Ln.findDOMNode(this)),this.TN(),this.xN()},n.shouldComponentUpdate=function(t,e){var n=!Et.isEqual(t,this.props),i=!Et.isEqual(e,this.state);return n||i},n.componentDidUpdate=function(){var t=this,e=this.props.AnalyzeViewData.Questions.filter((function(e){return e.Field===t.props.QuestionId}))[0];this.bC(e).length>0&&(this.TN(),this.xN())},n.componentWillUnmount=function(){},n.render=function(){var t=this;return oe.createElement("div",{className:"response-dialog-container",onKeyDown:function(e){(8===e.keyCode||37===e.keyCode&&e.altKey)&&(e.stopPropagation(),e.preventDefault()),27===e.keyCode&&t.props.closeSelf()}},this.FN(),this.mC(),this.DN())},n.mC=function(){var t=this,e=this.props.AnalyzeViewData,n=e.Questions.filter((function(e){return e.Field===t.props.QuestionId}))[0],i=oe.createElement("div",{className:"response-dialog-title"},Object(ga.b)({Text:Object(ae.a)().AnalyzeView_QuestionTitle.format(n.Index+1,n.Model.Title),RenderMode:"RichText"})),r=this.bC(n),o=oe.createElement("div",{className:"response-dialog-summary"},oe.createElement("div",{className:"response-dialog-response-count office-form-theme-primary-foreground"},r.length),Object(ae.a)().Common_Responses_Text),s=oe.createElement("button",{ref:this.SN,className:"response-dialog-close-button",title:Object(ae.a)().Common_Close_Text,onClick:function(){return t.props.closeSelf()}},Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16"},IconName:"Cancel"})),a={"aria-label":Object(ae.a)().AnalyzeView_Detail_DialogTitle.format(n.Index+1),className:"response-dialog",ref:this.CN,role:"dialog"};if(0===r.length){var c=oe.createElement("div",{className:"response-dialog-no-responses-message"},Object(ae.a)().AnalyzeView_DetailResponses_NoResponses_Message);return oe.createElement("div",a,s,i,o,c)}var u=oe.createElement("div",{className:"response-dialog-content",ref:this.NN},oe.createElement("div",{className:"response-dialog-table-container"},oe.createElement("table",{className:"response-dialog-table hover stripe cell-border"})));"Question.FileUpload"===Et.findWhere(e.Questions,{Field:this.props.QuestionId}).Model.Type&&(o=this.vC(r));var l=oe.createElement("div",{ref:this.IN},s,i,o);return oe.createElement("div",a,l,u)},n.vC=function(t){var e=this;if(t[0][this.props.QuestionId]){var n=Object(Gi.b)({HTMLAttributes:{className:"response-dialog-folder-button office-form-theme-button",onClick:function(){var t=e.props,n=Et.findWhere(t.AnalyzeViewData.Questions,{Field:t.QuestionId}),i=n.Model.FileUploadSPOInfo;i&&i.folderId&&new bc.a(n.Master.Form).getFileFolder(i.folderId).then((function(t){Object(g.b)("DesignPage.Responses.OpenFileFolder"),Object(Rn.a)(t)})).catch((function(t){t&&t.response&&404===t.response.statusCode&&e.setState({ShowErrorMessage:!0})}))}},ButtonStyle:"LightBackground",Text:Object(ae.a)().UploadFile_OpenFolder_Button}),i=this.state.ShowErrorMessage?oe.createElement("div",{className:"response-dialog-folder-button-error-message"},Object(ae.a)().UploadFile_FolderNotExist_ErrorMessage):void 0;return oe.createElement("div",null,oe.createElement("div",{className:"response-dialog-summary"},oe.createElement("div",{className:"response-detail-dialog-container"},oe.createElement("span",{className:"response-dialog-response-count office-form-theme-primary-foreground"},t.length),Object(ae.a)().UploadFile_Files_DetailPage_Subtitle),n),i)}},n.DN=function(){var t=this,e=this.props.AnalyzeViewData.Questions.filter((function(e){return e.Field===t.props.QuestionId}))[0];if(null!=this.props.goToNextModalCallback&&e.Index!==this.props.AnalyzeViewData.Questions.length-1){var n={className:"response-dialog-next-button",title:Object(ae.a)().AnalyzeView_DetailResponses_Next_Button,onClick:this.props.goToNextModalCallback};return Object(yn.a)({HTMLAttributes:n,Icon:"ChevronRight",GlyphButtonStyle:"GlyphOnly",ButtonStyle:"LightBackground"})}},n.FN=function(){var t=this,e=this.props.AnalyzeViewData.Questions.filter((function(e){return e.Field===t.props.QuestionId}))[0];if(null!=this.props.goToPreviousModalCallback&&0!==e.Index)return Object(yn.a)({HTMLAttributes:{className:"response-dialog-previous-button",onClick:this.props.goToPreviousModalCallback},Icon:"ChevronLeft",GlyphButtonStyle:"GlyphOnly",ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_DetailResponses_Previous_Button})},n.qN=function(t,e,n){var i=[Object(ae.a)().AnalyzeView_Sort_First,Object(ae.a)().AnalyzeView_Sort_Second,Object(ae.a)().AnalyzeView_Sort_Third,Object(ae.a)().AnalyzeView_Sort_Fourth,Object(ae.a)().AnalyzeView_Sort_Fifth,Object(ae.a)().AnalyzeView_Sort_Sixth,Object(ae.a)().AnalyzeView_Sort_Seventh,Object(ae.a)().AnalyzeView_Sort_Eighth,Object(ae.a)().AnalyzeView_Sort_Ninth,Object(ae.a)().AnalyzeView_Sort_Tenth],r=[Object(ae.a)().Common_Responses_Text],o=[{title:Object(ae.a)().AnalyzeView_Response_ID},{title:Object(ae.a)().AnalyzeView_ExcelHeader_ResponderName}],s=this.gC(e),a=[],c=60/s+"%";switch(t){case"Question.Ranking":$(".response-dialog-table").addClass("response-dialog-table-ranking"),a=Et.first(i,s);break;case"Question.MatrixChoiceGroup":a=r;for(var u=1;u<s;u++)a.push("");break;case"Question.NPS":a=[Object(ae.a)().AnalyzeView_NPS_Score,Object(ae.a)().AnalyzeView_NPS_Category];break;default:$(".response-dialog-table").removeClass("response-dialog-table-ranking"),a=r}return a=a.map((function(t){return{title:t,width:c}})),n&&a.push({title:Object(ae.a)().AnalyzeView_Quiz_Validation,width:c}),o.concat(a)},n.TN=function(){var t,n=this,i=this.props,r=i.AnalyzeViewData,o=Et.findWhere(r.Questions,{Field:i.QuestionId}),s=mc.isAutogradableQuestion(o.Model);this.OC&&($(".dataTables_wrapper").remove(),$(".response-dialog-table").remove(),$(".response-dialog-table-container").append("<table class='response-dialog-table hover stripe cell-border'></table>"),this.OC.destroy(),this.OC=void 0);var a=this.bC(o).map((function(t){return t.field_responder_name=Object(pn.c)(t.field_responder_name,!0),t}));if("Question.Ranking"===o.Model.Type){var c=this.gC(i.QuestionId),u=o.Model.ChoiceGroup;t=a.map((function(t,e){var i=[];i=[e+1,t.field_responder_name];var r=t[o.Field]||[],a=r.slice(0,Math.min(r.length,c)).sort((function(t,e){return t.answerOrder-e.answerOrder})).map((function(t,e){return s?"<span style='color:"+(u[e].Id===t.id?"#107C10":"#A80000")+"'>"+n.pC(t.displayText)+"</span>":n.pC(t.displayText)}));i=i.concat(a);for(var l=0;l<c-a.length;l++)i.push("");return s&&i.push(o.Master.isCorrectAnswer(t[o.Field])),i}))}else"Question.MatrixChoiceGroup"===o.Model.Type?(t=a.map((function(t,e){var i=[e+1,t.field_responder_name],r=Et.map(o.Master.SubQuestionMasters,(function(e){var i="field_"+e.Model.Id;return t[i]?n.pC(t[i].displayText):""}));return i.concat(r)}))).splice(0,0,["",""].concat(Et.map(o.Master.SubQuestionMasters,(function(t){return n.pC(t.Model.Title)})))):"Question.FileUpload"===o.Model.Type?(t=[],a.forEach((function(e,r){var a="";if(e[i.QuestionId]){var c=JSON.parse(e[i.QuestionId]);if(c.length>0){var u=c,l=[r+1,e.field_responder_name];u.forEach((function(t,e){var i=Object(qe.e)(t.name),r=n.jC(t.name),o=t.link.split('"')[0];e+1!==u.length?a+=i+'<a href="'+o+"\" target='_blank' class='response-dialog-fileName'>"+r+"</a></br>":a+=i+'<a href="'+o+"\" target='_blank' class='response-dialog-fileName'>"+r+"</a>"})),l.push(a),s&&l.push(mc.isCorrectAnswer(o,e)),t.push(l)}}}))):t="Question.NPS"===o.Model.Type?a.map((function(t,e){var n=t[i.QuestionId];return[e+1,t.field_responder_name,n,Object(Cr.b)(n)]})):a.map((function(t,e){var r=[e+1,t.field_responder_name,n.pC(t[i.QuestionId])];return o.Model.IsMathQuiz&&r.push(t[i.QuestionId+"_math"]),s&&r.push(mc.isCorrectAnswer(o,t)),r}));var l=s?1:0;l+=o.Model.IsMathQuiz?1:0,this.OC=$(".response-dialog-table").DataTable({data:s?t.map((function(t){var e=t.slice(0,t.length-l);return e.push(""),e})):t,columns:this.qN(o.Model.Type,i.QuestionId,s),searching:!1,paging:!1,info:!1,autoWidth:!0,rowCallback:function(n,i,r){if(s){var a=t[i[0]-1][t[0].length-1],c=e.createCorrectnessIcon(a),u=$(n).find("td:eq("+(t[0].length-l)+")").get(0);i[i.length-1]=a,Ln.render(c,u)}if(o.Model.IsMathQuiz)if("Question.TextField"===o.Model.Type){var h=t[i[0]-1][t[0].length-l];if(h){var f=$(n).find("td:eq("+(t[0].length-l-1)+")").get(0),d=Object(rr.c)({Formula:i[2]});Ln.render(d,f)}i[t[0].length-1]=h}else if("Question.Choice"===o.Model.Type){var b=i[2];Et.forEach(o.Model.Choices,(function(e){if(b===e.Description){if(e.IsMathOption){var r=$(n).find("td:eq("+(t[0].length-l-1)+")").get(0),o=Object(rr.c)({Formula:i[2]});Ln.render(o,r)}return i[t[0].length-1]=e.IsMathOption,!1}}))}}})},n.xN=function(){var t=$(this.CN.current).height()-$(this.IN.current).outerHeight(!0);$(this.NN.current).outerHeight(t)},n.jC=function(t){return t&&Object(pn.c)(""+t,!0)},n.pC=function(t){return Object(Oa.a)(t)},n.bC=function(t){var e=this.props,n=e.AnalyzeViewData.Answers;e.ShouldIncludeInvalidAnswers||(n=n.filter((function(e){return Js.hasValidAnswer(e,t)})));var i=e.filterResponses;return null!=i&&(n=n.filter(i)),n},e.createCorrectnessIcon=function(t){return t?oe.createElement("div",{title:Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel},oe.createElement("a",{className:"screenReaderVisible"},Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel),Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16 office-form-right-answerkey"},IconName:"CheckMark"})):oe.createElement("div",{title:Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel},oe.createElement("a",{className:"screenReaderVisible"},Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel),Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16 office-form-wrong-answerkey"},IconName:"Cancel"}))},n.gC=function(t){var e=Et.findWhere(this.props.AnalyzeViewData.Questions,{Field:this.props.QuestionId});switch(e.Model.Type){case"Question.Ranking":return e.Model.ChoiceGroup.length||1;case"Question.MatrixChoiceGroup":return e.Master.SubQuestionMasters.length||1;case"Question.NPS":return 2;default:return 1}},e}(ue.a),Oc=n(217),pc=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.statisticsContent=function(){if(this.props.AggregationMaster.isAverageResultEnabled){var e=this.yC(),n=String(e),i={AccessibilityText:Object(ae.a)().AnalyzeView_Average_Score_Explicit.format(n),Data:n,Description:Object(ae.a)().AnalyzeView_Average_Score,Ignorable:!0,IsReady:0===this.props.AggregationMaster.Model.TotalResponseCount||this.IsAggregationReady||this.IsAggregationFailed};return oe.createElement(Aa.a,Object(S.__assign)({},i))}return t.prototype.statisticsContent.call(this)},n.yC=function(){var t=this.props.AggregationMaster;return 0===t.Model.TotalResponseCount?0:this.IsAggregationReady?Number((t.Model.AverageScore||0).toFixed(1)):-1},e}(Oc.a);var jc=function(t){function e(e){var n=t.call(this,e)||this;n.wC=function(t){return n.SC(t)},n.createQuestionDetailDialog.bind(n);var i=n.props.FormMaster.Model;return n.state={IsAnalyzeDataReady:!1,LibraryLoaded:!1,DetailDialogQuestionIndex:-1,ShareResultToken:null,InsightDialogOpened:Object(_t.b)().Model.DataIdeas,InsightExploreViewIndex:-1,InsightExploreViewOpened:!1,InsightReady:!1,InsightType:null,ShowPhishingWarningMessage:Object(Oo.d)(i.ReputationTier),ShowExcelThrottleDialog:0},n.NC=n.NC.bind(n),n.IC=n.IC.bind(n),n.CC=n.CC.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return Object.defineProperty(n,"QuestionClassType",{get:function(){return Cs.Quiz},enumerable:!1,configurable:!0}),n.createSummaryPanel=function(){return t=this.SummaryPanelProps,oe.createElement(pc,Object(S.__assign)({},t));var t},n.registerObservers=function(){t.prototype.registerObservers.call(this),this.props.FormMaster.observe(this.wC,[Zt.a.Schema.ResponsesCount,Zt.a.Schema.Questions])},n.unregisterObservers=function(){t.prototype.unregisterObservers.call(this),this.props.FormMaster.unobserve(this.wC)},n.createExtensionReviewContent=function(){var t=this,e=this.props.FormMaster.Model.ResponsesCount>0,n=this.props.FormMaster.Model.QuizQuestionsCount>0,i=e&&n,r=Object(Gi.b)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:function(){window.ClickReviewAnswersStart=new Date,t.FocusRef="review-answers-button",(Object(Y.c)("RemoveReviewAnswersButtonSync")?Promise.resolve():t.kC()).then((function(){var t=Object(_t.b)();if(t.bulkEdit((function(){t.Model.Grading=ys.ByStudent,t.Model.TopView="Grading_ReviewAnswers"})),!Object(Y.c)("RemoveReviewAnswersButtonSync")){var e=Date.now()-window.ClickReviewAnswersStart.getTime();Object(g.b)("DesignPage.Responses.GradeResults",{Grading_ReviewAnswers_time:e})}}))},disabled:!i},ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_GradingButton_Label,ref:"review-answers-button"}),o=!Object(u.a)().userInfo.IsMsa&&Object(Gi.b)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:function(){Object(g.b)("DesignPage.Responses.ReleaseResults"),t.FocusRef="post-grades-button",t.kC().then((function(){Object(_t.b)().Model.TopView="Grading_PostGrades"}))},disabled:!i},ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_ReleaseResultsButton_Label,ref:"post-grades-button"});return oe.createElement("div",{className:"analyze-view-nav-bar-left-button-container"},r,o)},n.createQuestionDetailDialog=function(){var t=this.state.DetailDialogQuestionIndex,e=Wt.a.convertToArray(Et.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));if(!(t<0)){if(!(t>=e.length))return this.state.IsAnalyzeDataReady?this.mC(t,e):void this.kC();Object(g.c)("UnexpectedDetailQuestionIndex",{index:String(t)})}},n.mC=function(t,e){return vc({QuestionId:"field_"+e[t].Id,AnalyzeViewData:this.TC,goToNextModalCallback:this.NC,goToPreviousModalCallback:this.IC,closeSelf:this.CC})},n.NC=function(){var t=this.state.DetailDialogQuestionIndex,e=Wt.a.convertToArray(Et.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));t>=0&&t<e.length-1&&(Object(g.b)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"NextQuestion"}),this.setState({DetailDialogQuestionIndex:t+1}))},n.IC=function(){var t=this.state.DetailDialogQuestionIndex,e=Wt.a.convertToArray(Et.filter(this.props.FormMaster.Model.Questions,(function(t){return!t.GroupId})));t>0&&t<e.length&&(Object(g.b)("DesignPage.Responses.DetailDialogQuestionNavigate",{entry:"PreviouseQuestion"}),this.setState({DetailDialogQuestionIndex:t-1}))},n.CC=function(){this.setState({DetailDialogQuestionIndex:-1})},n.kC=function(){var t=this,e=Promise.resolve();return this.state.IsAnalyzeDataReady||(e=this.props.FormMaster.syncFormResponses().then((function(){return Js.createAnalyzeViewData(t.props.FormMaster)})).then((function(e){t.TC=e}))),e.then((function(){return t.setState({IsAnalyzeDataReady:!0})}))},n.SC=function(t){var e=t.NewValues.ResponsesCount!=t.OldValues.ResponsesCount,n=!Et.isEqual(t.NewValues.Questions,t.OldValues.Questions);this.setState({IsAnalyzeDataReady:!e&&!n&&!!this.TC})},e}(dc),yc=n(94),wc=function(t){function e(e){var n=t.call(this,e)||this;return n.state={HasTextCompliment:!!n.props.Insight.TextComplimentCluster&&!!n.props.Insight.TextCompliment,HasTextImprovement:!!n.props.Insight.TextImprovementCluster&&!!n.props.Insight.TextImprovement},n}Object(S.__extends)(e,t);var n=e.prototype;return n.updateContent=function(){},n.insightViewDescriptionDetail=function(){return oe.createElement("div",{className:"all-hands-summary-insight-container"},oe.createElement("div",{className:"all-hands-summary-insight-description"},this.xC(),this.FC(),this.PC()))},n.shouldShowSourceQuestions=function(){return!1},n.insightViewSourceQuestions=function(){return null},n.DC=function(t){var e,n,i="",r="";switch(this.props.Insight.MaxRatingScore){case 5:e=2.5,n=3.5;break;case 7:e=3.5,n=5;break;default:e=5,n=7}switch(this.props.Insight.AverageRating>=n?r=Object(ae.a)().All_Hands_Summary_Insight_Title1_High:this.props.Insight.AverageRating<n&&this.props.Insight.AverageRating>e?r=Object(ae.a)().All_Hands_Summary_Insight_Title1_Middle:this.props.Insight.AverageRating<=e&&(r=Object(ae.a)().All_Hands_Summary_Insight_Title1_Low),t){case 0:i=r;break;case 1:i=Object(ae.a)().All_Hands_Summary_Insight_Title2;break;case 2:i=Object(ae.a)().All_Hands_Summary_Insight_Title3}return oe.createElement("div",{className:"all-hands-summary-insight-title","aria-label":i,tabIndex:0},i)},n.xC=function(){return oe.createElement("div",null,this.DC(0),oe.createElement("div",{className:"all-hands-summary-insight-row-container"},oe.createElement("div",{className:"all-hands-summary-insight-row-rating"},oe.createElement("div",{className:"all-hands-summary-insight-icon-and-text-rating"},oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon-rating"},IconName:"People"}),oe.createElement("div",{className:"all-hands-summary-insight-rating-row-number","aria-label":this.props.Insight.TotalResponseCount.toString(),tabIndex:0},this.props.Insight.TotalResponseCount),oe.createElement("div",{className:"all-hands-summary-insight-rating-row-text","aria-label":Object(ae.a)().All_Hands_Summary_Insight_Total_Responses_Title1+Object(ae.a)().All_Hands_Summary_Insight_Total_Responses_Title2,tabIndex:0},Object(ae.a)().All_Hands_Summary_Insight_Total_Responses_Title1,oe.createElement("br",null),Object(ae.a)().All_Hands_Summary_Insight_Total_Responses_Title2)),oe.createElement("div",{className:"all-hands-summary-insight-icon-and-text-rating"},oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon-rating"},IconName:"FavoriteStar"}),oe.createElement("div",{className:"all-hands-summary-insight-rating-row-number","aria-label":this.props.Insight.AverageRating.toString(),tabIndex:0},this.props.Insight.AverageRating.toFixed(1)),oe.createElement("div",{className:"all-hands-summary-insight-rating-row-text","aria-label":Object(ae.a)().All_Hands_Summary_Insight_Average_Rating_Title1+Object(ae.a)().All_Hands_Summary_Insight_Average_Rating_Title2,tabIndex:0},Object(ae.a)().All_Hands_Summary_Insight_Average_Rating_Title1,oe.createElement("br",null),Object(ae.a)().All_Hands_Summary_Insight_Average_Rating_Title2)))))},n.FC=function(){var t=this.props.Insight.LikertComplimentCluster===this.props.Insight.TextComplimentCluster,e=this.MC(3,t),n=this.MC(4,t);if(e||n)return oe.createElement("div",null,this.DC(1),oe.createElement("div",{className:"all-hands-summary-insight-row-container"},e,t?null:n))},n.PC=function(){var t=this.props.Insight.LikertImprovementCluster===this.props.Insight.TextImprovementCluster,e=this.MC(5,t),n=this.MC(6,t);if(e||n)return oe.createElement("div",null,this.DC(2),oe.createElement("div",{className:"all-hands-summary-insight-row-container"},e,t?null:n))},n.MC=function(t,e){var n,i,r,o;switch(t){case 3:n=this.props.Insight.LikertComplimentCluster,i=Object(ae.a)().All_Hands_Summary_Insight_Likert_Compliment_Description.format(this.props.Insight.LikertComplimentCluster),i=Object(pn.i)(i),r="Like",o=!!this.props.Insight.LikertComplimentCluster;break;case 4:n=this.props.Insight.TextComplimentCluster,i=Object(ae.a)().All_Hands_Summary_Insight_Text_Compliment_Description.format(this.props.Insight.TextComplimentCluster),i=Object(pn.i)(i),r="GiftboxOpen",o=this.state.HasTextCompliment;break;case 5:n=this.props.Insight.LikertImprovementCluster,i=Object(ae.a)().All_Hands_Summary_Insight_Likert_Improvement_Description.format(this.props.Insight.LikertImprovementCluster),i=Object(pn.i)(i),r="HintText",o=!!this.props.Insight.LikertImprovementCluster;break;case 6:n=this.props.Insight.TextImprovementCluster,i=Object(ae.a)().All_Hands_Summary_Insight_Text_Improvement_Description.format(this.props.Insight.TextImprovementCluster),i=Object(pn.i)(i),r="Completed",o=this.state.HasTextImprovement}if(e&&3===t?(i=Object(ae.a)().All_Hands_Summary_Insight_Compliment_Same_Description.format(n),i=Object(pn.i)(i)):e&&5===t&&(i=Object(ae.a)().All_Hands_Summary_Insight_Improvement_Same_Description.format(n),i=Object(pn.i)(i)),o)return oe.createElement("div",{className:"all-hands-summary-insight-row"},oe.createElement("div",{className:"all-hands-summary-insight-icon-and-text"},oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size24x24 all-hands-summary-insight-icon"},IconName:r}),oe.createElement("div",{className:"all-hands-summary-insight-row-title","aria-label":n,tabIndex:0},n)),oe.createElement("div",{className:"all-hands-summary-insight-row-description","aria-label":i,tabIndex:0,dangerouslySetInnerHTML:{__html:i}}))},e}(yc.a),Sc=n(244),Nc=function(t){function e(e){var n=t.call(this,e)||this;return n.state={currentQuestion:n.props.Questions[n.props.CurrentInsightIndex],currentQuestionIndex:n.props.CurrentInsightIndex},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.state.currentQuestion,n=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option,i=n.format(e.QuestionOrder,e.Title),r=this.props.Questions.map((function(e){return{Disabled:e.Id===t.state.currentQuestion.Id,DisplayName:n.format(e.QuestionOrder,e.Title),Key:e.QuestionOrder,Value:n.format(e.QuestionOrder,e.Title)}})),o=Object(Pr.b)({DisplayValue:!0,HTMLAttributes:{"aria-label":i,className:"response-sentiment-insight-collection-dropdown"},onValueChange:this.LC,Placeholder:i,SelectOptions:r,Value:i});return oe.createElement("div",{className:"all-hands-rating-distribution-insight-dropdown-container"},oe.createElement("div",{className:"all-hands-rating-distribution-insight-dropdown-title"},Object(ae.a)().All_Hands_Insight_Dropdown_Title),oe.createElement("div",{className:"insight-view-dropdown-element"},o))},n.LC=function(t){var e=this,n=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option;this.props.Questions.forEach((function(i,r){n.format(i.QuestionOrder,i.Title)!==t||e.setState({currentQuestionIndex:r},(function(){e.props.HandleInsightData(e.state.currentQuestionIndex)}))}))},e}(ue.a);function Ic(t){return oe.createElement(Nc,Object(S.__assign)({},t))}var Cc,kc=function(t){function e(e){var n=t.call(this,e)||this;return n.state={CurrentInsight:n.props.Insight.DrivingFactorAnalysisInsights[0],CurrentInsightIndex:0,RatingValue:n.props.Insight.DrivingFactorAnalysisInsights[0].AverageRating,ShowScoreEstimater:!1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.updateContent=function(){},n.shouldShowSourceQuestions=function(){return!1},n.insightViewSourceQuestions=function(){return null},n.insightViewDescriptionDetail=function(){return this.state.ShowScoreEstimater?oe.createElement("div",{className:"driving-factor-insight-container"},this.createDrivingFactorView()):oe.createElement("div",{className:"driving-factor-insight-container"},this.createSummaryView(),this.createTopicList(),this.AC())},n.createSummaryView=function(){var t=this.RC()[0],e=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Summary_Description.format(t);return e=Object(pn.i)(e),oe.createElement("div",{className:"driving-factor-insight-summary-container"},oe.createElement("div",{className:"driving-factor-insight-summary-title-container"},oe.createElement("div",{className:"driving-factor-insight-summary-title"},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Summary_Title.format(t))),oe.createElement("div",{className:"driving-factor-insight-summary-description-container"},oe.createElement("div",{className:"driving-factor-insight-summary-description",dangerouslySetInnerHTML:{__html:e}})))},n.createTopicList=function(){var t=this,e=this.RC(),n=[];return e.forEach((function(e,i){var r=t.state.CurrentInsight.Importance[e];r>.2?n[i]=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_High:r>.1&&r<.2?n[i]=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_Middle:r<.1&&(n[i]=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_Low)})),oe.createElement("div",{className:"driving-factor-insight-topic-list-container"},oe.createElement("div",{className:"driving-factor-insight-topic-list-column-title"},oe.createElement("div",{className:"driving-factor-insight-topic-list-column-topics"},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Topics),oe.createElement("div",{className:"driving-factor-insight-topic-list-column-impact-level"},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level)),oe.createElement("div",{className:"driving-factor-insight-topic-list"},e.map((function(t,e){var i="driving-factor-insight-topic-list-item-topic",r="driving-factor-insight-topic-list-item-impact-level";return n[e]===Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_High&&(i="driving-factor-insight-topic-list-item-topic-highlight",r="driving-factor-insight-topic-list-item-impact-level-highlight"),oe.createElement("div",{className:"driving-factor-insight-topic-list-item",key:e},oe.createElement("div",{className:i},t),oe.createElement("div",{className:r},n[e]))})),oe.createElement("div",{className:"driving-factor-insight-score-estimater-button",onClick:function(){t.setState({ShowScoreEstimater:!0})}},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Score_Estimate)))},n.createDrivingFactorView=function(){var t=this,e=this.RC(),n=this.state.CurrentInsight.InitialPoints,i=this.state.CurrentInsight.Contributions,r=[];return e.forEach((function(e,n){var i=t.state.CurrentInsight.Importance[e];i>.2?r[n]=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_High:i>.1&&i<.2?r[n]=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_Middle:i<.1&&(r[n]=Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Impact_Level_With_Title_Low)})),oe.createElement("div",{className:"driving-factor-insight-score-estimater-container"},oe.createElement("div",{className:"driving-factor-insight-score-estimater-title-container"},this.Ff(),oe.createElement("div",{className:"driving-factor-insight-score-estimater-title"},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Score_Estimater_Title)),oe.createElement("div",{className:"driving-factor-insight-detail-container"},oe.createElement("div",{className:"driving-factor-insight-detail-description-container"},oe.createElement("div",{className:"driving-factor-insight-detail-description"},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Detail_Description),oe.createElement("div",{className:"driving-factor-insight-detail-rating-container"},oe.createElement("div",{className:"driving-factor-insight-detail-rating-title"},Object(ae.a)().All_Hands_Driving_Factor_Analysis_Insight_Detail_Rating_Title),oe.createElement("div",{className:"driving-factor-insight-detail-rating-score"},this.state.RatingValue.toFixed(1)))),oe.createElement("div",{className:"driving-factor-insight-key-influencer-list"},e.map((function(e,o){return oe.createElement("div",{className:"driving-factor-insight-key-influencer-container",key:o},oe.createElement("div",{className:"driving-factor-insight-key-influencer-title-dot"}),oe.createElement("div",{className:"driving-factor-insight-key-influencer-title"},e),oe.createElement("div",{className:"driving-factor-insight-key-influencer-impact-level"},r[o]),oe.createElement("div",{className:"driving-factor-insight-key-influencer-slidebar-container"},oe.createElement("div",{className:"driving-factor-insight-key-influencer-slidebar"},oe.createElement("input",{type:"range",className:"driving-factor-insight-key-influencer-slidebar-slider",min:0,max:i[e].length-1,defaultValue:Math.floor(10*(n[e]-1)).toString(),onChange:function(n){t.EC(o,i[e][parseInt(n.target.value)])}})),oe.createElement("div",{className:"driving-factor-insight-key-influencer-endpoint-left"},t.state.CurrentInsight.EndPoints.m_Item1),oe.createElement("div",{className:"driving-factor-insight-key-influencer-endpoint-right"},t.state.CurrentInsight.EndPoints.m_Item2)))})))))},n.Ff=function(){var t=this,e={ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"driving-factor-insight-score-estimater-back-button",onClick:function(){t.setState({RatingValue:t.state.CurrentInsight.AverageRating,ShowScoreEstimater:!1})}},Icon:"Back",IconClassName:"forms-icon-size18x18"};return Object(yn.a)(e)},n.RC=function(){var t=this,e=Object.keys(this.state.CurrentInsight.InitialPoints);return e.sort((function(e,n){return t.state.CurrentInsight.Importance[e]-t.state.CurrentInsight.Importance[n]})),e.reverse(),e},n.EC=function(t,e){var n=this,i=0,r=this.RC(),o=[];r.forEach((function(t,e){var i=n.state.CurrentInsight.Contributions[t];o[e]=i[Math.floor(10*(n.state.CurrentInsight.InitialPoints[t]-1))]})),o[t]=e,o.forEach((function(t){i+=t})),i+=this.state.CurrentInsight.AverageRating,this.setState({RatingValue:i})},n.BC=function(t){var e=this;this.setState({CurrentInsight:this.props.Insight.DrivingFactorAnalysisInsights[t],CurrentInsightIndex:t},(function(){e.setState({RatingValue:e.state.CurrentInsight.AverageRating})}))},n.AC=function(){return Ic({CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.BC,Questions:this.props.Insight.DrivingFactorAnalysisInsights.map((function(t){return t.LikertQuestion}))})},e}(yc.a),Tc=function(t){function e(e){var n=t.call(this,e)||this;return n.state={CurrentInsight:n.props.Insight.LikertImpactAnalysisInsights[0],CurrentInsightIndex:0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.shouldShowSourceQuestions=function(){return!1},n.insightViewSourceQuestions=function(){return null},n.updateContent=function(){},n.insightViewDescriptionDetail=function(){return oe.createElement("div",{className:"likert-impact-insight-container"},this.createSummaryView(),this._C(),this.AC())},n.createSummaryView=function(){var t,e;return this.props.Insight.Flag?(t=this.state.CurrentInsight.KeyWords?Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Positive_Keyword.format(this.state.CurrentInsight.KeyWords[0]):Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Positive,e=this.state.CurrentInsight.KeyWords?Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Positive_Keyword.format(this.state.CurrentInsight.KeyWords[0]):Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Positive,e=Object(pn.i)(e)):(t=this.state.CurrentInsight.KeyWords?Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Negative_Keyword.format(this.state.CurrentInsight.KeyWords[0]):Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Title_Negative,e=this.state.CurrentInsight.KeyWords?Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Negative_Keyword.format(this.state.CurrentInsight.KeyWords[0]):Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Summary_Description_Negative,e=Object(pn.i)(e)),oe.createElement("div",{className:"likert-impact-insight-summary-container"},oe.createElement("div",{className:"likert-impact-insight-summary-title-container"},oe.createElement("div",{className:"likert-impact-insight-summary-title"},t)),oe.createElement("div",{className:"likert-impact-insight-summary-description-container"},oe.createElement("div",{className:"likert-impact-insight-summary-description",dangerouslySetInnerHTML:{__html:e}})))},n._C=function(){return this.HC(),oe.createElement("div",{className:"likert-impact-insight-chart-container"},this.state.CurrentInsight.LikertStatement.map((function(t,e){var n=Object(ae.a)().All_Hands_Likert_Impact_Analysis_Insight_Chart_Data.format((100*t.m_Item2).toFixed(0)),i="likert-impact-insight-chart-item-dot-hidden",r="likert-impact-insight-chart-item-sentence",o="likert-impact-insight-chart-item-bar",s="likert-impact-insight-chart-item-data-hidden";return e<2&&(i="likert-impact-insight-chart-item-dot",r="likert-impact-insight-chart-item-sentence-highlight",o="likert-impact-insight-chart-item-bar-highlight",s="likert-impact-insight-chart-item-data"),oe.createElement("div",{className:"likert-impact-insight-chart-item",key:e},oe.createElement("div",{className:i}),oe.createElement("div",{className:"likert-impact-insight-chart-item-sentence-container"},oe.createElement("div",{className:r},t.m_Item1)),oe.createElement("div",{className:"likert-impact-insight-chart-item-bar-container",id:"bar-"+e},oe.createElement("div",{className:o})),oe.createElement("div",{className:s},n))})))},n.HC=function(){var t=this,e=this.state.CurrentInsight.LikertStatement[0].m_Item2;setTimeout((function(){t.state.CurrentInsight.LikertStatement.forEach((function(t,n){document.getElementById("bar-"+n).style.width=t.m_Item2/e*220+"px"}))}),100)},n.BC=function(t){this.setState({CurrentInsight:this.props.Insight.LikertImpactAnalysisInsights[t],CurrentInsightIndex:t})},n.AC=function(){return Ic({CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.BC,Questions:this.props.Insight.LikertImpactAnalysisInsights.map((function(t){return t.LikertGroup}))})},e}(yc.a);!function(t){t[t.Positive=0]="Positive",t[t.Neutral=1]="Neutral",t[t.Negative=2]="Negative"}(Cc||(Cc={}));var xc=function(t){function e(e){var n=t.call(this,e)||this;n.GC=n.GC.bind(n);var i=Et.max(n.props.Insight.ResponseSentimentInsights,(function(t){return t.Score}));return n.props.setCurrentViewInsight(i),n.state={ActiveDetail:Cc.Negative,ActiveInsight:i},n}Object(S.__extends)(e,t);var n=e.prototype;return n.updateContent=function(){this.state.ShowSourceDetail&&this.TN()},n.getSourceButtonTitle=function(){return this.state.ShowSourceDetail?Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Hide_Detail:Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Show_Detail},n.insightViewSourceQuestions=function(){return oe.createElement("div",{className:"response-sentiment-insight-detail-container"},oe.createElement("div",{className:"response-sentiment-insight-detail-buttons-container"},this.YN(Cc.Negative),this.YN(Cc.Neutral),this.YN(Cc.Positive)),oe.createElement("div",{className:"response-sentiment-insight-detail-grid-container"},oe.createElement("div",{className:"response-sentiment-insight-detail-grid-wraper"})))},n.insightViewDescriptionDetail=function(){return oe.createElement("div",{className:"response-sentiment-insight-container"},this.Ud(),this.qC(),this.$d())},n.Ud=function(){var t=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Collection_Description;return oe.createElement("div",{className:"insight-description-text-container"},oe.createElement("div",{"aria-label":t,className:"insight-description-text",tabIndex:0},t))},n.qC=function(){var t=this.state.ActiveInsight,e=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option,n=e.format(t.TextQuestion.QuestionOrder,t.TextQuestion.Title),i=this.props.Insight.ResponseSentimentInsights.map((function(n){var i=n.TextQuestion;return{Disabled:n.TextQuestion.Id===t.TextQuestion.Id,DisplayName:e.format(i.QuestionOrder,i.Title),Key:i.QuestionOrder,Value:e.format(i.QuestionOrder,i.Title)}})),r=Object(Pr.b)({DisplayValue:!0,HTMLAttributes:{"aria-label":n,className:"response-sentiment-insight-collection-dropdown"},onValueChange:this.GC,Placeholder:n,SelectOptions:i,Value:n}),o=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Title;return oe.createElement("div",{className:"response-sentiment-insight-dropdown-container"},oe.createElement("div",{className:"response-sentiment-insight-dropdown-title"},o),oe.createElement("div",{className:"insight-view-dropdown-element"},r))},n.$d=function(){if(this.state.ShowSourceDetail)return null;var t=this.state.ActiveInsight,e=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Description.format(t.TextQuestion.QuestionOrder,t.TextQuestion.Title);return oe.createElement("div",{className:"response-sentiment-insight-chart-container"},oe.createElement("div",{"aria-label":e,className:"response-sentiment-insight-chart",tabIndex:0},oe.createElement("div",{className:"response-sentiment-insight-emojis-container"},this.QC(Cc.Negative),this.QC(Cc.Neutral),this.QC(Cc.Positive))))},n.QC=function(t){var n,i,r,o=this.state.ActiveInsight,s=e.getOutstandingSentiments(this.state.ActiveInsight);switch(t){case Cc.Positive:i="Emoji2",n=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Positive,r=o.PositiveResponses.length;break;case Cc.Negative:i="Sad",n=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Negative,r=o.NegativeResponses.length;break;case Cc.Neutral:i="EmojiNeutral",n=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Neutral,r=o.NeutralResponses.length;break;default:return null}var a,c=Object(Un.b)({HTMLAttributes:{className:"response-sentiment-insight-emoji-icon"},IconName:i}),u="response-sentiment-insight-element-emoji",l="response-sentiment-insight-element-title",h="response-sentiment-insight-element-number";return s.indexOf(t)>=0&&(u=Object(pn.b)(u,Cc[t].toLowerCase()),l=Object(pn.b)(l,Cc[t].toLowerCase()),h=Object(pn.b)(h,Cc[t].toLowerCase())),a=1===r?Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Single_Response_Count.format(r):Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Multi_Response_Count.format(r),oe.createElement("div",{className:"response-sentiment-insight-emoji-container"},oe.createElement("div",{className:u},c),oe.createElement("div",{className:l},n),oe.createElement("div",{className:h},a))},n.TN=function(){var t,e=this.state.ActiveInsight;switch(this.state.ActiveDetail){case Cc.Positive:t=e.PositiveResponses;break;case Cc.Negative:t=e.NegativeResponses;break;case Cc.Neutral:t=e.NeutralResponses;break;default:t=new Array}var n=t.map((function(t){return[t.m_Item1,Object(pn.i)(t.m_Item2.RawValue)]}));$(".response-sentiment-insight-detail-grid").remove(),$(".response-sentiment-insight-detail-grid-wraper").append("<table class='response-sentiment-insight-detail-grid hover stripe cell-border'>"),$(".response-sentiment-insight-detail-grid").DataTable({autoWidth:!0,columns:[{title:Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Id},{title:Object(ae.a)().Common_Responses_Text}],data:n,info:!1,paging:!1,searching:!1})},n.YN=function(t){var e,n=this;switch(t){case Cc.Positive:e=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Positive;break;case Cc.Negative:e=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Negative;break;case Cc.Neutral:e=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Neutral;break;default:return null}var i="response-sentiment-insight-detail-button",r="response-sentiment-insight-detail-button-header";t===this.state.ActiveDetail&&(i=Object(pn.b)(i,"selected"),r=Object(pn.b)(r,"selected"));var o={ButtonStyle:"None",HTMLAttributes:{className:i,onClick:function(){Object(g.b)("DesignPage.Responses.ResponseSentimentInsight.SwitchSentiment",{SentimentType:t}),n.setState({ActiveDetail:t})}},Text:e},s=oe.createElement(Gi.a,Object(S.__assign)({},o));return oe.createElement("div",{className:"response-sentiment-insight-detail-button-container"},oe.createElement("div",{className:r}),s)},e.getOutstandingSentiments=function(t){var e=[{SentimentCount:t.NegativeResponses.length,SentimentType:Cc.Negative},{SentimentCount:t.NeutralResponses.length,SentimentType:Cc.Neutral},{SentimentCount:t.PositiveResponses.length,SentimentType:Cc.Positive}],n=Et.max(e,(function(t){return t.SentimentCount}));return e.filter((function(t){return t.SentimentCount===n.SentimentCount})).map((function(t){return t.SentimentType}))},n.GC=function(t){var e=this,n=Object(ae.a)().AnalyzeView_Insight_Response_Sentiment_Dropdown_Option;this.props.Insight.ResponseSentimentInsights.forEach((function(i){var r=i.TextQuestion;if(n.format(r.QuestionOrder,r.Title)===t)return Object(g.b)("DesignPage.Responses.ResponseSentimentInsight.SwitchQuestion",{InsightScore:i.Score,QuestionId:i.TextQuestion.Id,QuestionIndex:i.TextQuestion.QuestionOrder,QuestionSentimentConfidence:i.TextQuestion.SentimentConfidence,QuestionTag:i.TextQuestion.Tag}),e.props.setCurrentViewInsight(i),void e.setState({ActiveInsight:i})}))},e}(yc.a),Fc=function(t){function e(e){var n=t.call(this,e)||this;return n.state={CurrentInsight:n.props.Insight.AllHandsTextClusterInsights[0],CurrentInsightIndex:0,SelectedTopic:"",ShowDetails:!1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.shouldShowSourceQuestions=function(){return!1},n.insightViewSourceQuestions=function(){return null},n.updateContent=function(){},n.insightViewDescriptionDetail=function(){return oe.createElement("div",{className:"all-hands-text-cluster-insight-container"},this.VC(),this.zC())},n.initBar=function(){var t=this,e=this.RC(),n=this.state.CurrentInsight.TextClusters[e[0]].length;setTimeout((function(){e.forEach((function(e,i){document.getElementById("topic-"+i).style.width=t.state.CurrentInsight.TextClusters[e].length/n*313+"px"}))}),100)},n.VC=function(){if(!this.state.ShowDetails)return oe.createElement("div",null,oe.createElement("div",{className:"all-hands-text-cluster-insight-description"},this.UC()),oe.createElement("div",{className:"all-hands-text-cluster-insight-detail"},this.$C()),this.AC())},n.$C=function(){var t=this,e=this.RC();if(this.initBar(),!this.state.ShowDetails)return oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-container"},e.map((function(e,n){var i="all-hands-text-cluster-insight-topic-list-item-bar-item";return n<2&&(i="all-hands-text-cluster-insight-topic-list-item-bar-item-highlight"),oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item",key:n,onClick:function(){t.setState({SelectedTopic:e,ShowDetails:!0})}},oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-title-container"},oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-title"},e)),oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-bar",id:"topic-"+n},oe.createElement("div",{className:i})),oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-list-item-times"},Object(ae.a)().All_Hands_Text_Cluster_Insight_Selected_Topic_times.format(t.state.CurrentInsight.TextClusters[e].length)))})))},n.zC=function(){if(this.state.ShowDetails)return oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-container"},oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-title"},this.Ff(),oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-name"},this.state.SelectedTopic),oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-times"},Object(ae.a)().All_Hands_Text_Cluster_Insight_Selected_Topic_times.format(this.state.CurrentInsight.TextClusters[this.state.SelectedTopic].length))),oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-selected-topic-comment"},oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-all-details"},oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-comment-title"},Object(ae.a)().All_Hands_Text_Cluster_Insight_All_Details_Title),this.state.CurrentInsight.TextClusters[this.state.SelectedTopic].map((function(t,e){return oe.createElement("div",{className:"all-hands-text-cluster-insight-topic-detail-sentence",key:e},Object(ae.a)().All_Hands_Text_Cluster_Insight_Topic_Detail_Text.format(t))})))))},n.Ff=function(){var t=this,e={ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"all-hands-text-cluster-insight-topic-detail-back-button",onClick:function(){t.setState({ShowDetails:!1})}},Icon:"Back",IconClassName:"forms-icon-size18x18"};return Object(yn.a)(e)},n.UC=function(){var t,e=this.RC(),n=this.state.CurrentInsight.TargetQuestion.Tag;if(1===e.length){switch(n){case"NegativeOpinion":t=Object(ae.a)().All_Hands_Text_Cluster_Insight_Title_Single_Negative;break;case"PositiveOpinion":t=Object(ae.a)().All_Hands_Text_Cluster_Insight_Title_Single_Positive;break;case"GeneralOpinion":default:t=Object(ae.a)().All_Hands_Text_Cluster_Insight_Title_Single_General}return t.format(e[0])}switch(n){case"NegativeOpinion":t=Object(ae.a)().All_Hands_Text_Cluster_Insight_Title_Negative;break;case"PositiveOpinion":t=Object(ae.a)().All_Hands_Text_Cluster_Insight_Title_Positive;break;case"GeneralOpinion":default:t=Object(ae.a)().All_Hands_Text_Cluster_Insight_Title_General}return t.format(e[0],e[1])},n.RC=function(){var t=this.state.CurrentInsight.TextClusters,e=Object.keys(t).filter((function(e){return t[e].length>0}));return e.sort((function(e,n){return t[e].length-t[n].length})),e=e.reverse()},n.BC=function(t){var e=this;this.setState({CurrentInsight:this.props.Insight.AllHandsTextClusterInsights[t],CurrentInsightIndex:t},(function(){e.setState({SelectedTopic:e.RC()[0]})}))},n.AC=function(){return Ic({CurrentInsightIndex:this.state.CurrentInsightIndex,HandleInsightData:this.BC,Questions:this.props.Insight.AllHandsTextClusterInsights.map((function(t){return t.TargetQuestion}))})},e}(yc.a);function Pc(t){var e=t.Insight.Type,n=function(t){switch(t){case Zs.b.AssociationRuleInsight:return Sc.a;case Zs.b.AllHandsSummaryInsight:return wc;case Zs.b.DrivingFactorAnalysisInsightCollection:return kc;case Zs.b.LikertImpactAnalysisInsightCollection:return Tc;case Zs.b.ResponseSentimentInsightCollection:return xc;case Zs.b.TextClusterInsight:return Fc}}(e);if(n)return oe.createElement(n,Object(S.__assign)(Object(S.__assign)({},t),{key:t.Index}));throw Error('Type "'+e+'" has not been registered.')}var Dc=function(t){function e(e){var n=t.call(this,e)||this;return n.state={Feedback:0,FeedbackOptions:[]},n.WC=n.WC.bind(n),n.KC=n.KC.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.shouldComponentUpdate=function(t){return this.props.InsightIndex!==t.InsightIndex&&0!==this.state.Feedback&&(this.JC(),this.setState({Feedback:0,FeedbackOptions:[]})),!0},n.componentWillUnmount=function(){0!==this.state.Feedback&&this.JC()},n.render=function(){var t=2===this.state.Feedback?"insight-view-feedback-container expended":"insight-view-feedback-container";return oe.createElement("div",{className:t},this.XC(),this.ZC())},n.ZC=function(){var t=this;if(2!==this.state.Feedback)return null;var e=[{key:"Visual_Not_Intuitive",value:Object(ae.a)().AnalyzeView_Insight_Feedback_Visual_Not_Intuitive},{key:"Description_Not_Clear",value:Object(ae.a)().AnalyzeView_Insight_Feedback_Description_Not_Clear},{key:"Not_Relevant",value:Object(ae.a)().AnalyzeView_Insight_Feedback_Not_Relevant},{key:"Incorrect",value:Object(ae.a)().AnalyzeView_Insight_Feedback_Incorrect},{key:"Not_Meaningful",value:Object(ae.a)().AnalyzeView_Insight_Feedback_Not_Meaningful},{key:"Too_Similar",value:Object(ae.a)().AnalyzeView_Insight_Feedback_Too_Similar}].map((function(e){var n="insight-view-feedback-option";t.state.FeedbackOptions.indexOf(e.key)>=0&&(n=Object(pn.b)(n,"selected"));var i={className:n,tabIndex:0,id:e.key,title:e.value,onClick:t.YC.bind(t),onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||t.YC(e)}};return oe.createElement("span",Object(S.__assign)({},i),e.value)}));return oe.createElement("div",{className:"insight-view-feedback-option-container"},e)},n.XC=function(){var t=Object(pn.b)("insight-view-feedback-button-like",1===this.state.Feedback?"selected":"unselected"),e=Object(pn.b)("insight-view-feedback-button-dislike",2===this.state.Feedback?"selected":"unselected");return oe.createElement("div",{className:"insight-view-feedback-button-container"},oe.createElement("div",{"aria-label":Object(ae.a)().AnalyzeView_Insight_Feedback_Description,className:"insight-view-feedback-description",tabIndex:0},Object(ae.a)().AnalyzeView_Insight_Feedback_Description),this.tk(t,Object(ae.a)().Common_Yes_Text),this.tk(e,Object(ae.a)().Common_No_Text))},n.tk=function(t,e){return Object(Gi.b)({ButtonStyle:"None",HTMLAttributes:{className:t,onClick:this.WC,onKeyDown:this.KC,tabIndex:0},Text:e})},n.WC=function(t){var e=t.currentTarget.className.indexOf("insight-view-feedback-button-like")>=0?1:2;this.ek=this.props.getCurrentViewInsight(),this.setState({Feedback:this.state.Feedback===e?0:e,FeedbackOptions:[]})},n.KC=function(t){if(13===t.keyCode||32===t.keyCode){t.preventDefault(),t.stopPropagation();var e=t.currentTarget.className.indexOf("like")>=0?1:2;this.ek=this.props.getCurrentViewInsight(),this.setState({Feedback:this.state.Feedback===e?0:e,FeedbackOptions:[]})}},n.YC=function(t){var e=this.state.FeedbackOptions,n=t.currentTarget.id;if(e.indexOf(n)>=0){var i=e.indexOf(n);e.splice(i,1)}else e.push(n);this.setState({FeedbackOptions:e})},n.JC=function(){Object(g.b)("DesignPage.Feedback.Insights",{InsightType:this.ek.Type,InsightScore:this.ek.Score,Feedback:this.state.Feedback,FeedbackOptions:this.state.FeedbackOptions})},e}(ue.a);var Mc=function(t){function e(e){var n=t.call(this,e)||this;return n.$I=function(){Object(g.b)("DesignPage.Responses.ShowInsights",{InsightCount:n.nk.Insights.length,InsightTypes:n.nk.Insights.map((function(t){return Zs.b[t.Type]}))}),n.setState({DialogCount:n.nk.Insights.length,InsightReady:n.nk.Model.IsReady})},n.ik=function(){var t=Ln.findDOMNode(n.refs.insightDialog);t&&t.focus()},n.state={DialogCount:0,InsightIndex:0,InsightReady:!1,LibraryLoaded:!1,showAlert:!1},n.rk=n.rk.bind(n),n.ak=n.ak.bind(n),n.nk=new Zs.a(n.props.FormMaster),n.nk.observe(n.$I,[Zs.a.Schema.IsReady]),n.nk.loadInsight(n.props.ShowInsight),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.KI(),this.setState({showAlert:!0}),Object(yr.g)(Ln.findDOMNode(this))},n.componentWillUnmount=function(){this.nk.unobserve(this.$I)},n.render=function(){return oe.createElement("div",{className:"form-insight-container"},oe.createElement("div",{className:"form-insight-frost",role:"presentation"}),this.Vv(),this.ck(),this.zv())},n.KI=function(){var t=this;Object(An.b)(["D3"]).then((function(){t.setState({LibraryLoaded:!0})}))},n.ck=function(){var t={"aria-label":Object(ae.a)().AnalyzeView_Insight_Dialog,className:"form-insight-dialog",ref:"insightDialog",tabIndex:0};if(this.state.InsightReady&&this.state.LibraryLoaded){if(0===this.nk.Insights.length)return oe.createElement("div",Object(S.__assign)({},t),this.lk(),this.qc(),this.hk());var e=null;if(this.state.InsightIndex<this.nk.Insights.length){var n={InsightIndex:this.state.InsightIndex,getCurrentViewInsight:this.ak};e=oe.createElement(Dc,Object(S.__assign)({},n))}return oe.createElement("div",Object(S.__assign)({},t),this.lk(),this.qc(),this.fk(),e,this.au())}return oe.createElement("div",Object(S.__assign)({},t),this.lk(),this.qc(),this.dk())},n.au=function(){var t=this;if(1===this.state.DialogCount)return null;for(var e=[],n=function(n){var r="form-insight-dialog-gallery-dot";r=Object(pn.b)(r,n===i.state.InsightIndex?"active":"inactive");var o={key:n,className:r,tabIndex:0,onClick:function(){t.setState({InsightIndex:n})},onKeyDown:function(e){13!==e.keyCode&&32!==e.keyCode||t.setState({InsightIndex:n})}};e.push(oe.createElement("div",Object(S.__assign)({},o)))},i=this,r=0;r<this.state.DialogCount;r++)n(r);return oe.createElement("div",{className:"form-insight-dialog-gallery"},oe.createElement("div",{className:"form-insight-dialog-gallery-dots-container"},e))},n.dk=function(){var t="";this.state.showAlert&&(t=Object(ae.a)().AnalyzeView_Insight_Loading_Message);return oe.createElement("div",{"aria-live":"polite",className:"form-insight-loading-container"},oe.createElement("div",{className:"form-insight-loading-animation"},oe.createElement("div",{className:"common-spinner-circle"})),oe.createElement("div",{className:"form-insight-loading-message"},t))},n.hk=function(){var t=Object(pn.i)(Object(ae.a)().AnalyzeView_Insight_Default_View_Description),e=Object(ae.a)().AnalyzeView_Insight_Default_View_Title;return oe.createElement("div",{className:"form-insight-default-view-container"},oe.createElement("div",{className:"form-insight-default-img-container"},oe.createElement("div",{className:"form-insight-default-img"},oe.createElement("img",{className:"form-insight-default-image",src:Object(On.b)("/Images/insight/insight_default_pic.png")}))),oe.createElement("div",{className:"form-insight-default-message-container"},oe.createElement("div",{className:"form-insight-default-title",tabIndex:0},e),oe.createElement("div",{className:"form-insight-default-description",dangerouslySetInnerHTML:{__html:t},tabIndex:0})))},n.Vv=function(){var t=this;if(this.state.InsightIndex>0&&this.state.InsightIndex<this.state.DialogCount){var e={HTMLAttributes:{className:"form-insight-dialog-previous-button",onClick:function(){Object(g.b)("DesignPage.Responses.ClickInsightPreviousButton",{InsightCount:t.nk.Insights.length,InsightIndex:t.state.InsightIndex}),t.setState({InsightIndex:t.state.InsightIndex-1})}},Icon:"ChevronLeft",GlyphButtonStyle:"GlyphOnly",ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_Insight_Previous_Insight};return Object(yn.a)(e)}},n.zv=function(){var t=this;if(this.state.InsightIndex>=0&&this.state.InsightIndex<this.state.DialogCount-1){var e={HTMLAttributes:{className:"form-insight-dialog-next-button",onClick:function(){Object(g.b)("DesignPage.Responses.ClickInsightNextButton",{InsightCount:t.nk.Insights.length,InsightIndex:t.state.InsightIndex}),t.setState({InsightIndex:t.state.InsightIndex+1})}},Icon:"ChevronRight",GlyphButtonStyle:"GlyphOnly",ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_Insight_Next_Insight};return oe.createElement("div",{className:"form-insight-head-button"},Object(yn.a)(e))}},n.fk=function(){var t=this.state.InsightIndex,e=this.nk.Insights;if(t>=0&&t<e.length)return Pc({Insight:e[t],Index:t,focusOnInsightDialog:this.ik,setCurrentViewInsight:this.rk})},n.qc=function(){var t={HTMLAttributes:{onClick:this.props.onClose,className:"form-insight-dialog-close-button"},Icon:"Cancel",IconClassName:"forms-icon-size16x16",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(ae.a)().AnalyzeView_Insight_Close_Insight};return Object(yn.a)(t)},n.lk=function(){return oe.createElement("div",{className:"form-insight-preview-label-container"},oe.createElement("div",{className:"form-insight-preview-label"},oe.createElement("div",{className:"form-insight-preview-label-text"},Object(ae.a)().Common_Preview_Text)))},n.rk=function(t){this.bk=t},n.ak=function(){return this.bk},e}(ue.a);var Lc=function(t){function e(e){var n=t.call(this,e)||this;return n.vk=oe.createRef(),n.gk=n.gk.bind(n),n.Ok=n.Ok.bind(n),n.pk=n.pk.bind(n),n.jk=n.jk.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.yk()&&Object(g.b)("DesignPage.Responses.ShowInsightEntryPoint")},n.insightContent=function(){if(!Object(Ht.a)().Flighting.isEnabled_Deprecated("FormInsight")||Object(v.u)())return null;if(this.props.AggregationMaster.FormMaster.SyncContext===ro.a.AnalysisTimeForm)return null;if(!this.yk())return null;var t=Object(ae.a)().AnalyzeView_Ideas_Button,e={HTMLAttributes:{className:"insight-view-summery-button",onClick:this.jk,onKeyDown:this.Ok},ButtonStyle:"None",GlyphButtonStyle:"Vertical",Icon:"LightningBolt",IconClassName:"insight-view-summary-button-icon office-form-theme-primary-foreground",ref:this.vk,Text:t,TextClassName:"insight-view-summary-button-text"};return oe.createElement("div",{className:"analyze-view-summary-table analyze-view-insight-container"},oe.createElement("div",{className:"analyze-view-summary-container"},Object(yn.a)(e)))},n.getAverageTimeProps=function(){return t.prototype.getAverageTimeProps.call(this)},n.gk=function(t){32!==t.keyCode&&13!==t.keyCode||this.props.onClickInsightEntryPoint("TimeDistribution")},n.pk=function(t){this.props.onClickInsightEntryPoint("TimeDistribution")},n.Ok=function(t){32!==t.keyCode&&13!==t.keyCode||this.props.onClickInsightEntryPoint("Insights")},n.jk=function(t){var e=this;this.props.onClickInsightEntryPoint("Insights"),Object(yr.f)("ideas-entry-button",(function(){e.vk&&e.vk.current&&e.vk.current.focus()}))},n.yk=function(){var t=this.props,e=t.Form.Model.Questions;if(!(t.AggregationMaster.Model.TotalResponseCount>=10))return!1;var n=!1;if(Object(Y.c)("IntelligenceScenarioProcess")&&(n=Et.any(e,(function(t){var e=t.QuestionTagForIntelligence;return!!e&&e.indexOf("ScenarioTag")>=0}))),Object(Y.c)("PersonalContextInsight")&&!n)return!1;var i=Et.filter(e,(function(t){return"Question.Rating"===t.Type})).length,r=Et.filter(e,(function(t){return"Question.Choice"===t.Type})).length;return i+r>=4||1===i&&r>=2||n},e}(Oc.a);var Ac=function(t){function e(e){var n=t.call(this,e)||this;n.wk=n.Sk.bind(n);var i=n.props.FormMaster.Model;return n.Nk=n.Nk.bind(n),n.Ik=n.Ik.bind(n),n.state={LibraryLoaded:!1,DetailDialogQuestionIndex:-1,ShareResultToken:null,InsightDialogOpened:Object(_t.b)().Model.DataIdeas,InsightExploreViewIndex:-1,InsightExploreViewOpened:!1,InsightReady:!1,InsightType:null,ShowPhishingWarningMessage:Object(Oo.d)(i.ReputationTier),ShowExcelThrottleDialog:0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.initialize=function(){t.prototype.initialize.call(this),this.Ck=new Ta.a(this.props.FormMaster)},n.registerObservers=function(){t.prototype.registerObservers.call(this),window.addEventListener("message",this.wk,!1)},n.unregisterObservers=function(){t.prototype.unregisterObservers.call(this),window.removeEventListener("message",this.wk)},Object.defineProperty(n,"QuestionClassType",{get:function(){return Cs.Survey},enumerable:!1,configurable:!0}),n.createSummaryPanel=function(){var t,e=this.SummaryPanelProps;return Object(Y.c)("PersonalContextInsight")&&!this.formInsightMaster.isValidFormScenario()?Ca({AggregationMaster:e.AggregationMaster,Form:this.props.FormMaster,InsightMaster:this.formInsightMaster,onDeleteResponses:e.onDeleteResponses,onExportExcel:e.onExportExcel,onPrint:e.onPrint,onCreatePermissionToken:e.onCreatePermissionToken,onDeletePermissionToken:e.onDeletePermissionToken,PermissionToken:e.PermissionToken}):(t={onClickInsightEntryPoint:this.Nk,AggregationMaster:e.AggregationMaster,Form:this.props.FormMaster,onDeleteResponses:e.onDeleteResponses,onExportExcel:e.onExportExcel,onPrint:e.onPrint,onCreatePermissionToken:e.onCreatePermissionToken,onDeletePermissionToken:e.onDeletePermissionToken,PermissionToken:e.PermissionToken},oe.createElement(Lc,Object(S.__assign)({},t)))},n.createQuestionDetailDialog=function(){var t=this;if(!Object(v.u)()&&this.state.DetailDialogQuestionIndex>=0){var e={Index:this.state.DetailDialogQuestionIndex,QuestionDetailMaster:this.Ck,onClose:function(){t.setState({DetailDialogQuestionIndex:-1},(function(){Object(yr.d)(Fa.name)}))},EnableSubmitLanguage:this.props.FormMaster.Model.LocaleList.length>0};return oe.createElement(Fa,Object(S.__assign)({},e))}},n.createExtensionReviewContent=function(){if(!Object(v.u)()){var t=Object(Gi.b)({HTMLAttributes:{className:"analyze-view-nav-button office-form-theme-button",onClick:this.Ik,disabled:0===this.props.FormMaster.Model.ResponsesCount},ButtonStyle:"LightBackground",Text:Object(ae.a)().AnalyzeView_ViewResultsButton_Label,ref:"view-survey-results-button"});return oe.createElement("div",{className:"analyze-view-nav-bar-left-button-container"},t)}},n.onDetailViewLinkClick=function(e){t.prototype.onDetailViewLinkClick.call(this,e),this.Ck=new Ta.a(this.props.FormMaster)},n.createInsightViewContainer=function(){var t,e=this;if(this.state.InsightDialogOpened){var n={FormMaster:this.props.FormMaster,ShowInsight:this.state.InsightType,onClose:function(){return e.Tk()}};return t=n,Object(Ht.a)().Flighting.isEnabled_Deprecated("FormInsight")?oe.createElement(Mc,Object(S.__assign)({},t)):null}},n.xk=function(t){Object(g.b)("DesignPage.Responses.ClickInsightEntryPoint",{InsightType:t}),this.setState({InsightDialogOpened:!0,InsightType:t})},n.Nk=function(t){this.xk(t)},n.Tk=function(){this.setState({InsightDialogOpened:!1}),Object(yr.d)("ideas-entry-button"),Object(_t.b)().Model.DataIdeas=!1},n.Sk=function(t){var e=this,n="string"==typeof t.data?t.data.toLowerCase():"";if(n.startsWith("formreexporterror:")){if(n.indexOf(5117..toString())>=0){this.props.showErrorPage&&this.props.showErrorPage({innerCode:5117})}}else switch(n){case"formreexportsuccess":Rc("formreexportsuccess");break;case"openinexcelreachvmlimitationthrottle":this.setState({ShowExcelThrottleDialog:3}),window.setTimeout((function(){e.setState({ShowExcelThrottleDialog:0})}),5e3),Rc();break;case"openinexcelreachownerlimitationthrottle":this.setState({ShowExcelThrottleDialog:2}),Rc()}},n.Ik=function(){Object(v.u)()?Object(_t.h)().Model.SurveyResults=!0:(Object(g.b)("DesignPage.Responses.ViewResults"),Object(_t.b)().Model.TopView="SurveyResults"),this.FocusRef="view-survey-results-button"},e}(dc);function Rc(t){void 0===t&&(t="");var e=Object(_t.b)().Model.FormMaster;e&&(e.Model.XlExportingLocalTag="","formreexportsuccess"===t&&e.Synchronizer.onSourceDataReceived({xlFileUnSynced:!1}))}var Ec=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this,e=this.props.Form;return Object(at.c)((function(){var n,i=t.props.showErrorPage;return e.SettingMaster.Model.IsQuizMode?function(t){return oe.createElement(jc,Object(S.__assign)({},t))}({FormMaster:e,showErrorPage:i,isDesignTimeView:t.props.isDesignTimeView}):(n={FormMaster:e,showErrorPage:i,isDesignTimeView:t.props.isDesignTimeView},oe.createElement(Ac,Object(S.__assign)({},n)))}),at.f)},e}(ue.a),Bc=function(t){function e(e){var n=t.call(this,e)||this;return n.vl=Object(zi.a)().Model,n.Rw=n.Rw.bind(n),n.Aw=n.Aw.bind(n),n.Fk=n.Fk.bind(n),n.props.Form.observe(n.Fk,[Zt.a.Schema.ResponsesCount]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.Form.unobserve(this.Fk,[Zt.a.Schema.ResponsesCount])},n.render=function(){var t=this.props.Form.Model,e=Object(Oo.d)(t.ReputationTier)&&Object(b.d)(),n=Object(ae.a)().DesignPage_Responses_TextForCount.format(this.props.Form.Model.ResponsesCount);return oe.createElement(js,{DefaultSelectIndex:this.Pk(),onSelectTabChange:this.Rw},oe.createElement(ps,{key:"question-tab-content",TabName:Object(ae.a)().DesignPage_NavBar_ContentLink},this.Dk(oe.createElement(ms,{Form:this.props.Form,ref:this.props.FormDesignerRef}))),this.Mk(e,n))},n.Mk=function(t,e){var n,i=this;return oe.createElement(ps,{ButtonTitle:e,Disabled:t,key:"response-tab-content",NotificationShowedOnTab:this.Lk(),TabName:Object(ae.a)().Common_Responses_Text},this.Dk((n={Form:this.props.Form,isDesignTimeView:!0,showErrorPage:function(t){i.vl.CriticalError=t}},oe.createElement(Ec,Object(S.__assign)({},n)))))},n.Dk=function(t){var e="design-page-scrollable-content office-form-page-padding";return this.props.MalformedBranchingNotification&&(e=Object(pn.b)(e,"body-scrollable-content-with-warning")),oe.createElement("div",{className:e,id:"body-scrollable-content"},oe.createElement("div",{className:"design-content office-form-theme-shadow new-analyze-view-look"},t,!gi()&&$n({Form:this.props.Form})))},n.Lk=function(){var t=this;return Object(at.b)((function(){var e=t.props.Form;if(e.isFieldReady(Zt.a.Schema.ResponsesCount)){var n=e.Model.ResponsesCount;return n>0?oe.createElement("div",{className:"navbar-responses-notification office-form-theme-primary-background"},n):null}}))},n.Fk=function(){this.forceUpdate()},n.Rw=function(t){this.vl.Analysis=0!==t},n.Aw=function(t){return 0===t?!this.vl.Analysis:this.vl.Analysis},n.Pk=function(){return this.vl.Analysis?1:0},e}(ue.a),_c=function(t){function e(e){var n=t.call(this,e)||this;return n.Ak=n.Ak.bind(n),n.vl=Object(_t.b)().Model,n.state={EstiamtionTimeVariation:"undefined"},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(Y.c)("EstimationTimeExp")&&Object(ji.a)().initialize().then((function(e){t.setState({EstiamtionTimeVariation:e.EstimationTimeExperiment})}))},n.render=function(){return oe.createElement("div",{className:"intelligence-notification-container optional-cell"},this.Rk(),this.Ek())},n.Ek=function(){if(Object(Y.c)("ShareAssistant")&&!this.vl.Analysis){if(!Object(Y.c)("EstimationTimeExp"))return Object(Br.a)({Form:this.props.FormMaster});if(Object(ji.a)().activate("EstimationTimeExperiment"),"Treatment"===this.state.EstiamtionTimeVariation)return Object(Br.a)({Form:this.props.FormMaster})}},n.Rk=function(){return Object(Y.c)("PersonalContextSuggestion")&&!this.vl.Analysis?Object(Br.b)({applyTheme:this.Ak,FormMaster:this.props.FormMaster}):null},n.Ak=function(t){this.props.FormMaster.ThemeMaster.Model.Name=t,this.forceUpdate()},e}(ue.a),Hc=function(t){function e(e){var n=t.call(this,e)||this;return n.Bk=n.Bk.bind(n),n.state={display:!0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){if(!this.state.display)return null;var t=Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"phishing-message-button office-form-theme-button",onClick:this.Bk},key:"gotItButton",ref:"gotItButton",Text:Object(ae.a)().TeachingUi_GotIt});return oe.createElement("div",{className:"phishing-message-container"},oe.createElement("div",{className:"phishing-message-content"},oe.createElement("div",{className:"phishing-text-container"},oe.createElement("span",{className:"phishing-warning-message"},Object(ae.a)().Phishing_Form_First_Time_Warning)),t))},n.Bk=function(){this.props.showPhishingTipbarCallback(!0),this.setState({display:!1})},e}(ue.a),Gc=n(142),qc=function(t){function e(e){var n=t.call(this,e)||this;return n.ph=n.ph.bind(n),n.state={UserReputationTier:1,ShowPhishingWarningBar:!0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.Oe=function(){return t.forceUpdate()},this.props.FormMaster.observe(this.Oe,[Zt.a.Schema.NotifiedAdminForApproval])},n.componentDidMount=function(){this._k()},n.conponentWillUnmount=function(){this.props.FormMaster.unobserve(this.Oe)},n.render=function(){var t=this.props.FormMaster,e=t.isFieldReady(Zt.a.Schema.ReputationTier)&&t.Model.ReputationTier,n=this.Hk();if(this.state.ShowPhishingWarningBar&&(Object(Oo.b)(t.Model.ReputationTier)||null!=n)){if(2===this.state.UserReputationTier&&(Date.now()-Date.parse(t.Model.CreatedDate))/1e3<300)return null;var i=n;null==i&&(i=Object(Oo.a)(e,"Design"));var r=Object(Oo.d)(t.Model.ReputationTier);return Object(xi.d)({HrefInfo:Object(ae.a)().TermsLink,Info:i,onClickHref:Qc,onClose:this.ph,ShouldClose:!r,TipBarLocation:"Up",TipBarStyle:r?"RedBackground":"YellowBackground"})}return null},n.Hk=function(){var t=this.props.FormMaster,e=t.isFieldReady(Zt.a.Schema.ReputationTier)&&t.Model.ReputationTier,n=null;if(this.Gk()&&t.Model.Questions.length>0){var i=Wt.a.convertToArray(t.Model.Questions);switch(e){case 3:if(t.Model.NotifiedAdminForApproval)Object(Y.c)("EnableNotifyAdminForApprovalAPI")&&(n=Object(ae.a)().Phishing_Admin_Approval_Request_Sent);else{var r=Object(Me.i)(this.props.FormMaster);this.props.FormMaster.isFieldReady(Zt.a.Schema.Id)&&r.getSuspiciousEvidence(this.props.FormMaster.Model.Id).then((function(t){if(t&&t.id){var e=Et.find(i,(function(e){return e.Id===t.id}));e&&(e.SuspiciousEvidence=1)}}))}break;case 0:t.Model.NotifiedAdminForApproval&&(n=Object(ae.a)().Phishing_Admin_Approval_Request_Approved),i.forEach((function(t){0!==t.SuspiciousEvidence&&(t.SuspiciousEvidence=0)}));break;case 4:i.forEach((function(t){0!==t.SuspiciousEvidence&&(t.SuspiciousEvidence=0)}));break;default:t.Model.NotifiedAdminForApproval&&(t.Model.NotifiedAdminForApproval=!1),i.forEach((function(t){switch(t.SuspiciousEvidence){case 1:case 3:t.SuspiciousEvidence=2}}))}}return n},n.ph=function(){this.setState({ShowPhishingWarningBar:!1})},n.Gk=function(){return 0===this.state.UserReputationTier},n._k=function(){var t=this;Object(Ti.c)().then((function(e){t.setState({UserReputationTier:e})}))},e}(ue.a);function Qc(){var t=Object(u.a)().userInfo.IsMsa?Object(Gc.c)():Object(Gc.b)();Object(Rn.a)(t,"_blank")}function Vc(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"AdditionalLanguage_Button_Text":return n.MultiLingualPane_AdditionalLanguage_Button_Text;case"AdditionalLanguage_Default_Name":return n.MultiLingualPane_AdditionalLanguage_Default_Name;case"AdditionalLanguage_Title":return n.MultiLingualPane_AdditionalLanguage_Title;case"Additional_Language":return n.MultiLingualPane_Additional_Language;case"Cancel_Button":return n.MultiLingualPane_Cancel_Button;case"Cancel_Text":return n.MultiLingualPane_Cancel_Text;case"Continue_Button":return n.MultiLingualPane_Continue_Button;case"Continue_Text":return n.MultiLingualPane_Continue_Text;case"DefalutLanguage_Title":return n.MultiLingualPane_DefalutLanguage_Title;case"Default_Language":return n.MultiLingualPane_Default_Language;case"DeleteLanguage_Warning_Text":return n.MultiLingualPane_DeleteLanguage_Warning_Text;case"DropDown_Language_List":return n.MultiLingualPane_DropDown_Language_List;case"DropDown_Suggestion_Text":return n.MultiLingualPane_DropDown_Suggestion_Text;case"additional_language_delete":return n.MultiLingualPane_additional_language_delete;case"additional_language_download":return n.MultiLingualPane_additional_language_download;case"additional_language_download_error2":return n.MultiLingualPane_additional_language_download_error2;case"additional_language_download_text":return n.MultiLingualPane_additional_language_download_text;case"additional_language_edit":return n.MultiLingualPane_additional_language_edit;case"additional_language_upload":return n.MultiLingualPane_additional_language_upload;case"additional_language_upload_error1":return n.MultiLingualPane_additional_language_upload_error1;case"additional_language_upload_error2":return n.MultiLingualPane_additional_language_upload_error2;case"additional_language_upload_text":return n.MultiLingualPane_additional_language_upload_text;case"af":return n.MultiLingualPane_af;case"am_et":return n.MultiLingualPane_am_et;case"ar":return n.MultiLingualPane_ar;case"as_in":return n.MultiLingualPane_as_in;case"az_latn_az":return n.MultiLingualPane_az_latn_az;case"be":return n.MultiLingualPane_be;case"bg":return n.MultiLingualPane_bg;case"bn_bd":return n.MultiLingualPane_bn_bd;case"bn_in":return n.MultiLingualPane_bn_in;case"bs_latn_ba":return n.MultiLingualPane_bs_latn_ba;case"ca":return n.MultiLingualPane_ca;case"ca_es_valencia":return n.MultiLingualPane_ca_es_valencia;case"cs":return n.MultiLingualPane_cs;case"cy_gb":return n.MultiLingualPane_cy_gb;case"da":return n.MultiLingualPane_da;case"de":return n.MultiLingualPane_de;case"editall_download_generic_error_text":return n.MultiLingualPane_editall_download_generic_error_text;case"editall_download_overwrite_error_text":return n.MultiLingualPane_editall_download_overwrite_error_text;case"editall_download_success_text":return n.MultiLingualPane_editall_download_success_text;case"editall_download_text":return n.MultiLingualPane_editall_download_text;case"editall_upload_cancelbutton_tooltip":return n.MultiLingualPane_editall_upload_cancelbutton_tooltip;case"editall_upload_differentstrings_error":return n.MultiLingualPane_editall_upload_differentstrings_error;case"editall_upload_emptycells_error":return n.MultiLingualPane_editall_upload_emptycells_error;case"editall_upload_generic_error1_text":return n.MultiLingualPane_editall_upload_generic_error1_text;case"editall_upload_generic_error2_text":return n.MultiLingualPane_editall_upload_generic_error2_text;case"editall_upload_insufficientlanguages_error":return n.MultiLingualPane_editall_upload_insufficientlanguages_error;case"editall_upload_retrybutton_tooltip":return n.MultiLingualPane_editall_upload_retrybutton_tooltip;case"editall_upload_success_text":return n.MultiLingualPane_editall_upload_success_text;case"editall_upload_unsupportedfile_error":return n.MultiLingualPane_editall_upload_unsupportedfile_error;case"el":return n.MultiLingualPane_el;case"en_gb":return n.MultiLingualPane_en_gb;case"en_us":return n.MultiLingualPane_en_us;case"es":return n.MultiLingualPane_es;case"es_ES":return n.MultiLingualPane_es_ES;case"es_mx":return n.MultiLingualPane_es_mx;case"et":return n.MultiLingualPane_et;case"eu":return n.MultiLingualPane_eu;case"fa":return n.MultiLingualPane_fa;case"fi":return n.MultiLingualPane_fi;case"fil_ph":return n.MultiLingualPane_fil_ph;case"fr":return n.MultiLingualPane_fr;case"fr_FR":return n.MultiLingualPane_fr_FR;case"fr_ca":return n.MultiLingualPane_fr_ca;case"ga_ie":return n.MultiLingualPane_ga_ie;case"gd":return n.MultiLingualPane_gd;case"gl":return n.MultiLingualPane_gl;case"gu":return n.MultiLingualPane_gu;case"ha_latn_ng":return n.MultiLingualPane_ha_latn_ng;case"he":return n.MultiLingualPane_he;case"hi":return n.MultiLingualPane_hi;case"hr":return n.MultiLingualPane_hr;case"hu":return n.MultiLingualPane_hu;case"hy":return n.MultiLingualPane_hy;case"id":return n.MultiLingualPane_id;case"is":return n.MultiLingualPane_is;case"it":return n.MultiLingualPane_it;case"ja":return n.MultiLingualPane_ja;case"ka":return n.MultiLingualPane_ka;case"kk":return n.MultiLingualPane_kk;case"km_kh":return n.MultiLingualPane_km_kh;case"kn":return n.MultiLingualPane_kn;case"ko":return n.MultiLingualPane_ko;case"kok":return n.MultiLingualPane_kok;case"ky":return n.MultiLingualPane_ky;case"lb_lu":return n.MultiLingualPane_lb_lu;case"lo":return n.MultiLingualPane_lo;case"lt":return n.MultiLingualPane_lt;case"lv":return n.MultiLingualPane_lv;case"mi_nz":return n.MultiLingualPane_mi_nz;case"mk":return n.MultiLingualPane_mk;case"ml":return n.MultiLingualPane_ml;case"mn":return n.MultiLingualPane_mn;case"mr":return n.MultiLingualPane_mr;case"ms":return n.MultiLingualPane_ms;case"mt_mt":return n.MultiLingualPane_mt_mt;case"nb_no":return n.MultiLingualPane_nb_no;case"ne_np":return n.MultiLingualPane_ne_np;case"nl":return n.MultiLingualPane_nl;case"nn_no":return n.MultiLingualPane_nn_no;case"or_in":return n.MultiLingualPane_or_in;case"pa":return n.MultiLingualPane_pa;case"pl":return n.MultiLingualPane_pl;case"prs_af":return n.MultiLingualPane_prs_af;case"pt_br":return n.MultiLingualPane_pt_br;case"pt_pt":return n.MultiLingualPane_pt_pt;case"quz_pe":return n.MultiLingualPane_quz_pe;case"ro":return n.MultiLingualPane_ro;case"ru":return n.MultiLingualPane_ru;case"sd_arab_pk":return n.MultiLingualPane_sd_arab_pk;case"select_placeholder":return n.MultiLingualPane_select_placeholder;case"si_lk":return n.MultiLingualPane_si_lk;case"sk":return n.MultiLingualPane_sk;case"sl":return n.MultiLingualPane_sl;case"sq":return n.MultiLingualPane_sq;case"sr_cyrl_ba":return n.MultiLingualPane_sr_cyrl_ba;case"sr_cyrl_rs":return n.MultiLingualPane_sr_cyrl_rs;case"sr_latn_rs":return n.MultiLingualPane_sr_latn_rs;case"sv":return n.MultiLingualPane_sv;case"sw":return n.MultiLingualPane_sw;case"ta":return n.MultiLingualPane_ta;case"te":return n.MultiLingualPane_te;case"th":return n.MultiLingualPane_th;case"tk_tm":return n.MultiLingualPane_tk_tm;case"tr":return n.MultiLingualPane_tr;case"tt":return n.MultiLingualPane_tt;case"ug":return n.MultiLingualPane_ug;case"uk":return n.MultiLingualPane_uk;case"ur":return n.MultiLingualPane_ur;case"uz_latn_uz":return n.MultiLingualPane_uz_latn_uz;case"vi":return n.MultiLingualPane_vi;case"zh_Hans":return n.MultiLingualPane_zh_Hans;case"zh_Hant":return n.MultiLingualPane_zh_Hant;case"zh_cn":return n.MultiLingualPane_zh_cn;case"zh_hk":return n.MultiLingualPane_zh_hk;case"zh_tw":return n.MultiLingualPane_zh_tw;default:return""}}var zc=n(116),Uc=function(t){function e(n){var i=t.call(this,n)||this;i.qk=oe.createRef(),i.Qk=oe.createRef(),i.tn=oe.createRef(),i.Vk=oe.createRef(),i.Ze=Et.uniqueId(e.name);var r,o=n.Value;return o&&(r=Et.find(i.props.SelectOptions,(function(t){return t.Value===o}))),i.state={Expanded:!1,InputValue:r&&r.DisplayName||"",SelectedIndex:-1},i.xt=i.xt.bind(i),i.nn=i.nn.bind(i),i.zk=i.zk.bind(i),i.bO=i.bO.bind(i),i.en=i.en.bind(i),i}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){if(this.state.Expanded){this.an();var t=this.state.SelectedIndex;if(t>-1){var e=this.Vk.current;e&&e.children[t].focus()}}if(this.Uk){var n=this.qk.current;n&&n.select(),this.Uk=!1}},n.render=function(){var t=Et.extend({},this.props.HTMLAttributes),e=this.in().length,n=Object(pn.g)(t,{className:"suggestion-select-control",id:this.Ze,onBlur:this.en,onKeyDown:this.nn,ref:this.tn,tabIndex:-1});return oe.createElement("div",Object(S.__assign)({},n),this.un(),oe.createElement("div",{className:"suggestion-select-suggest-option-container",ref:this.Qk},this.$k(),this.ln()),oe.createElement("div",{className:"suggestion-search-hint","aria-live":"polite"},oe.createElement("div",null,Object(ae.a)().Suggestion_Select_Search_Result_Count.format(e))))},n.un=function(){var t=this.state.InputValue||"";return oe.createElement("div",{className:"suggestion-select-placeholder"},oe.createElement("input",{"aria-expanded":this.state.Expanded,"aria-label":this.props.SearchBoxLabel,autoComplete:"off",autoFocus:!0,className:"suggestion-select-placeholder-text default",onChange:this.xt,onFocus:this.bO,placeholder:this.props.Placeholder,value:t,ref:this.qk,role:"combobox"}))},n.ln=function(){var t=this,e=this.in();if(this.state.Expanded&&e)return oe.createElement("ul",{className:"suggestion-select-option-menu-options",ref:this.Vk,role:"listbox"},e.map((function(e){return t.On(e)})))},n.$k=function(){var t=this.props,e=this.state.InputValue?t.SuggestionText:t.optionListName;if(this.state.Expanded&&e)return oe.createElement("div",{className:"suggestion-select-suggest-content"},e)},n.On=function(t){var e={"aria-disabled":t.Disabled,className:"suggestion-select-option","data-option-name":t.DisplayName,"data-option-value":t.Value,key:t.Key,role:"option",tabIndex:-1};t.Disabled?e.className=Object(pn.b)(e.className,"disabled"):e.onClick=this.zk;var n=t.SecondText,i=n&&oe.createElement("div",{className:"suggestion-select-option-second-content"},n);return oe.createElement("li",Object(S.__assign)({},e),oe.createElement("div",{className:"suggestion-select-option-content"},t.DisplayName),i)},n.in=function(){var t=this.state.InputValue||"",e=this.props.SelectOptions,n=t.toLocaleLowerCase();return Et.filter(e,(function(t){var e=t.SecondText;return t.DisplayName.toLowerCase().indexOf(n)>-1||!!e&&e.toLocaleLowerCase().indexOf(n)>-1}))},n.nn=function(t){switch(t.keyCode){case 38:case 40:38===t.keyCode?this.pn():this.jn(),t.preventDefault();break;case 13:this.zk(t),t.stopPropagation(),t.preventDefault()}},n.pn=function(){for(var t=this.state.SelectedIndex,e=this.in();t>0;){if(!e[--t].Disabled){this.setState({SelectedIndex:t});break}}},n.jn=function(){for(var t=this.state.SelectedIndex,e=this.in();t<e.length-1;){if(!e[++t].Disabled){this.setState({SelectedIndex:t});break}}},n.bO=function(t){this.Uk=!0,this.setState({Expanded:!this.state.Expanded,SelectedIndex:-1})},n.en=function(t){var e=this.tn.current,n=Object(pn.d)(t),i=this.props.Value,r=Et.find(this.props.SelectOptions,(function(t){return t.Value===i})),o=r&&r.DisplayName;if(!e||!e.contains(n)){var s=this.props.onBlur;s&&s(t),this.Uk=!1,this.setState({Expanded:!1,InputValue:o,SelectedIndex:-1})}},n.zk=function(t){var e=t.target,n=t.currentTarget,i=e.dataset.optionValue||n.dataset.optionValue,r=e.dataset.optionName||n.dataset.optionName;i&&this.props.Value!==i&&this.props.onValueChange(i),this.Uk=!0,this.setState({Expanded:!0,InputValue:r,SelectedIndex:-1})},n.xt=function(t){var e=t.target.value;this.setState({InputValue:e,Expanded:!0})},n.an=function(){var t=document.getElementById(this.Ze);if(t){var e=t.offsetWidth,n=this.Qk.current;if(!n)return;n.offsetWidth<e&&(n.style.width=e+"px")}},e}(ue.a),$c=function(t){function e(e){var n=t.call(this,e)||this;return n.Wk=oe.createRef(),n.Kk=!0,n.Uj=new Lo(n,n.props.DesignFocus,n.props.LocaleId,n.props.AutoFocus),n.state={InDesignMode:n.Uj.Grabber.currentlyOwning(),ShowConfirmDialog:!1},n.bO=n.bO.bind(n),n.en=n.en.bind(n),n.nn=n.nn.bind(n),n.Jk=n.Jk.bind(n),n.Xk=n.Xk.bind(n),n.Zk=n.Zk.bind(n),n.Yk=n.Yk.bind(n),n.tT=n.tT.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this.Wk.current;t&&t.focus()},n.componentWillUnmount=function(){this.Uj.release()},n.componentDidUpdate=function(){if(this.state.InDesignMode){var t=this.Wk.current;t&&this.Kk&&t.focus()}},n.render=function(){if(this.state.ShowConfirmDialog)return this.Ee();var t=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"multi-lingual-edition-button edition-delete-button",onClick:this.Jk},Icon:"Edit",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().MultiLingualPane_additional_language_edit}),e=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"multi-lingual-delete-button edition-delete-button",onClick:this.Xk},Icon:"Delete",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().MultiLingualPane_additional_language_delete}),n={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":this.props.LocaleName,className:"multi-lingual-additional-language-button",onBlur:this.en,onClick:this.Jk,onFocus:this.bO,onKeyDown:this.nn},Text:this.props.LocaleName,ref:this.Wk},i=this.state.InDesignMode&&"multi-lingual-additional-language-selected";return oe.createElement("div",{className:"multi-lingual-additional-language-edition "+i},oe.createElement(Gi.a,Object(S.__assign)({},n)),t,e)},n.en=function(t){var e=t.currentTarget.parentElement,n=Object(pn.d)(t);e&&n&&e.contains(n)||this.Uj.Grabber.handsOff()},n.bO=function(t){var e=t.currentTarget,n=Object(pn.d)(t);e&&n&&e.contains(n)?this.Kk=!1:this.Kk=!0,this.Uj.Grabber.grab()},n.nn=function(t){var e,n=this.props.Length,i=this.props.Index+n,r=this.props.Form.Model.LocaleList;switch(t.keyCode){case 38:this.Uj.Grabber.handsOff(),e=r[--i%n].localeId;break;case 40:this.Uj.Grabber.handsOff(),e=r[++i%n].localeId;break;case 13:return t.preventDefault(),void this.Jk()}e&&this.props.setFocusOnLanguageItem(e),this.Kk=!0},n.Jk=function(){Object(g.b)("DesignPage.Flex.MultiLingual.EditLanguage");var t=this.props.LocaleId;this.props.enterLanguageEditionView(t)},n.Xk=function(t){t.stopPropagation(),this.setState({ShowConfirmDialog:!0})},n.Ee=function(){var t={ButtonsProps:[{ClassName:"multi-lingual-delete-continue-button",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:this.Yk,Text:Object(ae.a)().Common_Cancel_Text,Title:Object(ae.a)().MultiLingualPane_Cancel_Text},{ClassName:"multi-lingual-delete-continue-button",ConveyDescription:!0,GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:this.Zk,Text:Object(ae.a)().Common_Yes_Text,Title:Object(ae.a)().MultiLingualPane_Continue_Text}],ClassName:"multi-lingaul-confirm-dialog",Description:Object(ae.a)().MultiLingualPane_DeleteLanguage_Warning_Text,key:"deleteConfirmDialog",onBlur:this.tT,ShowDialog:!0};return Object(ce.b)(t)},n.Zk=function(t){Object(g.b)("DesignPage.Flex.MultiLingual.DeleteLanguage");var e=this.props,n=e.Form,i=n.Model.LocaleList,r=this.props.LocaleId;if(r){if(e.Index<e.Length-1){var o=i[e.Index+1].localeId;o&&e.setFocusOnLanguageItem(o)}else Object(yr.c)(t.currentTarget);n.deleteLocale(r)}},n.Yk=function(){this.Kk=!0,this.setState({ShowConfirmDialog:!1})},n.tT=function(){this.setState({ShowConfirmDialog:!1}),this.Uj.Grabber.handsOff()},e}(ue.a),Wc=function(t){function e(e){var n=t.call(this,e)||this;n.eT=Object(zc.d)(),n.hw=new Ui,n.Oe=function(){return n.forceUpdate()};var i=n.props.Form;if(!i.Model.DefaultLanguage){var r=Object(zc.a)(Object(u.a)().cultureInfo.Name.toLowerCase()),o=n.eT[r];i.Model.DefaultLanguage=o?r:Object(zc.b)()}return i.observe(n.Oe,[Zt.a.Schema.DefaultLanguage,Zt.a.Schema.LocaleList,Zt.a.Schema.LocaleList[0].localeName]),n.nT=n.nT.bind(n),n.iT=n.iT.bind(n),n.gO=n.gO.bind(n),n.rT=n.rT.bind(n),n.en=n.en.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.Form.unobserve(this.Oe)},n.render=function(){var t=this.props.Form.Model,e=t.DefaultLanguage,n=t.LocaleList,i={};e&&(i[e]=!0),Et.forEach(n,(function(t){var e=t.localeId;e&&(i[e]=!0)}));var r,o,s=this.oT(i);if(n&&n.length<Object(Pe.K)()){var a=this.state.AddingAdditionalLanguage&&"dn";r=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"multi-lingual-additional-language-add-button "+a,onClick:this.rT},Icon:"Add",IconClassName:"forms-icon-size20x20",Text:Object(ae.a)().MultiLingualPane_AdditionalLanguage_Button_Text,TextClassName:"multi-lingual-add-text"})}if(this.state.AddingAdditionalLanguage){var c={HTMLAttributes:{"aria-expanded":!1,"aria-label":Object(ae.a)().Multilingual_Select_Language,className:"multi-lingual-additional-language-dropdown"},onBlur:this.en,onValueChange:this.nT,optionListName:Object(ae.a)().MultiLingualPane_DropDown_Language_List,Placeholder:Object(ae.a)().MultiLingualPane_select_placeholder,SearchBoxLabel:Object(ae.a)().MultiLingualPane_AdditionalLanguage_Button_Text,SelectOptions:s,SuggestionText:Object(ae.a)().MultiLingualPane_DropDown_Suggestion_Text,Value:""};o=oe.createElement(Uc,Object(S.__assign)({},c))}return oe.createElement("div",{className:"flex-pane-multi-lingual-pane"},oe.createElement("div",{className:"multi-lingual-page-title",role:"heading","aria-level":1},Object(ae.a)().DesignPage_MultiLingualPane_Label),oe.createElement("div",{className:"multi-lingual-defaule-language"},oe.createElement("div",{className:"multi-lingual-defaule-language-title"},Object(ae.a)().MultiLingualPane_DefalutLanguage_Title),this.sT()),oe.createElement("div",{className:"multi-lingual-additional-language"},oe.createElement("div",{className:"multi-lingual-additional-language-title"},Object(ae.a)().MultiLingualPane_AdditionalLanguage_Title,void 0),this.aT(),r,o))},n.sT=function(){var t=this.props.Form.Model,e={};Et.forEach(t.LocaleList,(function(t){var n=t.localeId;n&&(e[n]=!0)}));var n=this.oT(e),i={HTMLAttributes:{"aria-label":Object(ae.a)().Multilingual_Select_Language,className:"multi-lingual-default-language-dropdown"},onValueChange:this.gO,optionListName:Object(ae.a)().MultiLingualPane_DropDown_Language_List,Placeholder:Object(ae.a)().MultiLingualPane_select_placeholder,SearchBoxLabel:Object(ae.a)().MultiLingualPane_DefalutLanguage_Title,SelectOptions:n,SuggestionText:Object(ae.a)().MultiLingualPane_DropDown_Suggestion_Text,Value:this.props.Form.Model.DefaultLanguage};return oe.createElement(Uc,Object(S.__assign)({},i))},n.gO=function(t){this.props.Form.Model.DefaultLanguage=t},n.iT=function(t){var e=this.hw.getGrabberByName(t);e&&e.grab()},n.cT=function(){if(!0===this.state.EditViewSelected){var t=Object(_t.b)();t.bulkEdit((function(){t.Model.FlexPane="MultiLingualEditAll"}))}},n.aT=function(){var t=this,e=this.props.Form,n=e.Model.LocaleList;if(n&&n.length)return Et.map(n,(function(i,r){var o=Et.find(e.Model.LocalizedResources,(function(t){return t.localeId===i.localeId})),s=i.localeId,a=i.localeName||Object(ae.a)().MultiLingualPane_AdditionalLanguage_Default_Name;if(o&&s)return oe.createElement($c,{DesignFocus:t.hw,Form:e,Index:r,key:s,Length:n.length,LocaleId:s,LocaleName:a,enterLanguageEditionView:t.props.enterLanguageEditionView,setFocusOnLanguageItem:t.iT})}))},n.oT=function(t){var e=[],n=this.eT,i=Object.keys(n);return i.sort((function(t,e){var i=n[t],r=n[e];return i<r?-1:i>r?1:0})),i.map((function(i){var r={Disabled:t[i],DisplayName:n[i],Key:i,SecondText:Vc(""+i.replace(/-/g,"_")),Value:i};e.push(r)})),e},n.rT=function(){this.setState({AddingAdditionalLanguage:!0})},n.en=function(t){this.setState({AddingAdditionalLanguage:!1})},n.nT=function(t){Object(g.b)("DesignPage.Flex.MultiLingual.AddAdditionalLanguage",{localeId:t});var e=this.eT[t];e&&this.props.Form.createLocale(t,e),this.setState({AddingAdditionalLanguage:!1})},e}(ue.a),Kc=n(251),Jc=function(t){function e(e){var n=t.call(this,e)||this;if(n.ce=!0,n.uT=n.uT.bind(n),n.lT=n.lT.bind(n),n.state={Suggestions:[]},Object(Y.c)("PersonalContextSuggestion"))n.hT=Object(Bi.a)(n.props.FormMaster),n.hT.observe(n.lT,[n.hT.Schema.SuggestionId]);else{var i=n.props.FormMaster.getInstanceId(),r=Object(Vr.b)(i);r&&r.observe(n.lT,[r.Schema.suggestions])}return n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){if(this.ce=!1,Object(Y.c)("PersonalContextSuggestion"))this.hT.unobserve(this.lT);else{var t=this.props.FormMaster.getInstanceId(),e=Object(Vr.b)(t);e&&e.unobserve(this.lT)}},n.componentDidMount=function(){this.lT()},n.componentWillUpdate=function(t,e){Et.isEqual(e.Suggestions,this.state.Suggestions)||(Object(g.b)("DesignPage.Theme.Suggestion.Update",{Expanded:t.ExpandView,HasSuggestion:!Et.isEmpty(e.Suggestions),IsQuiz:this.props.FormMaster.SettingMaster.Model.IsQuizMode}),Object(g.b)("IntelligenceStatistic.ThemeSuggestion.Update",{Expanded:t.ExpandView,IsQuiz:this.props.FormMaster.SettingMaster.Model.IsQuizMode,MsftUser:Object(u.a)().userInfo.TenantId===Object(v.k)(),Suggestions:e.Suggestions?e.Suggestions.map((function(t){return t.Name})):[]}))},n.render=function(){return!this.state.Suggestions||this.state.Suggestions.length<=0?null:oe.createElement("div",{className:"theme-suggestion-view-container"},oe.createElement("div",{className:"theme-suggestion-view-content"},this.fT(),this.dT()))},n.fT=function(){var t=Object(ae.a)().Designer_Intelligence_Button_Show;this.props.ExpandView&&(t=Object(ae.a)().Designer_Intelligence_Button_Hide);var e={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-expanded":this.props.ExpandView,className:"theme-suggestion-view-head-show-button",onClick:this.uT},Text:t},n=oe.createElement(Gi.a,Object(S.__assign)({},e));return oe.createElement("div",{className:"theme-suggestion-view-head-button",key:"theme-suggestion-view-head-button"},oe.createElement("div",{className:"theme-suggestion-view-head-button-title"},oe.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),oe.createElement("span",{className:"theme-suggestion-view-head-button-text"},Object(ae.a)().Designer_Intelligence_SuggestThemes_Title)),n)},n.dT=function(){var t=this;if(this.props.ExpandView&&this.state.Suggestions&&this.state.Suggestions.length>0){var e=this.state.Suggestions.map((function(e,n){return oe.createElement(Kc.a,{applyTheme:t.props.applyTheme,HTMLAttributes:{"aria-posinset":n+1,"aria-setsize":t.state.Suggestions.length},IsActive:t.props.FormMaster.ThemeMaster.Model.Name===e.Name,IsFromSuggestionCard:!1,IsQuiz:t.props.FormMaster.SettingMaster.Model.IsQuizMode,key:e.Name,Theme:e})}));return oe.createElement("div",{className:"theme-suggestion-list-container",key:"theme-suggestion-list-container",role:"list"},e)}return null},n.lT=function(){var t=this;if(this.ce)if(Object(Y.c)("PersonalContextSuggestion")){var e=this.hT.getSuggestion("TitleSuggestsTheme");e?this.setState({Suggestions:e.Suggestion||[]}):this.setState({Suggestions:[]})}else{var n=this.props.FormMaster.getInstanceId();Object(Xi.b)(n).then((function(e){t.setState({Suggestions:e||[]})}))}},n.uT=function(){Object(g.b)("DesignPage.Theme.ExpandShuggestion",{Expanded:!this.props.ExpandView}),this.props.expandOrCollapseSuggest()},e}(ue.a),Xc=n(68),Zc=n(198),Yc=function(t){function e(e){var n=t.call(this,e)||this;return n.bT=n.bT.bind(n),n.mT=n.mT.bind(n),n.Xk=n.Xk.bind(n),n.vT=n.vT.bind(n),n.state={ShowSpinner:!1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t,e=null!==(t=this.props.ThemeContainerClassName)&&void 0!==t?t:"theme-icon-container";return oe.createElement("span",{className:e},this.gT(),this.nb(),this.OT(),this.pT(),this.vf())},n.gT=function(){var t,e=this.props.Theme,n=Object(Zc.a)(e.Name)||Object(ae.a)().Customized_Theme_Name,i=null!==(t=this.props.ButtonClassName)&&void 0!==t?t:"theme-icon-button",r={ButtonStyle:"LightBackground",children:this.jT(),HTMLAttributes:{"aria-label":n,className:i,onClick:this.bT,title:Object(at.b)((function(){return n}))},ToggleActive:this.props.IsActive};return Object(at.c)((function(){return oe.createElement(qo.a,Object(S.__assign)({},r))}),at.f)},n.jT=function(){if(this.props.Theme){var t=void 0,e=this.props.Theme;if(e.Thumbnail)t={backgroundImage:"url("+e.Thumbnail+")"};else{if(e.BackgroundImage)return oe.createElement("img",{alt:Object(ae.a)().Customized_Theme_Name,className:"theme-icon",key:"background-image",src:e.BackgroundImage+"_mo",onLoad:this.vT});if(!e.PrimaryColor)return null;t={backgroundColor:e.PrimaryColor}}return oe.createElement("span",{className:"theme-icon",style:t})}return null},n.nb=function(){if(this.props.ShowColorSnapshot){var t=this.props.Theme,e={};return t.PrimaryColor&&(e.backgroundColor=t.PrimaryColor),oe.createElement("div",{className:"customized-theme-color-snapshot",onClick:this.bT},oe.createElement("div",{className:"snapshot-title",style:e},oe.createElement("div",{className:"snapshot-title-content"})),oe.createElement("div",{className:"snapshot-content"},oe.createElement("div",{className:"snapshot-submit-button",style:e})))}return null},n.OT=function(){return this.props.editTheme?Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"customized-theme-edit-button",onClick:this.mT},Icon:"Edit",IconClassName:"paneThemeEdit forms-icon-size18x18",key:"editButton",Text:Object(ae.a)().Common_Edit_Text}):null},n.pT=function(){return this.props.deleteTheme?Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"customized-theme-delete-button",onClick:this.Xk},Icon:"Delete",IconClassName:"paneThemeTrash forms-icon-size18x18",key:"deleteButton",Text:Object(ae.a)().Delete_Custom_Theme_Button_Tooltip}):null},n.Xk=function(){Object(g.b)("DesignPage.Theme.DeleteImage"),this.props.deleteTheme&&this.props.deleteTheme(),this.setState({ShowSpinner:!0})},n.bT=function(){Object(g.b)("DesignPage.Theme.SwitchTheme",{theme:this.props.Theme.Name},null,!0),this.props.applyTheme(this.props.Theme.Name)},n.mT=function(){Object(g.b)("DesignPage.Theme.EditCustomizedTheme"),this.props.editTheme&&this.props.editTheme()},n.vT=function(){this.setState({ShowSpinner:!1})},n.vf=function(){return this.state.ShowSpinner?oe.createElement("div",{className:"customized-theme-spinner-container"},oe.createElement("div",{className:"delete-theme-image-spinner common-spinner-circle"})):null},e}(ue.a),tu=function(t){function e(e){var n=t.call(this,e)||this;n.ce=!0,n.yT=!1,n.wT=!1,n.ST=oe.createRef(),n.NT=oe.createRef(),n.IT=oe.createRef(),n.CT=oe.createRef(),n.Ze=Et.uniqueId("CustomizeTheme"),n.kT=n.Ze+"-nagivation-button",n.TT=n.Ze+"-title",n.xT=n.xT.bind(n),n.FT=n.FT.bind(n),n.PT=n.PT.bind(n),n.DT=n.DT.bind(n),n.MT=n.MT.bind(n),n.Oe=function(){return n.forceUpdate()};var i=n.props.FormMaster;n.LT=i.getImageMaster(Zt.a.Schema.Background);var r=i.Model.PrimaryCustomizedThemeColor||Object(us.d)().PrimaryColor;n.state={ColorScriptLoaded:!1,CustomizedColor:r,FocusOnColorInput:!1,HexCodeStatus:Object(Xc.f)(Object(Xc.e)(r))?0:2,IsUploadingImage:!1,ShowColorPicker:!!i.Model.PrimaryCustomizedThemeColor};var o=Object(_t.f)();return n.LT.observe(n.Oe,[o.Schema.ResourceUrl,o.Schema.ImageProcessingStatus,o.Schema.ErrorType]),Object(An.a)("ColorThief").then((function(){n.ce&&n.setState({ColorScriptLoaded:!0})})),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){if(this.wT){var t=this.ST.current;t&&t.focus(),this.wT=!1}if(this.yT){var e=this.NT.current;e&&e.focus(),this.yT=!1}},n.componentWillUnmount=function(){this.LT.unobserve(this.Oe),this.ce=!1},n.render=function(){var t=this,e=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-labelledby":Object(pn.b)(this.TT,this.kT),autoFocus:!0,className:"customize-theme-view-navigation",id:this.kT,onClick:this.props.onViewNavigation},Icon:"Back",IconClassName:"paneThemeBack forms-icon-size16x16",Text:Object(ae.a)().Common_Back_Text,TextClassName:"customize-theme-view-navigation-text"}),n=oe.createElement("div",{className:"customize-theme-view-container"},oe.createElement("div",{className:"customize-theme-view-navigation-container"},e),oe.createElement("div",{className:"customize-theme-view-title",id:this.TT},oe.createElement("span",null,Object(ae.a)().Flex_Pane_ThemeView_Customize_Title)),oe.createElement("div",{className:"customize-theme-view-content"},oe.createElement("div",{className:"add-image"},this.AT(),this.RT()),oe.createElement("div",{className:"add-color"},this.ET(),this.BT(),this._T(),this.HT(),this.GT(),this.qT()),this.QT()),this.VT());return Object(at.c)((function(){return n}),(function(){return oe.createElement("div",null,n,oe.createElement(at.a.CustomizeThemeView_Pro,{FormMaster:t.props.FormMaster}))}))},n.AT=function(){if(this.props.FormMaster.Model.Background.ResourceId)return null;var t={disabled:this.LT.Model.ImageProcessingStatus!==ee.c.Idle,onClick:this.xT},e=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,Icon:"Photo2",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",ref:this.NT,Text:Object(ae.a)().Add_Customized_Theme_Image});return oe.createElement("span",{className:"theme-icon-container",key:"addImage"},e,this.vf())},n.RT=function(){var t=this,e=this.props.FormMaster.Model;if(e.Background.ResourceUrl){return oe.createElement(Yc,{applyTheme:this.xT,deleteTheme:function(){t.LT.clear().then((function(){t.props.FormMaster.ThemeMaster.isCustomized()&&!e.PrimaryCustomizedThemeColor&&t.props.applyTheme(Object(us.d)().Name),t.yT=!0,t.forceUpdate()}))},IsActive:e.Theme.Name===Sn.a,ShowColorSnapshot:!1,Theme:this.props.FormMaster.ThemeMaster.getCustomizedTheme()})}return null},n.ET=function(){if(this.state.ShowColorPicker&&(1===this.state.HexCodeStatus||this.props.FormMaster.Model.PrimaryCustomizedThemeColor))return null;var t={onClick:this.PT},e=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:t,Icon:"BucketColor",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",ref:this.ST,Text:Object(ae.a)().Add_Customized_Theme_Color});return oe.createElement("span",{key:"addColor"},e)},n.BT=function(){var t=this.props.FormMaster.Model.PrimaryCustomizedThemeColor;if(this.state.ShowColorPicker&&1!==this.state.HexCodeStatus&&t){var e={};return e.backgroundColor=t,oe.createElement("div",{className:"color-picker-use-color",style:e})}return null},n._T=function(){return this.state.ShowColorPicker&&1===this.state.HexCodeStatus?Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"office-form-theme-button",onClick:this.DT},Icon:"Cancel",IconClassName:"color-picker-remove-color forms-icon-size24x24"}):null},n.HT=function(){if(!this.state.ShowColorPicker)return null;var t=Object(ar.b)({AutoFocus:this.state.FocusOnColorInput,AutoSelection:!0,HTMLAttributes:{className:"color-picker-input"},MaxLength:120,MinimalHeight:60,onValueChange:this.FT,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Customized_Theme_Color_Input}},TextFieldType:0,Value:this.state.CustomizedColor});return oe.createElement("span",{className:"color-picker-container"},t)},n.GT=function(){var t="";return this.state.ShowColorPicker&&1===this.state.HexCodeStatus&&(t=Object(ae.a)().Customized_Theme_Color_Error_InvalidCode),oe.createElement("div",{className:"customize-theme-view-message error",role:"alert",ref:this.CT},t)},n.qT=function(){var t="";return this.state.ShowColorPicker&&2===this.state.HexCodeStatus&&(t=Object(ae.a)().Customized_Theme_Color_Suggestion_TooLight),oe.createElement("div",{className:"customize-theme-view-message suggestion","aria-live":"polite",role:"alert",ref:this.IT},t)},n.zT=function(t){var e=this;/^#[0-9A-F]{6}$/i.test(t)?(this.props.FormMaster.bulkEdit((function(n){n.PrimaryCustomizedThemeColor=t,n.SecondaryCustomizedThemeColor=Object(Xc.i)(t),n.TertiaryCustomizedThemeColor=Object(Xc.h)(t),e.props.applyTheme(Sn.a)})),Object(Xc.f)(Object(Xc.e)(t))?this.setState({HexCodeStatus:0}):this.setState({HexCodeStatus:2},(function(){Object(g.b)("DesignPage.Theme.ColorTooLight")}))):this.setState({HexCodeStatus:1})},n.QT=function(){var t=this.props.FormMaster.Model;if(this.state.ShowColorPicker&&t.PrimaryCustomizedThemeColor){var e={};e.backgroundColor=t.PrimaryCustomizedThemeColor;var n=oe.createElement("div",null,oe.createElement("div",{className:"snapshot-title",style:e},oe.createElement("div",{className:"snapshot-title-content"})),oe.createElement("div",{className:"snapshot-content"},oe.createElement("div",{className:"snapshot-submit-button",style:e}))),i={};return t.Background.ResourceUrl?i.backgroundImage="url("+t.Background.ResourceUrl+"_mo)":t.TertiaryCustomizedThemeColor&&(i.backgroundColor=t.TertiaryCustomizedThemeColor),oe.createElement("div",{className:"color-snapshot-container",style:i},n)}return null},n.PT=function(){Object(g.b)("DesignPage.Theme.AddColor"),this.setState({CustomizedColor:"Hex #",FocusOnColorInput:!0,ShowColorPicker:!0})},n.DT=function(){var t=this;Object(g.b)("DesignPage.Theme.DeleteColor"),this.props.FormMaster.bulkEdit((function(e){e.PrimaryCustomizedThemeColor&&(e.PrimaryCustomizedThemeColor=null,e.SecondaryCustomizedThemeColor=null,e.TertiaryCustomizedThemeColor=null,t.props.applyTheme(Sn.a))})),this.wT=!0,this.setState({HexCodeStatus:0,ShowColorPicker:!1})},n.xT=function(){var t=this,e=!1;Object(g.b)("DesignPage.Theme.AddImage"),Object(as.b)().then((function(n){var i=t.props.FormMaster.Model;if(t.props.onFlexPaneIndexChange(),t.LT.addImage(n).finally((function(){t.props.applyTheme(Sn.a),e&&t.setState({CustomizedColor:i.Theme.PrimaryColor,ShowColorPicker:!0})})),t.state.ColorScriptLoaded&&n.File&&n.File.size<=Object(Pe.r)()){var r=new FileReader;r.onload=function(){var t=new Image;t.src="string"==typeof r.result?r.result:"",t.onload=function(){var n,r=new ColorThief;try{n=r.getColor(t)}catch(t){n=[0,130,114]}var o=Object(Xc.a)({B:n[2],G:n[1],R:n[0]});i.PrimaryCustomizedThemeColor=i.PrimaryCustomizedThemeColor||Object(Xc.b)(o),i.SecondaryCustomizedThemeColor=i.SecondaryCustomizedThemeColor||Object(Xc.i)(i.PrimaryCustomizedThemeColor),i.TertiaryCustomizedThemeColor=i.TertiaryCustomizedThemeColor||Object(Xc.h)(i.PrimaryCustomizedThemeColor),e=!0}},r.readAsDataURL(n.File)}}))},n.VT=function(){var t=this.props.FormMaster,e=this.LT,n=e.Model;if(!t)return null;if(n.ImageProcessingStatus!==ee.c.Idle||n.ErrorType===ee.a.NoError)return null;var i=Object(xr.a)({HTMLAttributes:{className:"error-message"},key:"error-message",Label:e.getImageErrorMessage()}),r=Object(Un.b)({HTMLAttributes:{className:"customized-theme-error-frowny-icon"},IconName:"Sad",key:"customized-theme-error-frowny-icon"});return oe.createElement("div",{className:"customized-theme-error",key:"customized-them-error"},r,i)},n.MT=function(){if(this.CT.current){var t=this.CT.current;t.innerText=t.innerText}if(this.IT.current){var e=this.IT.current;e.innerText=e.innerText}},n.FT=function(t){this.setState({CustomizedColor:t},this.MT),(t=t.replace(/\s/g,"").toLowerCase()).startsWith("hex")&&(t=t.substr(3)),"#"!==t[0]&&(t="#"+t),this.zT(t)},n.vf=function(){var t=this.LT.Model,e=oe.createElement($o.a,Object(S.__assign)({},{ClassName:"deignPage-customized-theme-spinner",Ignorable:!1},{key:"group-forms-count-spinner"}));return t.ImageProcessingStatus!==ee.c.Idle?oe.createElement("div",{className:"customized-theme-spinner-container"},oe.createElement("div",{className:"customized-theme-spinner"},e)):null},e}(ue.a),eu=[{BackgroundColor:"#E6F2F1",BackgroundImage:null,Name:"Teal",PrimaryColor:"#008272",SecondaryColor:"#00695C",Thumbnail:Object(On.b)("/Images/Theme/teal-thumbnail.png")},{BackgroundColor:"#F2E6F2",BackgroundImage:null,Name:"Raspberry",PrimaryColor:"#8D398F",SecondaryColor:"#742F76",Thumbnail:Object(On.b)("/Images/Theme/raspberry-thumbnail.png")},{BackgroundColor:"#F2E9E6",BackgroundImage:null,Name:"Dark_Orange",PrimaryColor:"#CE4B28",SecondaryColor:"#B54223",Thumbnail:Object(On.b)("/Images/Theme/darkorange-thumbnail.png")},{BackgroundColor:"#F2E6EB",BackgroundImage:null,Name:"Pomegranate",PrimaryColor:"#911844",SecondaryColor:"#781438",Thumbnail:Object(On.b)("/Images/Theme/pomegranate-thumbnail.png")},{BackgroundColor:"#F2E6EE",BackgroundImage:null,Name:"Pink",PrimaryColor:"#BF3088",SecondaryColor:"#A62A76",Thumbnail:Object(On.b)("/Images/Theme/pink-thumbnail.png")},{BackgroundColor:"#E7F2E6",BackgroundImage:null,Name:"Bright_Green",PrimaryColor:"#0E8906",SecondaryColor:"#0B7005",Thumbnail:Object(On.b)("/Images/Theme/brightgreen-thumbnail.png")},{BackgroundColor:"#E6EDF2",BackgroundImage:null,Name:"Bright_Blue",PrimaryColor:"#0078D7",SecondaryColor:"#006ABE",Thumbnail:Object(On.b)("/Images/Theme/brightblue-thumbnail.png")},{BackgroundColor:"#E6EDF2",BackgroundImage:null,Name:"Medium_Dark_Blue",PrimaryColor:"#004B8B",SecondaryColor:"#003D72",Thumbnail:Object(On.b)("/Images/Theme/darkblue-thumbnail.png")},{BackgroundColor:"#F2EAE6",BackgroundImage:Object(On.b)("/Images/Theme/office.png"),Name:"Office",PrimaryColor:"#B84F22",SecondaryColor:"#9F441D",Thumbnail:Object(On.b)("/Images/Theme/office-thumbnail.png")},{BackgroundColor:"#E6EDF2",BackgroundImage:Object(On.b)("/Images/Theme/ocean.png"),Name:"Ocean",PrimaryColor:"#1D5482",SecondaryColor:"#174469",Thumbnail:Object(On.b)("/Images/Theme/ocean-thumbnail.png")},{BackgroundColor:"#E6EEF2",BackgroundImage:Object(On.b)("/Images/Theme/sky.png"),Name:"Sky",PrimaryColor:"#006DB2",SecondaryColor:"#005D99",Thumbnail:Object(On.b)("/Images/Theme/sky-thumbnail.png")},{BackgroundColor:"#E6EEF2",BackgroundImage:Object(On.b)("/Images/Theme/ski.png"),Name:"Ski",PrimaryColor:"#006DB2",SecondaryColor:"#005D99",Thumbnail:Object(On.b)("/Images/Theme/ski-thumbnail.png")},{BackgroundColor:"#EDF2E6",BackgroundImage:Object(On.b)("/Images/Theme/city01.png"),Name:"City01",PrimaryColor:"#3A501D",SecondaryColor:"#283714",Thumbnail:Object(On.b)("/Images/Theme/city01-thumbnail.png")},{BackgroundColor:"#E6ECF2",BackgroundImage:Object(On.b)("/Images/Theme/city02.png"),Name:"City02",PrimaryColor:"#024582",SecondaryColor:"#023769",Thumbnail:Object(On.b)("/Images/Theme/city02-thumbnail.png")},{BackgroundColor:"#EAF4DC",BackgroundImage:Object(On.b)("/Images/Theme/chemistry.png"),Name:"Chemistry",PrimaryColor:"#025700",SecondaryColor:"#013E00",Thumbnail:Object(On.b)("/Images/Theme/chemistry-thumbnail.png")},{BackgroundColor:"#E6E9F2",BackgroundImage:Object(On.b)("/Images/Theme/astronomy.png"),Name:"Astronomy",PrimaryColor:"#0A1431",SecondaryColor:"#050A18",Thumbnail:Object(On.b)("/Images/Theme/astronomy-thumbnail.png")},{BackgroundColor:"#ECE6F2",BackgroundImage:Object(On.b)("/Images/Theme/office2.png"),Name:"Office2",PrimaryColor:"#562685",SecondaryColor:"#461F6C",Thumbnail:Object(On.b)("/Images/Theme/office2-thumbnail.png")},{BackgroundColor:"#E6ECF2",BackgroundImage:Object(On.b)("/Images/Theme/meeting.png"),Name:"Meeting",PrimaryColor:"#053870",SecondaryColor:"#042B57",Thumbnail:Object(On.b)("/Images/Theme/meeting-thumbnail.png")}];eu.forEach((function(t,e){t=Object.freeze(t),eu[e]=t}));var nu=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ShowSpinner:!1},n.UT=n.UT.bind(n),n.$T=n.$T.bind(n),n.WT=Object(ae.a)(),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"theme-designer-container",key:"theme-designer-container"},this.KT(),this.JT(),this.XT())},n.KT=function(){var t=this;return eu.map((function(e){return oe.createElement(Yc,{applyTheme:t.props.applyTheme,IsActive:t.props.FormMaster.ThemeMaster.Model.Name===e.Name,ShowColorSnapshot:!1,Theme:e,key:e.Name})}))},n.XT=function(){var t=this.props.FormMaster.Model;if(t.Background.ResourceUrl||t.PrimaryCustomizedThemeColor)return null;var e={className:"theme-icon-button",onClick:this.UT},n=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,Icon:"Add",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",Text:this.WT.Add_Customized_Theme});return oe.createElement("span",{className:"theme-icon-container",key:"add"},n,this.vf())},n.JT=function(){var t=this.props.FormMaster.Model;return t.Background.ResourceUrl||t.PrimaryCustomizedThemeColor?oe.createElement(Yc,{applyTheme:this.props.applyTheme,editTheme:this.$T,IsActive:t.Theme.Name===Object(ae.a)().Customized_Theme_Name,ShowColorSnapshot:!!t.PrimaryCustomizedThemeColor&&!!t.Background.ResourceUrl,Theme:this.props.FormMaster.ThemeMaster.getCustomizedTheme()}):null},n.$T=function(){Object(g.b)("DesignPage.Theme.EditCustomizedTheme"),this.props.applyTheme(Sn.a),this.props.onViewNavigation()},n.UT=function(){Object(g.b)("DesignPage.Theme.AddCustomizedTheme"),this.props.onViewNavigation()},n.vf=function(){var t=this.props.FormMaster.getImageMaster(Zt.a.Schema.Background);return!this.state.ShowSpinner&&t.Model.ImageProcessingStatus===ee.c.Idle||t.Model.ErrorType!==ee.a.NoError?null:oe.createElement("div",{className:"customized-theme-spinner-container"},oe.createElement("div",{className:"customized-theme-spinner"},oe.createElement("div",{className:"spinner-tile-animation"})))},e}(ue.a),iu=function(t){function e(e){var n=t.call(this,e)||this;return n.Ak=n.Ak.bind(n),n.ZT=n.ZT.bind(n),n.YT=n.YT.bind(n),n.state={ShowCustomizeThemeView:!1,ShowSuggestThemeView:!0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"theme-container"},this.tx(),this.ex(),this.nx())},n.tx=function(){return this.state.ShowCustomizeThemeView?null:oe.createElement(Jc,{applyTheme:this.Ak,expandOrCollapseSuggest:this.ZT,ExpandView:this.state.ShowSuggestThemeView,FormMaster:this.props.FormMaster})},n.ex=function(){return this.state.ShowCustomizeThemeView?null:oe.createElement(nu,{FormMaster:this.props.FormMaster,applyTheme:this.Ak,onViewNavigation:this.YT})},n.nx=function(){return this.state.ShowCustomizeThemeView?oe.createElement(tu,{applyTheme:this.Ak,FormMaster:this.props.FormMaster,onFlexPaneIndexChange:this.props.onFlexPaneIndexChange,onViewNavigation:this.YT}):null},n.Ak=function(t){this.props.FormMaster.ThemeMaster.Model.Name=t,this.forceUpdate()},n.ZT=function(){this.setState({ShowSuggestThemeView:!this.state.ShowSuggestThemeView})},n.YT=function(){this.setState({ShowCustomizeThemeView:!this.state.ShowCustomizeThemeView})},e}(ue.a);var ru=n(167),ou=n(107),su=function(t){function e(e){var n=t.call(this,e)||this;return n.Nt=oe.createRef(),n.cn=n.cn.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t={ButtonStyle:"LightBackground",children:[oe.createElement(ou.a,{DisplayName:this.props.GroupMaster.Model.displayName,Photo:this.props.GroupMaster.Photo,PhotoType:1,key:this.props.GroupMaster.Model.id})],HTMLAttributes:{className:"flex-pane-moveform-destbutton",onClick:this.cn.bind(this),title:this.props.GroupMaster.Model.displayName},ref:this.Nt,ToggleActive:this.props.IsSelected},e=oe.createElement(qo.a,Object(S.__assign)({},t));return oe.createElement("li",{key:this.props.GroupMaster.Model.id,"aria-selected":this.props.IsSelected,role:"option"},e)},n.focus=function(){this.Nt.current&&this.Nt.current.focus()},n.cn=function(){this.props.onGroupSelected(this.props.GroupMaster)},e}(ue.a),au=function(t){function e(e){var n=t.call(this,e)||this;return n.ix=-1,n.ox=oe.createRef(),n.ce=!0,n.sx=n.sx.bind(n),n.ax=n.ax.bind(n),n.ux=n.ux.bind(n),n.lx=n.lx.bind(n),Object(g.b)("PortalPage.MoveFormPane.Start",{FormId:e.SelectedForm.Model.Id,IsDelegateMode:e.IsDelegateMode}),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;if(Object(yr.g)(Ln.findDOMNode(this)),!Object(u.a)().userInfo.IsMsa){var e=Object(ri.b)();e.ensureFieldsReady([e.Schema.groups]).then((function(){t.ce&&(Object(g.b)("PortalPage.MoveFormPane.GroupsCount",{groupsCount:e.Groups.length}),t.setState({AreGroupsReady:!0}))}))}},n.componentWillUnmount=function(){Object(yr.e)(Ln.findDOMNode(this)),this.ce=!1},n.render=function(){var t=this,e=null,n=null,i=null,r=Object(ae.a)().MovePaneView_Label_MyGroups,o=null;if(this.state.AreGroupsReady){var s=Object(ri.b)(),a=s.Groups.length,c=this.hx(a);if(c<a){var l=Object(ae.a)().MovePaneView_Link_MoreGroupCards,h={ButtonStyle:"LightBackground",children:[oe.createElement("span",null,l)],HTMLAttributes:{"aria-expanded":!1,"aria-label":l,className:"flex-pane-moveform-moreaction",label:l,onClick:this.ax,title:Object(ae.a)().MovePaneView_Link_MoreGroupCards_Tooltip}};i=oe.createElement(qo.a,Object(S.__assign)({},h))}c>0&&(e=s.Groups.slice(0,c).map((function(e,n){var i=t.ix===n?t.ox:void 0;return oe.createElement(su,{onGroupSelected:t.ux,GroupMaster:e,IsSelected:t.state.SelectedGroup===e,key:e.Model.id,ref:i})}))),this.ix>-1&&(r+=", "+Object(ae.a)().MovePaneView_Link_MoreGroupCards_Alert,this.ix=-1)}if(this.props.IsDelegateMode){var f=Object(u.a)().userInfo.DisplayName,d=Object(ae.a)().MovePaneView_Label_MyFormsWithName.format(f),b=Object(ae.a)().MovePaneView_Label_MyGroupsWithName.format(f),m={ButtonStyle:"LightBackground",children:[oe.createElement(ou.a,{DisplayName:Object(u.a)().userInfo.DisplayName,DisplayText:d,Photo:Object(ru.a)(),PhotoType:0})],HTMLAttributes:{className:"flex-pane-moveform-destbutton",onClick:this.lx,title:Object(u.a)().userInfo.DisplayName},ToggleActive:this.state.IsTransferToMe},v=oe.createElement(qo.a,Object(S.__assign)({},m));n=oe.createElement("div",{className:"flex-pane-moveform-me-container"},v),o=oe.createElement("div",{className:"flex-pane-moveform-group-title"},b)}var g={ButtonStyle:"LightBackground",children:[oe.createElement("span",null,Object(ae.a)().MovePaneView_Button_MoveAction)],HTMLAttributes:{className:"flex-pane-moveform-button",disabled:!this.bx(),onClick:this.sx}},O=oe.createElement(qo.a,Object(S.__assign)({},g));return oe.createElement("div",{className:"flex-pane-moveform-content"},oe.createElement("div",{className:"flex-pane-content-container-title"},Object(ae.a)().MovePaneView_Label_MoveSingleForm),oe.createElement("div",{className:"flex-pane-moveform-formtitle"},this.props.SelectedForm.Model.Title),oe.createElement("div",{className:"flex-pane-moveform-destArea"},oe.createElement("div",{className:"flex-pane-moveform-label-prompt"},Object(ae.a)().MovePaneView_Label_ChooseContainer),n,oe.createElement("div",{className:"flex-pane-moveform-group-container"},o,oe.createElement("ul",{"aria-label":r,className:"flex-pane-moveform-grouplist",role:"listbox"},e),oe.createElement("div",null,i))),O)},n.hx=function(t){if(this.state.ShowAllGroups)return t;if(t<=0)return 0;var e=window.innerHeight-330;if(this.props.IsDelegateMode){e-=90}var n=Math.floor(e/40);return n<1?1:n>t?t:n},n.bx=function(){return this.state.IsTransferToMe||!!this.state.SelectedGroup},n.ax=function(){var t=this,e=Object(ri.b)().Groups.length;this.ix=this.hx(e),this.setState({ShowAllGroups:!0},(function(){t.ox.current&&t.ox.current.focus()}))},n.ux=function(t){this.setState({SelectedGroup:t,IsTransferToMe:!1})},n.lx=function(){this.setState({SelectedGroup:null,IsTransferToMe:!0})},n.sx=function(){if(this.state.IsTransferToMe)this.props.changeFormOwnerHandler({IsGroupForm:!1,OwnerId:Object(u.a)().userInfo.UserId,OwnerTenantId:Object(u.a)().userInfo.TenantId});else if(this.state.SelectedGroup){var t=this.state.SelectedGroup;this.props.changeFormOwnerHandler({IsGroupForm:!0,OwnerId:t.Model.id,OwnerTenantId:Object(u.a)().userInfo.TenantId}).then((function(e){e&&t.isFieldReady(t.Schema.formReferences)&&t.addFormReference(e)}))}},e}(ue.a);var cu,uu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){},n.render=function(){var t={className:"flex-pane-feedback-post-community",onClick:function(){Object(g.b)("DesignPage.Feedback.Suggestion"),Object(Rn.a)("https://microsoftforms.uservoice.com")}},e=oe.createElement("div",{className:"flex-pane-content flex-pane-feedback-box"},oe.createElement("div",{className:"flex-pane-feedback-title"},Object(ae.a)().FlexPane_FeedbackView_SuggestionTitle),oe.createElement("div",{className:"flex-pane-feedback-desription"},Object(ae.a)().FlexPane_FeedbackView_SuggestionDescription),oe.createElement("button",t,Object(ae.a)().FlexPane_FeedbackView_SuggestionButton),oe.createElement("div",{className:"flex-pane-feedback-suggestionterm"},Object(ae.a)().FlexPane_FeedbackView_SuggestionTerms));return oe.createElement("div",{className:"flex-pane-feedback-container"},oe.createElement("div",{className:"flex-pane-feedback-content"},e))},e}(ue.a),lu=function(t){function e(e){return t.call(this,e)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this,e=Object(Gi.b)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",onClick:function(){t.props.cancelCallBack()}},ButtonStyle:"LightBackground",Text:this.props.CancelDisplayName,key:this.props.CancelDisplayName}),n=Object(Gi.b)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",onClick:function(){t.props.confirmCallBack()}},ButtonStyle:"LightBackground",Text:this.props.ConfirmDisplayName,key:this.props.ConfirmDisplayName}),i=this.props.LearnMoreLink&&oe.createElement("a",{onClick:function(){return Object(Rn.a)(t.props.LearnMoreLink,"_blank")},tabIndex:0},Object(ae.a)().LearnMore_General);return oe.createElement("div",{className:"flex-pane-confirm-dialog-container",role:"alertdialog"},oe.createElement("div",{className:"flex-pane-confirm-dialog-title","aria-label":this.props.ConfirmDialogWarningMessage},this.props.ConfirmDialogWarningMessage,i),oe.createElement("div",{className:"flex-pane-confirm-dialog-button-container"},e,n))},e}(ue.a);function hu(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"AnalysisResult":return n.SharePane_AnalysisResult_GetLink;case"Collaboration":return n.SharePane_Collaboration_GetLink;case"ShareAsTemplate":return n.SharePane_ShareAsTemplate_GetLink;default:return""}}function fu(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"AnalysisResult":return n.SharePane_AnalysisResult_Link_Title;case"Collaboration":return n.SharePane_Collaboration_Link_Title;case"ShareAsTemplate":return n.SharePane_ShareAsTemplate_Link_Title;default:return""}}!function(t){t[t.ShareAsTemplate=0]="ShareAsTemplate",t[t.Collaboration=1]="Collaboration",t[t.AnalysisResult=2]="AnalysisResult"}(cu||(cu={}));var du=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.needUpdateFocus=!1,e.mx="",e.vx=!0,e.gx=Et.uniqueId("confirm-delete-message-container"),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){if(this.needUpdateFocus){var t=Ln.findDOMNode(this.refs[this.mx]);t&&(t.focus(),this.mx=="flex-pane-share-"+this.Ox+"-textbox-link"&&t.select(),this.mx=void 0),this.needUpdateFocus=!1}},n.componentWillUnmount=function(){this.vx=!1},n.render=function(){if(Object(Ri.a)(this.props.Form,"DisableEditForm"))return null;this.Ox=cu[this.props.ShareOption];var t=this.state.AllowCopy&&this.state.Token;return oe.createElement("div",{"aria-label":fu(this.Ox),className:"flex-pane-option-container-share"},oe.createElement("div",{className:"flex-pane-content-container-title",key:"containerTitle"},fu(this.Ox)),t&&this.px(),!t&&this.jx())},Object.defineProperty(n,"Mounted",{get:function(){return this.vx},enumerable:!1,configurable:!0}),n.setStateSafely=function(t){this.Mounted&&this.setState(t)},n.createTitle=function(){return oe.createElement("div",{className:"flex-pane-share-content-title"},function(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"AnalysisResult":return n.SharePane_AnalysisResult_Title;case"CollectResponse_DropDownOption1":return n.SharePane_CollectResponse_DropDownOption1_Title;case"CollectResponse_DropDownOption2":return n.SharePane_CollectResponse_DropDownOption2_Title;case"CollectResponse_DropDownOption3":return n.SharePane_CollectResponse_DropDownOption3_Title;case"CollectResponse_DropDownSharing":return n.SharePane_CollectResponse_DropDownSharing_Title;case"CollectResponse":return n.SharePane_CollectResponse_Title;case"DuplicateTemplate":return n.SharePane_DuplicateTemplate_Title;case"Email":return n.SharePane_Email_Title;case"Others_Embed":return n.SharePane_Others_Embed_Title;case"Owner":return n.SharePane_Owner_Title;case"QRCode":return n.SharePane_QRCode_Title;case"ShareAsTemplateNotAllowed":return n.SharePane_ShareAsTemplateNotAllowed_Title;case"ShareAsTemplate":return n.SharePane_ShareAsTemplate_Title;default:return""}}(cu[this.props.ShareOption]))},n.showErrorStatus=function(t,e){Ln.findDOMNode(this.refs[e]).textContent=t},n.isEditingDisabled=function(){return!1},n.disableControls=function(){return!1},n.getDeleteWarningMessage=function(){return Object(ae.a)().SharePane_ShareOption_DeleteDialog_Message},n.createShareContent=function(){var t=this,e=oe.createElement("div",{className:"flex-pane-share-form-spinner-container"},this.vf(!0));return oe.createElement("div",{className:"flex-pane-share-form-content-container"},Object(at.b)((function(){return t.createTitle()})),oe.createElement("div",{className:"flex-pane-share-form-content-body"},oe.createElement("div",Object(S.__assign)({},{className:"flex-pane-share-content-copy"}),this.yx(),this.wx(),this.Sx()),this.Nx()),this.state.ShowSpinner&&e)},n.px=function(){var t=this.state.ShowConfirmDelete;return oe.createElement("div",{className:"flex-pane-dark-container",key:"shareContainer"},t&&this.Ix(),!t&&this.createShareContent(),this.Cx())},n.jx=function(){var t=this,e=this.state.ShowSpinner,n=function(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"Collaboration":return n.SharePane_Collaboration_Tooltip;case"CollectResponse_DropDownOption1":return n.SharePane_CollectResponse_DropDownOption1_Tooltip;case"CollectResponse_DropDownOption2":return n.SharePane_CollectResponse_DropDownOption2_Tooltip;case"CollectResponse_DropDownOption3":return n.SharePane_CollectResponse_DropDownOption3_Tooltip;case"CollectResponse_DropDownSharing":return n.SharePane_CollectResponse_DropDownSharing_Tooltip;case"ShareAsTemplate":return n.SharePane_ShareAsTemplate_Tooltip;default:return""}}(this.Ox),i=Object(yn.a)({HTMLAttributes:{className:"flex-pane-sharelink-button",disabled:this.isEditingDisabled(),id:"flex-pane-get-"+this.Ox+"-link-button",title:n,onClick:function(){t.setState({ShowSpinner:!0}),t.createLink(),t.mx="flex-pane-share-"+t.Ox+"-textbox-link"}},Icon:"Add",IconClassName:"share-link-plus-icon forms-icon-size16x16",ButtonStyle:"LightBackground",GlyphButtonStyle:"Horizontal",Text:hu(this.Ox),TextClassName:"flex-pane-share-link-text",key:"create"+this.Ox+"Link",ref:"flex-pane-get-"+this.Ox+"-link-button"});return oe.createElement("div",{className:"flex-pane-sharelink-container"},i,e&&this.vf(!1),this.Cx())},n.yx=function(){var t=this,e={disabled:this.disableControls(),readOnly:!0,value:this.getShareContentUrl(),className:"flex-pane-textbox",id:"flex-pane-share-"+this.Ox+"-textbox-link",ref:"flex-pane-share-"+this.Ox+"-textbox-link",onClick:function(){var e=$("#flex-pane-share-"+t.Ox+"-textbox-link");e.focus(),e.select()}};return this.Ox===cu[cu.Collaboration]?e["aria-label"]=Object(ae.a)().Link_Sharing_Collaborate:e["aria-label"]=Object(ae.a)().Link_Sharing_Template,oe.createElement("input",Object(S.__assign)({},e))},n.wx=function(){var t=this,e={disabled:this.disableControls(),type:"button",className:"flex-pane-button",id:"flex-pane-share-"+this.Ox+"-link",onClick:function(e){Object(g.b)({CopyShareAsTemplateLink:"DesignPage.Share.CopyShareAsTemplateLink",CreateShareAsTemplateLink:"DesignPage.Share.CreateShareAsTemplateLink",DeleteShareAsTemplateLink:"DesignPage.Share.DeleteShareAsTemplateLink",CopyCollaborationLink:"DesignPage.Share.CopyCollaborationLink",CreateCollaborationLink:"DesignPage.Share.CreateCollaborationLink",DeleteCollaborationLink:"DesignPage.Share.DeleteCollaborationLink",SwitchCollaborationLink:"DesignPage.Share.SwitchCollaborationLink",CopyAnalysisResultLink:"DesignPage.Share.CopyAnalysisResultLink",CreateAnalysisResulttLink:"DesignPage.Share.CreateAnalysisResulttLink",DeleteAnalysisResultLink:"DesignPage.Share.DeleteAnalysisResultLink",ChooseAllowAnonymous:"DesignPage.Share.ChooseAllowAnonymous"}["Copy"+t.Ox+"Link"])}};return e["data-clipboard-target"]="#flex-pane-share-"+this.Ox+"-textbox-link",oe.createElement("button",Object(S.__assign)({},e),Object(ae.a)().Common_Copy_Text)},n.Sx=function(){var t={className:"flex-pane-status",id:"flex-pane-share-"+this.Ox+"-status-link",role:"alert"};return oe.createElement("div",Object(S.__assign)({},t))},n.Nx=function(){var t=this;return Object(yn.a)({HTMLAttributes:{className:"flex-pane-share-content-delete-button",id:"flex-pane-"+this.Ox+"-delete-button",disabled:this.disableControls()||this.isEditingDisabled(),onClick:function(){t.setState({ShowConfirmDelete:!0}),t.mx=t.Ox+"cancelButton",t.needUpdateFocus=!0}},Icon:"Delete",IconClassName:"flex-pane-delete-icon forms-icon-size18x18",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(ae.a)().Common_Delete_Text,key:"deleteShareLink",ref:"flex-pane-"+this.Ox+"-delete-button"})},n.Ix=function(){var t=this,e=Object(Gi.b)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",id:this.Ox+"cancelButton",onClick:function(){t.setState({ShowConfirmDelete:!1}),t.mx="flex-pane-"+t.Ox+"-delete-button",t.needUpdateFocus=!0}},ButtonStyle:"LightBackground",Text:Object(ae.a)().Common_Cancel_Text,key:"cancelButton",ref:this.Ox+"cancelButton"}),n=Object(Gi.b)({HTMLAttributes:{className:"flex-pane-confirm-dialog-option",id:"deleteButton",onClick:function(){t.setState({ShowSpinner:!0,ShowConfirmDelete:!1}),t.deleteLink(),t.mx="flex-pane-get-"+t.Ox+"-link-button"},"aria-describedby":this.gx},ButtonStyle:"LightBackground",Text:Object(ae.a)().SharePane_ShareOption_DeleteDialog_Delete,key:"deleteButton"}),i={className:"flex-pane-confirm-delete-container",ref:"confirmDeleteContainer",onBlur:function(e){return t.kx(e)},tabIndex:-1},r=this.getDeleteWarningMessage();return oe.createElement("div",Object(S.__assign)({},i),oe.createElement("div",{className:"flex-pane-confirm-dialog-title",id:this.gx,"aria-label":r,tabIndex:0},r),oe.createElement("div",{className:"flex-pane-confirm-dialog-button-container"},e,n))},n.kx=function(t){var e=Object(pn.d)(t);Ln.findDOMNode(this.refs.confirmDeleteContainer).contains(e)||this.setState({ShowConfirmDelete:!1})},n.vf=function(t){var e=t?"flex-pane-delete-share-link-spinner":"flex-pane-share-form-spinner";return oe.createElement("div",{className:e},oe.createElement("div",{className:"common-spinner-circle"}))},n.Cx=function(){if(this.state.ShowError){var t="flex-pane-"+cu[this.props.ShareOption]+"-status";return oe.createElement("div",{className:"flex-pane-share-error-box",ref:t})}},e}(ue.a);function bu(){return n.e(122).then(n.bind(null,1133))}var mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=Object(Pi.a)(e,bu);return oe.createElement(Fi.a,{fallback:oe.createElement("div",{className:"flex-pane-collaborate-specific-share-loading"},oe.createElement("div",{className:"common-spinner-circle"}))},oe.createElement(t,Object(S.__assign)({},this.props)))},e}(ue.a);var vu=function(t){function e(e){var n=t.call(this,e)||this;n.Tx=oe.createRef(),n.xx=n.xx.bind(n),n.Fx=n.Fx.bind(n),n.Px=n.Px.bind(n),n.Dx=n.Dx.bind(n),n.Mx=n.Mx.bind(n),n.WT=Object(ae.a)(),n.Lx=n.WT.SharePane_Collaboration_TitleCrossTenant,n.Ax=n.WT.SharePane_Collaboration_TitleSameTenant,n.Rx=n.WT.SharePane_Collaboration_ShareToPeople;var i=Object(_t.b)();i.observe(n.xx,[i.Schema.FormsTenantSettings]);var r=n.Ex(),o=n.Bx(),s=Et.find(n.props.Form.Model.Permissions,(function(t){return t.Type===o})),a=null==s?void 0:s.PrincipalId,c=!1;return r||"Link"!==o||(o="OrgLink",c=!0),n.state={AllowCopy:n.props.Form.Model.Permissions.length>0,CollaborateOptionValue:o,ShowError:c,Token:a},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.state.ShowError&&this.showErrorStatus(this.WT.DesignPage_SharePane_CollabDisabled_AdminSettings,"flex-pane-Collaboration-status")},n.componentWillUnmount=function(){Object(_t.b)().unobserve(this.xx),t.prototype.componentWillUnmount.call(this)},n.createLink=function(){this.props.Form.refreshPermissions().then(this.Px)},n.deleteLink=function(){this.props.Form.refreshPermissions().then(this.Dx)},n.createShareContent=function(){return this.state.ShowConfirmDialog?oe.createElement(lu,Object(S.__assign)({},this._x)):t.prototype.createShareContent.call(this)},n.createTitle=function(){return this.Hx()},n.getShareContentUrl=function(){var t="FormId="+this.props.Form.Model.Id;this.SpecificShareMode||(t+="&Token="+this.state.Token);var e={fragment:t},n="../Pages/DesignPage.aspx?"+jQuery.param(e);return Object(f.a)(n)},n.isEditingDisabled=function(){return!this.props.Form.isCurrentUserFormOwnerOrGroupMember()},n.disableControls=function(){return this.state.IsChangingCollaborateOption},n.setStateSafely=function(t,e){this.Mounted&&this.setState(t,e)},n.getDeleteWarningMessage=function(){return this.SpecificShareMode?Object(ae.a)().DeleteCoauthLinkWarning:Object(ae.a)().SharePane_ShareOption_DeleteDialog_Message},Object.defineProperty(n,"SpecificShareMode",{get:function(){return"ShareToPeople"===this.state.CollaborateOptionValue},enumerable:!1,configurable:!0}),n.xx=function(){this.Ex()||"Link"!==this.state.CollaborateOptionValue||(this.setState({CollaborateOptionValue:"OrgLink",ShowError:!0}),this.showErrorStatus(this.WT.DesignPage_SharePane_CollabDisabled_AdminSettings,"flex-pane-Collaboration-status"))},n.Ex=function(){var t=Object(_t.b)().Model.FormsTenantSettings;return null==t||t.externalShareCollaboration},n.Hx=function(){var t=this.WT.OnlyOwnerCanChangeCollaborate,e=[];if(!Object(v.s)()){var n=this.isEditingDisabled()?t:this.Lx,i=oe.createElement("span",{className:"share-to-collaborate-content",title:n},this.Lx);e.push({Disabled:this.Gx()||this.isEditingDisabled(),DisplayContent:i,DisplayName:this.Lx,Key:"CrossTenant",Value:"Link"})}var r=this.isEditingDisabled()?t:this.Ax,o=oe.createElement("span",{className:"share-to-collaborate-content",title:r},this.Ax);e.push({Disabled:this.isEditingDisabled(),DisplayContent:o,DisplayName:this.Ax,Key:"SameTenant",Value:"OrgLink"});var s=this.isEditingDisabled()?t:this.Rx,a=oe.createElement("span",{className:"share-to-collaborate-content",title:s},this.Rx);e.push({Disabled:this.isEditingDisabled(),DisplayContent:a,DisplayName:this.Rx,Key:"ShareToPeople",Value:"ShareToPeople"});var c=oe.createElement(Pr.a,{HTMLAttributes:{"aria-label":this.state.CollaborateOptionValue},SelectOptions:e,Value:this.state.CollaborateOptionValue,onValueChange:this.Mx,ref:this.Tx}),u=oe.createElement("div",{className:"flex-pane-collaborate-dropdown-spinner-container"},oe.createElement("div",{className:"flex-pane-collaborate-dropdown-spinner-content flex-pane-collaborate-spinnerContainer"},oe.createElement("div",{className:"common-spinner-circle"}))),l=!this.state.ShowCollaborationDropDownSpinner&&this.SpecificShareMode;return oe.createElement("div",null,oe.createElement("div",{className:"flex-pane-option-dropdown-element"},c,oe.createElement("div",{className:"flex-pane-status",id:"flex-pane-change-collaborate-tenant-status",role:"alert"}),this.state.ShowCollaborationDropDownSpinner&&u),l&&this.qx())},n.Qx=function(){var t=this.props.Form.Model.Permissions,e=Et.find(t,(function(t){var e=t.Type;return"Link"===e||"OrgLink"===e||"ShareToPeople"===e}));return null==e?void 0:e.Type},n.Bx=function(){var t=this.Qx();return"Link"===t&&this.Gx()?"OrgLink":t},n.Gx=function(){return!this.Ex()},n.Px=function(){var t=this;Ci.a.getFormsTenantSettings().then((function(){var e=t.Gx()?"OrgLink":"Link";Object(g.b)("DesignPage.Share.CreateCollaborationLink",{linkType:e}),t.props.Form.appendPermission(e).then((function(n){t.needUpdateFocus=!1,t.setStateSafely({AllowCopy:!0,CollaborateOptionValue:e,ShowError:!1,ShowSpinner:!1,Token:n},(function(){var e=t.Tx.current;e&&e.focus()}))})).catch((function(e){t.setStateSafely({AllowCopy:!1,ShowError:!0,ShowSpinner:!1,Token:null}),t.showErrorStatus(t.Vx(e.innerCode),"flex-pane-Collaboration-status")}))}))},n.Dx=function(){var t=this;this.props.Form.removeLinkPermission().then((function(){Object(g.b)("DesignPage.Share.DeleteCollaborationLink",{linkType:t.state.CollaborateOptionValue}),t.needUpdateFocus=!0,t.setStateSafely({CollaborateOptionValue:null,ShowSpinner:!1,Token:null})})).catch((function(e){5506===e.innerCode?t.setStateSafely({ShowError:!1,ShowSpinner:!1,Token:null}):(t.setStateSafely({ShowError:!0,ShowSpinner:!1}),t.showErrorStatus(t.Vx(e.innerCode),"flex-pane-Collaboration-status"))}))},n.zx=function(t){var e=this;this.setState({IsChangingCollaborateOption:!0,ShowCollaborationDropDownSpinner:!0}),Object(g.b)("DesignPage.Share.SwitchCollaborationLink",{linkType:t}),t&&this.props.Form.appendPermission(t).then((function(n){e.setStateSafely({CollaborateOptionValue:t,IsChangingCollaborateOption:!1,ShowCollaborationDropDownSpinner:!1,Token:n}),e.props.Form.refreshPermissions()})).catch((function(t){e.setStateSafely({IsChangingCollaborateOption:!1,ShowCollaborationDropDownSpinner:!1,ShowError:!0}),e.showErrorStatus(e.Vx(t.innerCode),"flex-pane-change-collaborate-tenant-status")}))},n.qx=function(){return Object(g.b)("LazylazyShareToPeople.Start"),oe.createElement("div",{className:"share-to-people-container"},oe.createElement(mu,{Disable:this.isEditingDisabled(),onSelectPersonas:this.Fx,onClickManagePermission:this.props.OnClickManageAccess,SpecificPeoplePermissions:this.Ux()}))},n.Fx=function(t){var e=this,n=t.map((function(t){Object(Qe.b)(new Qe.a(t.id,t.primaryText,t.secondaryText,t.secondaryText));var n={FormId:e.props.Form.Model.Id,IsOwner:!1,PermissionSet:"Read, Write, Share",PrincipalEmailAddress:t.secondaryText,PrincipalName:t.primaryText,PrincipalId:t.id,SavingState:"Saving",Type:t.optionalText};return Object(g.b)("DesignPage.Share.AddSpecificPeople",{linkType:t.optionalText}),n}));return new Promise((function(t,i){return e.props.Form.appendSpecificPeoplePermissions(n).then(t,i)}))},n.Ux=function(){var t=this.props.Form.getUserOrGroupPermissions();return Et.map(t,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}))},n.Vx=function(t){var e=this.WT.Error_Page_DefaultErrorTitle;switch(t){case 5501:e=this.WT.Error_Message_5501;break;case 5503:e=this.WT.Error_Message_5503;break;case 5504:e=this.WT.Error_Message_5504;break;case 5554:e=this.WT.Error_Message_5554;break;case 5558:e=this.WT.Error_Message_5558;break;case 5510:e=this.WT.PermissionLimitReached}return e},n.Mx=function(t){var e,n=this;if(t!==this.state.CollaborateOptionValue)if(this.SpecificShareMode&&this.props.Form.getUserOrGroupPermissions().length>1)this.$x(this.WT.ShiftCoauthOptionFromSpecificShareWarning,null,(function(){n.zx(t)}));else if("ShareToPeople"===t&&(null===(e=this.props.Form.Model.PermissionTokens)||void 0===e?void 0:e.length)>0){this.$x(this.WT.ShiftSpecificShareFromSummaryLinkCoauthOptionWarning,"https://go.microsoft.com/fwlink/?linkid=2122902",(function(){n.zx(t)}))}else this.zx(t)},n.$x=function(t,e,n){var i=this;this._x={cancelCallBack:function(){i.setState({ShowConfirmDialog:!1})},CancelDisplayName:this.WT.Common_Cancel_Text,confirmCallBack:function(){n(),i.setState({ShowConfirmDialog:!1})},ConfirmDialogWarningMessage:t,ConfirmDisplayName:this.WT.Common_Yes_Text,LearnMoreLink:e},this.setState({ShowConfirmDialog:!0})},e}(du);function gu(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"Email":return n.Share_Options_Email;case"Embed":return n.Share_Options_Embed;case"Facebook":return n.Share_Options_Facebook;case"Link":return n.Share_Options_Link;case"QRCode":return n.Share_Options_QRCode;case"Teams":return n.Share_Options_Teams;case"Twitter":return n.Share_Options_Twitter;default:return""}}var Ou=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.ce=!0,e}Object(S.__extends)(e,t);var i=e.prototype;return i.componentDidMount=function(){var t=this;this.Wx().then((function(e){t.ce&&t.setState({Base64URL:e})})).catch((function(t){}))},i.componentWillUnmount=function(){this.ce=!1},i.render=function(){return oe.createElement("img",{alt:this.props.Title,title:this.props.Title,src:this.state.Base64URL||"iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mP8z8BQDwAEhQGAhKmMIQAAAABJRU5ErkJggg=="})},i.download=function(){var t=this;Promise.all([this.Kx(),n.e(0).then(n.t.bind(null,1116,7))]).then((function(e){var n=e[0];return e[1].saveAs(n,t.props.Title+".png")}))},i.Kx=function(){return this.Wx().then((function(t){var e=t&&t.split("base64,")[1];if(!e)throw Error("Invalid URL: "+t);for(var n=window.atob(e),i=new Uint8Array(n.length),r=0;r<n.length;r++)i[r]=n.charCodeAt(r);return new Blob([i])}))},i.Wx=function(){var t=this;return this.Jx||(this.Jx=Object(An.a)("JQuery_QRCode").then((function(){var e=$("<div/>").qrcode({correctLevel:1,height:800,text:t.props.URL,width:800}).children("canvas")[0];if(e)return e.toDataURL();throw Error("QRCode doesn't work with URL: "+t.props.URL)}))),this.Jx},e}(ue.a),pu=!1;function ju(){pu||(window.fbAsyncInit=function(){FB.init({appId:Object(M.f)()?"324475574804737":"521753901675351",autoLogAppEvents:!0,version:"v3.1",xfbml:!0})},function(){var t=document.getElementsByTagName("script")[0],e=document.getElementsByTagName("script")[0];if(document.getElementById("facebook-jssdk"))return;(t=document.createElement("script")).id="facebook-jssdk",t.src="https://connect.facebook.net/en_US/sdk.js",e.parentNode&&e.parentNode.insertBefore(t,e)}(),pu=!0)}var yu,wu=function(t){function e(e){var n=t.call(this,e)||this;return n.Xx=n.Xx.bind(n),n.Zx=n.Zx.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){ju()},n.render=function(){var t=Object(ae.a)().Share_Options_Facebook,e=Object(ae.a)().Share_Options_Twitter;return oe.createElement("div",{className:"flex-pane-social-channel-title-container"},Su(this.Xx,"facebookIcon",t),Su(this.Zx,"twitterIcon",e))},n.Xx=function(){try{FB.ui({href:this.Yx("Facebook"),method:"share"}),Object(g.b)("DesignPage.Send.Facebook")}catch(t){Object(g.c)("DesignPage.Send.Facebook",{error:t.message})}},n.Zx=function(){Object(g.b)("DesignPage.Send.Twitter");var t=encodeURIComponent(Object(ae.a)().SharePane_Twitter_FillFormMessage+" #MicrosoftForms"),e=encodeURIComponent(this.Yx("Twitter")),n=screen.width/2-300,i=screen.height/2-200;window.open("https://twitter.com/intent/tweet?text="+t+"&url="+e,"_blank","width=600,height=400,left="+n+",top="+i)},n.Yx=function(t){var e={id:this.props.FormMaster.Model.Id},n="../Pages/ResponsePage.aspx?"+jQuery.param(e),i={origin:t,time:Date.now()};return Object(f.a)(n)+"&"+jQuery.param(i)},e}(ue.a);function Su(t,e,n){return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"flex-pane-more-channel-option-social",onClick:t},Icon:e,Text:n})}function Nu(t,e,n,i,r){return r(),{cancelCallBack:i,CancelDisplayName:Object(ae.a)().Common_Cancel_Text,confirmCallBack:n,ConfirmDialogWarningMessage:t,ConfirmDisplayName:Object(ae.a)().Common_Yes_Text,LearnMoreLink:e}}!function(t){t[t.None=0]="None",t[t.Link=1]="Link",t[t.Email=2]="Email",t[t.QRCode=3]="QRCode",t[t.Embed=4]="Embed"}(yu||(yu={}));var Iu=function(t){function e(e){var n=t.call(this,e)||this;n.ce=!0,n.bl=[],n.vl=Object(_t.b)().Model,n.nj=oe.createRef(),n.tF=[],n.Oe=function(){n.ce&&n.forceUpdate()},n.wj=n.wj.bind(n),n.yj=n.yj.bind(n),n.Fx=n.Fx.bind(n),n.eF=n.eF.bind(n),n.nF=n.nF.bind(n);var i=n.iF();return n.state={CollectResponseOptionValue:i,LinkButtonChecked:!1,ShareButtonChanged:!1,ShareOption:yu.Link},n}Object(S.__extends)(e,t);var n=e.prototype;return n.iF=function(){return this.props.Form.getResponseCollectionType()},n.componentWillUnmount=function(){this.ce=!1,this.bl.forEach((function(t){t&&t.destroy()})),this.bl=[]},n.componentDidMount=function(){Object(_t.b)().Model.FormMaster.observe(this.Oe,[Zt.a.Schema.Questions]),this.wl("#flex-pane-button-link","#flex-pane-status-link",Object(ae.a)().SharePane_Link_SuccessMessage,Object(ae.a)().SharePane_Link_FailedMessage),this.wl("#flex-pane-button-embedCode","#flex-pane-status-embedCode",Object(ae.a)().SharePane_Others_Embed_SuccessMessage,Object(ae.a)().SharePane_Others_Embed_FailedMessage),this.wl("#flex-pane-share-ShareAsTemplate-link","#flex-pane-share-ShareAsTemplate-status-link",Object(ae.a)().SharePane_Link_SuccessMessage,Object(ae.a)().SharePane_Link_FailedMessage,"#flex-pane-ShareAsTemplate-delete-button"),this.wl("#flex-pane-share-Collaboration-link","#flex-pane-share-Collaboration-status-link",Object(ae.a)().SharePane_Link_SuccessMessage,Object(ae.a)().SharePane_Link_FailedMessage,"#flex-pane-Collaboration-delete-button"),this.wl("#flex-pane-share-AnalysisResult-link","#flex-pane-share-AnalysisResult-status-link",Object(ae.a)().SharePane_Link_SuccessMessage,Object(ae.a)().SharePane_Link_FailedMessage)},n.componentDidUpdate=function(){this.state.ShareOption===yu.Link&&this.state.LinkButtonChecked?$(Ln.findDOMNode(this.refs.link_button)).focus():this.state.ShareOption===yu.QRCode?$(Ln.findDOMNode(this.refs.qr_button)).focus():$(Ln.findDOMNode(this.refs.embed_button)).focus()},n.render=function(){var t=oe.createElement("div",{className:"flex-pane-content-container-title"},oe.createElement("div",null,Object(ae.a)().SharePane_CollectResponse_MoreChannels)),e=oe.createElement("div",{className:"flex-pane-collect-response-more-channel-element"},this.rF(),this.oF(),this.sF(),this.aF()),n=this.state.ShowConfirmDialog?oe.createElement(lu,Object(S.__assign)({},this._x)):oe.createElement("div",null,this.cF(),this.uF(),this.lF(),2===this.state.CollectResponseOptionValue&&this.qx(),e);return oe.createElement("div",{"aria-label":Object(ae.a)().SharePane_CollectResponse_MoreChannels,className:"flex-pane-collect-response-container"},t,n)},n.cF=function(){var t=this.props.Form.SettingMaster.Model.IsAnonymous,e=2===this.iF();return Object(u.a)().userInfo.IsMsa&&t?oe.createElement("div",{className:"flex-pane-share-content-title"},Object(ae.a)().SharePane_CollectResponse_DropDownOption1_Title):!Object(v.s)()||t||e?Object(v.s)()&&!t&&e?oe.createElement("div",{className:"flex-pane-share-content-title"},Object(ae.a)().SharePane_CollectResponse_DropDownSharing_Title):void 0:oe.createElement("div",{className:"flex-pane-share-content-title"},Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title)},n.aF=function(){return this.tF.length=0,oe.createElement("div",{className:"flex-pane-channel-title-container",role:"tablist"},this.hF(yu.Link,"Link","sharepane-response-link-icon"),this.hF(yu.QRCode,"qrcodeIcon","qrcode-icon"),this.hF(yu.Embed,"Embed",""),this.hF(yu.Email,"Mail",""),Object(u.a)().userInfo.IsMsa&&oe.createElement(wu,{FormMaster:this.props.Form}))},n.rF=function(){if(this.state.ShareOption===yu.Link)return oe.createElement("div",{className:"flex-pane-channel-content",role:"tabpanel"},oe.createElement("div",{className:"flex-pane-content-body-container"},this.fF()))},n.oF=function(){if(this.state.ShareOption!==yu.QRCode)return null;var t,e=this.props.Form;return t=oe.createElement("div",{id:"flex-pane-qrcode-img",ref:"qrcodeCanvas",className:"flex-pane-content-body-container"},oe.createElement("div",{className:"flex-pane-qrcode-container"},oe.createElement("span",{id:"qrcode-hint"},Object(ae.a)().SharePane_QRCode_Hint),oe.createElement("button",{"aria-describedby":"qrcode-hint",className:"flex-pane-button",ref:"qr_button",title:Object(ae.a)().SharePane_QRCode_DownloadButton,onClick:this.dF.bind(this)},Object(ae.a)().SharePane_QRCode_DownloadButton),void 0),oe.createElement(Ou,{URL:this.bF()+"&qrcode=true",Title:e.Model.Title,ref:"qrcode"})),oe.createElement("div",{className:"flex-pane-channel-content",role:"tabpanel"},t)},n.sF=function(){if(this.state.ShareOption===yu.Embed){var t=oe.createElement("div",{className:"flex-pane-subtitle"},Object(ae.a)().SharePane_Others_Embed_Label),e=oe.createElement("input",{"aria-label":Object(ae.a)().Embedded_Code_Text,readOnly:!0,value:this.mF(),className:"flex-pane-textbox",id:"flex-pane-textbox-embedCode"}),n={className:"flex-pane-button",id:"flex-pane-button-embedCode",ref:"embed_button","data-clipboard-target":"#flex-pane-textbox-embedCode"},i=oe.createElement("button",n,Object(ae.a)().Common_Copy_Text);return oe.createElement("div",{className:"flex-pane-channel-content",role:"tabpanel"},oe.createElement("div",{className:"flex-pane-content-body-container"},t,e,i,oe.createElement("div",{className:"flex-pane-status",id:"flex-pane-status-embedCode",role:"alert"})))}},n.vF=function(t,e){var n=(this.tF.indexOf(t)+(37===e?-1:1)+this.tF.length)%this.tF.length;this.tF[n].current.focus()},n.hF=function(t,e,n){var i,r=this,o=this.state.ShareOption===t;o&&this.state.ShareOption!==yu.Email&&(i=oe.createElement("div",{className:"flex-pane-more-channel-div"}));var s=o?"flex-pane-more-channel-icon active":"flex-pane-more-channel-icon";s=Object(pn.b)(s,n,"forms-icon-size24x24");var a=oe.createRef();return this.tF.push(a),oe.createElement("div",{className:"flex-pane-more-channel-box"},i,Object(yn.a)({HTMLAttributes:{"aria-selected":o,className:o?"flex-pane-more-channel-option active":"flex-pane-more-channel-option",role:"tab",onClick:function(){return r.gF(t)},onKeyDown:function(t){switch(t.keyCode){case 37:case 39:r.vF(a,t.keyCode)}}},Icon:e,IconClassName:s,ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:gu(yu[t]),key:yu[t],ref:a}))},n.gF=function(t){if(t===yu.Email)this.setState({ShareOption:yu.Email},this.eF);else{if(this.state.ShareOption!==t){Object(g.b)({Link:"DesignPage.Send.Link",Email:"DesignPage.Send.Email",Embed:"DesignPage.Send.MoreOptions",Navigate:"DesignPage.Send.Navigate",QRCode:"DesignPage.Send.QRCode",Sharing:"DesignPage.Send.Sharing",SocialShare:"DesignPage.Send.Share",ActionFailed:"DesignPage.Send.ActionFailed",ActionSuccess:"DesignPage.Send.ActionSuccess",CopyEmbedCode:"DesignPage.Send.CopyEmbedCode",CopyLink:"DesignPage.Send.CopyLink",DownloadQRCode:"DesignPage.Send.DownloadQRCode",SendEmails:"DesignPage.Send.SendEmails",AllowCopyCheckBox:"DesignPage.Send.AllowCopyCheckBox",ShareFormLink:"DesignPage.Send.ShareFormLink"}[yu[t]])}t===yu.Link&&this.setState({LinkButtonChecked:!0});var e=this.state.ShareButtonChanged;this.setState({ShareOption:t,ShareButtonChanged:!e})}},n.eF=function(){this.props.Form.getResponderEmailList().then(this.nF)},n.nF=function(t){var e=this;Object(g.b)("DesignPage.Send.Email");var n=Object(at.c)((function(){return e.props.Form.Model.Title}),at.f),i=Object(ae.a)().SharePane_Email_Content.format(n,this.bF());n=encodeURIComponent(Object(ae.a)().SharePane_Email_Subject.format(n)),i=encodeURIComponent(i);var r=t?"mailto:?bcc={2}&subject={0}&body={1}".format(n,i,t):"mailto:?subject={0}&body={1}".format(n,i),o=navigator.userAgent.toLowerCase(),s=/chrome|firefox/.test(o)||Object(et.p)()||Object(et.l)();if(Object(Z.q)()&&!/electron/.test(o)&&s){var a=window.open(r);a&&setTimeout((function(){return a.close()}),200)}else location.href=r;this.props.Form.triggerShareAction()},n.OF=function(){var t=this.props.Form.SettingMaster.Model;t.IsAnonymous=!0,t.NotRecordIdentity=!0,t.RequiresUniqueResponse=!1,Object(g.b)("DesignPage.Share.ChangeResponseCollectionType",{Value:"IsAnonymous"}),this.setState({CollectResponseOptionValue:0})},n.pF=function(){var t=this.props.Form.SettingMaster.Model;0===this.state.CollectResponseOptionValue&&(t.IsAnonymous=!1,t.NotRecordIdentity=!1),Object(g.b)("DesignPage.Share.ChangeResponseCollectionType",{Value:"InOrg"}),this.setState({CollectResponseOptionValue:1})},n.jF=function(){var t=this.props.Form.SettingMaster.Model;0===this.state.CollectResponseOptionValue&&(t.IsAnonymous=!1,t.NotRecordIdentity=!1),Object(g.b)("DesignPage.Share.ChangeResponseCollectionType",{Value:"SpecificRespond"}),this.setState({CollectResponseOptionValue:2})},n.lF=function(){var t=this;if(Object(u.a)().userInfo.IsMsa||Object(v.s)())return null;var e,n=this.props.Form,i=n.Model.OwnerTenantId===Object(u.a)().userInfo.TenantId,r=[{DisplayName:Object(ae.a)().SharePane_CollectResponse_DropDownOption1_Title,Value:0,Key:"AnonymousButton",DisplayContent:this.yF(),Disabled:!this.vl.FormsTenantSettings.externalSendForm||n.fileUploadAnonymousDisabled()}],o=i?Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title:Object(ae.a)().SharePane_CollectResponse_DropDownOption3_Title,s=i?Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Tooltip:Object(ae.a)().SharePane_CollectResponse_DropDownOption3_Tooltip,a=!1;switch(n.isFieldReady(Zt.a.Schema.Category)&&Object(Ri.a)(n,"DisableEditForm")&&(a=!0),r.push({DisplayName:o,Value:1,Key:"Non-AnonymousButton",DisplayContent:oe.createElement("span",{id:"Non-AnonymousButton",title:s},o)}),Object(Y.c)("SpecificResponder")&&r.push({DisplayName:Object(ae.a)().SharePane_CollectResponse_DropDownSharing_Title,Value:2,Key:"SpecificRespond",DisplayContent:oe.createElement("span",{id:"SpecificRespond",title:Object(ae.a)().SharePane_CollectResponse_DropDownSharing_Tooltip},Object(ae.a)().SharePane_CollectResponse_DropDownSharing_Title)}),this.state.CollectResponseOptionValue){case 0:e=Object(ae.a)().SharePane_CollectResponse_DropDownOption1_Title;break;case 1:e=i?Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title:Object(ae.a)().SharePane_CollectResponse_DropDownOption3_Title;break;case 2:e=Object(ae.a)().SharePane_CollectResponse_DropDownSharing_Tooltip}return oe.createElement("div",{className:"flex-pane-option-dropdown-element"},Object(Pr.b)({SelectOptions:r,Value:this.state.CollectResponseOptionValue,onValueChange:function(e){if(e!==t.state.CollectResponseOptionValue){switch(e){case 0:2===t.state.CollectResponseOptionValue?t.props.Form.getResponderPersonas().length>0?t._x=Nu(Object(ae.a)().RespondSharing_RemoveAwayFromSpecificSharing,null,(function(){t.props.Form.removeResponderPermissionLink(),t.OF(),t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!0})})):(t.props.Form.removeResponderPermissionLink(),t.OF()):t.OF();break;case 1:2===t.state.CollectResponseOptionValue?t.props.Form.getResponderPersonas().length>0?t._x=Nu(Object(ae.a)().RespondSharing_RemoveAwayFromSpecificSharing,null,(function(){t.props.Form.removeResponderPermissionLink(),t.pF(),t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!1})}),(function(){t.setState({ShowConfirmDialog:!0})})):(t.props.Form.removeResponderPermissionLink(),t.pF()):t.pF();break;case 2:t.jF(),t.props.Form.appendResponderPermission("SpecificResponder")}}},HTMLAttributes:{"aria-label":e,disabled:a}}))},n.yF=function(){var t=this.props.Form;return[oe.createElement("span",{id:"AnonymousButton",title:Object(ae.a)().SharePane_CollectResponse_DropDownOption1_Tooltip},Object(ae.a)().SharePane_CollectResponse_DropDownOption1_Title),t.fileUploadAnonymousDisabled()&&Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16 flex-pane-anonymous-warning-icon",onMouseLeave:this.yj,onMouseOver:this.wj},IconName:"Error",key:"warningIcon"})]},n.uF=function(){if(this.props.Form.fileUploadAnonymousDisabled()){var t=Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title;return oe.createElement("div",{className:"flex-pane-anonymous-tip",ref:this.nj},oe.createElement("div",{className:"flex-pane-anonymous-container"},oe.createElement("div",{className:"flex-pane-anonymous-tip-text"},Object(ae.a)().UploadFile_Setting_Pane_Sign_In_Tip.format(t)),oe.createElement("div",{className:"flex-pane-anonymous-tip-beak"}),oe.createElement("div",{className:"flex-pane-anonymous-tip-beak-shadow"})))}},n.wj=function(){$(this.nj.current).css("display","inline-block")},n.yj=function(){$(this.nj.current).css("display","none")},n.fF=function(){var t={readOnly:!0,"aria-label":Object(ae.a)().Link_Collect_Responses,value:this.bF(),className:"flex-pane-textbox",id:"flex-pane-textbox-link",onClick:function(){var t=$("#flex-pane-textbox-link");t.focus(),t.select()}},e=oe.createElement("input",t),n={type:"button",className:"flex-pane-button",id:"flex-pane-button-link",ref:"link_button",onClick:function(){Object(g.b)("DesignPage.Send.CopyLink")},"data-clipboard-target":"#flex-pane-textbox-link"},i=oe.createElement("button",n,Object(ae.a)().Common_Copy_Text);return oe.createElement("div",null,e,i,oe.createElement("div",{className:"flex-pane-status",id:"flex-pane-status-link",role:"alert"}))},n.wl=function(t,e,n,i,r){var o=new Clipboard(t);this.bl.push(o);var s=this.props.Form;o.on("success",(function(i){s.triggerShareAction(),Object(g.b)("DesignPage.Send.ActionSuccess",{action:t});var o=$(e);o.removeClass("flex-pane-status-error"),o.addClass("flex-pane-status-success"),o.text(n),o.show(),o.attr("aria-label",n);var a=$(r);a.css("margin-bottom",o.height()),setTimeout((function(){o.fadeOut("slow",(function(){o.hide(),a.css("margin-bottom","0")}))}),3e3),i.clearSelection()})),o.on("error",(function(){Object(g.b)("DesignPage.Send.ActionFailed",{action:t});var n=$(e);n.removeClass("flex-pane-status-success"),n.text(i),n.addClass("flex-pane-status-error"),n.attr("aria-label",i)}))},n.dF=function(){var t=this.refs.qrcode;t&&(t.download(),this.props.Form.triggerShareAction(),Object(g.b)("DesignPage.Send.DownloadQRCode"))},n.mF=function(){var t={id:this.props.Form.Model.Id,embed:!0},e="../Pages/ResponsePage.aspx?"+jQuery.param(t);return'<iframe width="640px" height= "480px" src= "'+Object(f.a)(e)+'" frameborder= "0" marginwidth= "0" marginheight= "0" style= "border: none; max-width:100%; max-height:100vh" allowfullscreen webkitallowfullscreen mozallowfullscreen msallowfullscreen> </iframe>'},n.bF=function(){var t={id:this.props.Form.Model.Id},e="../Pages/ResponsePage.aspx?"+jQuery.param(t);return Object(f.a)(e)},n.qx=function(){return Object(g.b)("LazylazyShareToPeople.Start"),oe.createElement("div",{className:"share-to-people-container"},oe.createElement(mu,{Disable:!this.props.Form.isCurrentUserFormOwnerOrGroupMember(),onSelectPersonas:this.Fx,onClickManagePermission:this.props.OnClickManageAccess,SpecificPeoplePermissions:this.props.Form.getResponderPersonas(),IsRespondSharing:"WhoCanRespond"}))},n.Fx=function(t){var e=this,n=t.map((function(t){Object(Qe.b)(new Qe.a(t.id,t.primaryText,t.secondaryText,t.secondaryText));var n={FormId:e.props.Form.Model.Id,IsOwner:!1,PermissionSet:"DataCreator",PrincipalEmailAddress:t.secondaryText,PrincipalName:t.primaryText,PrincipalId:t.id,SavingState:"Saving",Type:t.optionalText};return Object(g.b)("DesignPage.Share.AddSpecificResponderPeople",{linkType:t.optionalText}),n}));return new Promise((function(t,i){return e.props.Form.appendSpecificResponderPermissions(n).then(t,i)}))},e}(ue.a);var Cu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.vl=Object(_t.b)().Model,e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this.props.Form.SettingMaster.Model;this.setState({AllowCopy:t.AllowCopy&&!!t.ShareToken,Token:t.ShareToken})},n.createLink=function(){this.wF(!0)},n.deleteLink=function(){this.wF(!1)},n.disableControls=function(){var t=Object(u.a)().userInfo.IsMsa,e=this.props.Form.Model.OwnerTenantId,n=Object(M.b)();return t!==((null==e?void 0:e.toLowerCase())===n)},n.getShareContentUrl=function(){var t={id:this.props.Form.Model.Id,sharetoken:this.state.Token},e="../Pages/ShareFormPage.aspx?"+jQuery.param(t);return Object(f.a)(e)},n.createTitle=function(){var t;return t=Object(v.s)()||!this.vl.FormsTenantSettings.externalShareTemplate?Object(ae.a)().SharePane_ShareAsTemplateNotAllowed_Title:Object(ae.a)().SharePane_ShareAsTemplate_Title,oe.createElement("div",{className:"flex-pane-share-content-title"},t)},n.wF=function(t){var e=this,n=this.props.Form;n.SettingMaster.setSharingStatus(n.Model.Id,t).then((function(){Object(g.b)(t?"DesignPage.Share.CreateShareAsTemplateLink":"DesignPage.Share.DeleteShareAsTemplateLink"),e.needUpdateFocus=!0,e.setStateSafely({ShowSpinner:!1,AllowCopy:t,Token:n.SettingMaster.Model.ShareToken,ShowError:!1})})).catch((function(t){e.setStateSafely({AllowCopy:n.SettingMaster.Model.AllowCopy,ShowSpinner:!1,ShowError:!0});var i=Object(Ue.a)(""+t.innerCode);e.showErrorStatus(i,"flex-pane-ShareAsTemplate-status")}))},e}(du),ku=function(t){function e(e){var n=t.call(this,e)||this;return n.Ze=Et.uniqueId(n.currentViewName()),n.kT=n.Ze+"-nagivation-button",n.TT=n.Ze+"-title",n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-labelledby":Object(pn.b)(this.TT,this.kT),autoFocus:!0,className:"flex-pane-second-layer-view-navigation",id:this.kT,onClick:this.onClickBack},Icon:"Back",IconClassName:"flex-pane-second-layer-back forms-icon-size16x16",Text:Object(ae.a)().Common_Back_Text,TextClassName:"flex-pane-second-layer-view-navigation-text"});return oe.createElement("div",{className:"flex-pane-second-layer-view-container","aria-label":this.createViewTitle(),tabIndex:-1},oe.createElement("div",{className:"flex-pane-second-layer-view-navigation-container"},t),oe.createElement("div",{className:"flex-pane-second-layer-view-title"},oe.createElement("span",null,this.createViewTitle())),oe.createElement("div",{className:"flex-pane-second-layer-view-content"},this.createViewContent()),this.errorHandler())},n.onClickBack=function(){return this.props.OnViewNavigation()},n.errorHandler=function(){},e}(ue.a),Tu=n(184),xu=n(185),Fu=function(t){function e(e){var n=t.call(this,e)||this;return n.WT=Object(ae.a)(),n.state={Loaded:!1,People:n.props.People},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t,e=this,n=this.state.People,i=n.primaryText||this.WT.Searching,r=n.secondaryText?i+" ("+n.secondaryText+")":i;t=this.props.IsSpecificRespond?this.props.IsMobile?null:this.WT.CanRespond:this.props.IsOwner?this.WT.Owner:this.state.Loaded&&this.WT.ViewAndEdit;var o="User"===n.optionalText?Object(xu.b)(n.id):Object(Tu.b)(n.id),s=oe.createElement(ou.a,{DisplayName:r,HideName:!0,Photo:o,PhotoType:0,key:n.id}),a=(this.props.ReadOnly,!this.props.ReadOnly&&this.state.Loaded),c=this.props.ReadOnly&&!this.props.IsSpecificRespond?"manage-access-view-content-people-level-readonly":"manage-access-view-content-people-level",u=(a=a||this.props.IsMobile)&&Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"manage-access-view-content-edit",onClick:function(){e.props.onClickRemovePermission(n)}},Icon:"Delete",IconClassName:"forms-icon-size14x20",Text:this.WT.UploadFile_Delete_Uploaded_File_Label.format(i)});return oe.createElement("div",{className:"manage-access-view-content-people",key:this.props.People.id,role:"listitem"},s,oe.createElement("span",{className:"manage-access-view-content-people-name",title:r},i),oe.createElement("span",{className:c},oe.createElement("span",{className:"manage-access-view-content-people-permission"},t),u))},n.componentDidMount=function(){var t=this,e=this.state.People;if(!this.state.People.primaryText){var n=e.optionalText;Object(Qe.c)(n,e.id).then((function(n){e.primaryText=n.DisplayName,e.secondaryText=n.UserPrincipalName||n.Mail,t.setState({Loaded:!0,People:e})})).catch((function(i){var r;404===(null===(r=null==i?void 0:i.response)||void 0===r?void 0:r.statusCode)?("User"===n?(e.primaryText=t.WT.Common_UnknownUser_Text,e.secondaryText=t.WT.UserNotExist):(e.primaryText=t.WT.Common_UnknownGroup_Text,e.secondaryText=t.WT.GroupNotExist),t.setState({Loaded:!0,People:e})):t.setState({Loaded:!0})}))}},e}(ue.a),Pu=function(t){function e(e){var n=t.call(this,e)||this;if(n.WT=Object(ae.a)(),n.SF=!n.props.Form.isCurrentUserFormOwnerOrGroupMember(),n.onClickBack=n.onClickBack.bind(n),n.NF=n.NF.bind(n),n.createViewTitle=n.createViewTitle.bind(n),"WhoCanRespond"===n.props.ManageRespondSharing)n.state={SelectedPeopleList:n.props.Form.getResponderPersonas(),RemovedUserName:""};else{var i=n.props.Form.getUserOrGroupPermissions(),r=Et.map(i,(function(t){return{id:t.PrincipalId,optionalText:t.Type,primaryText:t.PrincipalName,secondaryText:t.PrincipalEmailAddress}}));n.state={SelectedPeopleList:r,RemovedUserName:""}}return n}Object(S.__extends)(e,t);var n=e.prototype;return n.createViewTitle=function(){return"WhoCanRespond"===this.props.ManageRespondSharing?this.WT.ManageWhoCanRespond:this.WT.ManageTheAccess},n.createViewContent=function(){var t=this,e=this.state.SelectedPeopleList,n=Et.find(e,(function(e){return e.id===t.props.Form.Model.OwnerId})),i=[n?this.IF(!0,n):null];e.forEach((function(e){e.id!==t.props.Form.Model.OwnerId&&i.push(t.IF(!1,e))}));var r=this.state.RemovedUserName,o=oe.createElement("span",{className:"manage-access-delete-live-region","aria-live":"polite",role:"status","aria-label":r},r);return oe.createElement("div",{className:"manage-access-view-content-peopleList",role:"list"},o,i)},n.currentViewName=function(){return"WhoCanRespond"===this.props.ManageRespondSharing?"ManageResponderView":"ManageAccessView"},n.onClickBack=function(){this.props.OnViewNavigation()},n.IF=function(t,e){return oe.createElement(Fu,{IsOwner:t,key:e.id,onClickRemovePermission:this.NF,People:e,ReadOnly:t&&"WhoCanRespond"!==this.props.ManageRespondSharing||this.SF,IsSpecificRespond:"WhoCanRespond"===this.props.ManageRespondSharing})},n.NF=function(t){var e,n;this.state.RemovedUserName&&this.setState({RemovedUserName:""}),"WhoCanRespond"===this.props.ManageRespondSharing?n=Et.find(this.props.Form.Model.ResponderPermissions,(function(e){return e.PrincipalId===t.id})):e=Et.find(this.props.Form.Model.Permissions,(function(e){return e.PrincipalId===t.id}));var i=Et.without(this.state.SelectedPeopleList,t),r=t.primaryText?this.WT.User_Removed_From_ManageAccess_CanReadName.format(t.primaryText):this.WT.User_Removed_From_ManageAccess,o=Et.find(i,(function(e){return e.id===t.id}))?"":r;"WhoCanRespond"===this.props.ManageRespondSharing?this.props.Form.removeResponderPermissions([n]):this.props.Form.removePermissions([e]),this.setState({SelectedPeopleList:i,RemovedUserName:o})},e}(ku);var Du=function(t){function e(e){var n=t.call(this,e)||this;return n.CF=n.CF.bind(n),n.kF=n.kF.bind(n),n.state={CurrentView:0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{id:"flex-pane-share-pane"},this.TF(),this.xF(),this.FF())},n.TF=function(){var t,e=this;return 0!==this.state.CurrentView?null:oe.createElement("div",{className:"flex-pane-share-options-container"},Object(at.b)((function(){return oe.createElement(Iu,{Form:e.props.Form,OnClickManageAccess:e.kF(2)})})),Object(at.b)((function(){return t={Form:e.props.Form,ShareOption:cu.ShareAsTemplate},oe.createElement(Cu,Object(S.__assign)({},t));var t})),Object(u.a)().userInfo.IsMsa?void 0:(t={Form:this.props.Form,OnClickManageAccess:this.kF(1),ShareOption:cu.Collaboration},oe.createElement(vu,Object(S.__assign)({},t))))},n.xF=function(){return 1!==this.state.CurrentView?null:oe.createElement(Pu,{Form:this.props.Form,OnViewNavigation:this.kF(0),ManageRespondSharing:"WhoCanAccess"})},n.FF=function(){return 2!==this.state.CurrentView?null:oe.createElement(Pu,{Form:this.props.Form,OnViewNavigation:this.kF(0),ManageRespondSharing:"WhoCanRespond"})},n.CF=function(t){this.setState({CurrentView:t})},n.kF=function(t){var e=this;return function(){return e.CF(t)}},e}(ue.a),Mu=function(t){function e(e){var n=t.call(this,e)||this;n._f=!1,n.Oe=function(){return n.forceUpdate()},n.PF=n.PF.bind(n),n.ZT=n.ZT.bind(n),n.ua=Object(_t.b)().Model.FormMaster;var i=n.ua.ThemeMaster;n.state={Theme:i,CustomizedImage:n.ua.Model.Background,ShowSpinner:!1,ShowErrorMessage:!1,ColorScriptLoaded:!1,ShowSuggestThemeView:!0};var r=n.ua.getImageMaster(n.ua.Schema.Background);return r.observe(n.Oe,[r.Schema.ImageProcessingStatus]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(An.a)("ColorThief").then((function(){t.setState({ColorScriptLoaded:!0})}))},n.componentWillUnmount=function(){this.ua.getImageMaster(this.ua.Schema.Background).unobserve(this.Oe)},n.componentDidUpdate=function(){var t=Ln.findDOMNode(this.refs.AddImageButton);t&&this._f&&(t.focus(),this._f=!1)},n.render=function(){return oe.createElement("div",null,this.tx(),oe.createElement("div",{className:"theme-designer-container",key:"theme-designer-container"},this.KT(),this.state.CustomizedImage.ResourceId?this.JT():this.DF()),this.MF())},n.tx=function(){return oe.createElement(Jc,{applyTheme:this.PF,expandOrCollapseSuggest:this.ZT,ExpandView:this.state.ShowSuggestThemeView,FormMaster:this.ua})},n.KT=function(){var t=this,e=this.ua.ThemeMaster;return eu.map((function(n){var i,r=Object(Zc.a)(n.Name),o={className:"theme-icon-button",title:r,"aria-label":r,onClick:function(){return t.LF(n.Name,t.ua)}};return i=n.Thumbnail?{backgroundImage:"url("+n.Thumbnail+")"}:{backgroundColor:n.PrimaryColor},oe.createElement("span",{className:"theme-icon-container",key:n.Name},Object(qo.b)({HTMLAttributes:o,key:n.Name,ButtonStyle:"LightBackground",ToggleActive:e.Model.Name===n.Name,children:oe.createElement("span",{className:"theme-icon",style:i})}))}))},n.JT=function(){var t=this,e=this.ua.ThemeMaster,n=this.ua.Model.Background,i={className:"theme-icon-button",title:Object(ae.a)().Customized_Theme_Name,onClick:function(){return t.AF()}},r=Object(yn.a)({HTMLAttributes:{className:"customized-theme-delete-button",onClick:function(){Object(g.b)("DesignPage.Theme.DeleteImage"),t.setState({ShowSpinner:!0});var e=Object(_t.b)().Model.FormMaster,n=e.getImageMaster(Zt.a.Schema.Background),i=t.state.Theme.Model.Name===Sn.a;n.clear().then((function(){t.setState({ShowSpinner:!1}),t._f=!0,i?t.LF(Object(us.d)().Name,e):t.forceUpdate()}))}},Icon:"Delete",IconClassName:"paneThemeTrash forms-icon-size18x18",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(ae.a)().Common_Delete_Text,key:"deleteButton"});return oe.createElement("span",{className:"theme-icon-container",key:"added"},Object(qo.b)({HTMLAttributes:i,ButtonStyle:"LightBackground",ToggleActive:e.Model.Name===Sn.a,children:oe.createElement("img",{className:"theme-icon",key:Sn.a,src:n.IsPredefined?n.ResourceUrl:n.ResourceUrl+"_mo",onLoad:function(){t.setState({ShowSpinner:!1})}})}),r,this.RF())},n.DF=function(){var t=this,e={className:"theme-icon-button",disabled:this.ua.getImageMaster(Zt.a.Schema.Background).Model.ImageProcessingStatus!==ee.c.Idle,onClick:function(){return t.EF()}};return oe.createElement("span",{className:"theme-icon-container",key:"add"},Object(yn.a)({HTMLAttributes:e,Icon:"Photo2",IconClassName:"customized-theme-pictureAdd-icon forms-icon-size28x28",ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Text:Object(ae.a)().Add_Customized_Theme_Image,ref:"AddImageButton"}),this.RF())},n.EF=function(){var t=this;Object(g.b)("DesignPage.Theme.AddImage"),Object(as.b)().then((function(e){Object(_t.b)().Model.FlexPane="Theme";var n=t.ua.Model;if(t.setState({ShowSpinner:!0}),t.ua.getImageMaster(Zt.a.Schema.Background).addImage(e).finally((function(){t.AF()})),t.state.ColorScriptLoaded)if(e.File&&e.File.size<=Object(Pe.r)()){var i=new FileReader;i.onload=function(e){var r=new Image;r.src=i.result.toString(),r.onload=function(e){var i,o=new ColorThief;try{i=o.getColor(r)}catch(t){i=[0,130,114]}var s={R:i[0],G:i[1],B:i[2]},a=Object(Xc.j)(s);Object(Xc.f)(s)||(a.V=.45,s=Object(Xc.d)(a)),t.ua.bulkEdit((function(){n.PrimaryCustomizedThemeColor=Object(Xc.b)(s);var t=Object(Xc.d)({H:a.H,S:a.S,V:a.V-.1});n.SecondaryCustomizedThemeColor=Object(Xc.b)(t);var e=Object(Xc.d)({H:a.H,S:.1,V:1});n.TertiaryCustomizedThemeColor=Object(Xc.b)(e)}))}},i.readAsDataURL(e.File)}else e.FromUrl&&t.ua.bulkEdit((function(){var t=Object(us.d)();n.PrimaryCustomizedThemeColor=t.PrimaryColor,n.SecondaryCustomizedThemeColor=t.SecondaryColor,n.TertiaryCustomizedThemeColor=t.BackgroundColor}))}))},n.LF=function(t,e){var n=e.ThemeMaster;Object(g.b)("DesignPage.Theme.SwitchTheme",{theme:t},null,!0),n.Model.Name=t,this.setState({Theme:n,ShowErrorMessage:!1})},n.AF=function(){var t=this.ua.Model;t.Background.ResourceUrl?this.LF(Sn.a,this.ua):(t.PrimaryCustomizedThemeColor=void 0,t.SecondaryCustomizedThemeColor=void 0,t.TertiaryCustomizedThemeColor=void 0,this.setState({ShowErrorMessage:!0}))},n.PF=function(t){this.ua.ThemeMaster.Model.Name=t,this.setState({ShowErrorMessage:!1})},n.ZT=function(){this.setState({ShowSuggestThemeView:!this.state.ShowSuggestThemeView})},n.RF=function(){var t=this.ua.getImageMaster(Zt.a.Schema.Background);return!this.state.ShowSpinner&&t.Model.ImageProcessingStatus===ee.c.Idle||t.Model.ErrorType!==ee.a.NoError?void 0:oe.createElement("div",{className:"customized-theme-spinner-container"},oe.createElement("div",{className:"customized-theme-spinner customized-theme-spinner-inner-container"},oe.createElement("div",{className:"common-spinner-circle"})))},n.MF=function(){var t=Object(_t.b)().Model.FormMaster;if(!t)return null;var e=t.getImageMaster(Zt.a.Schema.Background),n=e.Model;if(!this.state.ShowErrorMessage||n.ErrorType===ee.a.NoError)return null;var i=Object(xr.a)({HTMLAttributes:{className:"error-message"},Label:e.getImageErrorMessage(),key:"error-message"}),r=Object(Un.b)({HTMLAttributes:{className:"customized-theme-error-frowny-icon"},IconName:"Sad",key:"customized-theme-error-frowny-icon"});return oe.createElement("div",{className:"customized-theme-error",key:"customized-them-error"},r,i)},e}(ue.a);var Lu=n(132),Au=n(240),Ru=function(t){function e(e){var n=t.call(this,e)||this;return n.state={DataClassificationValue:"General",LabelsLoaded:!1},n.gO=n.gO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(st.b)().then((function(e){t.uu=Object(et.G)(e),t.setState({LabelsLoaded:!0})}))},n.render=function(){var t=Object(Un.b)({HTMLAttributes:{"aria-label":Object(ae.a)().DesignPage_SettingsPane_DataClassification_Description,className:"forms-icon-size16x16",tabIndex:0,title:Object(ae.a)().DesignPage_SettingsPane_DataClassification_Description},IconName:"Info",key:"icon"});if(!this.props.EnterDataClassificationSettingPane){var e=Object(ae.a)().DesignPage_SettingsPane_DataClassification_External_Title.format(null===this.props.FormMaster.Model.DataClassificationLabel?this.BF():this.props.FormMaster.Model.DataClassificationLabel);return oe.createElement("div",{className:"setting-pane-data-classification"},e,oe.createElement("a",{"aria-label":Object(ae.a)().DesignPage_SettingsPane_DataClassification_Edit,className:"__data-classification-edit__ setting-pane-data-classification-link",onClick:this.props.EditDataClassificationSettingCallBack.bind(this,!0),href:"javascript:void(0)"},oe.createElement("span",null,Object(ae.a)().Common_Edit_Text)),oe.createElement("div",{className:"setting-select-tooltip"},t))}var n=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{autoFocus:!0,className:"setting-pane-navigation",onClick:this.props.EditDataClassificationSettingCallBack.bind(this,!1)},Icon:"Back",IconClassName:"paneBack forms-icon-size16x16",Text:Object(ae.a)().Common_Back_Text,TextClassName:"setting-pane-navigation-text"});return oe.createElement("div",{className:"setting-pane-data-classification-container"},oe.createElement("div",{className:"setting-pane-navigation-container"},n),oe.createElement("div",{className:"flex-pane-content"},oe.createElement("div",{className:"setting-pane-group setting-pane-group-label"},oe.createElement("div",{className:"setting-select-title"},Object(ae.a)().DesignPage_SettingsPane_DataClassification_Title,oe.createElement("div",{className:"setting-select-tooltip"},t)),oe.createElement("div",{className:"setting-pane-select"},this._F()))))},n._F=function(){if(!this.state.LabelsLoaded)return oe.createElement("div",{className:"setting-pane-placerholder"},oe.createElement("div",{className:"simple-data-control-loading-spinner-animation"}));var t=this.uu.map((function(t){return{DisplayContent:[oe.createElement("span",{title:t.description,"aria-label":t.level+" "+t.description},t.level)],DisplayName:t.level,Key:t.level,Value:t.level}})),e=this.props.FormMaster.Model.DataClassificationLabel,n=Object(Pr.b)({HTMLAttributes:{"aria-label":Object(ae.a)().DesignPage_SettingsPane_DataClassification_Selector},onValueChange:this.gO,SelectOptions:t,Value:null===e?this.BF():e});return oe.createElement("div",{"aria-label":e,className:"__data-classification-select__ setting-pane-option-dropdown-element"},n)},n.gO=function(t){var e=this.props.FormMaster;this.setState({DataClassificationValue:t}),e.Model.DataClassificationLabel=t,Object(g.b)("DesignPage.Setting.DataClassificationLabel")},n.BF=function(){if(this.uu)for(var t=0,e=this.uu;t<e.length;t++){var n=e[t];if(n.isDefaultLabel)return n.level}return""},e}(ue.a);var Eu=function(t){function e(e){var n=t.call(this,e)||this;n.vl=Object(_t.b)().Model,n.nj=oe.createRef();var i=n.iF();return n.state={ShowRespondDetailSettings:i},n.yj=n.yj.bind(n),n.wj=n.wj.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this,e=this.props.Form;this.Oe=function(){return t.forceUpdate()},e.SettingMaster.observe(this.Oe)},n.componentWillUnmount=function(){var t=this.props.Form;t.unobserve(this.Oe),t.SettingMaster.unobserve(this.Oe)},n.render=function(){var t=Object(v.s)()?1:2,e=this.state.ShowConfirmDialog?oe.createElement(lu,Object(S.__assign)({},this._x)):oe.createElement("div",null,this.HF("SettingsPane-Response",1,2),this.GF("SettingsPane-Response",t,t),Object(Y.c)("SpecificResponder")&&this.qF("SettingsPane-Response",t,t));return oe.createElement("div",{className:"flex-pane-content"},oe.createElement("div",{"aria-labelledby":"SettingsPane-Response",className:"setting-pane-group",role:"radiogroup"},oe.createElement("div",{className:"setting-group-title"},Object(ae.a)().DesignPage_SettingsPane_Share_Title),e))},n.wj=function(){$(this.nj.current).css("display","inline-block")},n.yj=function(){$(this.nj.current).css("display","none")},n.QF=function(){},n.VF=function(){},n.zF=function(){var t=this.props.Form.SettingMaster,e=t.Model;Object(g.b)("DesignPage.Setting.ChangeResponseCollectionType",{Value:"IsAnonymous"}),t.bulkEdit((function(){e.IsAnonymous=!0,e.NotRecordIdentity=!0,e.RequiresUniqueResponse=!1})),this.setState({ShowRespondDetailSettings:0})},n.HF=function(t,e,n){var i=this,r=this.props.Form,o=r.SettingMaster.Model;return this.UF({Description:Object(ae.a)().SharePane_CollectResponse_DropDownOption1_Title,HelpText:Object(ae.a)().DesignPage_SettingsPane_Share_Public_Help,Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":e,"aria-setsize":n}},RadioCheckbox:!0,Value:Object(at.c)((function(){return o.IsAnonymous}),at.f),onValueChange:function(){0!==i.state.ShowRespondDetailSettings&&(2===i.state.ShowRespondDetailSettings?i.props.Form.getResponderPersonas().length>0?i._x=Nu(Object(ae.a)().RespondSharing_RemoveAwayFromSpecificSharing,null,(function(){i.zF(),i.props.Form.removeResponderPermissionLink(),i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!0})})):(i.zF(),i.props.Form.removeResponderPermissionLink()):i.zF())},Id:"AnonymousButton",Disabled:!this.vl.FormsTenantSettings.externalSendForm||this.props.Form.IsAssignmentForm||r.fileUploadAnonymousDisabled(),children:r.fileUploadAnonymousDisabled()&&this.$F()})},n.$F=function(){var t=Object(Un.b)({HTMLAttributes:{className:"forms-icon-size12x12 flex-pane-anonymous-warning-icon",onMouseLeave:this.yj,onMouseOver:this.wj},IconName:"Info",key:"warningIcon"}),e=Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title;return[t,oe.createElement("div",{className:"flex-pane-anonymous-tip",ref:this.nj},oe.createElement("div",{className:"flex-pane-anonymous-container"},oe.createElement("div",{className:"flex-pane-anonymous-tip-text"},Object(ae.a)().UploadFile_Setting_Pane_Sign_In_Tip.format(e)),oe.createElement("div",{className:"flex-pane-anonymous-tip-beak"}),oe.createElement("div",{className:"flex-pane-anonymous-tip-beak-shadow"})))]},n.WF=function(){var t=this.props.Form.SettingMaster.Model;return null!=t.NotRecordIdentity||t.IsAnonymous||(t.NotRecordIdentity=!1),this.UF({Disabled:this.props.Form.IsAssignmentForm||t.IsAnonymous,Description:Object(ae.a)().DesignPage_SettingsPane_Share_RecordIdentityOfQuizVNext,Id:"RecordNamesOfResponders",Value:!t.NotRecordIdentity,onValueChange:function(e){Object(g.b)("DesignPage.Setting.RecrodIdentity"),t.NotRecordIdentity=!e}})},n.KF=function(){var t=this.props.Form.SettingMaster.Model,e=this.props.Form.IsAssignmentForm||t.IsAnonymous;return this.props.Form.IsAssignmentForm&&!t.IsAnonymous&&(t.RequiresUniqueResponse=!0),this.UF({Disabled:e,Description:Object(ae.a)().DesignPage_SettingsPane_Share_OneResponse,Id:"SingleReponsePerPerson",Value:t.RequiresUniqueResponse,onValueChange:function(e){Object(g.b)("DesignPage.Setting.RequireUniqueResponse"),t.RequiresUniqueResponse=e}})},n.pF=function(){var t=this.props.Form.SettingMaster,e=t.Model;Object(g.b)("DesignPage.Setting.ChangeResponseCollectionType",{Value:"InOrg"}),0===this.state.ShowRespondDetailSettings&&t.bulkEdit((function(){e.IsAnonymous=!1,e.NotRecordIdentity=!1})),this.setState({ShowRespondDetailSettings:1})},n.GF=function(t,e,n){var i=this,r=Object(ae.a)().SharePane_CollectResponse_DropDownOption2_Title;return this.UF({Disabled:this.props.Form.IsAssignmentForm,Description:r,Id:"Non-AnonymousButton",Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":e,"aria-setsize":n}},RadioCheckbox:!0,Value:1===this.state.ShowRespondDetailSettings,onValueChange:function(){1!==i.state.ShowRespondDetailSettings&&(2===i.state.ShowRespondDetailSettings?i.props.Form.getResponderPersonas().length>0?i._x=Nu(Object(ae.a)().RespondSharing_RemoveAwayFromSpecificSharing,null,(function(){i.pF(),i.props.Form.removeResponderPermissionLink(),i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!1})}),(function(){i.setState({ShowConfirmDialog:!0})})):(i.pF(),i.props.Form.removeResponderPermissionLink()):i.pF())},children:1===this.state.ShowRespondDetailSettings?oe.createElement("div",{"aria-label":r},this.WF(),this.KF()):null})},n.JF=function(){var t=this.props.Form.SettingMaster,e=t.Model;Object(g.b)("DesignPage.Setting.ChangeResponseCollectionType",{Value:"SpecificRespond"}),0===this.state.ShowRespondDetailSettings&&t.bulkEdit((function(){e.IsAnonymous=!1,e.NotRecordIdentity=!1})),this.setState({ShowRespondDetailSettings:2})},n.qF=function(t,e,n){var i=this,r=Object(ae.a)().SharePane_CollectResponse_DropDownSharing_Title;return this.UF({Disabled:this.props.Form.IsAssignmentForm,Description:r,Id:"SpecificRespond",Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":e,"aria-setsize":n}},RadioCheckbox:!0,Value:2===this.state.ShowRespondDetailSettings,onValueChange:function(){2!==i.state.ShowRespondDetailSettings&&(i.JF(),i.props.Form.appendResponderPermission("SpecificResponder"))},children:2===this.state.ShowRespondDetailSettings?oe.createElement("div",{"aria-label":r},this.WF(),this.KF()):null})},n.UF=function(t){t.HTMLAttributes=t.HTMLAttributes||{},t.HTMLAttributes.className=t.HTMLAttributes.className||"setting-pane-checkbox",t.Options=t.Options||{classNameForInnerDiv:"flex-pane-checkbox-info",classNameForInnerLabel:"flex-pane-checkbox-label settings-display-inline"};var e=this.props.Form;return Object(Ri.a)(e,"DisableEditForm")&&(t.Disabled=!0),Object(Lu.a)(t)},n.XF=function(t){},n.ZF=function(t){0},n.iF=function(){return this.props.Form.getResponseCollectionType()},e}(ue.a),Bu=n(177);var _u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t={Label:this.props.Title,HTMLAttributes:{className:"setting-pane-toggle-item-title"},Options:{classNameForInnerDiv:"setting-pane-toggle-button"},Value:this.props.Value,onValueChange:this.props.onChange};return oe.createElement("div",{className:"setting-pane-toggle-group"},Object(Bu.a)(t),this.YF())},n.YF=function(){if(null!=this.props.Description)return oe.createElement("div",{className:"setting-pane-toggle-item-notification"},this.props.Description)},e}(ue.a);var Hu=function(t){function e(e){var n=t.call(this,e)||this;n.vl=Object(_t.b)().Model;var i,r,o=n.props.Form.SettingMaster.Model,s=Object(Pe.h)();if(o.LockGivenQuestionsStartDisplayOrder&&o.LockGivenQuestionsEndDisplayOrder)i=o.LockGivenQuestionsStartDisplayOrder.toString(),r=o.LockGivenQuestionsEndDisplayOrder.toString();else{var a=n.props.Form;i=s.toString(),o.LockGivenQuestionsStartDisplayOrder=s;var c=a.FormElementManager.TopQuestionMasters.length;r=c.toString(),o.LockGivenQuestionsEndDisplayOrder=c}return n.state={EndRange:r,ShowShuffleQuestionRangeError:!1,ShowThresholdResponseRangeError:!1,ShowThresholdExpiryDaysRangeError:!1,StartRange:i,ShowDataClassificationSettingPane:!1},n.tP=function(t){return n.eP(t)},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this,e=this.props.Form;this.Oe=function(){return t.forceUpdate()},e.SettingMaster.observe(this.Oe),e.observe(this.Oe,[Zt.a.Schema.HasValidBranching,Zt.a.Schema.QuizQuestionsCount,Zt.a.Schema.ThankYouMessage,Zt.a.Schema.EmailReceiptEnabled,Zt.a.Schema.ProgressBarEnabled])},n.componentWillUnmount=function(){var t=this.props.Form;t.unobserve(this.Oe),t.SettingMaster.unobserve(this.Oe)},n.componentDidUpdate=function(t,e){if(e.ShowDataClassificationSettingPane&&!this.state.ShowDataClassificationSettingPane){var n=$(".setting-pane-data-classification-link");n&&n.focus()}},n.render=function(){var t=this,e=this.props,n=e.Form.Model.OwnerTenantId===Object(u.a)().userInfo.TenantId;if((Object(st.k)()||!Object(M.f)())&&this.state.ShowDataClassificationSettingPane&&!Object(u.a)().userInfo.IsMsa&&n)return oe.createElement("div",{id:"flex-pane-settings-pane-data-classification"},oe.createElement(Ru,{FormMaster:e.Form,EnterDataClassificationSettingPane:!0,EditDataClassificationSettingCallBack:this.tP}));if("SendForm"===this.vl.PreviousFlexPane)var i=oe.createElement("div",{id:"flex-pane-setting-headline",className:"flex-pane-content"},oe.createElement("div",this.nP(void 0,void 0,(function(){Object(g.b)("DesignPage.Send.Navigate",{source:"FlexPane-Settings"}),t.vl.FlexPane="SendForm"})),Object(Un.b)({HTMLAttributes:{className:"settingPaneBack forms-icon-size16x16"},IconName:"Back"}),Object(ae.a)().Common_Back_Text));var r=!Object(u.a)().userInfo.IsMsa?function(t){return oe.createElement(Eu,t)}({Form:e.Form}):void 0,o=(Object(at.c)((function(){return null}),at.f),Object(Y.c)("DisplayOptionSetting")&&!Object(Y.c)("ProgressBarNew")&&Object(Y.c)("ProgressBar")?oe.createElement("div",{className:"flex-pane-content"},oe.createElement("div",{"aria-labelledby":"SettingsPane-display",className:"setting-pane-group",role:"group",key:"SettingsPane-displayOptions"},oe.createElement("div",{className:"setting-group-title",id:"SettingsPane-display"},Object(ae.a)().DesignPage_Setting_DisplayOptions),this.iP())):null),s=this.rP()&&oe.createElement("div",{"aria-labelledby":"SettingsPane-Notification",className:"setting-pane-group",role:"group"},oe.createElement("div",{className:"setting-group-title",id:"SettingsPane-Notification"},Object(ae.a)().DesignPage_SettingsPane_Notification),this.oP(),this.sP()),a=Object(at.c)((function(){return oe.createElement("div",{className:"flex-pane-content"},oe.createElement("div",{"aria-labelledby":"SettingsPane-Options",className:"setting-pane-group",role:"group"},oe.createElement("div",{className:"setting-group-title",id:"SettingsPane-Options"},Object(ae.a)().DesignPage_SettingsPane_Response_Title),t.aP(),t.cP(),t.uP(),t.lP(),t.hP(),!t.rP()&&t.sP(),t.fP(),t.dP(),e.Form.SettingMaster.Model.IsQuizMode?t.bP():void 0),s)}),at.f),c=e.Form.SettingMaster.Model.IsQuizMode?oe.createElement("div",{className:"flex-pane-content"},oe.createElement("div",{className:"setting-pane-group"},oe.createElement("div",{className:"setting-group-title"},Object(ae.a)().DesignPage_SettingsPane_GradingSetting),this.mP())):void 0,l=!Object(st.k)()&&Object(M.f)()||Object(u.a)().userInfo.IsMsa||!n?void 0:oe.createElement(Ru,{FormMaster:e.Form,EnterDataClassificationSettingPane:!1,EditDataClassificationSettingCallBack:this.tP});return oe.createElement("div",{id:"flex-pane-settings-pane"},i,oe.createElement("div",{className:"setting-page-title"},Object(ae.a)().DesignPage_SettingsPane_SettingLabel),c,r,a,!1,o,l)},n.rP=function(){return!Object(v.w)()&&!Object(u.a)().userInfo.IsMsa},n.mP=function(){var t,e=this.props.Form;if(e.SettingMaster.Model.IsQuizMode){var n=Object(ae.a)().DesignPage_SettingsPane_AutoGradingControlTitle,i=e.SettingMaster.Model.ManualGradingEnabled?Object(ae.a)().DesignPage_SettingsPane_OpenManualGrading:Object(ae.a)().DesignPage_SettingsPane_OpenAutoGrading;return t={Title:n,Description:i,Value:!e.SettingMaster.Model.ManualGradingEnabled,onChange:function(t){Object(g.b)("DesignPage.Setting.AutoReleaseGrade"),e.SettingMaster.Model.ManualGradingEnabled=!t,e.SettingMaster.Model.ShowGradedResults=t}.bind(this)},oe.createElement(_u,Object(S.__assign)({},t))}return null},n.aP=function(){var t=this.props.Form.SettingMaster,e=t.Model;return this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_AcceptResponse,Value:!e.FormClosed,onValueChange:function(t){Object(g.b)("DesignPage.Setting.AcceptResponse"),e.FormClosed=!t},children:[e.FormClosed?oe.createElement("div",{className:"flex-pane-inner-text"},Object(Un.b)({HTMLAttributes:{className:"flex-pane-alert-icon"},IconName:"AlertSolid"}),oe.createElement("span",{className:"flex-pane-alert-text"},Object(ae.a)().DesignPage_SettingsPane_FormClosed_Warning)):void 0,e.FormClosed?Object(ar.b)({Label:Object(ae.a)().DesignPage_SettingsPane_FormClosed_Label,Options:{HTMLPropsForInnerElement:{className:"flex-pane-inner-text"}},TextFieldType:2,MinimalHeight:100,HTMLAttributes:{className:"form-setting-inner-board",onBlur:function(){e.FormClosedMessageChanged&&(Object(g.b)("DesignPage.Setting.EditCloseMessage"),e.FormClosedMessageChanged=!1)}},Value:t.getFormClosedMessage(),onValueChange:function(t){e.FormClosedMessage=t,e.FormClosedMessageChanged=!0}}):void 0]})},n.cP=function(){var t=this.props.Form.SettingMaster,e=t.Model;return this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_StartTime,Disabled:e.FormClosed||this.props.Form.IsAssignmentForm,Value:e.TimerEnabledStart,onValueChange:function(n){Object(g.b)("DesignPage.Setting.ApplyStartTime"),t.bulkEdit((function(){if(n){var t=new Date(Date.now());t.setHours(t.getHours()+1,0,0,0),e.StartTime=t.toJSON()}else e.StartTime=void 0;e.TimerEnabledStart=n,e.TimerEnabled=!(!e.TimerEnabledStart&&!e.TimerEnabledEnd)}))},children:[!e.FormClosed&&e.TimerEnabledStart?oe.createElement("div",{},Object(Au.b)({Disabled:e.FormClosed||this.props.Form.IsAssignmentForm,InSettingPane:!0,Options:{classNameForInnerDiv:"form-setting-inner-board"},Value:e.StartTime,onValueChange:function(t){if(Object(g.b)("DesignPage.Setting.SetStartTime"),e.TimerEnabledEnd&&t>=e.EndTime){var n=new Date(t);n.setMinutes(n.getMinutes()+15,0,0),e.EndTime=n.toJSON()}e.StartTime=t,$("#flex-pane-status-start-date").hide(),$("#flex-pane-status-start-time").hide()},onValueValidation:function(t,e){switch(e){case 1:$(t?"#flex-pane-status-start-date":"#flex-pane-status-start-time").show();break;case 2:$("#flex-pane-status-start-invalidrange").show();break;default:$("#flex-pane-status-start-date").hide(),$("#flex-pane-status-start-time").hide(),$("#flex-pane-status-start-invalidrange").hide()}},children:[oe.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-start-date",style:{display:"none"}},Object(ae.a)().DateValidation_ErrorMessage.format(Object(u.a)().cultureInfo.DateTimeFormat.ShortDatePattern)),oe.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-start-time",style:{display:"none"}},Object(ae.a)().TimeValidation_ErrorMessage.format(Object(u.a)().cultureInfo.DateTimeFormat.ShortTimePattern)),oe.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-start-invalidrange",style:{display:"none"}},Object(ae.a)().DateRangeValidation_ErrorMessage)],DateTitle:Object(ae.a)().DesignPage_SettingsPane_DatePicker_StartDateTitle,TimeTitle:Object(ae.a)().DesignPage_SettingsPane_DatePicker_StartTimeTitle})):void 0]})},n.uP=function(){var t=this.props.Form.SettingMaster,e=t.Model;return null==e.TimerEnabledStart&&null==e.TimerEnabledEnd&&(e.TimerEnabledEnd=e.TimerEnabled),this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_Deadline,Disabled:e.FormClosed||this.props.Form.IsAssignmentForm,Value:e.TimerEnabledEnd,onValueChange:function(n){Object(g.b)("DesignPage.Setting.ApplyDeadline"),t.bulkEdit((function(){if(n){var t=void 0;if(e.TimerEnabledStart)(t=new Date(e.StartTime)).setMinutes(new Date(e.StartTime).getMinutes()+15,0,0),e.EndTime=t.toJSON();else{var i=new Date(Date.now());i.setHours(i.getHours(),0,0,0),e.StartTime=i.toJSON(),(t=new Date(Date.now())).setDate(t.getDate()),t.setHours(t.getHours()+1,0,0,0),e.EndTime=t.toJSON()}}else e.EndTime=void 0;e.TimerEnabledEnd=n,e.TimerEnabled=e.TimerEnabledStart||e.TimerEnabledEnd}))},children:[!e.FormClosed&&e.TimerEnabledEnd?oe.createElement("div",{},Object(Au.b)({AllowedDateTime:{Start:e.StartTime?new Date(e.StartTime):new Date(Date.now())},Disabled:e.FormClosed||this.props.Form.IsAssignmentForm,InSettingPane:!0,Options:{classNameForInnerDiv:"form-setting-inner-board"},Value:e.EndTime,onValueChange:function(t){if(Object(g.b)("DesignPage.Setting.SetDeadline"),!e.StartTime||t>e.StartTime)e.EndTime=t;else if(e.StartTime&&t<=e.StartTime){var n=new Date(e.StartTime);n.setMinutes(n.getMinutes()+15,0,0),e.EndTime=n.toJSON()}$("#flex-pane-status-end-date").hide(),$("#flex-pane-status-end-time").hide()},onValueValidation:function(t,e){switch(e){case 1:$(t?"#flex-pane-status-end-date":"#flex-pane-status-end-time").show();break;case 2:$("#flex-pane-status-end-invalidrange").show();break;default:$("#flex-pane-status-end-date").hide(),$("#flex-pane-status-end-time").hide(),$("#flex-pane-status-end-invalidrange").hide()}},children:[oe.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-end-date",style:{display:"none"}},Object(ae.a)().DateValidation_ErrorMessage.format(Object(u.a)().cultureInfo.DateTimeFormat.ShortDatePattern)),oe.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-end-time",style:{display:"none"}},Object(ae.a)().TimeValidation_ErrorMessage.format(Object(u.a)().cultureInfo.DateTimeFormat.ShortTimePattern)),oe.createElement("div",{className:"flex-pane-status flex-pane-status-error",id:"flex-pane-status-end-invalidrange",style:{display:"none"}},Object(ae.a)().DateRangeValidation_ErrorMessage)],DateTitle:Object(ae.a)().DesignPage_SettingsPane_DatePicker_EndDateTitle,TimeTitle:Object(ae.a)().DesignPage_SettingsPane_DatePicker_EndTimeTitle})):void 0]})},n.hP=function(){var t=this.props.Form,e=t.SettingMaster.Model,n=Object(ae.a)().DesignPage_SettingsPane_ShuffleQuestion;return this.UF({Description:n,Value:this.vP(),Disabled:t.Model.HasValidBranching||t.hasSection(),onValueChange:function(n){Object(g.b)("DesignPage.Setting.ShuffleQuestion"),t.SettingMaster.bulkEdit((function(){e.ShuffleQuestionOrder=n,n&&null==e.ShuffleAllQuestions&&(e.ShuffleAllQuestions=!0)}))},children:oe.createElement("div",{"aria-label":n},this.gP("SettingsPane-ShuffleQuestion",1,2),this.OP("SettingsPane-ShuffleQuestion",2,2),this.pP())})},n.jP=function(){var t=this.props.Form,e=t.SettingMaster.Model,n=Object(ae.a)().DesignPage_SettingsPane_ShowQuestionNumbers;return this.UF({Description:n,Value:null==e.ShowQuestionNumbers||e.ShowQuestionNumbers,onValueChange:function(n){Object(g.b)("DesignPage.Setting.ShowQuestionNumbers"),t.SettingMaster.bulkEdit((function(){e.ShowQuestionNumbers=n,n&&null==e.ShowQuestionNumbers&&(e.ShowQuestionNumbers=!0)}))}})},n.lP=function(){var t=this.props.Form;if(Object(Ri.a)(t,"Settings.AllowResponderGetAllResponses")){var e=t.SettingMaster.Model;return this.UF({Description:"Allow responder get all responses",Value:e.AllowResponderGetAllResponses,onValueChange:function(t){e.AllowResponderGetAllResponses=t}})}},n.gP=function(t,e,n){var i=this.props.Form,r=i.SettingMaster.Model;if(this.vP())return this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_ShuffleAllQuestions,Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":e,"aria-setsize":n}},RadioCheckbox:!0,Value:r.ShuffleAllQuestions,Disabled:i.Model.HasValidBranching,onValueChange:function(t){Object(g.b)("DesignPage.Setting.ShuffleAllQuestions"),r.ShuffleAllQuestions=t}})},n.sP=function(){if(!Object(v.w)()){var t=this.props.Form.SettingMaster.Model,e=this.rP()?Object(ae.a)().DesignPage_SettingsPane_Notification_EmailNotification:Object(ae.a)().DesignPage_SettingsPane_EmailNotification;return this.UF({Description:e,Value:t.EmailNotification,onValueChange:function(e){Object(g.b)("DesignPage.Setting.EmailNotification"),t.EmailNotification=e}})}},n.yP=function(){},n.wP=function(t,e){},n.oP=function(){if(this.rP()){var t=this.props.Form.SettingMaster.Model,e=this.props.Form.Model,n=t.IsAnonymous||t.NotRecordIdentity;return this.UF({HelpText:n?Object(ae.a)().DesignPage_SettingsPane_EmailReceipt_DisabledTooltip:Object(ae.a)().DesignPage_SettingsPane_EmailReceipt_EnabledTooltip,Disabled:n,Description:Object(ae.a)().DesignPage_SettingsPane_Notification_EmailReceipt,Value:!n&&e.EmailReceiptEnabled,onValueChange:function(t){Object(g.b)("DesignPage.Setting.EmailReceipt"),e.EmailReceiptEnabled=t}})}},n.dP=function(){var t=this.props.Form.Model;return this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_CustomizeThankYou,Options:{classNameForInnerDiv:"flex-pane-checkbox-info flex-pane-checkbox-thank-you-message",classNameForInnerLabel:"flex-pane-checkbox-label"},Value:null!=t.ThankYouMessage,onValueChange:function(e){t.ThankYouMessage=e?Object(ae.a)().Renderer_SubmissionSucceeded:null},children:[null!=t.ThankYouMessage&&Object(ar.a)({AllowRichText:!0,AutoSelection:!0,Options:{HTMLPropsForInnerElement:{className:"flex-pane-inner-text","aria-label":Object(ae.a)().DesignPage_SettingsPane_CustomizeThankYou}},Placeholder:Object(ae.a)().DesignPage_SettingsPane_ThankYouMessage_Placeholder,TextFieldType:2,MinimalHeight:80,MaxLength:Object(Pe.e)(),HTMLAttributes:{className:"form-setting-inner-board",onBlur:function(){null!=t.ThankYouMessage&&Object(g.b)("DesignPage.Setting.ThankYouMessage",{length:t.ThankYouMessage.length})}},Value:t.ThankYouMessage,onValueChange:function(e){t.ThankYouMessage=e||""}},!0)]})},n.SP=function(t){},n.OP=function(t,e,n){var i=this.props.Form,r=i.SettingMaster.Model;if(this.vP())return this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_LockGivenQuestions,Options:{HTMLPropsForInnerElement:{name:t,"aria-posinset":e,"aria-setsize":n}},RadioCheckbox:!0,Value:!r.ShuffleAllQuestions,Disabled:i.Model.HasValidBranching,onValueChange:function(t){Object(g.b)("DesignPage.Setting.LockGivenQuestions"),r.ShuffleAllQuestions=!t}})},n.pP=function(){var t=this,e=this.state,n=this.props.Form,i=n.SettingMaster.Model;if(this.vP()&&!i.ShuffleAllQuestions){var r=Number(e.StartRange),o=Number(e.EndRange),s=Object(ar.b)({HTMLAttributes:{className:"flex-pane-setting-shuffle-input",onBlur:function(){Object(Mr.c)(r)&&r>=1&&r<=n.FormElementManager.QuestionMasters.length&&r<=o?(i.LockGivenQuestionsStartDisplayOrder=r,t.setState({ShowShuffleQuestionRangeError:!1})):t.setState({ShowShuffleQuestionRangeError:!0})}},TextFieldType:0,AutoSelection:!0,Value:e.StartRange,onValueChange:function(e){t.setState({StartRange:e})}}),a=Object(Un.b)({HTMLAttributes:{className:"flex-pane-setting-shuffle-seperator"},IconName:"CalculatorSubtract"}),c=Object(ar.b)({HTMLAttributes:{className:"flex-pane-setting-shuffle-input",onBlur:function(){Object(Mr.c)(o)&&o>=1&&o<=n.FormElementManager.TopQuestionMasters.length&&o>=r?(i.LockGivenQuestionsEndDisplayOrder=o,t.setState({ShowShuffleQuestionRangeError:!1})):t.setState({ShowShuffleQuestionRangeError:!0})}},TextFieldType:0,AutoSelection:!0,Value:e.EndRange,onValueChange:function(e){t.setState({EndRange:e})}}),u=void 0;return e.ShowShuffleQuestionRangeError&&(u=oe.createElement("span",{className:"flex-pane-shuffle-status flex-pane-status-error"},Object(ae.a)().ShuffleQuestionValidation_ErrorMessage)),oe.createElement("div",{className:"flex-pane-setting-shuffle-div office-form-theme-focus-border"},s,a,c,u)}},n.bP=function(){if(Object(Y.c)("ResponseInApp")){var t=this.props.Form.SettingMaster.Model;return this.UF({Description:Object(ae.a)().DesignPage_SettingsPane_ResponseInTakeATest,Value:t.RespondInAppOnly,onValueChange:function(e){Object(g.b)("DesignPage.Setting.RespondInAppOnly"),t.RespondInAppOnly=e}})}},n.fP=function(){if(Object(Y.c)("ProgressBarNew")){var t=this.props.Form,e=t.Model,n=Object(ae.a)().FormsType_Form,i=t.totalSectionCount()>=2;return"survey"===e.Type?n=Object(ae.a)().FormsType_Survey:t.SettingMaster.Model.IsQuizMode&&(n=Object(ae.a)().FormsType_Quiz),Object(g.b)("DesignPage.Setting.ShowProgressBarOption"),this.UF({key:"SettingsPane-responseOptions-ProgressBarNew",Disabled:!i,HelpText:Object(ae.a)().DesignPage_SettingsPane_ProgressBar_HelpText.format(n),Description:Object(ae.a)().DesignPage_SettingsPane_ProgressBar,Value:"true"===e.ProgressBarEnabled&&i,onValueChange:function(t){t?Object(g.b)("DesignPage.Setting.ProgressBarEnabled"):Object(g.b)("DesignPage.Setting.ProgressBarDisabled"),e.ProgressBarEnabled=String(t)},Options:i?null:{classNameForInnerDiv:"flex-pane-checkbox-info",classNameForInnerLabel:"flex-pane-checkbox-label-disabled settings-display-inline"},children:[i?null:oe.createElement("div",{className:"progress-bar-setting-tooltip"},Object(Un.b)({HTMLAttributes:{"aria-label":Object(ae.a)().DesignPage_SettingsPane_ProgressBar_Tooltip.format(n),className:"forms-icon-size16x16",tabIndex:0,title:Object(ae.a)().DesignPage_SettingsPane_ProgressBar_Tooltip.format(n)},IconName:"Info",key:"icon"}))]})}},n.iP=function(){if(!Object(Y.c)("ProgressBarNew")&&Object(Y.c)("ProgressBar")){var t=this.props.Form,e=t.Model,n=Object(ae.a)().FormsType_Form;return"survey"===e.Type?n=Object(ae.a)().FormsType_Survey:t.SettingMaster.Model.IsQuizMode&&(n=Object(ae.a)().FormsType_Quiz),this.UF({key:"SettingsPane-displayOptions-ProgressBar",Disabled:!1,HelpText:Object(ae.a)().DesignPage_Setting_DisplayOptions_ProgressBar_HelpText.format(n),Description:Object(ae.a)().DesignPage_Setting_DisplayOptions_ProgressBar,Value:"true"===e.ProgressBarEnabled,onValueChange:function(t){Object(g.b)("DesignPage.Setting.ProgressBar"),e.ProgressBarEnabled=String(t)},children:[oe.createElement("div",{className:"progress-bar-setting-tooltip"},Object(Un.b)({HTMLAttributes:{"aria-label":Object(ae.a)().DesignPage_Setting_DisplayOptions_ProgressBar_Tooltip.format(n),className:"forms-icon-size16x16",tabIndex:0,title:Object(ae.a)().DesignPage_Setting_DisplayOptions_ProgressBar_Tooltip.format(n)},IconName:"Info",key:"icon"}))]})}},n.UF=function(t){t.HTMLAttributes=t.HTMLAttributes||{},t.HTMLAttributes.className=t.HTMLAttributes.className||"setting-pane-checkbox",t.Options=t.Options||{classNameForInnerDiv:"flex-pane-checkbox-info",classNameForInnerLabel:"flex-pane-checkbox-label settings-display-inline"};var e=this.props.Form;return Object(Ri.a)(e,"DisableEditForm")&&(t.Disabled=!0),Object(Lu.a)(t)},n.nP=function(t,e,n){var i=this;return{id:t,role:"button",className:e,onClick:n,onKeyDown:function(t){return i.NP(t,n)},tabIndex:0}},n.NP=function(t,e){32!==(t=t||window.event).keyCode&&13!==t.keyCode||e(t)},n.XF=function(t){},n.vP=function(){var t=this.props.Form;return t.SettingMaster.Model.ShuffleQuestionOrder&&!t.hasSection()},n.IP=function(){},n.eP=function(t){this.setState({ShowDataClassificationSettingPane:t})},n.ZF=function(t){0},e}(ue.a),Gu=n(236);function qu(t){return oe.createElement(Qu,t)}var Qu=function(t){function e(e){var n=t.call(this,e)||this;n.vl=Object(_t.b)().Model,n.CP=n.CP.bind(n),n.kP=n.kP.bind(n);var i=Object(_t.b)();return n.TP()?i.bulkEdit((function(){i.Model.FlexPane="None",i.observe(n.kP,[i.Schema.FlexPane]),i.Model.FlexPane=n.props.FlexPaneType})):i.observe(n.kP,[i.Schema.FlexPane]),n.state={AnimationDone:!n.TP(),Expanded:n.TP(),PaneWidth:n.xP()},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.FP=function(){t.state.PaneWidth!==t.xP()&&t.setState({PaneWidth:t.xP()})},window.addEventListener("resize",this.FP)},n.componentDidUpdate=function(){var t=this,e=Ln.findDOMNode(this),n=$(e);n.width(this.state.PaneWidth),this.state.AnimationDone||(n.off("animationend"),this.state.Expanded?(n.removeClass("NotVisible"),n.removeClass("slideRightOut"),n.on("animationend",(function(){n.off("animationend"),n.find(":focusable").first().focus(),t.setState({AnimationDone:!0})})),n.addClass("slideLeftIn")):(n.removeClass("slideLeftIn"),n.on("animationend",(function(){n.off("animationend"),n.addClass("NotVisible"),t.setState({AnimationDone:!0})})),n.addClass("slideRightOut")))},n.componentWillUnmount=function(){window.removeEventListener("resize",this.FP),Object(_t.b)().unobserve(this.kP)},n.render=function(){var t,e=this,n=this.props,i={id:"flex-pane-container-"+n.FlexPaneType,className:"flex-pane-board NotVisible",role:"group","aria-label":n.FlexPaneType,style:{width:this.state.PaneWidth+"px"}};this.TP()&&(i.className="flex-pane-board"),Object(at.c)((function(){i.onKeyUp=Object(pn.h)((function(t){27===t.keyCode&&(e.vl.FlexPane="None",t.stopPropagation(),Object(yr.d)("Flexpane-"+n.FlexPaneType))}))}),at.f);var r,o,s,a,c,l=n.Form,h=!1;if(this.state.Expanded||!this.state.AnimationDone||"ImagePicker"===n.FlexPaneType||"Theme"===n.FlexPaneType)switch(n.FlexPaneType){case"SendForm":l.isFieldReady(Zt.a.Schema.Id)&&(t=function(t){return oe.createElement(Du,t)}({Form:l})),h&&(h.innerHTML=Object(ae.a)().SharePane_Label);break;case"Settings":t=function(t){return oe.createElement(Hu,t)}({Form:l}),h&&(h.innerHTML=Object(ae.a)().SettingsPane_Label);break;case"MultiLingual":t=oe.createElement(Wc,{Form:n.Form,enterLanguageEditionView:this.CP});break;case"Theme":l.isFieldReady(Zt.a.Schema.Theme)&&(Object(Ht.a)().Flighting.isEnabled_Deprecated("DisableBrandingForMSA")&&Object(u.a)().userInfo.IsMsa?t=function(t){return oe.createElement(Mu,t)}():(a=this.props.Form,c=function(){e.vl.FlexPane="Theme"},t=oe.createElement(iu,{FormMaster:a,onFlexPaneIndexChange:c}))),h&&(h.innerHTML=Object(ae.a)().ThemePane_Label);break;case"Feedback":t=function(t){return oe.createElement(uu,t)}(),h&&(h.innerHTML=Object(ae.a)().Feedback_Panel_Title);break;case"MultiLingualEditAll":null!=l&&(t=FormsPro.createMultiLingualEditAllView(n.Form,this.CP)),h&&(h.innerHTML=Object(ae.a)().Multilingual_Edit_All);break;case"MoveFormPane":null!=l&&(r=function(t){return e.PP(t)},o=l,s=Object(Z.m)(),t=oe.createElement(au,{changeFormOwnerHandler:r,SelectedForm:o,IsDelegateMode:s})),h&&(h.innerHTML=Object(ae.a)().MoveFormPane_Label);break;case"CopyFormPane":null!=l&&(t=FormsPro.createCopyPaneView((function(t,n){return e.DP(t,n)}),l)),h&&(h.innerHTML=Object(ae.a)().CopyFormPane_Label);break;case"ImagePicker":t=Object(as.a)({ContainerWidth:this.xP()}),h&&(h.innerHTML=Object(ae.a)().ImagePickerPane_Label);break;case"VideoPicker":t=Object(Gu.a)({ContainerWidth:this.xP()}),h&&(h.innerHTML=Object(ae.a)().VideoPickerPane_Label);break;case"MediaSelect":t=Object(zo.a)(),h&&(h.innerHTML=Object(ae.a)().MediaSelectPane_Label);break;case"CustomData":break;default:throw Error("All flexpane should be handled above")}return this.state.Expanded&&(i.tabIndex=0),oe.createElement("div",i,t,!1)},n.PP=function(t){return this.props.changeFormOwnerHandler(this.props.Form,t)},n.DP=function(t,e){return this.props.copyToFormHandler(this.props.Form,t,e)},n.TP=function(){return this.props.FlexPaneType===this.vl.FlexPane},n.kP=function(){this.state.Expanded!==this.TP()&&this.setState({AnimationDone:!1,Expanded:!this.state.Expanded})},n.xP=function(){var t=this.props.FlexPaneType;if("ImagePicker"===t||"VideoPicker"===t){var e=Object(us.f)();return $(document).width()<e?$(document).width():e}return $(document).width()<=768?300:400},n.CP=function(t){var e=Object(_t.b)();e.bulkEdit((function(){e.showTopView("MultiLingualEditionView",(function(){})),e.Model.Locale=t,e.Model.FlexPane="None"}))},e}(ue.a),Vu=Object(Tt.c)("RtcMaxIdleMinutes",5);var zu=function(t){function e(e){var n=t.call(this,e)||this;return n.MP=oe.createRef(),n.ce=!0,n.LP=!0,n.Oe=function(){return n.forceUpdate()},n.AP=0,n.vl=Object(_t.b)().Model,n.state={FormReadyToDesign:!1,DisableReadonlyTipBar:!1},n.RP=n.RP.bind(n),n.EP=n.EP.bind(n),n.BP=n.BP.bind(n),n._P=n._P.bind(n),n.HP=n.HP.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this.props.FormMaster;this.GP(t);var e,n=Object(_t.b)();(n.observe(this.Oe,[n.Schema.Analysis,n.Schema.Grading]),Object(Y.c)("PersonalContextSuggestion"))&&Object(Bi.a)(t).registerObservers();if(Object(Y.c)("RtcRefactor")?(t.Model.RtcStatus=0,this.qP(!0),this._P(),Object(Y.c)("EnableStrictMode")||n.observe(this._P,[n.Schema.LastActiveTime])):t.startReceivingNotifications((function(t,e){switch(e){case ge.UserDisconnect:t.forEach((function(t){ve().removeUser(t)}));break;case ge.ConnectionStateChanged:case ge.UserAction:case ge.UserConnect:default:t.forEach((function(t){ve().addOrUpdateUser(t)}))}})),t.observe(this.Oe,[Zt.a.Schema.ReputationTier]),t.ensureFieldsReady([Zt.a.Schema.ResponsesCount]).then((function(){(null==t.Model.ResponsesCount||t.Model.ResponsesCount<0)&&t.getFormResponsesCountByAPICall()})),Object(d.b)().Token?e="Hash":Object(d.d)().Token&&(e="QueryString"),e){var i=Object(Vt.a)(t.Model.Id).OwnerId==Object(u.a)().userInfo.UserId;Object(g.b)("DesignPage.OpenWithCoauthToken",{location:e,isOwner:i})}Object(Y.c)("UserInterationSuggestionCard")&&(Object(vn.getIoCQuestionSuggestionClass)().Initialize(),n.Model.IntelligeceQuestionSuggestionStatus="Default",n.Model.CollapseIntelligenceSuggestionCard=!1);this.QP()},n.componentWillReceiveProps=function(t){t.FormMaster!==this.props.FormMaster&&this.GP(t.FormMaster)},n.componentDidMount=function(){this.VP()},n.componentDidUpdate=function(){this.VP()},n.componentWillUnmount=function(){this.ce=!1;var t=Object(_t.b)(),e=this.props.FormMaster;(Object(Y.c)("RtcRefactor")?(this.qP(!1),Object(Y.c)("EnableStrictMode")||t.unobserve(this._P)):e.stopReceivingNotifications((function(){ve().removeAllUsers()})),t.unobserve(this.Oe),e.unobserve(this.Oe),Object(Y.c)("PersonalContextSuggestion"))&&Object(Bi.a)(e).unregisterObservers()},n.render=function(){var t=this;if(!this.state.FormReadyToDesign)return Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text,TimeoutMessage:Object(ae.a)().RetryRecoverableErrorMessage_OpeningForm});var e,n=this.props.FormMaster;return e={className:"body-content office-form-theme-page-background"},this.vl.Analysis||(e.onMouseDown=this.EP),oe.createElement("div",e,qu({Form:this.props.FormMaster,FlexPaneType:"Theme"}),qu({Form:this.props.FormMaster,FlexPaneType:"SendForm"}),qu({Form:this.props.FormMaster,FlexPaneType:"Settings"}),qu({Form:this.props.FormMaster,FlexPaneType:"MultiLingual"}),qu({Form:this.props.FormMaster,FlexPaneType:"ImagePicker"}),qu({Form:this.props.FormMaster,FlexPaneType:"VideoPicker"}),qu({Form:this.props.FormMaster,FlexPaneType:"MediaSelect"}),!1,this.zP(),this.UP(),this.LP&&oe.createElement(qc,{FormMaster:n}),!1,this.$P(),this.WP(),Object(at.b)((function(){return t.KP()})))},n.JP=function(){var t;if(this.props.CorruptedBranchingNotification&&!this.props.FormMaster.IsSampleForm){var e=Object(ae.a)().MFPBranchingRules_Corruption_Failed_Message;return t={text:e,learnMoreLink:"",level:"Error",warningClickText:Object(ae.a)().MFPBranchingRules_Corruption_Link,warningClick:this.XP.bind(this)},oe.createElement(Li,Object(S.__assign)({},t))}return null},n.XP=function(t){this.props.CorruptedBranchingNotification&&(this.vl.FormsProBranchingData=null,this.props.FormMaster.Model.MfpBranchingData=null),t.preventDefault(),t.stopPropagation(),Object(_t.b)().showTopView("MFPBranching",(function(){}))},n.$P=function(){return Object(Y.c)("RemoveRedundantAggregateAPI")&&this.props.TopView?oe.createElement(es.a,{ThemeMaster:this.props.FormMaster.ThemeMaster}):oe.createElement(Bc,{Form:this.props.FormMaster,FormDesignerRef:this.MP,MalformedBranchingNotification:this.props.MalformedBranchingNotification||this.props.CorruptedBranchingNotification})},n.VP=function(){Gn&&this.state.FormReadyToDesign&&window.performance&&Object(g.f)("Endpoint.DesignPage",Vn())},n.WP=function(){return Object(_i.h)(Object(Ei.c)().Model.ExcelSurveyIntroduction)&&this.vl.ShowExcelSurveyIntroductionDialog&&Object(u.a)().userInfo.IsMsa?oe.createElement(qi,{}):null},n.QP=function(){Object(Si.b)("AppResume"),Object(Si.c)("AppUsageTime")},n.zP=function(){var t=this.props.FormMaster;if(t.isFieldReady(Zt.a.Schema.Category)&&Object(Ri.a)(t,"DisableEditForm")&&!this.state.DisableReadonlyTipBar)return Object(xi.d)({Info:Object(ae.a)().DesignPage_ReadonlyFormTip,TipBarLocation:"Up",TipBarStyle:"YellowBackground",ShouldClose:!0,onClose:this.RP})},n.KP=function(){return oe.createElement(_c,{FormMaster:this.props.FormMaster})},n.UP=function(){var t=Object(Ei.c)().Model;if(Object(u.a)().userInfo.IsMsa&&Object(Oo.c)(this.props.FormMaster.Model.ReputationTier)&&!t.IsNotFirstTimePhishingDetected&&!this.vl.Analysis)return t.IsNotFirstTimePhishingDetected=!0,this.LP=!1,Object(g.b)("DesignPage.ShowFirstTimePhishingDetectedWarning"),oe.createElement(Hc,{showPhishingTipbarCallback:this.HP})},n.HP=function(t){t&&(this.LP=!0,this.forceUpdate())},n.RP=function(){this.setState({DisableReadonlyTipBar:!0})},n.GP=function(t){var e=this;t.ensureReadyToDesign().catch((function(n){var i=n;if(i)switch(i.innerCode){case 639:e.vl.FormId=i.innerMessage;break;case 625:e.ZP(t);break;default:e.vl.CriticalError=n}throw n})).then((function(){return Object(ni.b)("survey"===t.Model.Type)})).then((function(){return t.Model.LastSyncTime=Date.now()})).then((function(){null==t.SettingMaster.Model.IsQuizMode&&(t.SettingMaster.Model.IsQuizMode=t.Model.QuizQuestionsCount>0),e.ce&&e.props.FormMaster===t&&e.setState({FormReadyToDesign:!0})}))},n.qP=function(t){var e=this.props.FormMaster,n=Object(_t.b)();t&&2!==e.Model.RtcStatus?(e.startReceivingNotificationsV2(),Object(Y.c)("EnableStrictMode")&&n.observe(this._P,[n.Schema.LastActiveTime])):t||2!==e.Model.RtcStatus||(e.stopReceivingNotificationsV2(),Object(Y.c)("EnableStrictMode")&&n.unobserve(this._P))},n.EP=function(t){var e=this.MP.current;if(e){var n=$(t.target);Ln.findDOMNode(e).contains(n[0])||n.hasClass("flex-pane-board")||n.parents(".flex-pane-board").length||e.endCurrentDesignMode()}},n.ZP=function(t){var e=this;t.IsGroupForm&&(Object(u.a)().userInfo.TenantId===t.Model.OwnerTenantId?Object(De.b)(t.Model.OwnerId).then((function(){e.vl.CriticalError={innerCode:6706,type:"ExpectedFailure"}})).catch((function(){e.vl.CriticalError={innerCode:6707,type:"ExpectedFailure"}})):this.vl.CriticalError={innerCode:6708,type:"ExpectedFailure"})},n.BP=function(){this.qP(!1)},n._P=function(){0!==this.AP&&window.clearTimeout(this.AP),this.AP=window.setTimeout(this.BP,60*Vu*1e3),Object(Y.c)("EnableStrictMode")||3!==this.props.FormMaster.Model.RtcStatus||this.qP(!0)},e}(ue.a),Uu=function(t){function e(e){var n=t.call(this,e)||this;return n.YP=n.YP.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.getContainerProps=function(){var t=this.props,e=Et.extend({},t.HTMLAttributes);return e.className=Object(pn.b)(e.className,"top-view-container"),this.props.TopViewTitle&&(e["aria-label"]=this.props.TopViewTitle),e},n.onBackButtonClick=function(t){},n.createHeader=function(){for(var t,e=this,n=[],i=0;i<arguments.length;i++)n[i]=arguments[i];Object(Z.k)()||(t=Object(yn.a)({HTMLAttributes:{className:"top-view-back-button office-form-theme-button-color",onClick:function(t){return e.YP(t)},autoFocus:!0},ButtonStyle:"LightBackground",Icon:"Back",IconClassName:"top-view-back-icon "+(Object(Z.b)()?"forms-icon-size16x16":"forms-icon-size18x18"),Text:Object(ae.a)().Common_Back_Text,TextClassName:"top-view-back-text",ref:"back-button"}));var r=[{className:"top-view-header",role:"navigation"}],o=[t,n];return oe.createElement("div",r,o)},n.YP=function(t){Object(_t.b)().bulkEdit((function(t){t.TopView="None",t.Locale=void 0,t.BranchingElementId=null,t.SectionElementId=null})),this.onBackButtonClick(t)},e}(ue.a),$u=n(148),Wu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.tD=function(){return e.eD()},e.Tv=function(){return e.forceUpdate()},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.props.Master.observe(this.tD,[$u.a.Schema.TargetQuestionId,$u.a.Schema.ToTheEnd]),this.eD()},n.componentWillUnmount=function(){this.props.Master.unobserve(this.tD);var t=this.nD;t&&t.unobserve(this.Tv)},n.render=function(){var t=this,n=this.props,i=n.Master.Model,r=i.ToTheEnd?e.SpecialIdForGoingToTheEnd:i.TargetQuestionId;r=r||e.SpecialIdForGoingToTheNext;var o=[n.AriaLabel,Object(ae.a)().Branch_Menu_Description_Prefix].join(Object(ae.a)().Common_ItemSeperator),s=this.props.ReadOnly?oe.createElement("div",{className:"office-form-question-title"},this.iD(r)):Object(Pr.b)({AllowWrap:!0,Label:o,onValueChange:function(e){return t.gO(e.toString())},SelectOptionGroups:this.fn(),Value:r}),a=Et.extend({},n.HTMLAttributes);return a.className=Object(pn.b)("branch-selector office-form-theme-primary-color",a.className),oe.createElement("div",Object(S.__assign)({},a),e.createGuide(),s)},e.createGuide=function(){return oe.createElement("div",{className:"branch-selector-guide office-form-theme-primary-foreground"},Object(ae.a)().Branch_Menu_Description_Prefix)},n.fn=function(){var t=this.props.Master.getElementMaster(),n=t.Form.FormElementManager,i=Yt.a.isSection(this.props.Master.getElementMaster().Model.Type),r=[{SelectOptions:[e.getSelectOptionToTheNext(),e.getDropdownOptionToTheEnd()]}],o=n.findContainerSection(t),s=t.Form.hasSection();if(!i){var a=n.findQuestionsInSection(o);if(a.length>=0){var c=n.TopQuestionMasters.indexOf(a[0]);r.push(e.getSelectOptionGroup(a,t,s?Object(ae.a)().Branch_OptionGroup_CurrentSection:void 0,c))}}return r.push(e.getSelectOptionGroup(n.SectionMasters,o,Object(ae.a)().Branch_OptionGroup_OtherSections)),r},e.getNextLabel=function(){return Object(ae.a)().Common_Next_Text},e.getSelectOptionGroup=function(t,n,i,r){void 0===r&&(r=0);var o=t.map((function(t,o){if(t!==n)return e.getSelectOptionToTarget(t,r+o+1,i)})).filter((function(t){return!!t}));return{DisplayName:i,SelectOptions:o}},n.iD=function(t){switch(t){case e.SpecialIdForGoingToTheEnd:return e.getDropdownOptionToTheEnd().DisplayName;case e.SpecialIdForGoingToTheNext:return e.getSelectOptionToTheNext().DisplayName;default:if(!t)return"";var n=this.props.Master.getElementMaster().Form.FormElementManager,i=n.TopQuestionMasters,r=Et.findIndex(i,(function(e){return e.Model.Id===t}));if(r>=0)return e.getSelectOptionToTarget(i[r],r+1).DisplayName;var o=n.SectionMasters;return(r=Et.findIndex(o,(function(e){return e.Model.Id===t})))>=0?e.getSelectOptionToTarget(o[r],r+1).DisplayName:""}},e.getSelectOptionToTheNext=function(){return{DisplayName:e.getNextLabel(),Key:e.SpecialIdForGoingToTheNext,Value:e.SpecialIdForGoingToTheNext}},e.getSelectOptionToTarget=function(t,e,n){var i=t.Model,r=Object(Oa.b)(i.Title),o=Object(ae.a)().Branch_QuestionTitle.format(e,r),s=Yt.a.isSection(t.Model.Type),a=e.toString();return s&&(a=Object(ae.a)().Designer_Sections_DefaultDescription.format(a)),{AriaLabel:n?Object(ae.a)().Common_Fullstop.format(n,o):o,DisplayContent:oe.createElement("div",{className:"branch-selector-option-item"},oe.createElement("span",{className:"branch-selector-option-ordinal",key:"ordinal"},Object(ae.a)().Designer_QuestionOrdinal.format(a)),oe.createElement("span",{className:"branch-selector-option-title",key:"title"},oe.createElement("span",null,r))),DisplayName:o,Key:i.Id,Value:i.Id}},e.getDropdownOptionToTheEnd=function(){return{DisplayName:Object(ae.a)().Branch_Menu_End,Key:e.SpecialIdForGoingToTheEnd,Value:e.SpecialIdForGoingToTheEnd}},n.gO=function(t){var n=this.props.Master,i=n.Model;t===e.SpecialIdForGoingToTheEnd?i.ToTheEnd=!0:(t===e.SpecialIdForGoingToTheNext&&(t=null),n.bulkEdit((function(){i.ToTheEnd=!1,i.TargetQuestionId=t})));var r=n.getElementMaster().Model;Object(g.b)("DesignPage.Branch.BranchChanged",{isQuestionBranching:r.BranchInfo===i,questionType:r.Type,targetQuestionType:n.getTargetElementMaster()&&n.getTargetElementMaster().Model.Type,toTheEnd:i.ToTheEnd,value:t,withSection:n.getElementMaster().Form.hasSection()})},n.eD=function(){this.forceUpdate();var t=this.nD;t&&t.unobserve(this.Tv),this.nD=this.props.Master.getTargetElementMaster(),(t=this.nD)&&t.observe(this.Tv)},Object.defineProperty(e,"SpecialIdForGoingToTheNext",{get:function(){return"% To The Next %"},enumerable:!1,configurable:!0}),Object.defineProperty(e,"SpecialIdForGoingToTheEnd",{get:function(){return"% To The End %"},enumerable:!1,configurable:!0}),e}(ue.a),Ku=function(t){function e(e){var n=t.call(this,e)||this;n.rD=oe.createRef(),n.oD=oe.createRef(),n.sD=oe.createRef(),n.aD=!1,n.Oe=function(){return n.forceUpdate()},n.cD=n.cD.bind(n),n.uD=n.uD.bind(n);var i=n.props.Question;return n.lD=new Zi.a(i,null),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.cD(),this.aD=!0,$(window).resize(this.cD),this.props.Question.observe(this.Oe)},n.componentWillUnmount=function(){$(window).unbind("resize",this.cD),this.props.Question.unobserve(this.Oe)},n.componentDidUpdate=function(){this.cD()},n.render=function(){var t=this.props.Question,e="branch-design-question-card";t.supportsChoiceLevelBranching()||(e=Object(pn.b)(e,"branch-design-question-nonflex")),this.props.Active&&(e=Object(pn.b)(e,"active","office-form-theme-border-top"));var n={Disabled:!0,DisableFormulaLinebreak:!0,DisableShuffle:!0,ExpandAll:!0,HiddenPoint:!0,HideMedia:!0,LocalizedStrings:Object(ae.a)(),Master:this.lD,onHeightChange:this.cD,Ordinal:this.props.Ordinal,ref:this.rD,ShowDesignInfo:!0},i=this.hD(t).filter((function(t){return!!t})),r=0!==i.length&&oe.createElement("div",{className:"branch-design-card",ref:this.oD},i);return oe.createElement("div",{className:e,onClick:this.uD,onFocus:this.uD,key:t.Model.Id,ref:this.sD},Object(ts.a)(n),r)},n.uD=function(){this.props.Active||this.props.setAsActive(this.props.Question)},n.hD=function(t){var e=this,n=[],i=t.Model;return t.supportsQuestionLevelBranching()&&n.push(this.fD(i.BranchInfo,i.Title)),t.supportsChoiceLevelBranching()&&(n=n.concat(Et.map(t.Model.Choices,(function(t){return e.fD(t.BranchInfo,t.Description)}))),i.AllowOtherAnswer&&n.push(this.fD(t.Model.BranchInfoForOtherChoice,Object(ae.a)().Designer_OtherAnswer))),n},n.fD=function(t,e){var n=Wt.a.getObjectMasterFromModel(t),i=n.getInstanceId();if(this.props.Active||!n.isDefault())return oe.createElement(Wu,{AriaLabel:e,Master:n,key:i,ref:i,ReadOnly:this.props.ReadOnly})},n.cD=function(){var t=this,e=$(Ln.findDOMNode(this.rD.current)),n=$(Ln.findDOMNode(this.oD.current));if(e.length&&n.length){var i=e.offset().top,r=this.props.Question;if(r.supportsQuestionLevelBranching()){var o=e.find(".office-form-question-title");this.dD(r.Model.BranchInfo,o,i)}if(r.supportsChoiceLevelBranching()){var s=e.find(".office-form-question-choice"),a=r.Model.Choices;if(s.each((function(e,n){t.dD(a[e].BranchInfo,$(n),i)})),r.Model.AllowOtherAnswer){var c=e.find(".office-form-other-answer");this.dD(r.Model.BranchInfoForOtherChoice,c,i)}}if(!this.aD&&this.props.NeedScroll){var u=this.sD.current;if(u&&u.offsetParent.lastElementChild){var l=u.offsetParent.lastElementChild.firstElementChild;if(l){var h=Object(_t.b)().Model.RelativeScrollHeight;l.scrollTop=u.getBoundingClientRect().top-h}}}}},n.dD=function(t,e,n){var i=e.offset().top-n+e.outerHeight()/2,r=Wt.a.getObjectMasterFromModel(t),o=$(Ln.findDOMNode(this.refs[r.getInstanceId()]));o.length&&o.css("top",i-o.outerHeight()/2)},e}(ue.a),Ju=function(t){function e(e){var n=t.call(this,e)||this;return n.Ky=oe.createRef(),n.bD=n.bD.bind(n),n.cD=n.cD.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.cD()},n.render=function(){var t=this,e=this.props.SectionNode,n=this.props.SectionIndex,i=this.props.QuestionStartIndex,r="branch-design-section-container";0===this.props.QuestionStartIndex&&0===n&&(r=Object(pn.b)(r,"branch-design-section-container-merge")),this.props.Active&&(r=Object(pn.b)(r,"office-form-theme-border-top"));var o=e.TopQuestionMasters.map((function(e){return oe.createElement(Ku,{Question:e,Active:e===t.props.getActive(),Ordinal:1+i++,key:e.Model.Id,ReadOnly:t.props.ReadOnly,setAsActive:t.props.setActive,NeedScroll:e===t.props.getScroll()})}));return oe.createElement("div",{className:r,ref:this.Ky},oe.createElement("div",{className:"branch-design-section-header"},oe.createElement("h2",{className:"branch-design-section-sequence"},Object(ae.a)().Designer_Sections_DefaultDescription.format(n+1))),oe.createElement("div",{className:"branch-design-section-title office-form-title heading-2 office-form-theme-primary-color"},e.Section.Model.Title),oe.createElement("div",{className:"branch-design-section-view"},o),oe.createElement("div",{className:"branch-design-section-footer",onClick:this.bD,onFocus:this.bD},this.fD(e.Section.Model.BranchInfo,e.Section.Model.Title)))},n.bD=function(){this.props.Active||this.props.setActive(this.props.SectionNode.Section)},n.fD=function(t,e){var n=Wt.a.getObjectMasterFromModel(t),i=n.getInstanceId();return oe.createElement(Wu,{AriaLabel:e,Master:n,key:i,ref:i,ReadOnly:this.props.ReadOnly})},n.cD=function(){if(this.props.NeedSectionScroll){var t=this.Ky.current;if(t&&t.offsetParent.lastElementChild){var e=t.offsetParent.lastElementChild.firstElementChild;if(e){var n=Object(_t.b)().Model.RelativeScrollHeight;e.scrollTop=t.getBoundingClientRect().top-n}}}},e}(ue.a);var Xu=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.mD=oe.createRef(),n.vD=oe.createRef(),n.Oe=function(){return n.forceUpdate()},n.gD=n.gD.bind(n),n.OD=n.OD.bind(n),n.pD=n.pD.bind(n),n.jD=n.jD.bind(n),n.yD=n.yD.bind(n),n.wD=n.wD.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this,e=this.props.Form,n=Object(d.b)().BranchingElementId,i=Object(d.b)().SectionElementId;e.ensureReadyToDesign().then((function(){if(t.ce){e.observe(t.Oe,[Zt.a.Schema.Questions]),e.observe(t.Oe,[Zt.a.Schema.DescriptiveElements]);var r=e.FormElementManager.QuestionMasters[0],o=Et.find(e.FormElementManager.QuestionMasters,(function(t){return t.Model.Id===n}))||null;o&&(r=o);var s=Et.find(e.FormElementManager.SectionMasters,(function(t){return t.Model.Id===i}))||null;i&&(r=s),t.setState({ElementInDesignMode:r,ElementInDesignScrollMode:o,FormReadyForDesign:!0,SectionInDesignScrollMode:s})}})),Object(g.b)("DesignPage.Branch.BranchDesignViewNavigate")},n.componentWillUnmount=function(){this.ce=!1,this.props.Form.unobserve(this.Oe)},n.render=function(){var t;return t=this.state.FormReadyForDesign?oe.createElement("div",{className:"office-form-page-padding branch-design-view-container"},this.SD(),this.ND()):Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text}),oe.createElement("div",Object(S.__assign)({},this.getContainerProps()),this.createHeader(),oe.createElement("div",{className:"top-view-content office-form-theme-page-background"},t))},n.gD=function(t){null===this.state.SectionInDesignScrollMode?this.setState({ElementInDesignMode:t,ElementInDesignScrollMode:null}):this.setState({ElementInDesignMode:t,SectionInDesignScrollMode:null})},n.Me=function(){return oe.createElement("div",{className:"branch-design-view-title-bar"},oe.createElement("div",{className:"branch-design-view-title office-form-theme-primary-foreground"},Object(ae.a)().DesignPage_BranchingDesignViewTitle),this.ID())},n.ID=function(){var t,e=this;if(this.state.MoreOptionsExpanded){var n={ButtonStyle:"LightBackground",HTMLAttributes:{className:"branch-design-view-options-menu-item",onClick:function(){e.setState({MoreOptionsExpanded:!1}),e.props.Form.resetBranchInfo(),e.mD.current.focus()}},Text:Object(ae.a)().Branch_ResetToDefault},i=oe.createElement(Gi.a,Object(S.__assign)({},n));t=oe.createElement("div",{className:"branch-design-view-options-menu-container"},oe.createElement("div",{className:"branch-design-view-options-menu",onBlur:this.jD,onKeyDown:this.yD,ref:this.vD},i))}var r=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{"aria-expanded":this.state.MoreOptionsExpanded,className:"branch-design-view-options-button",onBlur:this.jD,onClick:this.wD,onKeyDown:this.yD},Icon:"More",IconClassName:"forms-icon-size18x18",ref:this.mD,Text:Object(ae.a)().DesignPage_BranchingDesignView_MoreOptions});return oe.createElement("div",{className:"branch-design-view-options"},r,t)},n.jD=function(t){var e=this.vD.current,n=this.mD.current.getHtmlElement(),i=Object(pn.d)(t);n!==i&&e&&!e.contains(i)&&this.setState({MoreOptionsExpanded:!1})},n.wD=function(){this.setState({MoreOptionsExpanded:!this.state.MoreOptionsExpanded})},n.yD=function(t){var e=this;27===t.keyCode&&27===t.keyCode&&this.state.MoreOptionsExpanded&&this.setState({MoreOptionsExpanded:!1},(function(){e.mD.current.focus()}))},n.SD=function(){var t=this,e=this.props.Form,n=e.FormElementManager.HeaderTopQuestionMasters.map((function(e,n){return oe.createElement(Ku,{Question:e,Active:e===t.state.ElementInDesignMode,Ordinal:n+1,key:e.Model.Id,ReadOnly:!1,setAsActive:t.gD,NeedScroll:e===t.state.ElementInDesignScrollMode})})),i="branch-design-view office-form-theme-border-top";return e.hasSection()&&(i=Object(pn.b)(i,"branch-design-view-trimmed")),oe.createElement("div",{className:i,key:"headerDesigner"},this.Me(),n,oe.createElement(es.a,{ThemeMaster:this.props.Form.ThemeMaster}))},n.ND=function(){var t=this,e=this.props.Form,n=e.FormElementManager.HeaderTopQuestionMasters.length;return e.FormElementManager.getSectionNodes().filter((function(t){return t.Section})).map((function(e,i){var r=oe.createElement(Ju,{key:i,QuestionStartIndex:n,ReadOnly:!1,Active:e.Section===t.state.ElementInDesignMode,SectionIndex:i,SectionNode:e,setActive:t.gD,getActive:t.OD,getScroll:t.pD,NeedSectionScroll:e.Section===t.state.SectionInDesignScrollMode});return n+=e.TopQuestionMasters.length,r}))},n.OD=function(){return this.state.ElementInDesignMode},n.pD=function(){return this.state.ElementInDesignScrollMode},e}(Uu);var Zu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.CD=function(){return e.kD()},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.kD();var t=Object(_t.b)();t.observe(this.CD,[t.Schema.ErrorBarMessage])},n.componentWillUnmount=function(){Object(_t.b)().unobserve(this.CD)},n.render=function(){var t=this.state.Message;if(!t)return null;var e=Object(Un.b)({HTMLAttributes:{className:"forms-icon-size14x14 error-message-bar-warning-icon"},IconName:"Error",key:"warningIcon"});return oe.createElement("div",{id:"error-message-bar",className:"error-message-bar"},oe.createElement("div",{className:"error-message-bar-message-alert","aria-live":"polite"},t),oe.createElement("div",{className:"error-message-bar-message"},e,t))},n.kD=function(){var t=this,e=Object(_t.b)().Model.ErrorBarMessage;e?this.setState({Message:e},(function(){return $("#error-message-bar").stop().fadeIn("fast")})):$("#error-message-bar").stop().fadeOut("slow",(function(){t.setState({Message:void 0})}))},e}(ue.a);var Yu=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.TD=function(){return e.xD()},e.vl=Object(_t.b)().Model,e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.setState({MessageType:this.vl.InfoBarMessageType})},n.componentDidMount=function(){this.xD();var t=Object(_t.b)();t.observe(this.TD,[t.Schema.InfoBarMessageType])},n.componentWillUnmount=function(){Object(_t.b)().unobserve(this.TD)},n.render=function(){var t=this.FD(this.state.MessageType);return t?oe.createElement("div",{id:"info-message-bar",className:"info-message-bar"},oe.createElement("div",{className:"info-message-bar-message"},oe.createElement(Un.a,{IconName:"Info"}),t)):null},n.xD=function(){var t=this,e=this.vl.InfoBarMessageType;this.FD(e)?(this.setState({MessageType:e}),$("#info-message-bar").stop().fadeIn("fast")):$("#info-message-bar").stop().fadeOut("slow",(function(){t.setState({MessageType:void 0})}))},n.FD=function(t){switch(t){case"DownloadExcelLimitReached":return Object(ae.a)().InfoBarMessage_DownloadExcel_LimitReached;case"DownloadExcelVMLimitReached":return Object(ae.a)().Error_Message_10203;default:return}},e}(ue.a);var tl=function(t){function e(e){var n=t.call(this,e)||this;n.PD="",n.JS=Object(_t.b)().Model,n.DD=!0;var i=n.JS.FormMaster;i&&i.Model.XlFileUnsynced&&(n.PD=i.Model.XlUnsyncedReason);var r=parseInt(n.PD);return n.DD=isNaN(r)?n.DD:r<=2e3,n.MD=n.MD.bind(n),n.LD=n.LD.bind(n),n.AD=n.AD.bind(n),n.RD=n.RD.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return Object(g.b)("DesignPage.XLUnsyncedDialog.Render",{errorCode:this.PD}),oe.createElement("div",{className:"form-introduction-dialog-div"},oe.createElement("div",{className:"xl-unsynced-dialog-container"},this.ED(),this.Rn(),this.qc()))},n.ED=function(){return oe.createElement("div",{className:"xl-unsynced-dialog-text-container"},oe.createElement("div",{className:"xl-unsynced-dialog-title"},this.BD()),oe.createElement("div",{className:"xl-unsynced-dialog-content-text"},this._D()))},n.Rn=function(){return oe.createElement("div",{className:"xl-unsynced-dialog-button-container"},this.HD(),this.DD?this.GD():this.qD())},n.GD=function(){return Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{autoFocus:!0,className:"xl-unsynced-dialog-light-button",onClick:this.MD},Text:Object(ae.a)().XLUnsyncedDialog_OpenExcel_Button})},n.HD=function(){return Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{autoFocus:!1,className:"xl-unsynced-dialog-button",onClick:this.LD},Text:Object(ae.a)().XLUnsyncedDialog_Reexport_Button})},n.qD=function(){return Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{autoFocus:!0,className:"xl-unsynced-dialog-light-button",onClick:this.RD},Text:Object(ae.a)().XLUnsyncedDialog_SetSync_Button})},n.qc=function(){return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"xl-unsynced-dialog-close-button",onClick:this.AD},Icon:"Cancel",IconClassName:"xl-unsynced-dialog-close-icon forms-icon-size16x16",Text:Object(ae.a)().Common_Close_Text})},n._D=function(){var t=function(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"1001":return n.XLUnsyncedDialog_Content_1001;case"1002":return n.XLUnsyncedDialog_Content_1002;case"1003":return n.XLUnsyncedDialog_Content_1003;case"1004":return n.XLUnsyncedDialog_Content_1004;case"1005":return n.XLUnsyncedDialog_Content_1005;case"2001":return n.XLUnsyncedDialog_Content_2001;default:return""}}(""+this.PD);if(t||(t=Object(ae.a)().XLUnsyncedDialog_Content),!this.DD){var e=t.split("{0}");if(2===e.length){var n=Object(ae.a)().XLUnsyncedDialog_OpenExcel_Button;return oe.createElement("span",null,e[0],oe.createElement("a",{style:{cursor:"pointer"},onClick:this.MD},n),e[1])}}return oe.createElement("span",null,t)},n.BD=function(){var t=function(t,e){var n=null!=e?e:Object(ae.a)();switch(t){case"2001":return n.XLUnsyncedDialog_Title_2001;default:return""}}(""+this.PD);return t||(t=Object(ae.a)().XLUnsyncedDialog_Title),t},n.AD=function(){Object(g.b)("DesignPage.XLUnsyncedDialog.Close"),this.JS.ShowXLUnsyncedDialog=!1},n.MD=function(){Object(g.b)("DesignPage.XLUnsyncedDialog.OpenExcel");var t=this.JS.FormMaster;t&&Object(pi.a)(t.Model.Id),this.DD&&this.AD()},n.LD=function(){Object(g.b)("DesignPage.XLUnsyncedDialog.ReexportExcel");var t=this.JS.FormMaster;t&&(t.SetToExporting(),Object(pi.b)(t.Model.Id)),this.AD()},n.RD=function(){Object(g.b)("DesignPage.XLUnsyncedDialog.SetSync");var t=this.JS.FormMaster;t&&(t.Model.XlFileUnsynced=!1),this.AD()},e}(ue.a),el=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate()};var i=Object(_t.b)().Model.FormMaster;return i&&i.observe(n.Oe,[Zt.a.Schema.YouTubeMessageBarState]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){var t=Object(_t.b)().Model.FormMaster;t&&t.observe(this.Oe,[Zt.a.Schema.YouTubeMessageBarState])},n.componentWillUnmount=function(){var t=Object(_t.b)().Model.FormMaster;t&&t.unobserve(this.Oe)},n.render=function(){var t=Object(Un.b)({HTMLAttributes:{className:"forms-icon-size14x14 youtube-disable-message-bar-close-icon",onClick:e.closeYouTubeMessageBar},IconName:"ChromeClose",key:"closeIcon"}),n=Object(ae.a)().DesignPage_Youtube_Disabled_Message_Bar,i=oe.createElement("span",{className:"youtube-disable-message-bar-message"},n),r=Object(_t.b)().Model.FormMaster;if(r&&r.Model.YouTubeMessageBarState===Ji.a.Shown){var o="youtube-disable-message-bar";return Object(et.r)()&&(o=Object(pn.b)(o,"mobile-message-bar")),oe.createElement("div",{className:o},i,t)}return null},e.closeYouTubeMessageBar=function(){var t=Object(_t.b)().Model.FormMaster.Model.Id,e=function(){var t=[],e=Object(O.b)().getItem(Ki.c);e&&(t=JSON.parse(e));return t}();e&&!e.indexOf(t)&&e.push(t),Object(O.b)().setItem(Ki.c,JSON.stringify(e)),Object(_t.b)().Model.FormMaster.Model.YouTubeMessageBarState=Ji.a.Closed},e}(ue.a);var nl=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ClosePopUp:!1,DisableDialogButton:!1,ShowTour:!1},n.QD=n.QD.bind(n),n.VD=n.VD.bind(n),n.zD=n.zD.bind(n),n.UD=n.UD.bind(n),n.Wv=n.Wv.bind(n),n.$D=[Object(On.b)("/Images/PortalMyForms/freDesign.gif"),Object(On.b)("/Images/PortalMyForms/freEmail.gif"),Object(On.b)("/Images/PortalMyForms/freFlow.gif"),Object(On.b)("/Images/PortalMyForms/freAnalysis.gif")],n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){this.state.ShowTour&&this.WD(0)},n.render=function(){return this.state.ClosePopUp||this.props.isProUser&&!Object(Ei.d)(Object(Ei.c)().Model.PortalFormsProIntroduction)?null:(this.Cn=(new Date).getTime()/1e3,oe.createElement("div",{className:"portal-page"},this.KD()))},n.KD=function(){return oe.createElement("div",{className:"form-introduction-dialog-div"},oe.createElement("div",{className:"pro-introduction-dialog-start-container"},this.state.ShowTour?this.JD():this.XD(),this.state.ShowTour&&this.Ff(),this.qc()))},n.JD=function(){var t="pro-introduction-dialog-image-lower-text form-introduction-dialog-image-first-line-padding",e="pro-introduction-dialog-image-lower-text form-introduction-dialog-image-second-line-padding",n=Object(ae.a)().FormPro_Available_Design_FREFirstLineText,i=Object(ae.a)().FormPro_Available_Design_FRE_HeadingText,r=Object(ae.a)().FormPro_Available_Design_FRESecondLineText,o=Object(ae.a)().FormPro_Available_Email_FREFirstLineText,s=Object(ae.a)().FormPro_Available_Email_FRE_HeadingText,a=Object(ae.a)().FormPro_Available_Email_FRESecondLineText,c=Object(ae.a)().FormPro_Available_Flow_FREFirstLineText,u=Object(ae.a)().FormPro_Available_Flow_FRE_HeadingText,l=Object(ae.a)().FormPro_Available_Flow_FRESecondLineText,h=Object(ae.a)().FormPro_Available_Analysis_FREFirstLineText,f=Object(ae.a)().FormPro_Available_Analysis_FRE_HeadingText,d=Object(ae.a)().FormPro_Available_Analysis_FRESecondLineText;return oe.createElement("div",{className:"pro-introduction-dialog-container"},oe.createElement("div",{className:"pro-introduction-dialog-image-container carousel slide",id:"myCarousel","data-ride":"carousel","data-interval":"20000"},oe.createElement("ol",{className:"carousel-indicators pro-carousel-indicators"},oe.createElement("li",{"data-target":"#myCarousel","data-slide-to":"0",className:"active",onClick:this.VD,title:Object(ae.a)().FormPro_Available_Design_FRE_HeadingText}),oe.createElement("li",{"data-target":"#myCarousel","data-slide-to":"1",onClick:this.VD,title:Object(ae.a)().FormPro_Available_Email_FRE_HeadingText}),oe.createElement("li",{"data-target":"#myCarousel","data-slide-to":"2",onClick:this.VD,title:Object(ae.a)().FormPro_Available_Flow_FRE_HeadingText}),oe.createElement("li",{"data-target":"#myCarousel","data-slide-to":"3",onClick:this.VD,title:Object(ae.a)().FormPro_Available_Analysis_FRE_HeadingText})),oe.createElement("div",{className:"carousel-inner pro-carousel-inner"},oe.createElement("div",{className:"form-introduction-dialog-title-container item active"},oe.createElement("img",{className:"pro-introduction-fre-img",src:this.$D[0],alt:i+" "+n+" "+r,width:"100%"}),oe.createElement("div",{className:"pro-introduction-dialog-image-text"},Object(ae.a)().FormPro_Available_Design_FRE_HeadingText),oe.createElement("div",{className:t},Object(ae.a)().FormPro_Available_Design_FREFirstLineText),oe.createElement("div",{className:e},Object(ae.a)().FormPro_Available_Design_FRESecondLineText)),oe.createElement("div",{className:"form-introduction-dialog-title-container item"},oe.createElement("img",{className:"pro-introduction-fre-img",src:this.$D[1],alt:s+" "+o+" "+a,width:"100%"}),oe.createElement("div",{className:"pro-introduction-dialog-image-text"},Object(ae.a)().FormPro_Available_Email_FRE_HeadingText),oe.createElement("div",{className:t},Object(ae.a)().FormPro_Available_Email_FREFirstLineText),oe.createElement("div",{className:e},Object(ae.a)().FormPro_Available_Email_FRESecondLineText)),oe.createElement("div",{className:"form-introduction-dialog-title-container item"},oe.createElement("img",{className:"pro-introduction-fre-img",src:this.$D[2],alt:u+" "+c+" "+l,width:"100%"}),oe.createElement("div",{className:"pro-introduction-dialog-image-text"},Object(ae.a)().FormPro_Available_Flow_FRE_HeadingText),oe.createElement("div",{className:t},Object(ae.a)().FormPro_Available_Flow_FREFirstLineText),oe.createElement("div",{className:e},Object(ae.a)().FormPro_Available_Flow_FRESecondLineText)),oe.createElement("div",{className:"form-introduction-dialog-title-container item"},oe.createElement("img",{className:"pro-introduction-fre-img",src:this.$D[3],alt:f+" "+h+" "+d,width:"100%"}),oe.createElement("div",{className:"pro-introduction-dialog-image-text"},Object(ae.a)().FormPro_Available_Analysis_FRE_HeadingText),oe.createElement("div",{className:t},Object(ae.a)().FormPro_Available_Analysis_FREFirstLineText),oe.createElement("div",{className:e},Object(ae.a)().FormPro_Available_Analysis_FRESecondLineText))),oe.createElement("a",{className:"left carousel-control pro-carousel-control",href:"#myCarousel","data-slide":"prev",role:"button",onClick:this.zD},oe.createElement("span",{className:" ms-Icon ms-Icon--ChevronLeftMed"}),oe.createElement("span",{className:"sr-only"},Object(ae.a)().FormPro_Available_Previous)),oe.createElement("a",{className:"right carousel-control pro-carousel-control",href:"#myCarousel","data-slide":"next",role:"button",onClick:this.zD},oe.createElement("span",{className:"ms-Icon ms-Icon--ChevronRightMed"}),oe.createElement("span",{className:"sr-only"},Object(ae.a)().Common_Next_Text))),this.ZD())},n.XD=function(){return oe.createElement("div",null,oe.createElement("div",{className:"pro-introduction-dialog-title-container"},oe.createElement("div",{className:"pro-introduction-dialog-image"},oe.createElement("img",{role:"presentation","aria-hidden":"true",src:Object(On.b)("/Images/PortalMyForms/FormsPro_info_1.png")})),oe.createElement("div",{className:"pro-introduction-dialog-title"},Object(ae.a)().Form_Introduction_Dialog_Title1.format(function(){var t=Object(u.a)().userInfo.GivenName||Object(u.a)().userInfo.DisplayName;t||Object(g.c)("MissingUserName",{displayName:!!Object(u.a)().userInfo.DisplayName,givenName:!!Object(u.a)().userInfo.GivenName,userId:!!Object(u.a)().userInfo.UserId});return t}())),oe.createElement("div",{className:"pro-introduction-dialog-subtitle1"},this.props.isProUser?Object(ae.a)().FormPro_GetStarted_Dialog_Title1:Object(ae.a)().FormPro_Available_Dialog_Title1),oe.createElement("div",{className:"pro-introduction-dialog-subtitle2"},Object(ae.a)().FormPro_Available_Dialog_Title2),oe.createElement("div",{className:"pro-introduction-dialog-subtitle3",onClick:this.QD},Object(ae.a)().FormPro_Available_Dialog_Title3)),oe.createElement("div",{className:"pro-introduction-dialog-container"},oe.createElement("div",{className:"pro-introduction-dialog-text-container"},il(Object(ae.a)().FormPro_Available_Dialog_Body_Text1,Object(ae.a)().FormPro_Available_Dialog_Body_Text4),il(Object(ae.a)().FormPro_Available_Dialog_Body_Text2,Object(ae.a)().FormPro_Available_Dialog_Body_Text5),il(Object(ae.a)().FormPro_Available_Dialog_Body_Text3,Object(ae.a)().FormPro_Available_Dialog_Body_Text6)),this.ZD()))},n.qc=function(){var t=this;return Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:this.props.isProUser?"formspro-introduction-dialog-close-button":"form-introduction-dialog-close-button",onClick:function(){if(t.props.isProUser)t.Wv("MFPUI_FRECloseClick");else{t.Wv("PortalPage.FormIntroductionDialog.Close");var e=Object(_t.b)();e.bulkEdit((function(){e.Model.TopView="None"}))}t.setState({ClosePopUp:!0})}},Icon:"Cancel",IconClassName:"pro-introduction-dialog-close-icon forms-icon-size14x14",Text:Object(ae.a)().Common_Close_Text})},n.Ff=function(){var t=this;return Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{autoFocus:!0,className:"pro-introduction-dialog-back-button",onClick:function(){t.state.ShowTour&&t.setState({ShowTour:!1})},title:Object(ae.a)().FormPro_Available_GoBack_Button},Icon:"Back",IconClassName:"top-view-back-icon forms-icon-size14x14",ref:"back-button"})},n.ZD=function(){var t=this;return Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{autoFocus:!0,className:this.state.DisableDialogButton?"pro-introduction-dialog-button disable":"pro-introduction-dialog-button",onClick:function(){t.props.isProUser?(t.Wv("MFPUI_FREGetStartedClick"),t.setState({ClosePopUp:!0})):t.state.DisableDialogButton||(t.Wv("PortalPage.ProIntroductionDialog.SwitchToFormsPro"),FormsPro.onConfirmSwitchToFormsPro(),t.setState({DisableDialogButton:!0}))}},ref:"dialogButton",Text:this.props.isProUser?Object(ae.a)().FormPro_Available_GetStarted_Button:Object(ae.a)().FormPro_Available_SwitchToPro_Button})},n.QD=function(){this.props.isProUser?Object(g.e)({eventInfo:{Component:"ProIntroductionDialog",Geo:null!==document.getElementById("Geo")?document.getElementById("Geo").value:"",tenantId:Object(u.a)().userInfo.TenantId,userId:Object(u.a)().userInfo.UserId},type:"MFPUI_FRETakeTourClick"}):Object(g.b)("PortalPage.ProIntroductionDialog.TakeTour"),this.setState({ShowTour:!0})},n.UD=function(t){var e=$(".carousel-indicators li.active").attr("data-slide-to");this.WD(e)},n.VD=function(t){var e=t.currentTarget.dataset.slideTo;this.WD(e)},n.zD=function(t){var e,n=$("#myCarousel div.active").index();t.currentTarget.classList.contains("right")?(e=(n+1)%this.$D.length,this.WD(e)):t.currentTarget.classList.contains("left")&&(e=n-1<0?this.$D.length-1:n-1,this.WD(e))},n.WD=function(t){var e=document.getElementsByClassName("form-introduction-fre-img")[t];null!=e&&(e.src=this.$D[t])},n.Wv=function(t){var e=(new Date).getTime()/1e3-this.Cn;this.props.isProUser?(Object(g.e)({eventInfo:{Component:"ProIntroductionDialog",duration:e,Geo:null!==document.getElementById("Geo")?document.getElementById("Geo").value:"",tenantId:Object(u.a)().userInfo.TenantId,userId:Object(u.a)().userInfo.UserId},type:t}),Object(Ei.c)().Model.PortalFormsProIntroduction=Ei.a.toString()):Object(g.b)(t,{duration:e})},e}(ue.a);function il(t,e){var n=Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16"},IconName:"CheckMark"});return oe.createElement("div",{className:"pro-introduction-dialog-text-row"},oe.createElement("div",{className:"pro-introduction-dialog-text-column"},oe.createElement("div",{className:"pro-introduction-dialog-check"},n),oe.createElement("div",{className:"pro-introduction-dialog-subtext"},t)),oe.createElement("div",{className:"pro-introduction-dialog-text-column"},oe.createElement("div",{className:"pro-introduction-dialog-check"},n),oe.createElement("div",{className:"pro-introduction-dialog-subtext"},e)))}var rl=n(66),ol=n(155),sl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"multi-lingual-title-edition office-form-theme-focus-border"},this.YD(),this.tM())},n.YD=function(){var t,e=this,n=this.props.Ordinal;n&&(t=oe.createElement("span",{className:"multi-lingual-question-ordinal"},n));var i=Object(ar.c)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-title-editon-text"},MaxLength:this.props.TitleLengthLimitation,MinimalHeight:Object(Pe.j)(),onValueChange:this.props.onTitleValueChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.props.TitleLabel}},TextFieldType:2,Value:Object(at.c)((function(){return e.props.LingualTitle||""}),at.f)},this.props.Form,!this.props.IsForm);return oe.createElement("div",null,oe.createElement("div",{className:"multi-lingual-title"},this.props.Title),oe.createElement("div",{className:"multi-lingual-title-editon-container"},t,i))},n.tM=function(){var t=this.props.SubTitle,e=this.props.LingualSubTitle;if(t){var n=Object(ar.c)({AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-subtitle-edition-box"},MaxLength:this.props.SubtitleLengthLimitation,MinimalHeight:Object(Pe.j)(),onValueChange:this.props.onSubTitleValueChange,Options:{HTMLPropsForInnerElement:{"aria-label":this.props.SubTitleLabel}},TextFieldType:2,Value:Object(at.c)((function(){return e||""}),at.f)},this.props.Form,!0);return oe.createElement("div",{className:"multi_lingual_subtitle_edition"},oe.createElement("div",{className:"multi-lingual-title"},t),n)}},e}(ue.a),al=function(t){function e(e){var n=t.call(this,e)||this;return n.Oe=function(){return n.forceUpdate()},n.nw=n.nw.bind(n),n.Se=n.Se.bind(n),n.eM=rl.a.getQuestionResourceMaster(e.LocaleId,e.Master.Model.Id,e.Master.Form),n.eM.observe(n.Oe,[sr.a.Schema.title,sr.a.Schema.subtitle]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){var t=this.eM.Model.title;t&&(this.eM.Model.title=t.replace(/\s*$/,"")),this.eM.unobserve(this.Oe)},n.render=function(){var t=this.eM.Model,e=this.props.Master.Model,n=Object(at.c)((function(){return{}}),at.f);return oe.createElement(sl,Object(S.__assign)({onSubTitleValueChange:this.Se,onTitleValueChange:this.nw,Ordinal:this.props.Ordinal,SubTitle:e.Subtitle,SubTitleLabel:Object(ae.a)().Designer_QuestionSubtitle,Title:e.Title,TitleLabel:Object(ae.a)().Designer_QuestionTitle,LingualTitle:t.title,LingualSubTitle:t.subtitle,TitleLengthLimitation:Object(Pe.I)(),SubtitleLengthLimitation:Object(Pe.H)()},n))},n.nw=function(t){var e=this;Object(at.c)((function(){e.eM.Model.title=t}),at.f)},n.Se=function(t){var e=this;Object(at.c)((function(){e.eM.Model.subtitle=t}),at.f)},e}(ue.a),cl=function(t){function e(e){var n=t.call(this,e)||this;return n.Oe=function(){return n.forceUpdate()},n.props.QuestionResourceMaster.observe(n.Oe,[n.props.QuestionResourceMaster.Schema.choicesV1]),n.gO=n.gO.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.QuestionResourceMaster&&this.props.QuestionResourceMaster.unobserve(this.Oe)},n.render=function(){var t=this.props,e=t.Index,n=t.ShowAsDropdown,i=t.QuestionResourceMaster.getChoiceV1LocalizedMaster(e),r=i&&i.Model,o=!n&&oe.createElement("input",{"aria-label":Object(ae.a)().DesignPage_ChoiceOptionRadioBox_AriaLabel.format(e+1),disabled:!0,className:"multi-lingual-choice-icon",type:this.props.IsMultipleAnswer?"checkbox":"radio"}),s=r?r.description:"",a={AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-option-textbox"},MaxLength:Object(Pe.G)(),onValueChange:this.gO,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().DesignPage_ChoiceOptionInputBox_AriaLabel}},Value:s},c=Object(ar.c)(a),u=n?"multi-answer":"multi-lingual-choice-description";return oe.createElement("div",null,oe.createElement("div",{className:u},t.OriginalDescription),oe.createElement("div",null,o,c))},n.gO=function(t){var e=this.props.QuestionResourceMaster.getChoiceV1LocalizedMaster(this.props.Index),n=e&&e.Model;n&&Object(at.c)((function(){n.description=t}),at.f)},e}(ue.a),ul=function(t){function e(e){var n=t.call(this,e)||this,i=n.props.Master,r=i.Form;return n.nM=rl.a.getQuestionResourceMaster(n.props.LocaleId,i.Model.Id,r),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this;return oe.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),oe.createElement("div",{className:"multi-lingual-all-choices"},Et.map(this.props.Master.Model.Choices,(function(e,n){return t.On(e,n)}))))},n.On=function(t,e){var n=this.props.Master;return oe.createElement(cl,{Index:e,IsMultipleAnswer:n.Model.ChoiceType===te.a.MultiChoice,key:e,OriginalDescription:t.Description,QuestionMaster:this.props.Master,QuestionResourceMaster:this.nM,ShowAsDropdown:n.showAsDropdown()})},e}(ue.a),ll=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=Object(Un.b)({HTMLAttributes:{className:"date-snapshot-event-icon forms-icon-size22x22"},IconName:"Calendar"}),e=Object(ae.a)().QuestionType_DateTime_PlaceHolder.format(Object(u.a)().cultureInfo.DateTimeFormat.ShortDatePattern);return oe.createElement("div",{className:"multi-lingual-question-edition"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),oe.createElement("div",{className:"multi-lingual-date-placeholder"},t,oe.createElement("input",{className:"form-control",disabled:!0,placeholder:e})))},e}(ue.a),hl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){return oe.createElement("div",{className:"multi-lingual-question-edition"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}))},e}(ue.a),fl=function(t){function e(e){var n=t.call(this,e)||this;return n.Oe=function(){return n.forceUpdate()},n.props.QuestionResourceMaster.observe(n.Oe,[n.props.QuestionResourceMaster.Schema.choices]),n.iM=n.iM.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.QuestionResourceMaster&&this.props.QuestionResourceMaster.unobserve(this.Oe)},n.render=function(){var t=this.props.QuestionResourceMaster.getChoiceLocalizedMaster(this.props.ChoiceId).Model,e=Object(ar.b)({AutoSelection:!0,MinimalHeight:Object(Pe.j)(),onValueChange:this.iM,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().DesignPage_LikertOptionInputBox_AriaLabel}},TextFieldType:2,Value:t&&t.description});return oe.createElement("td",null,e)},n.iM=function(t){var e=this.props.QuestionResourceMaster.getChoiceLocalizedMaster(this.props.ChoiceId),n=e&&e.Model;n&&(n.description=t)},e}(ue.a),dl=function(t){function e(e){var n=t.call(this,e)||this;return n.Oe=function(){return n.forceUpdate()},n.nM=rl.a.getQuestionResourceMaster(e.LocaleId,e.QuestionId,e.Form),n.nM.observe(n.Oe,[n.nM.Schema.title]),n.rM=n.rM.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.nM&&this.nM.unobserve(this.Oe)},n.render=function(){var t=this.nM.Model,n=this.props.QuestionId,i=this.props.Form.getQuestionById(n),r=i.ParentQuestionMaster&&i.ParentQuestionMaster.Model,o=r&&r.ChoiceGroup,s=Object(at.c)((function(){return t.title||""}),at.f),a=Object(ar.c)({AutoSelection:!0,HTMLAttributes:{},MinimalHeight:Object(Pe.j)(),onValueChange:this.rM,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_LabelForLikertRowTitle,className:"muliti-lingual-statement-edition"}},TextFieldType:2,Value:s}),c=o&&o.length&&Et.map(o,(function(t,n){return e.createMatrixRadio(n,t.Description)}));return oe.createElement("tr",{className:"multi-lingual-statement-line"},oe.createElement("td",{className:"multi-lingual-statement-edition"},a),c)},e.createMatrixRadio=function(t,e){return oe.createElement("td",{key:t},oe.createElement("input",{"aria-disabled":!0,"aria-label":e,className:"multi-lingual-choice-icon",disabled:!0,type:"radio"}))},n.rM=function(t){var e=this;Object(at.c)((function(){e.nM.Model.title=t}),at.f)},e}(ue.a),bl=function(t){function e(e){var n=t.call(this,e)||this,i=n.props.Master,r=i.Form;return n.nM=rl.a.getQuestionResourceMaster(n.props.LocaleId,i.Model.Id,r),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),oe.createElement("div",{className:"muliti-lingual-div-table"},oe.createElement("table",{className:"multi-lingual-likert-table"},oe.createElement("thead",null,this.oM(),this.sM()),oe.createElement("tbody",{className:"multi-lingual-edition-content"},this.aM()))))},n.oM=function(){var t=this.props.Master.Model.ChoiceGroup;return oe.createElement("tr",{className:"multi-lingual-choice-line"},oe.createElement("td",null),Et.map(t,(function(t){return e.createChoice(t)})))},e.createChoice=function(t){return oe.createElement("td",{key:t.Id},t.Description)},n.sM=function(){var t=this,e=this.props.Master.Model.ChoiceGroup,n=Et.map(e,(function(e){return t.cM(e)}));return oe.createElement("tr",{className:"multi-lingual-choice-edition-line"},oe.createElement("td",null),n)},n.cM=function(t){var e=t.Id.toString();return oe.createElement(fl,{ChoiceId:e,key:e,QuestionResourceMaster:this.nM})},n.aM=function(){var t=this;return this.props.Master.SubQuestionMasters.map((function(e){return t.uM(e)}))},n.uM=function(t){var e=t.Model;return[this.lM(e),this.hM(t)]},n.hM=function(t){var e=this.props.LocaleId;return oe.createElement(dl,{Form:t.Form,QuestionId:t.Model.Id,LocaleId:e,key:"edition"+t.Model.Id})},n.lM=function(t){var n=this.props.Master.Model.ChoiceGroup,i=oe.createElement("td",null,t.Title),r=Et.map(n,(function(t,n){return e.createBlankTds(n)}));return oe.createElement("tr",{className:"multi-lingual-statement-line",key:"statement"+t.Id},i,r)},e.createBlankTds=function(t){return oe.createElement("td",{key:t})},e}(ue.a),ml=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate()};var i=n.props.Master,r=i.Form;return n.nM=rl.a.getQuestionResourceMaster(n.props.LocaleId,i.Model.Id,r),n.nM.observe(n.Oe,[n.nM.Schema.leftDescription,n.nM.Schema.rightDescription,n.nM.Schema.formsprortlocaleldescription,n.nM.Schema.formsprortlocalerdescription]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.nM&&this.nM.unobserve(this.Oe)},n.render=function(){var t=oe.createElement(Cr.a,{Disabled:!0,Value:void 0});return oe.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),oe.createElement("div",{className:"multi-lingual-nps-question-content"},t,this.zs()))},n.zs=function(){var t=this.props.Master.Model,e=this.nM.Model,n=Object(at.c)((function(){return oe.createElement("span",{className:"multi-lingual-label-description"},t.LeftDescription)}),at.f),i=Object(at.c)((function(){return oe.createElement("span",{className:"multi-lingual-label-description"},t.RightDescription)}),at.f),r={MinimalHeight:Object(Pe.j)(),onValueChange:this.fM.bind(this,!0),Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_NPSDescription_Label.format(0)}},Placeholder:Object(ae.a)().Designer_PlaceholderForRatingDescription,Value:""};Object(at.c)((function(){r.HTMLAttributes={className:""},r.TextFieldType=0,r.Value=e.leftDescription||""}),at.f);var o=Object(ar.c)(r),s={MinimalHeight:Object(Pe.j)(),onValueChange:this.fM.bind(this,!1),Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_NPSDescription_Label.format(10)}},Placeholder:Object(ae.a)().Designer_PlaceholderForRatingDescription,Value:""};Object(at.c)((function(){s.HTMLAttributes={className:""},s.TextFieldType=0,s.Value=e.rightDescription||""}),at.f);var a=Object(ar.c)(s);return oe.createElement("div",{className:"multi-lingual-nsp-label"},oe.createElement("div",{className:"multi-lingual-left-label"},n,o),oe.createElement("div",{className:"multi-lingual-right-label"},i,a))},n.fM=function(t,e){var n=this;Object(at.c)((function(){t?n.nM.Model.leftDescription=e:n.nM.Model.rightDescription=e}),at.f)},e}(ue.a),vl=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate()};var i=n.props.Master,r=i.Form;return n.nM=rl.a.getQuestionResourceMaster(n.props.LocaleId,i.Model.Id,r),n.nM.observe(n.Oe,[n.nM.Schema.choices]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.nM&&this.nM.unobserve(this.Oe)},n.render=function(){var t=this,e=Wt.a.convertToArray(this.props.Master.Model.ChoiceGroup).sort((function(t,e){return t.Order-e.Order}));return oe.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),oe.createElement("div",{className:"multi-lingual-ranking-edition"},Et.map(e,(function(e){return t.dM(e)}))))},n.dM=function(t){var n=this.nM.getChoiceLocalizedMaster(t.Id.toString()).Model;return[oe.createElement("div",{className:"multi-lingual-item-text",key:"description"+t.Id},t.Description),Object(ar.b)({AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-option-textbox"},key:"edition"+t.Id,MaxLength:Object(Pe.G)(),onValueChange:e.choiceChanged.bind(this,n),Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().DesignPage_RankingOptionInputBox_AriaLabel}},Value:n&&n.description})]},e.choiceChanged=function(t,e){t.description=e},e}(ue.a),gl=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate()};var i=n.props.Master,r=i.Form;return n.nM=rl.a.getQuestionResourceMaster(n.props.LocaleId,i.Model.Id,r),n.nM.observe(n.Oe,[n.nM.Schema.leftDescription,n.nM.Schema.rightDescription,n.nM.Schema.formsprortlocaleldescription,n.nM.Schema.formsprortlocalerdescription]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.nM&&this.nM.unobserve(this.Oe)},n.render=function(){return oe.createElement("div",{className:"multi-lingual-question-edition office-form-theme-focus-border"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}),oe.createElement("div",null,this.bM(),this.mM()))},n.mM=function(){if(this.props.Master.Model.ShowRatingLabel)return oe.createElement("div",{className:"multi-lingual-label-edition"},this.vM(!0),this.vM(!1))},n.vM=function(t){var e,n,i=this.props.Master.Model,r=this.nM.Model,o=i.MinRating;o||(o=1),i.RatingShape===te.f.Number?(e=t?o.toString():i.Length.toString(),n="multi-linmgual-rating-description-label-number"):(e=t?Object(ae.a)().RatingDescriptionTitle.format(o):Object(ae.a)().RatingDescriptionTitlePlural.format(i.Length),n="multi-linmgual-rating-description-label-star");var s=r.leftDescription||"",a=r.rightDescription||"",c=Object(ar.c)({HTMLAttributes:{className:"multi-lingual-range-edition-box"},MinimalHeight:25,onValueChange:this.gM.bind(this,t),Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Designer_RatingDescription_Label.format(e)}},TextFieldType:Object(at.c)((function(){return 0}),at.f),Value:t?s:a}),u=Object(at.c)((function(){return t?i.LeftDescription:i.RightDescription}),at.f);return oe.createElement("div",null,oe.createElement("span",{className:n},e),oe.createElement("div",{className:"multi-lingual-rating-range"},Object(at.c)((function(){return oe.createElement("div",{className:"multi-lingual-range-description"},u)}),at.f),c))},n.bM=function(){var t=this.props.Master.Model,n=t.MinRating;switch(n||(n=1),t.RatingShape){case te.f.Number:var i=Et.range(n,t.Length+1),r=i.map((function(t,e){return oe.createElement("td",{className:"office-form-question-rating-title-td",key:e},t)})),o=i.map((function(t,e){return oe.createElement("td",{className:"office-form-question-rating-td",key:e},oe.createElement("input",{disabled:!0,type:"radio"}))}));return oe.createElement("table",{className:"design-question-element"},oe.createElement("tr",{className:"office-form-question-rating-tr"},r),oe.createElement("tr",{className:"office-form-question-rating-tr"},o));case te.f.Smiley:return FormsPro.createSmileyRating({ContainerClass:"design-question-element",Disabled:!0,Model:this.props.Master.Model});case te.f.Star:default:return Object(Fr.a)({Disabled:!0,HTMLAttributes:{className:"design-question-element"},Length:this.props.Master.Model.Length,NoTabFocus:!0,onValueChange:e.onClickStarsLine,ShowRatingLabel:!1,Value:0})}},n.gM=function(t,e){var n=this.nM.Model;Object(at.c)((function(){t?n.leftDescription=e:n.rightDescription=e}),at.f)},e.onClickStarsLine=function(){},e}(ue.a),Ol=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){return oe.createElement("div",{className:"multi-lingual-question-edition"},oe.createElement(al,{Master:this.props.Master,LocaleId:this.props.LocaleId,Ordinal:this.props.Ordinal}))},e}(ue.a);function pl(t){var e=function(t){switch(t){case"Question.Choice":return ul;case"Question.DateTime":return ll;case"Question.FileUpload":return hl;case"Question.MatrixChoiceGroup":return bl;case"Question.NPS":return ml;case"Question.Ranking":return vl;case"Question.Rating":return gl;case"Question.TextField":return Ol;default:throw Error('Type "'+t+'" has not been found.')}}(t.Master.Model.Type);if(e)return oe.createElement(e,t)}var jl=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate()};var i=n.props.FormLocalizedItemMaster;return i.observe(n.Oe,[i.Schema.formCloseMessage]),n.OM=n.OM.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.FormLocalizedItemMaster.unobserve(this.Oe)},n.render=function(){var t=this,e=this.props,n=e.FormLocalizedItemMaster.Model,i=this.props.FormLocalizedItemMaster.Model.formCloseMessage||e.Form.SettingMaster.Model.FormClosedMessage,r=!e.InEditionMode&&oe.createElement("div",{className:"multi-lingual-message"},i),o=e.InEditionMode&&oe.createElement("div",{className:"multi-lingual-message"},e.Form.SettingMaster.Model.FormClosedMessage);return oe.createElement(_o.a.Consumer,null,(function(i){var s=i.LocalizedStrings;return oe.createElement("div",{className:"multi-lingual-message-box"},oe.createElement("div",{className:"multi-lingual-message-title office-form-theme-primary-color"},s.DesignPage_SettingsPane_FormClosed_Label),oe.createElement("div",{className:"multi-lingual-message-edition"},o,r,e.InEditionMode&&Object(ar.b)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-message-edition-box"},onValueChange:t.OM,Options:{HTMLPropsForInnerElement:{"aria-label":s.DesignPage_SettingsPane_FormClosed_Label}},TextFieldType:2,Value:n.formCloseMessage||""})))}))},n.OM=function(t){this.props.FormLocalizedItemMaster.Model.formCloseMessage=t},e}(ue.a),yl=function(t){function e(e){var n=t.call(this,e)||this;return n.Oe=function(){return n.forceUpdate()},n.Cu(n.props),n.pM=n.pM.bind(n),n.jM=n.jM.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillReceiveProps=function(t){this.Cu(t)},n.render=function(){var t=this,e=this.Pu.Model,n=this.props,i=n.Master.Model,r=n.Master.Form;return oe.createElement(_o.a.Consumer,null,(function(o){var s=o.LocalizedStrings;return oe.createElement("div",{className:"multi-lingual-section"},oe.createElement("div",{className:"multi-lingual-section-header"},oe.createElement("h5",{className:"multi-lingual-section-title"},s.Designer_Sections_DefaultDescription.format(n.Ordinal))),oe.createElement("div",{className:"multi-lingual-section-content"},oe.createElement(Eo,{DesignFocus:n.DesignFocus,Name:n.Master.Model.Id},oe.createElement(Eo.Designer,null,oe.createElement(sl,{Title:i.Title,TitleLabel:s.Designer_SectionTitle,SubTitle:i.Subtitle,SubTitleLabel:s.Designer_SectionSubtitle,LingualTitle:e.title,LingualSubTitle:e.subtitle,LingualRTTitle:e.formsprortlocaletitle,LingualRTSubTitle:e.formsprortlocalesubtitle,onTitleValueChange:t.pM,onSubTitleValueChange:t.jM,Form:r,TitleLengthLimitation:Object(Pe.o)(),SubtitleLengthLimitation:Object(Pe.n)(),IsForm:!1})),oe.createElement(Eo.Renderer,null,oe.createElement(Ho.a,{LocalizedStrings:s,HideMedia:!0,LocaleId:n.LocaleId,Master:n.Master,Ordinal:n.Ordinal}))),n.children))}))},n.Cu=function(t){var e=t.Master,n=t.LocaleId;n&&(this.Pu=rl.a.getQuestionResourceMaster(n,e.Model.Id,e.Form),this.Pu.observe(this.Oe,[sr.a.Schema.title,sr.a.Schema.subtitle]))},n.pM=function(t){var e=this;Object(at.c)((function(){e.Pu.Model.title=t}),at.f)},n.jM=function(t){var e=this;Object(at.c)((function(){e.Pu.Model.subtitle=t}),at.f)},e}(ue.a),wl=function(t){function e(e){var n=t.call(this,e)||this;n.Oe=function(){return n.forceUpdate()};var i=n.props.FormLocalizedItemMaster;return i.observe(n.Oe,[i.Schema.thankYouMessage]),n.yM=n.yM.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.props.FormLocalizedItemMaster.unobserve(this.Oe)},n.render=function(){var t,e,n=this,i=this.props,r=i.FormLocalizedItemMaster.Model;t=Object(ga.b)({ContainsHtml:!0,RenderMode:"RichText",Text:r.thankYouMessage||i.Form.Model.ThankYouMessage}),e=Object(ga.b)({ContainsHtml:!0,RenderMode:"RichText",Text:i.Form.Model.ThankYouMessage});var o=!i.InEditionMode&&oe.createElement("div",{className:"multi-lingual-message"},t),s=i.InEditionMode&&oe.createElement("div",{className:"multi-lingual-message"},e);return oe.createElement(_o.a.Consumer,null,(function(t){var e=t.LocalizedStrings;return oe.createElement("div",{className:"multi-lingual-message-box"},oe.createElement("div",{className:"multi-lingual-message-title office-form-theme-primary-color"},e.DesignPage_SettingsPane_CustomizeThankYou),oe.createElement("div",{className:"multi-lingual-message-edition"},s,o,i.InEditionMode&&Object(ar.a)({AutoFocus:!0,AutoSelection:!0,HTMLAttributes:{className:"multi-lingual-message-edition-box"},onValueChange:n.yM,Options:{HTMLPropsForInnerElement:{"aria-label":e.DesignPage_SettingsPane_CustomizeThankYou}},TextFieldType:2,Value:r.thankYouMessage||""},!0)))}))},n.yM=function(t){this.props.FormLocalizedItemMaster.Model.thankYouMessage=t},e}(ue.a),Sl=function(t){function e(n){var i=t.call(this,n)||this;i.dw={},i.hw=new Ui,i.Oe=function(){return i.forceUpdate()},i.wM=i.wM.bind(i);var r=Object(_t.b)();return r.observe(i.wM,[r.Schema.Locale]),i.state={InEditionMode:3,IsLanguageNameInEditionMode:!0,LocaleId:e.getLocale()||"",LocalizedResourcesLoaded:!1,LocalizedStrings:Object(ae.a)()},i.SM=i.SM.bind(i),i.nw=i.nw.bind(i),i.iw=i.iw.bind(i),i.NM=i.NM.bind(i),i.props.Form.observe(i.Oe,[Zt.a.Schema.Title,Zt.a.Schema.Description,Zt.a.Schema.Questions,Zt.a.Schema.LocaleList,Zt.a.Schema.LocaleList[0].localeName]),i}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUpdate=function(t,e){e.LocaleId!==this.state.LocaleId&&this.IM(t.Form,e.LocaleId)},n.componentWillUnmount=function(){this.CM&&(this.CM.unobserve(this.Oe),this.CM=void 0),this.props.Form.unobserve(this.Oe),Object(_t.b)().unobserve(this.wM)},n.componentDidMount=function(){var t=this;Object(zc.e)()?(this.kM(),Object(ae.c)(this.state.LocaleId).then((function(e){return t.setState({LocalizedStrings:e})}))):Object(_t.b)().showTopView("None",null)},n.render=function(){if(this.CM){this.er=new ol.a(this.props.Form);var t=this.CM.Model.localeName||"";return oe.createElement(_o.a.Provider,{value:this.state},oe.createElement("div",Object(S.__assign)({},this.getContainerProps()),this.createHeader(),oe.createElement("div",{className:"top-view-content"},oe.createElement("div",{className:"muliti-lingual-page-padding",onMouseDown:this.SM},oe.createElement("div",{className:"multi-lingul-edition-body office-form-theme-border-top"},oe.createElement("div",{className:"multi-lingual-section",key:"firstSection"},oe.createElement("div",{className:"multi-lingual-language-name-container"},oe.createElement("span",null,Object(ae.a)().MultiLingualEditionView_language_Name_label),oe.createElement("div",{className:"multi-lingual-language-name-edition"},t)),this.TM(),this.xM()),this.FM()),this.PM(),!1,this.DM()))))}return Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text})},n.onBackButtonClick=function(t){Object(_t.b)().Model.FlexPane="MultiLingual",t.stopPropagation(),t.preventDefault()},e.getLocale=function(){return Object(_t.b)().Model.Locale},n.wM=function(){this.setState({LocaleId:e.getLocale()||""})},n.kM=function(){var t=this,e=this.props.Form,n=this.state.LocaleId;e.ensureFieldsReady([Zt.a.Schema.LocalizedResources]).then((function(){t.IM(e,n),t.setState({LocalizedResourcesLoaded:!0})}))},n.IM=function(t,e){this.CM&&(this.CM.unobserve(this.Oe),this.CM=void 0);var n=t.Model.LocalizedResources;if(n&&n.length>0){var i=Wt.a.Collection.getItemWithKeyFields(n,{localeId:e});i&&(this.CM=Wt.a.getObjectMasterFromModel(i),this.CM&&this.CM.observe(this.Oe,[rl.a.Schema.localeName,rl.a.Schema.title,rl.a.Schema.subtitle]))}},n.NM=function(t){var e=this.CM;e.Model.localeName=t;var n=this.props.Form.Model.LocaleList,i=Et.find(n,(function(t){return t.localeId===e.Model.localeId}));i&&(i.localeName=t)},n.xM=function(){var t=this;return this.props.Form.FormElementManager.HeaderTopQuestionMasters.map((function(e,n){return t.LM(e,n+1)}))},n.LM=function(t,e){var n=this,i=this.state.LocaleId;if(i){var r=pl({LocaleId:i,Master:t,Ordinal:e}),o=oe.createElement(_o.a.Consumer,{children:function(r){return Object(ts.a)({Disabled:!0,DisableShuffle:!0,HideMedia:!0,LocaleId:i,LocalizedStrings:r.LocalizedStrings,Master:n.Pw(t),Ordinal:e})}});return oe.createElement(Eo,{DesignFocus:this.hw,Name:t.Model.Id,key:t.Model.Id},oe.createElement(Eo.Designer,null,r),oe.createElement(Eo.Renderer,null,o))}},n.FM=function(){var t=this,e=this.props.Form,n=e.FormElementManager.TopQuestionMasters,i=e.FormElementManager.SectionMasters,r=this.state.LocaleId;if(r&&0!==i.length)return Et.map(i,(function(e,i){var o=t.props.Form.FormElementManager.findQuestionsInSection(e);return oe.createElement(yl,{DesignFocus:t.hw,LocaleId:r,Master:e,Ordinal:i+1,key:i},oe.createElement("div",null,o.map((function(e,i){return t.LM(e,Et.indexOf(n,e)+1)}))))}))},n.Pw=function(t){var e=this.dw[t.Model.Id];return e||(e=new Zi.a(t,this.er),this.dw[t.Model.Id]=e),e},n.SM=function(t){var e=t.target;e&&"muliti-lingual-page-padding"===e.className&&(this.state.InEditionMode&&3!==this.state.InEditionMode?this.setState({InEditionMode:3}):this.hw.getDefaultGrabber().grab())},n.TM=function(){var t=this,n=this.props.Form,i=n.Model,r=this.CM.Model;return oe.createElement(_o.a.Consumer,null,(function(o){var s=o.LocalizedStrings;return oe.createElement(Eo,{AutoFocus:!0,DesignFocus:t.hw,Name:"form-title-edition",key:"form-title-edition"},oe.createElement(Eo.Designer,null,oe.createElement(sl,{Title:i.Title,TitleLabel:s.Designer_FormTitle,SubTitle:i.Description,SubTitleLabel:s.Designer_FormSubtitle,LingualTitle:r.title,LingualSubTitle:r.subtitle,LingualRTTitle:!1,LingualRTSubTitle:!1,onTitleValueChange:t.nw,onSubTitleValueChange:t.iw,TitleLengthLimitation:Object(Pe.o)(),SubtitleLengthLimitation:Object(Pe.n)(),Form:n,IsForm:!0})),oe.createElement(Eo.Renderer,null,oe.createElement(fs,{Form:n,FormLocalizedItemMaster:t.CM,HideMedia:!0,onHeightChange:e.onHeightChange})))}))},e.onHeightChange=function(){},n.nw=function(t){var e=this;Object(at.c)((function(){e.CM.Model.title=t}),at.f)},n.iw=function(t){var e=this;Object(at.c)((function(){e.CM.Model.subtitle=t}),at.f)},n.PM=function(){if(this.props.Form.Model.ThankYouMessage&&this.CM)return oe.createElement("div",{className:"multi-lingual-message-container office-form-theme-focus-border"},oe.createElement(Eo,{DesignFocus:this.hw,Name:"form-thankyouMessage-edition",key:"form-thankyouMessage-edition"},oe.createElement(Eo.Designer,null,oe.createElement(wl,{Form:this.props.Form,InEditionMode:!0,FormLocalizedItemMaster:this.CM})),oe.createElement(Eo.Renderer,null,oe.createElement(wl,{Form:this.props.Form,InEditionMode:!1,FormLocalizedItemMaster:this.CM}))))},n.DM=function(){var t=this.props.Form.SettingMaster.Model;if(t.FormClosed&&t.FormClosedMessage&&this.CM)return oe.createElement("div",{className:"multi-lingual-message-container office-form-theme-focus-border"},oe.createElement(Eo,{DesignFocus:this.hw,Name:"form-closeMessage-edition",key:"form-closeMessage-edition"},oe.createElement(Eo.Designer,null,oe.createElement(jl,{Form:this.props.Form,InEditionMode:!0,FormLocalizedItemMaster:this.CM})),oe.createElement(Eo.Renderer,null,oe.createElement(jl,{Form:this.props.Form,InEditionMode:!1,FormLocalizedItemMaster:this.CM}))))},n.AM=function(){return null},e}(Uu),Nl=n(152),Il=function(t){function e(e){var n=t.call(this,e)||this;return n.state={CreatingCardMouseOver:!1},n.mouseOverCallback=n.mouseOverCallback.bind(n),n.mouseOutCallback=n.mouseOutCallback.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.createFormCreatingCardByMode=function(){var t,e=this.props.IsQuizMode,n=e?Object(On.b)("/Images/icon-new-quiz-normal.png"):Object(On.b)("/Images/icon-new-form-normal.png"),i=e?Object(On.b)("/Images/icon-new-quiz-hover.png"):Object(On.b)("/Images/icon-new-form-hover.png"),r=this.state.CreatingCardMouseOver?i:n,o=this.state.CreatingCardMouseOver?"fl-text-hover":"fl-text";t=this.props.IsGroupForm?e?Object(ae.a)().PortalView_NewGroupQuizTitle:Object(ae.a)().PortalView_NewGroupFormTitle:e?Object(ae.a)().PortalView_NewQuizTitle:Object(ae.a)().PortalView_NewFormTitle;var s={className:"fl-new-tile fl-form-tile fl-tile",onMouseOut:this.mouseOutCallback,onMouseOver:this.mouseOverCallback},a={className:"fl-content",id:e?"fl-content-new-quiz":"fl-content-new-form",onClick:this.onClick.bind(this)};this.props.IsHorizontal?s.className=Object(pn.b)(s.className,"fl-form-tile-horizontal"):a.className=Object(pn.b)(a.className,"glyph-button-control-vertical");var c={ButtonStyle:"LightBackground",children:[oe.createElement("img",{src:r,key:"newCardImg","aria-hidden":"true"}),oe.createElement("div",{className:o,key:"newCardText"},t)],HTMLAttributes:a};return oe.createElement("div",Object(S.__assign)({},s),oe.createElement(qo.a,Object(S.__assign)({},c)),this.props.Menu)},n.onClick=function(){var t=this.props.IsQuizMode;this.props.IsGroupForm&&Object(g.b)("PortalPage.GroupFormsPortal.GroupFormCreate",{isQuizMode:t}),this.props.onClick()},n.getCardDescription=function(){return null},n.getCardThemeName=function(){return null},n.getCardThemeBackgroupUrl=function(){return null},n.getCardThemePrimaryColor=function(){return null},n.getCardTitle=function(){return""},n.getCardType=function(){return""},n.createCardOwnerContent=function(){return null},n.createCardWarning=function(){return null},n.createCardTypeContent=function(){return null},n.getCardResponseCount=function(){return 0},n.mouseOverCallback=function(){this.setState({CreatingCardMouseOver:!0})},n.mouseOutCallback=function(){this.setState({CreatingCardMouseOver:!1})},e}(Nl.a);function Cl(){}var kl=function(t){function e(e){var n=t.call(this,e)||this;return n.RM=n.RM.bind(n),n.EM=n.EM.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"portal-creating-card portal-creating-card-horizontal"},oe.createElement(Il,{CreateNew:!0,focusOut:Cl,IsGroupForm:!1,IsHorizontal:!0,IsQuizMode:!1,onClick:this.RM}),oe.createElement("div",{className:"creating-card-middle-line"}),oe.createElement(Il,{CreateNew:!0,focusOut:Cl,IsGroupForm:!1,IsHorizontal:!0,IsQuizMode:!0,onClick:this.EM}))},n.RM=function(){this.props.createCallback("Form"),Object(g.b)("MyTemplate.createForm",{Origin:this.props.Origin})},n.EM=function(){this.props.createCallback("Quiz"),Object(g.b)("MyTemplate.createQuiz",{Origin:this.props.Origin})},e}(ue.a),Tl=function(t){function e(e){var n=t.call(this,e)||this;return n.BM=n.BM.bind(n),n.nn=n.nn.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t={className:"template-form-card __template-form-card__",onClick:this.BM,onKeyDown:this.nn,role:"button",tabIndex:0,title:this.props.TemplateForm.Title},e={backgroundImage:"url('"+this.props.TemplateForm.Theme.BackgroundImage+"')"};return oe.createElement("div",{className:"fl-history-tile fl-tile fl-template-tile"},oe.createElement("div",Object(S.__assign)({},t),oe.createElement("div",{className:"image-container"},oe.createElement("div",{className:"background-container",style:e})),oe.createElement("div",{className:"title-container __template-form-card-title__"},this.props.TemplateForm.Title)))},n.nn=function(t){switch(t.keyCode){case 13:case 32:this.BM()}},n.BM=function(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var t,e,n=this;return Object(S.__generator)(this,(function(i){switch(i.label){case 0:return Object(g.b)("MyTemplate.Click",{TemplateTitle:this.props.TemplateForm.TemplateId},null,!0),[4,Tn(this.props.TemplateForm)];case 1:return t=i.sent(),Object(Ci.b)(t),this.props.viewTemplate(t),t.fieldsReady([Zt.a.Schema.Id]).then((function(){Object(g.b)("MyTemplate.Create",{FormId:t.Model.Id,Origin:n.props.Origin})})),(e=JSON.parse(t.Model.OtherInfo)).TemplateId=this.props.TemplateForm.TemplateId,t.Model.OtherInfo=JSON.stringify(e),Object(Si.b)("MSATemplateClick"),[2]}}))}))},e}(ue.a),xl=function(t){function e(e){var n=t.call(this,e)||this;return n._M=Cn,n.state={Templates:[]},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;(In||(In=Object(kn.c)().then(xn)),In).then((function(e){t.setState({Templates:e}),"PortalView"===t.props.Origin&&t.props.updateTemplateList&&t.props.updateTemplateList()}))},n.render=function(){return this.state.Templates.length?oe.createElement("div",{style:{display:"inline"}},this.createTemplateCard()):oe.createElement(Hi.a,{className:"template-loading",key:"template-loading",src:"/Images/LoadingBlackSpinner.gif"})},n.createTemplateCard=function(){var t,e=this;return t=!this.props.Quota&&this._M&&"PortalView"===this.props.Origin?this._M:this.props.Quota||this.state.Templates.length,this.state.Templates.slice(0,t).map((function(t){return oe.createElement(Tl,{key:t.Title,Origin:e.props.Origin,TemplateForm:t,viewTemplate:e.props.viewTemplateHandler})}))},e}(ue.a),Fl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"template-gallery-container __portal-template-gallery-container__"},oe.createElement("div",{className:"portal-tiles template-gallery"},this.Ff(),oe.createElement(kl,{createCallback:this.props.createFormCallback,Origin:"TemplateGallery"}),oe.createElement(xl,{key:"TemplateGallery",Origin:"TemplateGallery",Quota:0,viewTemplateHandler:this.props.viewTemplateHandler})))},n.Ff=function(){var t=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":Object(ae.a)().Common_Back_Text,autoFocus:!0,className:"template-gallery-back-button office-form-theme-button-color __template-gallery-back-button__",onClick:this.props.backToPortalViewPageHandler,title:Object(ae.a)().Common_Back_Text},Icon:"Back",IconClassName:"top-view-back-icon forms-icon-size27x27",ref:"back-button"});return oe.createElement("div",{"aria-label":Object(ae.a)().MSATemplate_SelectTemplate,className:"template-top-view-header",role:"navigation"},t,oe.createElement("span",{className:"top-view-title-text"},Object(ae.a)().MSATemplate_SelectTemplate))},e}(ue.a);function Pl(){return oe.createElement("div",{className:"analyze-view-placerholder"},Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text}))}function Dl(t){var e=Object(_t.b)();e.bulkEdit((function(){return t(e)}))}var Ml=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=Object(pn.b)(Object(et.m)()?"edge":void 0,Object(et.o)()?"ie":void 0,Object(et.n)()?"firefox":void 0);return this.createAdditionalTopViewHeaderElements(),oe.createElement("div",{className:t},oe.createElement("div",Object(S.__assign)({},this.getContainerProps()),this.createHeader.apply(this,this.additionalTopViewHeaderElements),Object(Y.c)("EnableSavingConfirmationOnAssignments")&&Object(Z.k)()&&window.parent&&$n({Form:this.props.FormMaster}),oe.createElement("div",{className:"top-view-content"},oe.createElement("div",{className:"form-content-container"},oe.createElement("div",{className:"office-form-content office-form-page-padding"},oe.createElement("div",{className:"office-form office-form-theme-shadow office-form-theme-border-top grading-design-view",id:"scrollAnchor",role:"main"},this.renderView()))))))},n.createAdditionalTopViewHeaderElements=function(){},n.includeTheme=function(){return oe.createElement(es.a,{ThemeMaster:this.props.FormMaster.ThemeMaster})},n.onBackButtonClick=function(){Dl((function(t){t.Model.Grading?t.Model.Grading.GoBackToView===ys.GoBackToAnalysis?(t.Model.Grading=void 0,t.Model.Analysis=!0):t.Model.Grading.GoBackToView===ys.GoBackToReleaseResults&&(t.Model.Grading=void 0,t.Model.TopView="Grading_PostGrades"):t.Model.Analysis=!0}))},e}(Uu),Ll=n(53),Al=function(){function t(t){this.HM=[],this.GM=[],this.qM=[],this.QM=t}var e=t.prototype;return e.calculateBranchedResponses=function(){if(Object(Y.c)("QuizReviewLogicUpgrade")){var e=t.getBranchedQuestionsForAllResponses(this.QM,this.qM);e&&e.length>0&&(this.GM=this.GM.concat(e),this.HM=t.getBranchedResponses(this.QM,this.GM)),this.qM=this.GM.map((function(t){return t&&t.field_id}))}else this.GM=t.getBranchedQuestionsForAllResponses(this.QM,[]),this.GM&&(this.HM=t.getBranchedResponses(this.QM,this.GM))},t.getBranchedResponses=function(e,n){return Et.map(e.Model.Responses,(function(e){return t.getBranchedResponse(n,e)}))},t.getBranchedQuestionsForAllResponses=function(t,e){var n=Et.map(t.Model.Responses,(function(e){return Js.getResponseWithIndexableQuestion(e,t)})),i=n;return e.length>0&&(i=n.filter((function(t){return!(t.field_id in e)}))),Js.getBranchedQuestions(t,i)},t.getBranchedResponse=function(e,n){var i=Et.extend(n);return i.Answers=t.getAnswersInBranch(e,i),i},t.getAnswersInBranch=function(t,e){var n=Et.findWhere(t,{field_id:e.Id}),i=null==n?void 0:n.branchedQuestions;return void 0===n&&Object(g.b)("DesignPage.QuizReview.ResponseNotFound",{lengthOfAllResponses:t.length}),Et.filter(e.Answers,(function(t){return null!=Et.findWhere(i,{Id:t.QuestionId})}))},e.addGeneralFeedback=function(t,e){if(void 0!==e){var n=Object(Ll.f)(this,t);if(n)n.Feedback!==e&&(this.QM.setResponseComment(t,e),n.Feedback=e)}},e.addAnswerFeedbacks=function(t,e,n,i,r){var o=this;if(void 0!==n||void 0!==i){var s=!1;this.QM.bulkEdit((function(){t.forEach((function(t){var r=Object(Ll.a)(o,t,e);if(r){var a,c,u=!1;void 0!==n&&(a=n)!==r.Score&&(u=!0,r.Score=a),void 0!==i&&(c=i)!==r.Feedback&&(u=!0,r.Feedback=c),u&&(o.QM.setAnswerGrading(t,e,a,c),s=!0)}}))})),s&&r&&r()}},e.markAsReleased=function(t){this.QM.setReleaseDate(t,new Date)},e.onDeleteResponse=function(t){this.HM=Et.without(this.HM,Et.findWhere(this.HM,{Id:t})),this.GM=Et.without(this.GM,Et.findWhere(this.GM,{fidld_id:t})),this.qM=this.qM.filter((function(e){return e!==t}))},e.ensureReadyToGrade=function(){var t=this,e=Zt.a.Schema;return Object(Y.c)("QuizReviewLogicUpgrade")?this.QM.ensureFieldsReady([e.Responses,e.Title,e.Questions,e.DescriptiveElements,e.Theme,e.ResponsesCount,e.ModifiedDate]).then((function(){if(Object(Y.c)("RemoveReviewAnswersButtonSync")||0===t.QM.Model.Responses.length||0===t.getQuestions().length)return t.QM.Model.QuizPreviousResponsesCount!==t.QM.Model.ResponsesCount?(t.QM.bulkEdit((function(){t.QM.Model.QuizPreviousResponsesCount=t.QM.Model.ResponsesCount})),t.QM.syncFormResponses()):void 0})):this.QM.ensureFieldsReady([e.Responses,e.Title,e.Questions,e.DescriptiveElements,e.Theme]).then((function(){if(Object(Y.c)("RemoveReviewAnswersButtonSync")||0===t.QM.Model.Responses.length||0===t.getQuestions().length)return t.QM.syncFormResponses()}))},e.getResponses=function(){return this.HM},e.getQuestions=function(){return Wt.a.convertToArray(this.QM.Model.Questions)},e.getTitle=function(){return this.QM.Model.Title},e.getWrappedForm=function(){return this.QM},e.getBranchedQuestions=function(){return this.GM},t}();function Rl(t){return null==t.Score}function El(t){if(Et.isString(t))return t}var Bl=n(74);function _l(t,e){var n=e.Model,i={},r={};return t.forEach((function(t){var o=e.SubQuestionMasters.length?void 0:Object(Bl.c)(t,n.Id),s={Response:t,Answer:o};if(o){var a=function(t){if(null==t.Answer)return"";var e=El(t.Answer.Answer),n=null!=e?e.trim():void 0,i=null!=t.Answer.Score?t.Answer.Score:void 0,r=null!=t.Answer.Feedback?t.Answer.Feedback:void 0;return n+"-"+i+"-"+r}(s);i[a]||(i[a]=[]),i[a].push(s),e.isCorrectAnswer(o.Answer)&&(r[a]=!0)}})),Et.object(Et.sortBy(Et.pairs(i),(function(t){var e=t[0],n=t[1],i=r[e];return function(t,e){if(null==t.Answer)return"";var n,i=El(t.Answer.Answer),r=null!=i?i.trim():void 0;n=e?"1":null!=r&&""!==r?"5":"9";return n+r}(n[0],i)})))}function Hl(t){return"Question.Choice"===t.Type||"Question.DateTime"===t.Type||"Question.Rating"===t.Type||"Question.TextField"===t.Type&&!t.Multiline||"Question.Ranking"===t.Type||"Question.MatrixChoiceGroup"===t.Type||"Question.FileUpload"===t.Type}var Gl=function(){function t(){}t.prototype;return t}();var ql=function(t){function e(e,n){var i=t.call(this)||this;return i.VM=0,i.zM=Et.pairs(e),i.UM=n||function(t){return!0},i}Object(S.__extends)(e,t);var n=e.prototype;return n.hasNext=function(){for(var t=!1;this.VM<this.zM.length;){var e=this.zM[this.VM][1][0].Answer,n=e?El(e.Answer):void 0;if(this.UM(n)){t=!0;break}this.VM++}return t},n.next=function(){var t=this.zM[this.VM][1],e=t[0].Answer,n=this.VM;return this.VM++,{answerAndResponses:t,answer:e,answerRenderOrderIndex:n}},e}(Gl),Ql=function(t){function e(e,n){return t.call(this,e,(function(t){return n.isCorrectAnswer(t)}))||this}return Object(S.__extends)(e,t),e}(ql),Vl=function(t){function e(e,n){return t.call(this,e,(function(t){return!n.isCorrectAnswer(t)}))||this}return Object(S.__extends)(e,t),e}(ql),zl=n(93),Ul=function(t){function e(e,n){var i=t.call(this)||this;return i.$M=0,i.O=e,i.WM=n,i}Object(S.__extends)(e,t);var n=e.prototype;return n.hasNext=function(){for(var t=null;this.$M<this.O.getResponses().length;){var e=this.O.getResponses()[this.$M],n=this.O.getWrappedForm().getQuestionById(this.WM).Model;if(t=Object(Bl.c)(e,this.WM),"Question.MatrixChoiceGroup"===n.Type&&(t=""),null!=t)break;this.$M++}return null!=t},n.next=function(){var t=this.O.getResponses()[this.$M],e=Object(Bl.c)(t,this.WM),n=this.$M;return this.$M++,{response:t,answer:e,answerRenderOrderIndex:n}},e}(Gl),$l=function(t){function e(e,n){var i=t.call(this)||this;i.KM=0,i.O=e,i.za=n,i.JM=[];var r=Et.findWhere(e.getBranchedQuestions(),{field_id:n.Id});return r&&(i.JM=r.branchedQuestions.filter((function(t){return!t.GroupId}))),i}Object(S.__extends)(e,t);var n=e.prototype;return n.hasNext=function(){return this.KM<this.JM.length},n.next=function(){var t,e=this,n=this.JM[this.KM],i=this.KM;if("Question.MatrixChoiceGroup"===n.Type){var r=this.O.getWrappedForm().getQuestionById(n.Id),o=Et.map(r.SubQuestionMasters,(function(t){return t.Model.Id})),s=Et.filter(Et.map(o,(function(t){return Et.find(e.za.Answers,(function(e){return e.QuestionId===t}))})),(function(t){return!!t}));s.length&&((t=Et.clone(s[s.length-1])).QuestionId=n.Id,t.Answer=s)}else t=Object(Bl.c)(this.za,n.Id);this.KM++,t=t||{Answer:null,Feedback:null,IsAutoGraded:!1,IsMathAnswer:!1,Score:0,QuestionId:n.Id};var a=Et.filter(this.O.getQuestions(),(function(t){return!t.GroupId})),c=Et.findIndex(a,(function(t){return t.Id===n.Id}));return{question:n,answerRenderOrderIndex:i,unbranchedQuestionIndex:c,answer:t}},e}(Gl),Wl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this.props.formula;if(""===t)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);if(void 0!==this.props.specialCorrectnessStyle){var e=void 0,n=void 0,i="",r=" gradingOptionCorrectnessIcon forms-icon-size16x16";"correct"===this.props.specialCorrectnessStyle?(e="gradingOptionIsCorrect",n={HTMLAttributes:{"aria-hidden":!0,className:"office-form-right-answerkey office-form-answerkey"+r,role:"presentation"},IconName:"CheckMark"},i=Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel):(e="gradingOptionIsNotCorrect",n={HTMLAttributes:{"aria-hidden":!0,className:"office-form-wrong-answerkey office-form-answerkey"+r,role:"presentation"},IconName:"Cancel"},i=Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel);var o=Object(Un.b)(n);return oe.createElement("div",{className:"gradingPlainTextAnswer gradingShortTextAnswerCorrectnessBox "+e},Object(rr.c)({Formula:t}),oe.createElement("a",{className:"screenReaderVisible"},i),o)}return oe.createElement("span",{className:"gradingPlainTextAnswer"},Object(rr.c)({Formula:t}))},e}(ue.a);var Kl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this,e=this.props.Answer.Answer;if(!e&&0!==e)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);var n=Number(""+e),i=Object(at.c)((function(){return t.props.LeftDescription}),at.f),r=Object(at.c)((function(){return t.props.RightDescription}),at.f);return oe.createElement("div",null,oe.createElement(Cr.a,{ClassNameForInnerLabel:"office-form-theme-button-foreground",Disabled:!0,LeftLabel:i,RightLabel:r,Value:n}),oe.createElement("a",{className:"screenReaderVisible"},Object(ae.a)().GradingView_NPSAnswerFormat.format(1)))},e}(ue.a);function Jl(t,e,n,i,r,o,s){var a=Object(ye.c)(),c=Xl(t),u=Object(_r.b)(e,t);u.IsLegacyChoiceAnswer&&i&&Object(g.b)(i);var l=u.IsLegacyChoiceAnswer||u.IsSingleChoiceAnswer?"radio":"checkbox",h=Et.map(t.Choices,(function(t,e){var i,r,h=u.SelectedOptions.some((function(e){return e===t.Description})),f=oe.createElement("input",{disabled:!0,type:l,name:u.IsSingleChoiceAnswer?a:void 0,checked:h}),d="",b="";if(c){var m=void 0,v=void 0;b=Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel,t.IsAnswerKey?(m="office-form-right-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16",v="CheckMark",d=h?o:"",b=Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel):h&&(m="office-form-wrong-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16",v="Cancel",d=s),r={HTMLAttributes:{className:m,"aria-hidden":!0,role:"presentation"},IconName:v},i=Object(Un.b)(r)}var g={className:Object(pn.b)(l,n,d),key:e},O=Object(zl.a)(t),p=O+" . "+b;return oe.createElement("div",Object(S.__assign)({},g),oe.createElement("label",null,f,oe.createElement("span",{role:"presentation","aria-hidden":"true"},O)),oe.createElement("a",{className:"screenReaderVisible"},p),i)}));return h.push.apply(h,function(t,e,n,i,r){var o=Xl(t),s=Object(pn.b)(e.IsSingleChoiceAnswer?"radio":"checkbox",n,o?r:""),a=oe.createElement("input",{disabled:!0,type:e.IsSingleChoiceAnswer?"radio":"checkbox",checked:!0}),c=Object(Un.b)({HTMLAttributes:{className:"office-form-wrong-answerkey office-form-answerkey forms-icon-size14x14"+i},IconName:"Cancel"}),u=o?c:void 0,l=Et.map(t.Choices,(function(t){return t.Description}));return Et.difference(e.SelectedOptions,l).map((function(t,e){var n=Object(ga.b)({Text:t,RenderMode:"RichText"});return oe.createElement("div",{className:s,key:e+l.length},oe.createElement("label",{},a,n,u))}))}(t,u,n,r,s)),h}function Xl(t){return t.IsQuiz&&Et.some(t.Choices,(function(t){return t.IsAnswerKey}))}var Zl=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this.props.answer,e=this.props.question;return e.Choices&&e.Choices.length>0||null!=t?oe.createElement("div",null,Jl(e,t.Answer,"gradingChoiceAnswerOption",void 0,"gradingOptionCorrectnessIcon","gradingOptionIsCorrect","gradingOptionIsNotCorrect")):oe.createElement("div",null,oe.createElement("span",{className:"noChoices"},Object(ae.a)().GradingView_NoChoices_Message))},e}(ue.a);var Yl=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.XM=Et.uniqueId("likert_"),e}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this.AO(),e=this.ZM();return oe.createElement("table",{className:"office-form-matrix-table",key:"Likert"},t,e)},n.AO=function(){var t=this,e=this.props.question.Model.ChoiceGroup,n=oe.createElement("td",{className:"office-form-matrix-ptd",key:"emptyTd"}),i=[];i.push(n);var r={width:80/e.length+"%",className:"office-form-matrix-ptd"},o=Et.map(e,(function(e,n){r.id=t.YM(n);var i=oe.createElement("span",null,e.Description);return oe.createElement("td",Object(S.__assign)({},r,{key:n}),i)}));i=i.concat(o);var s=oe.createElement("tr",{className:"office-form-matrix-ptr"},i);return oe.createElement("thead",{className:"office-form-matrix-pthead"},s)},n.ZM=function(){var t=this,e=this.props.question,n=e.Model.ChoiceGroup,i=e.SubQuestionMasters,r=Et.map(i,(function(e,i){var r=[],o=oe.createElement("span",{className:"office-form-matrix-subquestion"},e.Model.Title),s=oe.createElement("td",{className:"office-form-matrix-std",key:"subQuestionTitle"},o);r.push(s);var a=Et.map(n,(function(e,n){return t.tL(i,n,e.Description)}));r=r.concat(a);var c={className:"office-form-matrix-str",key:i};return oe.createElement("tr",Object(S.__assign)({},c),r)}));return oe.createElement("tbody",{className:"office-form-matrix-stbody"},r)},n.tL=function(t,e,n){var i,r,o=this.props.question,s=o.Model.ChoiceGroup,a=o.SubQuestionMasters[t].Model.Id,c=this.props.answer.Answer,u=Et.filter(c,(function(t){return t.QuestionId===a}));return r=s[e].Id,i=u.length>0&&Et.isEqual(u[0].Answer.id,r),oe.createElement("td",{className:"office-form-matrix-radio",key:e},oe.createElement("label",{className:"office-form-matrix-label"},oe.createElement("input",{"aria-labelledby":this.YM(e),"aria-posinset":e+1,"aria-setsize":s.length,type:"radio","aria-checked":i,checked:i})))},n.YM=function(t){return this.XM+"-col-"+t},e}(ue.a),th=n(250);function eh(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}var nh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this.props;if(!!!t.answer.Answer)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);var e=Number(""+t.answer.Answer),n=Et.uniqueId("numberAnswerDesciption."),i=Object(th.a)({HTMLAttributes:{className:"gradingNumberRatingAnswer rating-"+t.maxRating},Disabled:!0,Value:e,onValueChange:eh,Length:t.maxRating,ShowRatingLabel:t.showRatingLabel,LeftDescription:t.leftDescription,RightDescription:t.rightDescription});return oe.createElement("div",{"aria-labelledby":n},oe.createElement("div",{id:n,className:"screenReaderVisible"},Object(ae.a)().GradingView_RatingAnswer_LabelFormat.format(e,t.maxRating)),oe.createElement("div",{"aria-hidden":"true",role:"presentation"},i))},e}(ue.a);var ih=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=this.props.text;if(null==t||""===t)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);var e=Object(ga.b)({Text:t,RenderMode:"RichText"});if(null!=this.props.specialCorrectnessStyle){var n=void 0,i=void 0,r="";"correct"===this.props.specialCorrectnessStyle?(n="gradingOptionIsCorrect",i={HTMLAttributes:{className:"office-form-right-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16","aria-hidden":!0,role:"presentation"},IconName:"CheckMark"},r=Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel):(n="gradingOptionIsNotCorrect",i={HTMLAttributes:{className:"office-form-wrong-answerkey office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16","aria-hidden":!0,role:"presentation"},IconName:"Cancel"},r=Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel);var o=Object(Un.b)(i);return oe.createElement("div",{className:"gradingPlainTextAnswer gradingShortTextAnswerCorrectnessBox "+n},e,oe.createElement("a",{className:"screenReaderVisible"},r),o)}return oe.createElement("span",{className:"gradingPlainTextAnswer"},e)},e}(ue.a);var rh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t=this,e=this.props.question.ChoiceGroup,n=this.props.answer.Answer.sort((function(t,e){return t.answerOrder-e.answerOrder})),i=(JSON.parse(this.props.question.GradingBasis)||[]).map((function(t){return Et.findWhere(e,{Key:t})})),r=i.map((function(t){return t.Id})),o=Et.map(n,(function(e,n){var i=r[n]&&r[n]===e.id;return t.eL(e.displayText,i)})),s=i.map((function(t){return t.Description})),a=!1,c=n.map((function(t){return t.id}));Et.isEqual(c,r)&&(a=!0);var u=s.join(Object(ae.a)().VariousLocations_ItemList_Separator),l=a?void 0:oe.createElement("div",{className:"gradingByStudentShortTextCorrectAnswerList various-short-text-correct-answer-list"},oe.createElement("b",null,Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel,": "),oe.createElement("span",null,u));return oe.createElement("div",null,oe.createElement("div",{className:"gradingByStudentAnswerContainer gradingAnswerContainer"},o),l)},n.eL=function(t,e){var n="office-form-answerkey gradingOptionCorrectnessIcon forms-icon-size16x16",i={HTMLAttributes:{className:n=Object(pn.b)(n,e?"office-form-right-answerkey":"office-form-wrong-answerkey")},IconName:e?"CheckMark":"Cancel"},r=Object(Un.b)(i),o="checkbox gradingChoiceAnswerOption",s=e?"gradingOptionIsCorrect":"gradingOptionIsNotCorrect";o=Object(pn.b)(o,s);var a=oe.createElement("span",{className:"inline-display"},t);return oe.createElement("div",{className:o,key:t},a,r)},e}(ue.a);var oh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.nL=function(t){var e=t.Answer;return e>20?20:e<0?0:e},n.render=function(){var t=this.props;if(!!!t.answer.Answer)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);var e=this.nL(t.answer),n=Et.uniqueId("starAnswerDesciption."),i={Disabled:!0,HTMLAttributes:{className:"stars-container"},Length:t.maxRating,onValueChange:void 0,Value:e,LeftDescription:t.leftDescription,RightDescription:t.rightDescription,LeftDescriptionTitle:"1",RightDescriptionTitle:t.maxRating+"",ShowRatingLabel:t.showRatingLabel,NoTabFocus:!0},r=Object(Fr.a)(i);return oe.createElement("div",{"aria-labelledby":n},oe.createElement("div",{id:n,className:"screenReaderVisible"},Object(ae.a)().GradingView_StarAnswerFormat.format(e,t.maxRating)),r)},e}(ue.a);function sh(t,e,n,i){var r=t.Model;n=n||[];var o,s=r.Type,a=Et.contains(n,s);if("Question.Rating"===s&&!a){if(r.RatingShape===te.f.Number){var c={answer:e.Answer,maxRating:r.Length,showRatingLabel:r.ShowRatingLabel,leftDescription:r.LeftDescription,rightDescription:r.RightDescription};return o=c,oe.createElement(nh,Object(S.__assign)({},o))}return function(t){return oe.createElement(oh,Object(S.__assign)({},t))}({answer:e.Answer,maxRating:r.Length,showRatingLabel:r.ShowRatingLabel,leftDescription:r.LeftDescription,rightDescription:r.RightDescription})}if("Question.Choice"===s&&!a)return function(t){return oe.createElement(Zl,Object(S.__assign)({},t))}({question:r,answer:e.Answer});if("Question.Ranking"===s&&!a)return function(t){return oe.createElement(rh,Object(S.__assign)({},t))}({question:r,answer:e.Answer});if("Question.MatrixChoiceGroup"===s&&!a)return function(t){return oe.createElement(Yl,Object(S.__assign)({},t))}({question:t,answer:e.Answer});if("Question.FileUpload"===s){var u=e.Answer.Answer;return null===u||""===u?oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label):JSON.parse(u).map((function(t){var e=Object(qe.d)(t.name);return oe.createElement("div",{className:"gradingQuestionFileName",key:t.id},e,oe.createElement("a",{className:"gradingQuestionFileLink",href:t.link,target:"_blank"},t.name))}))}if("Question.NPS"===s)return function(t){return oe.createElement(Kl,Object(S.__assign)({},t))}({Answer:e.Answer,LeftDescription:r.LeftDescription,RightDescription:r.RightDescription});var l,h=e.CorrectAnswer;if("Question.TextField"===s&&!r.Multiline){var f=new lr.a(r).getAnswers();h=1===f.length?f[0].answer:void 0}"Question.TextField"===s&&i&&!r.Multiline&&r.IsQuiz&&(new lr.a(r).areAnyAnswersDefined()&&(l=t.isCorrectAnswer(El(e.Answer.Answer))?"correct":"incorrect"));return r.IsMathQuiz&&e.Answer.IsMathAnswer?oe.createElement(Wl,{formula:e.Answer.Answer,specialCorrectnessStyle:l}):function(t){return oe.createElement(ih,Object(S.__assign)({},t))}({text:ah(El(e.Answer.Answer),r),correctText:ah(h,r),isChoiceQuestion:"Question.Choice"===s,specialCorrectnessStyle:l})}function ah(t,e){if(null==t)return t;var n=Object(_r.b)(String(t),e).SelectedOptions;if("Question.Ranking"===e.Type){var i=e.ChoiceGroup;if(t&&""!==t)return JSON.parse(t).map((function(t,e){var n=Wt.a.Collection.getItemWithKeyFields(i,{Id:t});if(n)return n.Description})).filter((function(t){return!!t})).join(", ")}else{if("Question.DateTime"!==e.Type)return n.join(", ");if(t&&""!==t)return Date.parseDate(t,Object(Pe.f)(),Object(u.a)().cultureInfo).toDateShortString(Object(u.a)().cultureInfo)}}function ch(t){return oe.createElement(lh,Object(S.__assign)({},t))}function uh(t){return Object(et.k)(t).toString()}var lh=function(t){function e(e){var n=t.call(this,e)||this;n.iL=new me.a.CallLater((function(){var t=n.state.FeedbackValue;n.props.FeedbackUpdate(""===t?null:t)}),1e3),n.It=oe.createRef(),n.state={FeedbackValue:e.StoredFeedback,IsExpanded:!!e.StoredFeedback,IsInternetExplorerPageLoaded:!1,CurrentFeedbackId:e.Id},n.rL=Object(ae.a)().GradingView_FeedbackInputPlaceholder_LabelFormat.format(Object(Pe.k)());var i=Et.clone(n.props.HTMLAttributes)||{};i.className=i.className||"feedbackInput";var r=eh;if(!n.props.Readonly){var o=i.onBlur;i.onBlur=function(t){null!=o&&o(t);var e=n.state.FeedbackValue;null!=e&&e.length>0&&Object(g.b)(n.props.FeedbackChangeEvent),Object(Y.c)("QuizReviewLogicUpgrade")&&n.iL.callImmediately()},r=function(t){if(n.state.IsInternetExplorerPageLoaded||!Object(et.o)()){var e=n.state.IsExpanded;t&&t!==n.state.FeedbackValue&&(e=!0),n.setState({FeedbackValue:t,IsExpanded:e}),Object(Y.c)("QuizReviewLogicUpgrade")?n.iL.callOnceLater():n.props.FeedbackUpdate(""===t?null:t)}else n.setState({IsInternetExplorerPageLoaded:!0})}}return n.gO=r,n.oL=i,n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillReceiveProps=function(t){var e=this;Object(Y.c)("QuizReviewLogicUpgrade")?t.Id!==this.state.CurrentFeedbackId&&this.setState({FeedbackValue:t.StoredFeedback,IsInternetExplorerPageLoaded:!1,CurrentFeedbackId:t.Id}):this.setState((function(e){return{FeedbackValue:t.StoredFeedback}})),this.setState((function(n){var i=!!t.StoredFeedback||n.IsExpanded;return i&&!e.It.current.className.includes("in")&&$(e.It.current).collapse("show"),{IsExpanded:i}}))},n.componentDidMount=function(){var t=this;$(this.It.current).on("hidden.bs.collapse",(function(){t.setState({IsExpanded:!(!t.state.FeedbackValue||""===t.state.FeedbackValue)})})),this.state.IsExpanded&&!this.It.current.className.includes("in")&&$(this.It.current).collapse("show")},n.sL=function(){var t,e="collapse";return this.state.IsExpanded&&(e+=" in"),null!=this.props.Id?t=uh(this.props.Id):null!=this.props.ClassName&&(e+=" "+uh(this.props.ClassName)),{id:t,className:e}},n.render=function(){var t=this.state.FeedbackValue,e=this.props.Readonly,n=this.sL(),i=n.id,r=n.className;return oe.createElement("div",{className:r,id:i,ref:this.It},Object(ar.b)({AllowRichText:!0,HTMLAttributes:this.oL,TextFieldType:2,Placeholder:this.rL,Value:t,Options:{HTMLPropsForInnerElement:{"aria-label":this.rL}},onValueChange:this.gO,Disabled:e}),oe.createElement("div",{className:"textbox-printview none-display"},t))},e}(ue.a);function hh(t){return oe.createElement(fh,Object(S.__assign)({},t))}var fh=function(t){function e(e){var n=t.call(this,e)||this;return n.state={IsExpanded:e.IsExpanded,ResponseId:e.CurrentResponseId},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillReceiveProps=function(t){this.state.ResponseId!==t.CurrentResponseId&&this.setState({IsExpanded:t.IsExpanded,ResponseId:t.CurrentResponseId})},n.componentDidMount=function(){var t=this,e=this.aL();$(".gradingViewContainer").on("shown.bs.collapse",e,(function(){$(e+" textarea").focus(),t.cL(!0)})),$(".gradingViewContainer").on("hidden.bs.collapse",e,(function(){t.cL(!1)}))},n.aL=function(){return null!=this.props.AssociatedFeedbackId?"#"+uh(this.props.AssociatedFeedbackId):"."+uh(this.props.AssociatedFeedbackClassName)},n.uL=function(){return!this.state.IsExpanded},n.render=function(){var t=this.aL(),e=null!=this.props.AssociatedFeedbackId?uh(this.props.AssociatedFeedbackId):null,n=this.props.Label||Object(ae.a)().GradingView_GiveFeedbackButton_Label,i=Object(pn.b)("feedbackToggle",this.uL()?void 0:"disabled"),r=Object(Un.b)({HTMLAttributes:{className:"feedback-icon forms-icon-size16x16","aria-hidden":!0},IconName:"Chat"});return oe.createElement("div",Object(S.__assign)({},this.props.HTMLAttributes),oe.createElement("a",{href:this.uL()?t:"javascript:;","data-toggle":this.uL()?"collapse":void 0,"aria-expanded":this.state.IsExpanded,"aria-controls":e,"aria-disabled":!this.uL()||void 0,title:this.props.Title,onClick:this.cn.bind(this),className:i},r,!0===this.props.NoLabel?null:n))},n.lL=function(){var t=this.aL()+" .form-control",e=$(t);e.addClass("focus"),setTimeout((function(){return e.removeClass("focus")}),1e3)},n.cn=function(){this.uL()||this.lL(),Object(g.b)(this.props.OnClickEventName,{isClickable:this.uL()})},n.cL=function(t){this.setState({IsExpanded:t})},e}(ue.a),dh=n(234);function bh(t){return oe.createElement(mh,Object(S.__assign)({},t))}var mh=function(t){function e(e){var n=t.call(this,e)||this;n.hL=1e9;var i=null!=e.CurrentScore;return n.state={Score:i?e.CurrentScore:void 0,ScoreString:i?e.CurrentScore.toString():void 0,ScoreUpdated:!1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillReceiveProps=function(t){var e;if(!Object(Y.c)("QuizReviewLogicUpgrade")){var n=null!=t.CurrentScore;n&&t.CurrentScore.toString()!==(null===(e=this.state.Score)||void 0===e?void 0:e.toString())&&this.setState({Score:n?t.CurrentScore:void 0,ScoreString:n?t.CurrentScore.toString():""})}},n.fL=function(){return this.props.TotalPoints||0},n.dL=function(){var t=this.state.Score,e=this.fL();return null==t?oe.createElement("div",{className:"gradingNeedsReviewNotification"},Object(ae.a)().GradingView_GradeInputNeedsReview_Label):t>e?oe.createElement("div",{className:"gradingExtraCreditNotification"},Object(ae.a)().GradingView_GradeInputExtraCredit_Label):this.props.autoGraded&&!this.state.ScoreUpdated?oe.createElement("div",{className:"gradingAutogradedNotification"},Object(ae.a)().GradingView_AutoGraded):void 0},n.render=function(){var t,e=this,n=Object(ae.a)().Common_Points_Text,i=this.state.ScoreString?this.state.ScoreString:"";t=1===this.fL()?Object(ae.a)().GradingView_GradeInputPoint_Label:Object(ae.a)().GradingView_GradeInputPoints_LabelFormat.format(this.fL());var r=Et.extend({},this.props.HTMLAttributes);return r.className=Object(pn.b)("gradeInputContainer",r.className),oe.createElement("div",Object(S.__assign)({},r),oe.createElement("div",{className:"gradingGradeInputWrapper"},Object(ar.b)({HTMLAttributes:{className:"gradingGradeInput","aria-label":this.props.title},Placeholder:n,Value:i,Options:{HTMLPropsForInnerElement:{"aria-label":n}},onValueChange:function(t){var n=Object(dh.validateQuizPoint)(t,e.hL);null!=n&&n.pointString!==e.state.ScoreString&&e.setState({Score:n.point,ScoreString:n.pointString,ScoreUpdated:!0},(function(){e.bL(n.point)}))}}),oe.createElement("div",{className:"gradingGradeTotalScore"},"/ "+t)),oe.createElement("div",null,this.dL()))},n.bL=function(t){var e=this.props.UpdateParentScore;e&&e(t)},e}(ue.a),vh=n(214);function gh(t){return oe.createElement(Oh,Object(S.__assign)({},t))}var Oh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.mL=function(){var t=this,e={onClick:function(e){t.props.nextItemCallback(),$(e.target).focus()},disabled:this.props.indexOfCurrentItem>=this.props.numberOfItems-1,className:"gradingNavBarArrow nextQuestion","aria-label":this.vL()},n=Object(qo.b)({HTMLAttributes:e,ButtonStyle:"None",children:Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16"},IconName:"ChevronRightMed"})});return oe.createElement("div",{className:"gradingNavBarArrowContainer"},n)},n.gL=function(){var t=this,e={onClick:function(e){t.props.previousItemCallback(),$(e.target).focus()},disabled:this.props.indexOfCurrentItem<1,className:"gradingNavBarArrow previousQuestion","aria-label":this.OL()},n=Object(qo.b)({HTMLAttributes:e,ButtonStyle:"None",children:Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16"},IconName:"ChevronLeftMed"})});return oe.createElement("div",{className:"gradingNavBarArrowContainer"},n)},n.vL=function(){switch(this.props.gradingMode){case ys.ByQuestion:return Object(ae.a)().GradingView_NextQuestion_ButtonLabel;case ys.ByStudent:return Object(ae.a)().GradingView_NextStudent_ButtonLabel;default:throw new Error("Unknown grading mode: "+this.props.gradingMode)}},n.OL=function(){switch(this.props.gradingMode){case ys.ByQuestion:return Object(ae.a)().GradingView_PreviousQuestion_ButtonLabel;case ys.ByStudent:return Object(ae.a)().GradingView_PreviousStudent_ButtonLabel;default:throw new Error("Unknown grading mode: "+this.props.gradingMode)}},n.pL=function(){var t=this.props.dropdownOptions.map((function(t,e){return{DisplayName:t=Object(Oa.b)(t),Value:e,Key:e,DisplayContent:oe.createElement("span",{title:t},t)}}));return Object(Pr.b)({HTMLAttributes:{className:"analyze-view-dropdown-div gradingNavBarDropDown"},SelectOptions:t,Value:this.props.indexOfCurrentItem,onValueChange:this.props.dropdownCallback,AllowWrap:!0})},n.jL=function(){if(!0===this.props.showProgressIndicator)return oe.createElement("span",{className:"progressIndicator"},"(",this.props.progressIndicatorTemplate.format(this.props.indexOfCurrentItem+1,this.props.numberOfItems),")")},n.yL=function(){if(null!=this.props.fillTime){var t=Object(ae.a)().Forms_TimeInMinutesAndSeconds_Format.format(this.props.fillTime.minutes<10?"0"+this.props.fillTime.minutes:this.props.fillTime.minutes,this.props.fillTime.seconds<10?"0"+this.props.fillTime.seconds:this.props.fillTime.seconds),e=Object(ae.a)().GradingView_ResponseFillTimeInMinutesAndSeconds_AccessibilityLabel.format(this.props.fillTime.minutes,this.props.fillTime.seconds);return oe.createElement("div",{className:"gradingNavBarItem gradingNavBarStudentFillTime"},oe.createElement("a",{className:"screenReaderVisible"},e),oe.createElement("div",{className:"gradingNavBarItemLabel",role:"presentation","aria-hidden":"true"},Object(ae.a)().GradingView_ResponseFillTime_Format.format(t)))}},n.wL=function(){var t,e;if(null!=this.props.studentScore&&(null!=this.props.studentScore.pointsEarned||null!=this.props.studentScore.scoreOverride))return null==this.props.studentScore.scoreOverride?(t=n(this.props.studentScore.pointsEarned,this.props.studentScore.pointsPossible),t=Object(ae.a)().GradingView_NavBar_StudentScore_Format.format(t),e=n(this.props.studentScore.pointsEarned,this.props.studentScore.pointsPossible,!0)):e=t=Object(ae.a)().GradingView_NavBar_ScorePercent_Label.format(this.props.studentScore.scoreOverride),oe.createElement("div",{className:"gradingNavBarItem"},oe.createElement("a",{className:"screenReaderVisible"},e),oe.createElement("div",{className:"gradingNavBarItemLabel",role:"presentation","aria-hidden":"true"},t));function n(t,e,n){return void 0===n&&(n=!1),n?Object(ae.a)().GradingView_NavBar_StudentScore_AccessibilityLabel.format(t,e):Object(ae.a)().GradingView_NavBar_Score_Format.format(t,e)}},n.tk=function(){if(this.props.generalFeedbackProps){var t=!!this.props.generalFeedbackProps?this.props.generalFeedbackProps.ClassName:void 0;return oe.createElement("div",{key:t+"-button",className:"gradingNavBarItem"},hh(this.props.generalFeedbackButtonProps))}},n.Zu=function(){if(this.props.generalFeedbackProps){var t=!!this.props.generalFeedbackProps?this.props.generalFeedbackProps.ClassName:void 0;return oe.createElement("div",{key:t+"-input",className:"gradingNavBarFeedbackInput"},ch(this.props.generalFeedbackProps))}},n.SL=function(){var t=this;if(this.props.MenuProps){var e=Et.extend({},this.props.MenuProps);return e.onBeforeDeletedDialogShown=function(){t.NL(),t.props.MenuProps.onBeforeDeletedDialogShown&&t.props.MenuProps.onBeforeDeletedDialogShown()},e.onDeleteDialogDismissed=function(){t.IL(),t.props.MenuProps.onDeleteDialogDismissed&&t.props.MenuProps.onDeleteDialogDismissed()},Object(vh.b)(e)}},n.NL=function(){this.setState({disabled:!0})},n.IL=function(){this.setState({disabled:void 0})},n.CL=function(){if(null!=this.props.questionScore){var t=n(this.props.questionScore.pointsEarned,this.props.questionScore.pointsPossible,this.props.questionScore.numQuestions);t=Object(ae.a)().GradingView_NavBar_QuestionScore_Format.format(t);var e=n(this.props.questionScore.pointsEarned,this.props.questionScore.pointsPossible,this.props.questionScore.numQuestions,!0);return oe.createElement("div",{className:"gradingNavBarItem"},oe.createElement("a",{className:"screenReaderVisible"},e),oe.createElement("div",{className:"gradingNavBarItemLabel",role:"presentation","aria-hidden":"true"},t))}function n(t,e,n,i){function r(t){var e=Math.round(t);return t===e?e:t.toFixed(1)}void 0===i&&(i=!1);var o=0!==n?r(t/n):0,s=0!==n?r(e/n):0;return i?Object(ae.a)().GradingView_NavBar_QuestionScore_AccessibilityLabel.format(o,s):Object(ae.a)().GradingView_NavBar_Score_Format.format(o,s)}},n.render=function(){return oe.createElement("div",null,oe.createElement("div",{className:"gradingNavBar"},oe.createElement("div",{className:"gradingNavBarItemsContainer","aria-disabled":this.state.disabled},oe.createElement("div",{className:"gradingNavBarItem gradingNavBarNavigationContainer"},oe.createElement("div",{className:"gradingNavBarNavigationComponent"},this.gL()),oe.createElement("div",{className:"gradingNavBarNavigationComponent gradingNavBarDropdownContainer"},this.jL(),this.pL()),oe.createElement("div",{className:"gradingNavBarNavigationComponent"},this.mL())),this.yL(),this.wL(),this.CL(),this.tk()),this.SL()),this.Zu())},e}(ue.a);function ph(t){var e=Object(Bl.d)(t.response);return Object(Jo.b)({email:e.email,name:e.name,tooltip:e.email&&-1!==e.email.indexOf("@")?e.name+" <"+e.email+">":e.name,displayText:Object(Xo.b)(e.name)})}function jh(){var t=document.getElementById("scrollAnchor");t&&t.scrollIntoView()}function yh(){if(Object(et.r)()){var t=$(window).width();return 0===t&&(t=document.body.scrollWidth),t/(16/9)}return Object(Pe.l)()}var wh=function(t){function e(e){var n=t.call(this,e)||this;return n.setState({dummyToForceUpdate:{},ResponseIdsForDetailsModal:[],AnalyzeViewData:null,DataTablesLibraryLoaded:!1}),n.CC=n.CC.bind(n),n.kL=n.kL.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.Form.getQuestions(),n=this.props.Form.getResponses(),i=Object(Bl.a)(e,n);Object(g.b)("Grading.PowertoolView.Initial",i),Object(An.a)("DataTables").then((function(){return t.setState({DataTablesLibraryLoaded:!0})}))},n.render=function(){var t=this.props.Form,e=this.props.CurrentQuestionMaster,n=e.Model,i=function(t,e){return[new Ql(t,e),new Vl(t,e)]}(_l(t.getResponses(),e),e),r=i[0],o=i[1],s=mc.isAutogradableQuestion(n);return oe.createElement("div",{className:"gradingPowertoolContainer"},this.TL(r,s,!0),this.TL(o,s,!1),this.xL(n.Id))},n.TL=function(t,n,i){for(var r=this,o=this.props.CurrentQuestionIndex,s=this.props.CurrentQuestionMaster,a=s.Model,c=this.props.CurrentQuestionIndex+1,u=[],l=function(){var l=t.next(),f=l.answerAndResponses,d=Object(Bl.b)(f.map((function(t){return t.Response}))),b=f[0].Answer,m=null!=b?El(b.Answer):void 0,v=a.IsMathQuiz&&"Question.TextField"!==a.Type?function(t,e){if(!t)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);for(var n=Object(_r.b)(t,e).SelectedOptions.map((function(t){return Et.find(e.Choices,(function(e){return e.Description===t+""}))})).filter((function(t){return null!=t})),i=[],r=0;r<n.length;r++)i.push(Object(zl.a)(n[r])),r!==n.length-1&&i.push(Object(ae.a)().GradingView_ItemSeparator);return i.every(Et.isString)?i.join(""):oe.createElement("span",null,i)}(m,a):sh(s,{Answer:b},["Question.Choice","Question.Ranking","Question.MatrixChoiceGroup"]),g=o+"_"+l.answerRenderOrderIndex,O="answerFeedback-"+g,p=Object(ae.a)().GradingView_Feedback_ButtonTextFormat.format(d,c),j=Object(ae.a)().GradingView_Grade_ButtonTextFormat.format(d,c),y=e.getResponsesCountText(f.length),w=f.map((function(t){return t.Response.Id})),S=e.getCorrectnessIcon(n,i),N=i?"gradingPowertoolCorrectAnswer":"gradingPowertoolIncorrectAnswer",I=Object(zl.b)(a,b.Feedback);u.push(oe.createElement("div",{className:"gradingPowertoolAnswerAndFeedbackBoxContainer",key:g},oe.createElement("div",{className:"gradingPowertoolAnswerContainer"},S,oe.createElement("div",{className:"gradingPowertoolAnswer gradingAnswerContainer "+N},v),oe.createElement("div",{className:"gradingPowertoolAnswerSecondRow"},oe.createElement("div",{className:"gradingPowertoolResponseCountContainer"},oe.createElement("a",{href:"javascript:;",onClick:function(){return r.FL(w)},className:"office-form-theme-primary-foreground"},y)),oe.createElement("div",{className:"gradingPowertoolGradeInputContainer",key:a.Id+g},bh({TotalPoints:a.Point,CurrentScore:b.Score,UpdateParentScore:h.PL(f,a),HTMLAttributes:{hidden:!a.IsQuiz,onBlur:h.DL.bind(h),onFocus:function(){return r.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded(l.answerRenderOrderIndex)}},title:j,autoGraded:Object(Ll.l)(b)})),0===I&&oe.createElement("div",{className:"gradingPowertoolFeedbackButtonContainer"},hh({IsExpanded:!!b.Feedback,AssociatedFeedbackId:O,Title:p,NoLabel:!0,OnClickEventName:"Grading.PowertoolView.FeedbackButtonClick"})))),1!==I&&oe.createElement("div",{className:"gradingPowertoolFeedbackInputContainer"},ch({HTMLAttributes:{onBlur:h.ML.bind(h)},Id:O,FeedbackUpdate:h.LL(f,a),StoredFeedback:b.Feedback,FeedbackChangeEvent:"Grading.PowertoolView.FeedbackChanged",Readonly:2===I}))))},h=this;t.hasNext();)l();return u},e.getCorrectnessIcon=function(t,e){var n,i;if(t)return e?(n="forms-icon-size16x16 office-form-right-answerkey",i=Object(ae.a)().GradingView_CorrectAnswer_AccessibilityLabel):(n="forms-icon-size16x16 office-form-wrong-answerkey",i=Object(ae.a)().GradingView_IncorrectAnswer_AccessibilityLabel),oe.createElement("span",{className:"gradingPowertoolCorrectnessIcon"},oe.createElement(Un.a,{HTMLAttributes:{className:n},IconName:e?"CheckMark":"Cancel"}),oe.createElement("a",{className:"screenReaderVisible"},i),oe.createElement("span",{"aria-hidden":"true",role:"presentation"}))},e.getResponsesCountText=function(t){return 1===t?Object(ae.a)().GradingView_PowertoolAnswerResponseCount_Label_Singular:Object(ae.a)().GradingView_PowertoolAnswerResponseCount_Label.format(t)},n.FL=function(t){var e=this;Object(g.b)("Grading.PowertoolView.RowDetailsModalOpen"),this.setState({ResponseIdsForDetailsModal:t}),Js.createAnalyzeViewData(this.props.Form.getWrappedForm()).then((function(t){e.setState({AnalyzeViewData:t})})).catch((function(t){Dl((function(e){return e.Model.CriticalError=t}))}))},n.xL=function(t){var e=this,n=this.state;if(null!=n.ResponseIdsForDetailsModal&&null!=n.AnalyzeViewData&&n.DataTablesLibraryLoaded)return vc({QuestionId:"field_"+t,AnalyzeViewData:n.AnalyzeViewData,closeSelf:function(){e.setState({ResponseIdsForDetailsModal:null})},goToNextModalCallback:null,goToPreviousModalCallback:null,ShouldIncludeInvalidAnswers:!0,filterResponses:this.kL})},n.CC=function(){this.setState({ResponseIdsForDetailsModal:null})},n.kL=function(t){return Et.contains(this.state.ResponseIdsForDetailsModal,t.field_id)},n.LL=function(t,e){var n=this;return function(i){var r=n.props.Form,o=t.map((function(t){return t.Response.Id}));r.addAnswerFeedbacks(o,e.Id,void 0,i,(function(){return Object(g.b)("Grading.PowertoolView.FeedbackChanged",{responsesCount:o.length})}))}},n.PL=function(t,e){var n=this;return function(i){var r=n.props.Form,o=t.map((function(t){return t.Response.Id}));r.addAnswerFeedbacks(o,e.Id,i,void 0,(function(){return Object(g.b)("Grading.PowertoolView.GradeChanged",{isFormFullyGraded:Object(Ll.m)(r),isGradedAnswer:t[0].Answer.IsAutoGraded,isMathQuestion:e.IsMathQuiz,responsesChanged:t.length,questionType:e.Type,questionId:e.Id})}))}},n.DL=function(){this.AL(),this.props.OnGradeChange()},n.ML=function(){this.AL()},n.AL=function(){this.props.Form.calculateBranchedResponses(),this.setState({dummyToForceUpdate:{}})},e}(ue.a);function Sh(){var t=$("body");t.addClass("gradingViewContainer");var e=$("#gradingViewPrintChild").appendTo(t),n=$("#content-root");n.hide(),$(".feedbackInput").hide(),$(".textbox-printview.none-display").show(),Object(et.c)((function(){t.removeClass("gradingViewContainer"),e.appendTo($(".gradingViewContainer")),n.show(),$(".textbox-printview.none-display").hide(),$(".feedbackInput").show()}))}var Nh=function(t){function e(n){var i=t.call(this,n)||this,r=i.props.CurrentQuestionMaster.Model.Id;return i.state={score:e.createNavBarAverageScore(n.Form,r)},i}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){Object(g.b)("Grading.QuestionView.Initial")},n.componentDidMount=function(){jh()},n.render=function(){var t=this.props.CurrentQuestionMaster;return oe.createElement("div",Object(S.__assign)({},{className:"gradingByQuestion",id:"grading-by-question-panel",role:"tabpanel","aria-labelledby":"grading-by-question-tab","aria-expanded":!0}),this.RL(),this.EL(t),this.BL(t))},n.BL=function(t){var n,i=this,r=t.Model,o=this._L(r.Id);if(!o.length)return oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoOneAnswered_Label);if("Question.MatrixChoiceGroup"===r.Type||"Question.Ranking"===r.Type)return oe.createElement("div",{className:"gradingByQuestionContainer"},oe.createElement("span",null,Object(ae.a)().QuestionView_Tip_LikertAndRanking));if(Hl(r)){Object(g.b)("Grading.QuestionView.RenderedInPowertool");var s=this.props.Form;return n={Form:s,CurrentQuestionIndex:this.props.CurrentQuestionIndex,CurrentQuestionMaster:this.props.CurrentQuestionMaster,OnGradeChange:function(){i.setState({score:e.createNavBarAverageScore(i.props.Form,r.Id)}),i.props.UpdateNextUngradedButtonState()},UpdateGradeBoxIndexAfterWhichToSearchNextUngraded:this.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded},oe.createElement(wh,Object(S.__assign)({},n))}Object(g.b)("Grading.QuestionView.RenderedInNonPowertool");var a=o.map((function(e,n){return i.HL(e,t,n)}));return oe.createElement("div",{className:"gradingByQuestionContainer"},oe.createElement("div",{className:"gradingByQuestionAnswerContainer gradingAnswerContainer"},a))},n._L=function(t){for(var e=[],n=new Ul(this.props.Form,t),i=function(){var t=n.next(),i=Et.filter(e,(function(e){return e.Response.Responder===t.response.Responder})).length;e.push({Response:t.response,Answer:t.answer,Attempt:i})};n.hasNext();)i();return e},n.GL=function(t){return t+1+". "+Et.filter(this.props.Form.getQuestions(),(function(t){return!t.GroupId}))[t].Title},n.RL=function(){var t=this,n=Et.filter(this.props.Form.getQuestions(),(function(t){return!t.GroupId})),i=Et.range(n.length).map((function(e,n){return t.GL(n)})),r={HasAnswers:null!=this.props.Form.getResponses()&&this.props.Form.getResponses().length>0,DeleteAllResponses:!1,onDelete:void 0,onPrint:function(){Sh(),Object(g.b)("Grading.StudentView.PrintResponse")}},o=n[this.props.CurrentQuestionIndex].Id,s=this.props.Form.getQuestions().filter((function(t){return!t.GroupId})).length;return gh({dropdownCallback:this.qL(),dropdownOptions:i,previousItemCallback:this.QL(),nextItemCallback:this.VL(),indexOfCurrentItem:this.props.CurrentQuestionIndex,numberOfItems:s,generalFeedbackProps:null,generalFeedbackButtonProps:null,gradingMode:ys.ByQuestion,progressIndicatorTemplate:Object(ae.a)().GradingView_Of_Format,MenuProps:r,questionScore:e.createNavBarAverageScore(this.props.Form,o)})},n.qL=function(){var t=this;return function(n){var i=t.props.Form.getQuestions()[n].Id;t.props.UpdateParentCurrentQuestionIndex(n),Object(g.b)("Grading.QuestionView.GotoPage"),t.setState({score:e.createNavBarAverageScore(t.props.Form,i)}),jh()}},n.QL=function(){var t=this,n=this.props.CurrentQuestionIndex;return function(){if(n>=1){var i=n-1,r=t.props.Form.getQuestions()[i].Id;t.props.UpdateParentCurrentQuestionIndex(i),Object(g.b)("Grading.QuestionView.PreviousPage"),t.setState({score:e.createNavBarAverageScore(t.props.Form,r)}),jh()}}},n.VL=function(){var t=this,n=this.props.CurrentQuestionIndex;return function(){if(n<t.props.Form.getQuestions().length-1){var i=n+1,r=t.props.Form.getQuestions()[i].Id;t.props.UpdateParentCurrentQuestionIndex(i),Object(g.b)("Grading.QuestionView.NextPage"),t.setState({score:e.createNavBarAverageScore(t.props.Form,r)}),jh()}}},e.createNavBarAverageScore=function(t,e){var n=Object(Ll.h)(t,e);return{pointsPossible:Object(Ll.j)(t,e),pointsEarned:n,numQuestions:Object(Ll.c)(t,e).length}},n.EL=function(t){var e=t.Model,n=Object(zl.e)(e),i=Object(ga.b)({Text:e.Title,RenderMode:"RichText"}),r=Object(ga.b)({Text:e.Subtitle,RenderMode:"RichText"}),o=e.ShowSubtitle&&e.Subtitle&&null==n?oe.createElement("div",{className:"gradingByQuestionQuestionSubtitle"},r):null,s=Object(zl.d)(e)?Object(is.b)({Image:t.ImageInfoMaster,ImageSettings:t.ImageSettingsMaster,ImageType:"Question"}):null,a=t.hasValidVideoUrl()?oe.createElement("iframe",{src:e.VideoInfo.Url,height:yh(),width:"100%",frameBorder:"0",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"}):null;return oe.createElement("div",{className:"gradingByQuestionQuestionContainer"},oe.createElement("div",{className:"gradingByQuestionQuestionNumberAndTitleContainer"},oe.createElement("div",{className:"gradingByQuestionQuestionNumberContainer"},this.props.CurrentQuestionIndex+1,"."),oe.createElement("div",{className:"gradingQuestionText gradingByQuestionQuestionTextContainer",key:e.Id},i,o)),oe.createElement("div",{className:"gradingQuestionFormulaAndImageContainer"},oe.createElement("div",{className:"gradingQuestionImage",key:e.Id+"Image"},s),a,oe.createElement("div",{className:"gradingQuestionFormula",key:e.Id+"Formula"},n)))},n.HL=function(t,e,n){var i=this,r=e.Model,o=this.props.CurrentQuestionIndex,s=Object(Bl.d)(t.Response).name,a=""+r.Id+s+t.Attempt+o,c=t.Answer?t.Answer.Score:void 0,u=Object(ae.a)().GradingView_Grade_ButtonTextFormat.format(s,o+1),l=this.zL(t,r);return oe.createElement("div",{className:"gradingByQuestionOneResponseContainer",key:a},oe.createElement("div",{className:"gradingByQuestionResponseHeader"},oe.createElement("div",{className:"gradingByQuestionStudentAvatar gradingByQuestionAvatarContainer"},ph({response:t.Response})),oe.createElement("div",{className:"gradingByQuestionStudentNameContainer"},s,t.Attempt>0?" ("+t.Attempt+")":void 0),oe.createElement("div",{className:"gradingByQuestionGradeAndFeedbackContainer"},oe.createElement("div",{className:"gradingByQuestionGradeContainer"},bh({TotalPoints:r.Point,CurrentScore:c,UpdateParentScore:this.UL(t.Response.Id,r),HTMLAttributes:{hidden:!r.IsQuiz,onBlur:this.$L(r.Id),onFocus:function(){return i.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded(n)}},title:u,autoGraded:Object(Ll.l)(t.Answer)})),oe.createElement("div",{className:"gradingByQuestionFeedbackContainer"},null==l?void 0:l.button))),oe.createElement("div",null,oe.createElement("div",{className:"gradingByQuestionResponseTitle"},Object(ae.a)().GradingView_Response_Label),oe.createElement("div",{className:"gradingByQuestionResponseBody"},this.WL(t,e)),oe.createElement("div",{className:"grading-feedback"},null==l?void 0:l.input)))},n.zL=function(t,e){var n=Object(zl.b)(e,t.Answer.Feedback);if(1===n)return null;var i="feedback-"+Object(et.k)(t.Response.Responder||t.Response.ResponderName)+"-"+t.Attempt,r=this.props.CurrentQuestionIndex,o=Object(Bl.d)(t.Response).name,s=Object(ae.a)().GradingView_Feedback_ButtonTextFormat.format(o,r+1),a=null;return 0===n&&(a=hh({IsExpanded:!!t.Answer.Feedback,AssociatedFeedbackId:i,Title:s,NoLabel:!0,OnClickEventName:"Grading.QuestionView.FeedbackButtonClick"})),{button:a,input:oe.createElement("div",{className:"gradingByQuestionFeedback"},ch({Id:i,StoredFeedback:t.Answer.Feedback,FeedbackUpdate:this.LL(t.Response.Id,e),FeedbackChangeEvent:"Grading.QuestionView.FeedbackChanged",Readonly:2===n}))}},n.WL=function(t,e){return!!El(t.Answer.Answer)?sh(e,{Answer:t.Answer}):oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label)},n.$L=function(t){var n=this;return function(){n.setState({score:e.createNavBarAverageScore(n.props.Form,t)}),n.props.UpdateNextUngradedButtonState()}},n.UL=function(t,e){var n=this;return function(i){var r=n.props.Form;r.addAnswerFeedbacks([t],e.Id,i,void 0,(function(){return Object(g.b)("Grading.QuestionView.GradeChanged",{isFormFullyGraded:Object(Ll.m)(r)})}))}},n.LL=function(t,e){var n=this;return function(i){n.props.Form.addAnswerFeedbacks([t],e.Id,void 0,i)}},e}(ue.a),Ih=n(212),Ch=n(213);var kh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t,n=this.props.questionMaster,i=n.Model,r=this.props.answer.Answer;t=("Question.Ranking"===i.Type?!!r:"Question.MatrixChoiceGroup"===i.Type?Et.some(r,(function(t){return!!t.Answer})):!!El(r))?sh(n,{Answer:this.props.answer},null,!0):oe.createElement("div",{className:"gradingQuestionNoAnswerGiven"},Object(ae.a)().GradingView_NoAnswerGiven_Label);var o=Object(zl.e)(i),s=Object(ga.b)({Text:i.Title,RenderMode:"RichText"}),a=Object(ga.b)({Text:i.Subtitle,RenderMode:"RichText"}),c=i.ShowSubtitle&&i.Subtitle&&null==o?oe.createElement("div",null,a):null,u=Object(zl.d)(i)?Object(is.b)({Image:n.ImageInfoMaster,ImageSettings:n.ImageSettingsMaster,ImageType:"Question"}):null,l=n.hasValidVideoUrl()?oe.createElement("iframe",{src:i.VideoInfo.Url,height:yh(),width:"100%",frameBorder:"0",allowFullScreen:!0,sandbox:"allow-scripts allow-same-origin allow-popups allow-forms"}):null;return oe.createElement("div",{key:i.Id},oe.createElement("div",{className:"gradingQuestionText"},s),c,oe.createElement("div",{className:"gradingQuestionImage"},u),l,oe.createElement("div",{className:"gradingQuestionFormula"},o),oe.createElement("div",{className:"gradingByStudentAnswerContainer gradingAnswerContainer"},t),oe.createElement("div",null,e.getShortTextQuestionCorrectAnswerList(this.props)),oe.createElement("div",{className:"gradingByStudentIndividualQuestionFeedbackContainer gradingGiveFeedbackLink"},this.props.feedbackButton,this.props.feedbackInput))},e.getShortTextQuestionCorrectAnswerList=function(t){var e=t.questionMaster.Model;if("Question.TextField"===e.Type&&!e.Multiline&&e.IsQuiz&&!t.questionMaster.isCorrectAnswer(El(t.answer.Answer))){var n=new lr.a(t.questionMaster.Model);if(n.areAnyAnswersDefined()){var i,r=n.getAnswers();if(r.some((function(t){return t.isMath}))){for(var o=[],s=0,a=r;s<a.length;s++){var c=a[s];if(c.isMath){var u=Object(rr.c)({Formula:c.answer});o.push(oe.createElement("div",{className:"correct-answer-list-formula-element"},u))}else o.push(c.answer);o.push(Object(ae.a)().VariousLocations_ItemList_Separator)}o.pop(),i=oe.createElement("div",{className:"correct-answer-list-formula-container"},o)}else i=Et.map(r,(function(t){return El(t.answer)})).join(Object(ae.a)().VariousLocations_ItemList_Separator);return oe.createElement("div",{className:"gradingByStudentShortTextCorrectAnswerList various-short-text-correct-answer-list"},oe.createElement("b",null,Object(ae.a)().VariousLocations_CorrectAnswerList_Label," "),i)}}},e}(ue.a),Th=function(t){function e(n){var i=t.call(this,n)||this;i.KL=function(){return i.props.Form.getResponses()[i.props.CurrentResponderIndex]},i.JL=function(t){var e=i.props.Form,n=i.KL().Id;e.addGeneralFeedback(n,t),i.setState({currentGeneralFeedback:t})};var r=n.Form.getResponses()[n.CurrentResponderIndex],o=r.Id;return i.state={score:e.createNavBarStudentScore(n.Form,o),currentGeneralFeedback:Object(Ll.g)(r),responseIsReleased:Object(Ll.p)(r)},i}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this.props.Form.getQuestions(),e=this.props.Form.getResponses(),n=Object(Bl.a)(t,e);Object(g.b)("Grading.StudentView.Initial",n)},n.componentDidMount=function(){jh()},n.render=function(){var t,e=this,n=this.XL();t=0===this.props.Form.getWrappedForm().FormElementManager.SectionMasters.length?n.map((function(t,n){return e.ZL(t,n)})):this.YL(n);return oe.createElement("div",Object(S.__assign)({},{id:"grading-by-people-panel",role:"tabpanel","aria-labelledby":"grading-by-people-tab","aria-expanded":!0}),this.tA(),oe.createElement("div",null,t))},n.eA=function(){return"feedback-general-"+this.props.CurrentResponderIndex+"-"+this.props.Form.getResponses()[this.props.CurrentResponderIndex].Id},n.tA=function(){var t=this,n=this.props.Form.getResponses(),i=this.props.CurrentResponderIndex,r=n.length,o=n.map((function(t){return Object(Bl.d)(t).name})),s=this.props.Form.getResponses()[this.props.CurrentResponderIndex],a=Object(Bl.d)(s).name,c=Object(Ll.g)(s),u={Id:this.eA(),FeedbackUpdate:this.JL.bind(this),StoredFeedback:c,FeedbackChangeEvent:"Grading.StudentView.GeneralFeedbackChanged",Readonly:!1},l={HTMLAttributes:{className:"gradingNavBarFeedbackButtonContainer"},IsExpanded:!!u.StoredFeedback,AssociatedFeedbackId:u.Id,Title:Object(ae.a)().GradingView_GeneralFeedback_Label.format(a),OnClickEventName:"Grading.StudentView.GeneralFeedbackButtonClick",NoLabel:!0,CurrentResponseId:s.Id},h={HasAnswers:null!=n&&n.length>0,DeleteAllResponses:!1,IsScoreReleased:this.state.responseIsReleased,onDelete:i>=0?function(){t.nA(i,r),Object(g.b)("Grading.StudentView.DeleteResponse")}:eh,onPrint:function(){Sh(),Object(g.b)("Grading.StudentView.PrintResponse")},onPostScore:function(){t.props.Form.markAsReleased(s.Id),Object(g.b)("Grading.StudentView.ReleaseResult"),t.setState({responseIsReleased:!0})},ConfirmDialogTextClassName:"menu-action-confirmation-smaller-font"};return oe.createElement("span",null,oe.createElement("span",{id:"general-feedback-toggle-wrapper",style:{display:"none"}},hh(l)),gh({dropdownCallback:this.qL(n),dropdownOptions:e.handleDuplicatedResponderNames(o),previousItemCallback:this.iA(i),nextItemCallback:this.rA(i,r),indexOfCurrentItem:i,numberOfItems:r,generalFeedbackProps:u,generalFeedbackButtonProps:l,gradingMode:ys.ByStudent,progressIndicatorTemplate:Object(ae.a)().GradingView_Of_Format,MenuProps:h,fillTime:e.calculateIndividualFillTime(s),studentScore:e.createNavBarStudentScore(this.props.Form,s.Id)}))},n.iA=function(t){var n=this;return function(){if(t>=1){var i=t-1,r=n.props.Form.getResponses()[i],o=r.Id;n.props.UpdateParentCurrentStudentIndex(i),Object(g.b)("Grading.StudentView.PreviousPage"),n.setState({score:e.createNavBarStudentScore(n.props.Form,o),currentGeneralFeedback:Object(Ll.g)(r),responseIsReleased:Object(Ll.p)(r)}),jh()}}},n.rA=function(t,n){var i=this;return function(){if(t<=n){var r=t+1,o=i.props.Form.getResponses()[r],s=o.Id;i.props.UpdateParentCurrentStudentIndex(r),Object(g.b)("Grading.StudentView.NextPage"),i.setState({score:e.createNavBarStudentScore(i.props.Form,s),currentGeneralFeedback:Object(Ll.g)(o),responseIsReleased:Object(Ll.p)(o)}),jh()}}},n.qL=function(t){var n=this;return function(t){var i=n.props.Form.getResponses()[t],r=i.Id;n.props.UpdateParentCurrentStudentIndex(t),Object(g.b)("Grading.StudentView.GotoPage"),n.setState({score:e.createNavBarStudentScore(n.props.Form,r),currentGeneralFeedback:Object(Ll.g)(i),responseIsReleased:Object(Ll.p)(i)}),jh()}},n.XL=function(){for(var t=this.props.Form.getWrappedForm().FormElementManager.TopQuestionMasters,e=this.KL(),n=[],i=new $l(this.props.Form,e);i.hasNext();){var r=i.next(),o=this.oA(r.question,r.answer,r.answerRenderOrderIndex);n.push({questionMaster:t[r.unbranchedQuestionIndex],answer:r.answer,feedbackButton:null==o?void 0:o.button,feedbackInput:null==o?void 0:o.input})}return n},n.ZL=function(t,e){var n=this,i=Et.filter(this.props.Form.getQuestions(),(function(t){return!t.GroupId}))[e].IsQuiz?"":"InvisibleBlock",r=Object(Bl.d)(this.KL()).name,o=t.feedbackButton;t.feedbackButton=void 0;var s=e+1+".",a=oe.createElement("div",{className:"gradingByStudentQuestionNumber"},s),c=oe.createElement("div",{className:"gradingByStudentResponseContainer"},function(t){return oe.createElement(kh,Object(S.__assign)({},t))}(t)),u=t.questionMaster.Model,l=t.answer,h=Object(ae.a)().GradingView_Grade_ButtonTextFormat.format(r,e+1),f=u.Id+this.props.CurrentResponderIndex,d=oe.createElement("div",{className:"gradingByStudentGradeAndFeedbackContainer"},oe.createElement("div",{className:"gradingByStudentGradeContainer",key:f+"-gradeAndFeedback"},bh({TotalPoints:u.Point,CurrentScore:l.Score,UpdateParentScore:this.UL(u,l),HTMLAttributes:{className:i,onBlur:function(){return n.$L()},onFocus:function(){return n.props.UpdateGradeBoxIndexAfterWhichToSearchNextUngraded(e)}},title:h,autoGraded:Object(Ll.l)(l)})),oe.createElement("div",{className:"gradingByStudentFeedbackContainer"},o));return oe.createElement("div",{key:f+"-container",className:"gradingByStudentFullQuestionContainer"},d,a,c)},n.YL=function(t){return this.sA(t)},n.aA=function(t,e){return t?[oe.createElement(Ih.a,{HasTheme:!1,key:"form-section-breaker-"+t.Model.Id}),oe.createElement(Ch.a,{children:e,Disabled:!0,DisableShuffle:!0,Expaned:!0,IsMobile:Object(et.r)(),key:"form-section-container-"+t.Model.Id,SectionMaster:t})]:e},n.sA=function(t){var e=this,n=0,i=this.cA(t).map((function(t){var i=Et.map(t.TopQuestionMasters,(function(t){return e.ZL(t,n++)}));return e.aA(t.Section,i)}));return oe.createElement("div",null,i)},n.cA=function(t){var e=[],n=this.props.Form.getWrappedForm().FormElementManager.getSectionNodes(),i=null;return t.forEach((function(t){var r=Et.find(n,(function(e){return e.TopQuestionMasters.indexOf(t.questionMaster)>=0}))||{Section:null,TopQuestionMasters:[]};i&&i.Section===r.Section||(i={Section:r.Section,TopQuestionMasters:[]},e.push(i)),i.TopQuestionMasters.push(t)})),e},n.oA=function(t,e,n){var i=Object(zl.b)(t,e.Feedback);if(1===i)return null;var r=this.props.Form.getResponses()[this.props.CurrentResponderIndex],o=Object(Bl.d)(r).name,s="feedback-"+t.Id+"-"+r.Id,a=Object(ae.a)().GradingView_Feedback_ButtonTextFormat.format(o,n+1),c=null;return 0===i&&(c=oe.createElement("div",{key:"button-"+s},hh({IsExpanded:!!e.Feedback,AssociatedFeedbackId:s,Title:a,NoLabel:!0,OnClickEventName:"Grading.StudentView.FeedbackButtonClick",CurrentResponseId:r.Id}))),{button:c,input:oe.createElement("div",{key:"input-"+s},ch({Id:s,FeedbackUpdate:this.LL(t),StoredFeedback:e.Feedback,FeedbackChangeEvent:"Grading.StudentView.FeedbackChanged",Readonly:2===i}))}},e.handleDuplicatedResponderNames=function(t){var e={};return t.map((function(t){return e[t]?e[t]++:e[t]=1,void 0===t?Object(ae.a)().DisplayFormat_AnonymousUserName.format(Object(ae.a)().ResponderNameForAnonymousUser,e[t]):1===e[t]?t:Object(ae.a)().DisplayFormat_DuplicateUserName.format(t,e[t])}))},n.$L=function(){this.setState({score:e.createNavBarStudentScore(this.props.Form,this.KL().Id)}),this.props.UpdateNextUngradedButtonState()},n.UL=function(t,e){var n=this;return function(i){var r=n.props.Form,o=n.KL().Id;r.addAnswerFeedbacks([o],t.Id,i,void 0,(function(){return Object(g.b)("Grading.StudentView.GradeChanged",{isFormFullyGraded:Object(Ll.m)(r),isGradedAnswer:e.IsAutoGraded,isMathQuestion:t.IsMathQuiz,questionType:t.Type,questionId:t.Id})}))}},n.LL=function(t){var e=this;return function(n){var i=e.KL().Id;e.props.Form.addAnswerFeedbacks([i],t.Id,void 0,n)}},n.nA=function(t,n){var i=this.props.Form,r=i.getResponses()[t].Id;mc.onDeleteCurrentResponse(i.getWrappedForm(),r),i.onDeleteResponse(r),i.calculateBranchedResponses();var o=t;if(t===n-1&&(o=n-2),o<0)this.props.onDeleteLastResponse();else{var s=this.props.Form.getResponses()[o];this.props.UpdateParentCurrentStudentIndex(o),this.setState({score:e.createNavBarStudentScore(this.props.Form,s.Id),currentGeneralFeedback:Object(Ll.g)(s)})}},e.calculateIndividualFillTime=function(t){var e=t.StartDate.getTime(),n=(t.SubmitDate.getTime()-e)/1e3;return{minutes:Math.floor(n/60),seconds:Math.round(n%60)}},e.createNavBarStudentScore=function(t,e){var n=Object(Ll.d)(t,e),i=Object(Ll.i)(t,e);return n>0?{pointsPossible:n,pointsEarned:i}:this.getScoreBasedOnNumberOfCorrectAnswers(t,e)},e.getScoreBasedOnNumberOfCorrectAnswers=function(t,e){var n=Object(Ll.b)(t,e),i=n.map((function(t){return t.QuestionId})),r=t.getQuestions().filter((function(t){return Et.contains(i,t.Id)})),o=0,s=0,a={};n.forEach((function(t){a[t.QuestionId]=t})),r.forEach((function(e){var n=Object(zl.c)(t,e.Id);a[e.Id]&&n.isCorrectAnswer(a[e.Id].Answer)&&o++,Et.some(e.Choices,(function(t){return t.IsAnswerKey}))&&s++}));var c=Math.round(100*o/s);return{pointsPossible:void 0,pointsEarned:void 0,scoreOverride:isFinite(c)&&!isNaN(c)?c+"":void 0}},e}(ue.a),xh=function(t){function e(e){var n=t.call(this,e)||this;return n.uA=null,n.lA=!1,n.hA=!1,n.fA=!1,n.dA=!1,n.bA=oe.createRef(),n.mA=oe.createRef(),n.dA=!0,n.Oe=n.Oe.bind(n),n.state={GradingMode:(e.UxState||ys.ByStudent).View,isReadyToRender:!1,CurrentIndexForQuestionView:(e.UxState||ys.ByStudent).Index,CurrentIndexForStudentView:(e.UxState||ys.ByStudent).Index,IndexOfGradeBoxToFocusOnLoad:null,hasUngradedQuestions:!0,lastResponseDeleted:!1,Form:new Al(e.FormMaster),isMounted:!0},n.vA(),n.gA=Et.debounce(n.forceUpdate,1e3),n}Object(S.__extends)(e,t);var n=e.prototype;return n.vA=function(){this.OA=-1},n.componentWillMount=function(){var t=this,e=this.state.Form,n=this.props.FormMaster.Schema;this.props.FormMaster.observe(this.Oe,[n.Responses]),e.ensureReadyToGrade().then((function(){e.calculateBranchedResponses(),t.setState({isReadyToRender:!0,hasUngradedQuestions:null!==t.pA(e)}),Object(g.b)("Grading.OnLoad.Success")})).catch((function(t){Object(Oo.f)(t)||Dl((function(e){return e.Model.CriticalError=t}))}))},n.componentDidMount=function(){this.setState({isMounted:!0})},n.componentDidUpdate=function(){this.jA(),this.yA(this.uA)},n.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.Oe),this.setState({isMounted:!1})},n.yA=function(t){null!==t&&(this.wA(t),this.uA=null)},n.jA=function(){this.lA&&($("#body-scrollable-content").scrollTop(0),this.lA=!1)},n.wA=function(t){var e=$(".gradingGradeInput input")[t];e&&e.focus()},n.renderView=function(){var t=this;if(!this.state.isReadyToRender)return oe.createElement("div",{className:"gradingViewContainer"},Pl());var e=this.state.Form;e.calculateBranchedResponses();var n,i=e.getQuestions().length,r=e.getResponses().length;if(!i||!r||this.state.lastResponseDeleted){var o=i?Object(ae.a)().GradingView_NothingToBeGraded_GetAnswers_Message:Object(ae.a)().GradingView_NothingToBeGraded_AddQuestions_Message,s=Object(Un.b)({HTMLAttributes:{className:"analyze-view-warning-icon forms-icon-size40x40",role:"presentation"},IconName:"Sad"});return oe.createElement("div",{className:"analyze-view-detail-noresponses-container gradingViewContainer"},this.includeTheme(),s,oe.createElement("div",{className:"analyze-view-detail-noresponse-message"},Object(ae.a)().GradingView_NothingToBeGraded_Message),oe.createElement("div",{className:"analyze-view-detail-noresponse-detail"},o))}switch(this.state.GradingMode){case ys.ByQuestion.View:var a=this.state.CurrentIndexForQuestionView,c=e.getWrappedForm().FormElementManager.TopQuestionMasters[a],u={Form:this.state.Form,CurrentQuestionIndex:a,CurrentQuestionMaster:c,UpdateParentCurrentQuestionIndex:this.SA(),UpdateGradeBoxIndexAfterWhichToSearchNextUngraded:function(e){t.OA=e},UpdateNextUngradedButtonState:function(){return t.setState({hasUngradedQuestions:null!==t.pA()})}};n=oe.createElement(Nh,Object(S.__assign)({},u));break;case ys.ByStudent.View:var l={Form:this.state.Form,CurrentResponderIndex:this.state.CurrentIndexForStudentView,UpdateParentCurrentStudentIndex:this.NA(),UpdateGradeBoxIndexAfterWhichToSearchNextUngraded:function(e){t.OA=e},UpdateNextUngradedButtonState:function(){return t.setState({hasUngradedQuestions:null!==t.pA()})},onDeleteLastResponse:function(){return t.setState({lastResponseDeleted:!0})}};n=oe.createElement(Th,Object(S.__assign)({},l))}var h=this.IA();if(window.ClickReviewAnswersStart&&this.dA&&Object(Y.c)("RemoveReviewAnswersButtonSync")){var f=Date.now()-window.ClickReviewAnswersStart.getTime();Object(g.b)("DesignPage.Responses.GradeResults",{Grading_ReviewAnswers_time:f}),this.dA=!1}return oe.createElement("div",{className:"gradingViewContainer"},this.includeTheme(),h,oe.createElement("div",{id:"gradingViewPrintChild"},n))},n.createAdditionalTopViewHeaderElements=function(){this.additionalTopViewHeaderElements=[this.CA()]},n.IA=function(){var t=this,e="gradingGradingModeSwitcherNavBarButton office-form-theme-page-foreground-active",n=this.state.GradingMode===ys.ByStudent.View,i={className:Object(pn.b)(e,this.hA&&"mouseDown-active",n&&"active"),role:"tab","aria-selected":n,"aria-controls":n?"grading-by-people-panel":null,id:"grading-by-people-tab",tabIndex:n?0:-1,onClick:function(e){Dl((function(t){var e=t.Model.Grading;t.Model.Grading={View:ys.ByStudent.View,Index:0,GoBackToView:e.GoBackToView}})),t.setState({GradingMode:ys.ByStudent.View,CurrentIndexForQuestionView:0,CurrentIndexForStudentView:0}),Object(g.b)("Grading.PeopleTab.Click")},onKeyDown:function(e){39===e.keyCode&&t.kA(e,t.bA,t.mA)}},r=this.state.GradingMode===ys.ByQuestion.View,o={className:Object(pn.b)(e,this.fA&&"mouseDown-active",r&&"active"),role:"tab","aria-selected":r,"aria-controls":r?"grading-by-question-panel":null,id:"grading-by-question-tab",tabIndex:r?0:-1,onClick:function(e){Dl((function(t){var e=t.Model.Grading;t.Model.Grading={View:ys.ByQuestion.View,Index:0,GoBackToView:e.GoBackToView}})),t.setState({GradingMode:ys.ByQuestion.View,CurrentIndexForQuestionView:0,CurrentIndexForStudentView:0}),Object(g.b)("Grading.QuestionTab.Click")},onKeyDown:function(e){37===e.keyCode&&t.kA(e,t.mA,t.bA)}},s=this.TA({HTMLAttributes:i,Text:Object(ae.a)().GradingView_StudentMode_ButtonLabel,ref:this.bA},(function(e){t.hA=e})),a=this.TA({HTMLAttributes:o,Text:Object(ae.a)().GradingView_QuestionMode_ButtonLabel,ref:this.mA},(function(e){t.fA=e}));return oe.createElement("div",null,oe.createElement("div",{className:"gradingTitle office-form-theme-primary-foreground"},Object(ae.a)().GradingView_Title.format(this.state.Form.getTitle())),oe.createElement("div",{className:"gradingGradingModeSwitcherNavBar"},oe.createElement("div",{className:"gradingGradingModeSwitcherNavBarModeContainer",role:"tablist"},s,a)))},n.kA=function(t,e,n){t.stopPropagation(),t.preventDefault();var i=e.current,r=n.current;r&&(r.focus(),r.getHtmlElement().setAttribute("tabindex","0"),i.getHtmlElement().setAttribute("tabindex","-1"))},n.pA=function(t){return(t=Et.isUndefined(t)?this.state.Form:t)?this.state.GradingMode===ys.ByStudent.View?e.findNextUngradedAnswerForStudentView(t,this.state.CurrentIndexForStudentView,this.OA):e.findNextUngradedAnswerForQuestionView(t,this.state.CurrentIndexForQuestionView,this.OA):null},n.xA=function(t){this.state.GradingMode===ys.ByStudent.View?this.FA(t):this.PA(t)},n.CA=function(){var t=this;return this.state.hasUngradedQuestions?this.TA({HTMLAttributes:{className:"gradingTextButton gradingNextUngradedButton office-form-theme-button",onClick:function(){var e=t.pA();t.xA(e),Object(g.b)("Grading.NextUngraded.Click")}},ButtonStyle:"LightBackground",Text:Object(ae.a)().GradingView_NextUngraded_ButtonLabel}):this.TA({HTMLAttributes:{className:"gradingTextButton gradingNextUngradedButton office-form-theme-button",disabled:!0},ButtonStyle:"DarkBackGround",Text:Object(ae.a)().GradingView_NextUngraded_ButtonLabel})},n.FA=function(t){null!=t&&(t.ViewElementIndex!==this.state.CurrentIndexForStudentView?(this.uA=t.GradeBoxIndex,this.NA(!1)(t.ViewElementIndex)):this.wA(t.GradeBoxIndex))},e.findNextUngradedAnswerForStudentView=function(t,n,i){var r=t.getResponses().length-1,o=i+1,s=e.findNextUngradedAnswerForStudentViewInInterval(t,n,r,o);return null!==s?s:e.findNextUngradedAnswerForStudentViewInInterval(t,0,n,0)},e.findNextUngradedAnswerForStudentViewInInterval=function(t,n,i,r){for(var o=t.getResponses(),s=n;s<=i;s++){var a=o[s];if(a){var c=s===n?r:0,u=new $l(t,a),l=e.findNextUngradedAnswerForStudent(u,c);if(null!==l)return{ViewElementIndex:s,GradeBoxIndex:l}}}return null},e.findNextUngradedAnswerForStudent=function(t,e){for(;t.hasNext();){var n=t.next();if(n)if(n.answerRenderOrderIndex>=e&&n.question.IsQuiz&&Rl(n.answer))return n.answerRenderOrderIndex}return null},n.PA=function(t){null!=t&&(t.ViewElementIndex!==this.state.CurrentIndexForQuestionView?(this.uA=t.GradeBoxIndex,this.SA(!1)(t.ViewElementIndex)):this.wA(t.GradeBoxIndex))},e.findNextUngradedAnswerForQuestionView=function(t,n,i){var r=t.getQuestions().filter((function(t){return!t.GroupId})).length-1,o=i+1,s=e.findNextUngradedAnswerForQuestionViewInInterval(t,n,r,o);return null!==s?s:e.findNextUngradedAnswerForQuestionViewInInterval(t,0,n,0)},e.findNextUngradedAnswerForQuestionViewInInterval=function(t,n,i,r){for(var o=Et.filter(t.getQuestions(),(function(t){return!t.GroupId})),s=n;s<=i;s++){var a=o[s],c=Object(zl.c)(t,a.Id);if(a&&a.IsQuiz){var u=s===n?r:0,l=void 0;if(Hl(a)){var h=_l(t.getResponses(),c);l=new ql(h)}else l=new Ul(t,a.Id);var f=e.findNextUngradedAnswerForQuestion(l,u);if(null!==f)return{GradeBoxIndex:f,ViewElementIndex:s}}}return null},e.findNextUngradedAnswerForQuestion=function(t,e){for(;t.hasNext();){var n=t.next();if(n.answerRenderOrderIndex>=e&&Rl(n.answer))return n.answerRenderOrderIndex}return null},n.NA=function(t){var e=this;return void 0===t&&(t=!0),function(n){t&&(e.vA(),e.lA=!0),e.setState({CurrentIndexForStudentView:n}),Dl((function(t){var i=t.Model.Grading;t.Model.Grading={View:e.state.GradingMode,Index:n,GoBackToView:i.GoBackToView}}))}},n.SA=function(t){var e=this;return void 0===t&&(t=!0),function(n){t&&(e.vA(),e.lA=!0),e.setState({CurrentIndexForQuestionView:n}),Dl((function(t){var i=t.Model.Grading;t.Model.Grading={View:e.state.GradingMode,Index:n,GoBackToView:i.GoBackToView}}))}},n.Oe=function(t){Object(Y.c)("QuizReviewLogicUpgrade")?this.gA():this.forceUpdate()},n.TA=function(t,e){return void 0===e&&(e=function(t){}),t.HTMLAttributes=Et.extend({onMouseDown:function(t){t.target.classList.add("mouseDown-active"),e(!0)},onBlur:function(t){t.target.classList.remove("mouseDown-active"),e(!1)}},t.HTMLAttributes),Object(Gi.b)(t)},e}(Ml),Fh=function(t){function e(e){var n=t.call(this,e)||this;return n.DA=oe.createRef(),n.MA=oe.createRef(),n.LA=oe.createRef(),n.state={isReadyToRender:!1,releasedResponseSortBy:"Status",releasedResponseIsSortAscending:!1,unreleasedResponseSortBy:"Status",unreleasedResponseIsSortAscending:!1,checkedReponseIds:{},checkedAll:!1,releasedResponseIds:[],shouldShowInfoBar:!1,Form:new Al(e.FormMaster),isMounted:!0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.state.Form;this.setState({isMounted:!0}),e.ensureReadyToGrade().then((function(){e.calculateBranchedResponses(),t.setState({isReadyToRender:!0,releasedResponseIds:Object(Ll.e)(e).map((function(t){return t.Id}))}),Object(g.b)("Grading.ResultsView.Initial")})).catch((function(t){Dl((function(e){return e.Model.CriticalError=t}))}))},n.componentDidMount=function(){jh(),this.setState({isMounted:!0})},n.componentWillUnmount=function(){this.setState({isMounted:!1})},n.renderView=function(){if(!this.state.isReadyToRender)return oe.createElement("div",{className:"gradingReleaseResultsView gradingViewContainer"},Pl());this.state.Form.calculateBranchedResponses();var t=this.Me(),e=this.AA(),n=this.RA(),i=this.EA();return oe.createElement("div",{className:"gradingReleaseResultsView gradingViewContainer"},this.includeTheme(),t,e,n,i)},n.BA=function(){var t=this.state.Form,e=this.state.releasedResponseIds.slice(),n=this.state.checkedReponseIds;for(var i in n)if(n.hasOwnProperty(i)&&n[i]){var r=Number(i);Et.isNumber(r)&&(e.push(r),t.markAsReleased(r),Object(g.b)("Grading.ResultsView.ReleaseIndividualResult",{responseId:i}))}this.setState({checkedAll:!1,checkedReponseIds:{},releasedResponseIds:e}),Object(g.b)("Grading.ResultsView.ReleaseResults",{anyManuallyGradedResults:Object(Ll.k)(t),isFormFullyReleased:Object(Ll.n)(t)})},n._A=function(){var t=this,e=!1,n=this.state.checkedReponseIds;if(!Et.isEmpty(n))for(var i in this.state.checkedReponseIds)n.hasOwnProperty(i)&&n[i]&&(e=!0);var r=function(){return t.BA()},o=!1;return e||(r=eh,o=!0),Object(Gi.b)({HTMLAttributes:{className:"office-form-theme-button gradingTextButton",onClick:r,disabled:o},ButtonStyle:"LightBackground",Text:Object(ae.a)().GradingView_ReleaseResultButton_Label})},n.Me=function(){var t=this.state.Form,e=Object(ae.a)().GradingView_ReleaseResultViewTitle_LabelFormat.format(t.getTitle());return oe.createElement("div",{className:"gradingReleaseResultTitleBarContainer"},oe.createElement("div",{className:"gradingReleaseResultTitle gradingTitle office-form-theme-primary-foreground"},e),oe.createElement("div",{className:"gradingReleaseResultButtonGroup"},this.HA(),this._A()))},n.HA=function(){var t=this;return Object(yn.a)({HTMLAttributes:{className:"gradingReleaseResultInfoButton office-form-theme-primary-foreground",onClick:function(){var e=t.state.shouldShowInfoBar;t.setState({shouldShowInfoBar:!e}),Object(g.b)("Grading.ReleaseView.PostScoresInfoBar",{showInfoBar:!e})}},GlyphButtonStyle:"GlyphOnly",Icon:"Help",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().GradingView_ReleaseResultInfoButton_Label,ref:function(e){return t.GA=Ln.findDOMNode(e)}})},n.AA=function(){var t=this;if(this.state.shouldShowInfoBar){var e=Object(ae.a)().GradingView_ReleaseResultFunctionalityDescription_Text,n=Object(yn.a)({HTMLAttributes:{className:"gradingReleaseResultInfoBarCloseButton",onClick:function(){t.setState({shouldShowInfoBar:!1}),Object(g.b)("Grading.ReleaseView.PostScoresInfoBar",{showInfoBar:!1}),t.GA.focus()}},GlyphButtonStyle:"GlyphOnly",Icon:"Cancel",IconClassName:"forms-icon-size14x14",Text:Object(ae.a)().Common_Close_Text}),i=oe.createElement("div",{className:"gradingReleaseResultInfoBarTriangle"});return oe.createElement("div",{className:"gradingReleaseResultInfoBar",tabIndex:0,ref:function(t){t&&t.focus()}},e,n,i)}},n.EA=function(){var t=this.state.Form.getResponses().map((function(t,e){return{response:t,index:e}})),e=this.state.releasedResponseIds,n=this.qA(!0,t.filter((function(t){return-1!==e.indexOf(t.response.Id)})));if(!n||0===n.length)return oe.createElement("div",null);var i=this.QA(!0),r=this.VA(!0),o=this.zA(n);return oe.createElement("div",null,i,oe.createElement("div",{className:"gradingReleaseResultTableContainer"},r,o))},n.RA=function(){var t=this.state.Form.getResponses().map((function(t,e){return{response:t,index:e}})),e=this.state.releasedResponseIds,n=this.qA(!1,t.filter((function(t){return-1===e.indexOf(t.response.Id)})));if(!n||0===n.length)return oe.createElement("div",null);var i=this.QA(!1),r=this.VA(!1),o=this.zA(n);return oe.createElement("div",null,i,oe.createElement("div",{className:"gradingReleaseResultTableContainer"},r,o))},n.QA=function(t){var e=t?Object(ae.a)().GradingView_ReleasedResponseTableTitle_Label:Object(ae.a)().GradingView_UnreleasedResponseTableTitle_Label;return oe.createElement("div",{className:"gradingReleaseResultTableTitle"},e)},n.UA=function(t){var e,n;return"SortDown"===t&&(e=Object(ae.a)().Accessibility_SortColumnAscending,n="descending"),"Sort"===t&&(e=Object(ae.a)().Accessibility_SortColumnToggleButton_Label+" "+Object(ae.a)().Accessibility_SortColumnAscending,n=void 0),"SortUp"===t&&(e=Object(ae.a)().Accessibility_SortColumnDescending,n="ascending"),{label:Object(ae.a)().Common_Points_Text+": "+e,sort:n}},n.$A=function(t){if(t){if("Points"===this.state.releasedResponseSortBy)return this.state.releasedResponseIsSortAscending?"SortDown":"SortUp"}else if("Points"===this.state.unreleasedResponseSortBy)return this.state.unreleasedResponseIsSortAscending?"SortDown":"SortUp";return"Sort"},n.VA=function(t){var e=this,n=oe.createElement("div",{title:Object(ae.a)().GradingView_PostGrades_NameColumnDescription},Object(ae.a)().GradingView_NameColumn_Label,oe.createElement("span",{"aria-label":Object(ae.a)().GradingView_PostGrades_NameColumnDescription})),i=oe.createElement("a",{className:"screenReaderVisible"},Object(ae.a)().GradingView_PostGrades_PreviewColumnDescription),r=oe.createElement("div",{title:Object(ae.a)().GradingView_PostGrades_StatusColumnDescription},Object(ae.a)().GradingView_ReleaseResultsStatus_Label,oe.createElement("span",{"aria-label":Object(ae.a)().GradingView_PostGrades_StatusColumnDescription})),o=this.$A(t),s=this.UA(o),a=Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16",role:"presentation"},IconName:o}),c=Object(qo.b)({HTMLAttributes:{"aria-label":s.label,"aria-sort":s.sort,className:"gradingReleaseResultHeaderButton",onClick:function(){e.WA(t,"Points")}},ButtonStyle:"None",children:oe.createElement("div",null,oe.createElement("span",null,Object(ae.a)().Common_Points_Text),a)}),u=oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell"},i);if(t)return oe.createElement("div",{className:"gradingReleaseResultTableRow"},oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell"}),oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell","aria-label":"This column contains the name of students"},n),u,oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewStatusColumn"},r),oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewPointsColumn"},c));var l=this.state.checkedAll,h=Object(Lu.a)({Description:void 0,HelpText:Object(ae.a)().GradingView_PostGrades_SelectAllCheckbox_Description,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().GradingView_PostGrades_SelectAllCheckbox_Description}},Value:l,onValueChange:function(){var t=JSON.parse(JSON.stringify(e.state.checkedReponseIds));e.state.Form.getResponses().filter((function(t){return-1===e.state.releasedResponseIds.indexOf(t.Id)})).forEach((function(e){return t[e.Id]=!l})),e.setState({checkedReponseIds:t,checkedAll:!l})}});return oe.createElement("div",{className:"gradingReleaseResultTableRow"},oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewCheckBoxColumn"},h),oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell"},n),u,oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewStatusColumn"},r),oe.createElement("div",{className:"gradingReleaseResultTableCell gradingReleaseResultTableHeaderCell gradingResultViewPointsColumn"},c))},n.WA=function(t,e){t?this.state.releasedResponseSortBy===e?this.setState({releasedResponseIsSortAscending:!this.state.releasedResponseIsSortAscending}):this.setState({releasedResponseSortBy:e,releasedResponseIsSortAscending:!1}):this.state.unreleasedResponseSortBy===e?this.setState({unreleasedResponseIsSortAscending:!this.state.unreleasedResponseIsSortAscending}):this.setState({unreleasedResponseSortBy:e,unreleasedResponseIsSortAscending:!1})},n.zA=function(t){var e=this,n=this.state.Form;return t.map((function(t){var i,r=Object(Ll.d)(n,t.response.Id),o=Object(Ll.i)(n,t.response.Id);if(-1!==e.state.releasedResponseIds.indexOf(t.response.Id))return e.KA(3,t,o,r);var s=n.getQuestions().filter((function(t){return t.IsQuiz})),a=0,c=0;return Et.forEach(t.response.Answers,(function(t){null!=Et.find(s,(function(e){return t.QuestionId===e.Id}))&&(a++,null!=t.Score&&c++)})),i=a===c?2:0===c?0:1,e.KA(i,t,o,r)}))},n.qA=function(t,e){return t&&"Points"===this.state.releasedResponseSortBy?this.JA(e,this.state.releasedResponseIsSortAscending):t||"Points"!==this.state.unreleasedResponseSortBy?e:this.JA(e,this.state.unreleasedResponseIsSortAscending)},n.XA=function(t){var e=Object(Ll.i)(this.state.Form,t.Id),n=Object(Ll.d)(this.state.Form,t.Id);return 0!==n?e/n:0},n.JA=function(t,e){var n=this,i=t.slice();return e?i.sort((function(t,e){return n.XA(e.response)-n.XA(t.response)})):i.sort((function(t,e){return n.XA(t.response)-n.XA(e.response)})),i},n.KA=function(t,e,n,i){var r,o,s,a,c=this,u=this.state.checkedReponseIds[e.response.Id];if(3===t)r=null;else{var l=Object(ae.a)().GradingView_PostGrades_SelectStudentCheckbox_AccessibilityTextFormat.format(e.response.ResponderName),h={Value:!0===u,Description:void 0,HelpText:l,Options:{HTMLPropsForInnerElement:{"aria-label":l}},onValueChange:function(){var t=JSON.parse(JSON.stringify(c.state.checkedReponseIds));t[e.response.Id]=!u,c.setState({checkedReponseIds:t,checkedAll:!1})}};r=Object(Lu.a)(h)}switch(t){case 0:case 1:o="redText";break;case 3:case 2:o="greenText";break;default:o="blackText"}switch(t){case 3:s=Object(ae.a)().GradingView_ReleaseResultStatusReleased_Label;break;case 0:case 1:s=Object(ae.a)().GradingView_ReleaseResultStatusNeedsReview_Label;break;case 2:s=Object(ae.a)().GradingView_ReleaseResultStatusGraded_Label;break;default:s="unknown"}if(0===t)a=oe.createElement("span",{"aria-label":Object(ae.a)().GradingView_NoScore},void 0,[" "]);else{var f=n&&i?Math.round(n/i*100):0;a="{0} ({1}%)".format(n,f)}var d=function(t){return function(){Dl((function(n){n.Model.Grading={View:ys.ByStudent.View,Index:e.index,GoBackToView:ys.GoBackToReleaseResults},n.showTopView("Grading_ReviewAnswers",(function(){t.current&&t.current.focus()}))})),Object(g.b)("Grading.ResultsView.DeepLinkToStudent")}},b=Object(Bl.d)(e.response).name,m=oe.createElement("a",{href:"javascript:;",title:Object(ae.a)().GradingView_GoToStudentLink_LabelFormat.format(b),ref:this.DA,"aria-label":Object(ae.a)().GradingView_GoToStudentLink_LabelFormat.format(b),onClick:d(this.DA),className:"goToStudentLink"},oe.createElement("span",null,b)),v=oe.createElement("a",{href:"javascript:;",title:Object(ae.a)().GradingView_GoToStudentLink_LabelFormat.format(b),ref:this.MA,"aria-label":Object(ae.a)().GradingView_PostGrades_ResponseStatus_AccessibilityLabelFormat.format(b,s),onClick:d(this.MA),className:"goToStudentLink"},oe.createElement("span",{className:o},s)),O=oe.createElement("a",{href:"javascript:;",ref:this.LA,title:Object(ae.a)().Common_Preview_Text,"aria-label":Object(ae.a)().GradingView_PostGrades_PreviewLink_AccessibilityLabelFormat.format(b),onClick:function(){Dl((function(t){t.Model.Preview={PreviousTopView:"Grading_PostGrades",ResponseIndex:e.index},t.showTopView("Preview",(function(){c.LA.current&&c.LA.current.focus()}))})),Object(g.b)("Grading.ResultsView.LinkToStudentPreview")},className:"goToStudentLink"},Object(ae.a)().Common_Preview_Text),p=oe.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewPreviewColumn"},O);return oe.createElement("div",{className:"gradingReleaseResultTableRow",key:e.response.Id},oe.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewCheckBoxColumn"},r),oe.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewResponderColumn"},ph({response:e.response}),oe.createElement("span",{className:"gradingReleaseResultResponderName"},m)),p,oe.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewStatusColumn"},v),oe.createElement("div",{className:"gradingReleaseResultTableCell gradingResultViewPointsColumn"},oe.createElement("span",null,a)))},e}(Ml);function Ph(){return Object(S.__awaiter)(this,void 0,void 0,(function(){var t;return Object(S.__generator)(this,(function(e){switch(e.label){case 0:return Object(Y.c)("EnableMoreResponseNav")?[4,n.e(124).then(n.bind(null,1132))]:[3,2];case 1:return t=e.sent(),[3,4];case 2:return[4,n.e(123).then(n.bind(null,1135))];case 3:t=e.sent(),e.label=4;case 4:return[2,{default:t.SurveyIndividualViewContainer}]}}))}))}function Dh(t){var e=Object(Pi.a)(Dh,Ph);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}var Mh=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.VI=n.VI.bind(n),n.props.FormMaster.observe(n.VI,[Zt.a.Schema.ReputationTier]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.props.FormMaster.ensureFieldsReady([Zt.a.Schema.Settings,Zt.a.Schema.ReputationTier]).then((function(){t.ce&&t.setState({IsFormSettingsReady:!0,ReputationTier:t.props.FormMaster.Model.ReputationTier})}))},n.componentWillUnmount=function(){this.props.FormMaster.unobserve(this.VI),this.ce=!1},n.renderView=function(){return this.state.IsFormSettingsReady?oe.createElement("div",{className:"surveyResultsView"},oe.createElement("div",{className:"surveyResultsTitle office-form-theme-primary-foreground",role:"heading","aria-level":1},Object(ae.a)().AnalyzeView_ViewResultsButton_Label),oe.createElement("div",{id:"analyzeViewPrintParent",ref:"analyzeContainer"},oe.createElement("div",{id:"analyzeViewPrintChild",className:"analyze-view-container results-view-container"},Dh({FormMaster:this.props.FormMaster}))),this.ZA()):oe.createElement("div",null)},n.ZA=function(){if(Object(Oo.d)(this.state.ReputationTier)&&Object(b.d)()&&this.props.FormMaster.SyncContext===ro.a.DesignTimeForm)return Object(xi.b)({formId:this.props.FormMaster.Model.Id})},n.VI=function(){this.setState({ReputationTier:this.props.FormMaster.Model.ReputationTier})},e}(Ml);function Lh(t){var e,n,i,r=t.FormMaster;switch(t.TopView){case"Grading_ReviewAnswers":return e=r,n=t.Grading,i={FormMaster:e,UxState:n,key:"grading-"+e.getInstanceId()},oe.createElement(xh,Object(S.__assign)({},i));case"Grading_PostGrades":return function(t){var e={FormMaster:t,key:"grading-release-result-"+t.getInstanceId()};return oe.createElement(Fh,Object(S.__assign)({},e))}(r);case"SurveyResults":return function(t){var e={Form:new Al(t),FormMaster:t,key:"suvey-result-"+t.getInstanceId(),TopViewTitle:Object(ae.a)().AnalyzeView_ViewResultsButton_Label};return oe.createElement(Mh,Object(S.__assign)({},e))}(r)}}var Ah=function(t){function e(e){var n=t.call(this,e)||this;return n.YA=n.YA.bind(n),n.state={IsToggleEnable:!1,SuggestionEmailState:!0,UserFeatureSettingsData:null},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(Ti.a)().then((function(e){t.setState({IsToggleEnable:!0,SuggestionEmailState:"true"===e.Items.FormsEmailNotifications.toString(),UserFeatureSettingsData:e})})).catch((function(){}))},n.render=function(){var t=this.state.SuggestionEmailState?Object(ae.a)().Intelligence_EmailAssistant_Toggle_State_False:Object(ae.a)().Intelligence_EmailAssistant_Toggle_State_True,e=Object(Bu.a)({Disabled:!this.state.IsToggleEnable,HTMLAttributes:{className:"intelligence-email-assistant-setting-pane-toggle-item-title"},Label:t,onValueChange:this.YA,Options:{classNameForInnerDiv:"setting-pane-toggle-button"},Value:!this.state.SuggestionEmailState});return oe.createElement("div",{className:"intelligence-email-assistant-preference"},oe.createElement("div",{className:"intelligence-email-assistant-Introduction"},oe.createElement("div",{className:"intelligence-email-assistant-title"},Object(ae.a)().Intelligence_EmailAssistant_Title),oe.createElement("div",{className:"intelligence-email-assistant-description"},Object(ae.a)().Intelligence_EmailAssistant_Description)),oe.createElement("hr",{className:"intelligence-email-assistant-hr"}),oe.createElement("div",{className:"intelligence-email-assistant-setting"},oe.createElement("div",{className:"intelligence-email-assistant-setting-item"},oe.createElement("div",{className:"intelligence-email-assistant-setting-item-title"},Object(ae.a)().Intelligence_EmailAssistant_Suggestion_Setting_Title),e,oe.createElement("div",{className:"intelligence-email-assistant-setting-item-tip"},Object(ae.a)().Intelligence_EmailAssistant_Suggestion_Setting_Tip))))},n.YA=function(){var t=this,e=this.state.UserFeatureSettingsData;e.Items.FormsEmailNotifications=!this.state.SuggestionEmailState,Object(Ti.e)(e).then((function(){t.setState({SuggestionEmailState:!t.state.SuggestionEmailState,UserFeatureSettingsData:e})}))},e}(ue.a),Rh=n(224),Eh=function(t){function e(e){var n=t.call(this,e)||this;return n.state={PrivacyUrl:"https://go.microsoft.com/fwlink/?LinkId=521839",ProTermUrl:"https://go.microsoft.com/fwlink/p/?linkid=2064713"},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;Object(ii.c)().then((function(e){return t.setState({PrivacyUrl:e||""})}))},n.render=function(){var t=this,e=Object(at.c)((function(){return t.state.PrivacyUrl}),at.f),n={className:"portal-footer-link",onClick:function(){return Object(Rn.a)(e)}},i=Object(at.c)((function(){return Object(u.a)().userInfo.IsMsa?Object(Gc.c)():Object(Gc.b)()}),at.f),r={className:"portal-footer-link",onClick:function(){return Object(Rn.a)(i)}},o=Object(at.c)((function(){return"/Third_Party_Notices.txt"}),at.f),s={className:"portal-footer-link",onClick:function(){return Object(Rn.a)(o)}},a={className:"portal-footer-link",onClick:function(){return Object(Rn.a)(Object(ii.a)())}};return oe.createElement("div",{className:"portal-footer",role:"contentinfo"},oe.createElement("div",null,oe.createElement("button",Object(S.__assign)({},s),Object(ae.a)().Legal_Third_Party),oe.createElement("button",Object(S.__assign)({},r),Object(ae.a)().Legal_TermsOfService),oe.createElement("button",Object(S.__assign)({},n),Object(ae.a)().Form_Footer_PrivacyStatement),Object(v.t)()&&oe.createElement("button",Object(S.__assign)({},a),Object(Rh.b)(Object(ae.a)())),oe.createElement("div",Object(S.__assign)({},{className:"portal-footer-link"}),Object(ae.a)().Legal_Copyright.format(Object(u.a)().copyRightYear))))},e}(ue.a),Bh=function(t){function e(e){return t.call(this,e)||this}return Object(S.__extends)(e,t),e.prototype.render=function(){var t=oe.createRef();return oe.createElement("div",{className:"user-feature-settings-container"},oe.createElement(Ah,null),oe.createElement(Eh,{ref:t}))},e}(ue.a);var _h=function(t){function e(e){var n=t.call(this,e)||this;n.Ti=void 0,n.tR=oe.createRef(),n.eR=function(){return n.nR()};var i=Object(_t.b)();return i.observe(n.eR,[i.Schema.FormMaster]),n.nR(),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.Rv&&this.Rv.unobserve(this.eR),Object(_t.b)().unobserve(this.eR),window.clearTimeout(this.Ti)},n.render=function(){return this.state.ShowMessageBar?oe.createElement("div",{ref:this.tR,className:"error-message-bar auto-saving-message-bar"},oe.createElement("div",{className:"error-message-bar-message"},oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size14x14 error-message-bar-warning-icon auto-saving-message-bar-warning-icon"},IconName:"CloudUpload",key:"warningIcon"}),this.props.Message)):null},n.nR=function(){var t=this,e=Object(_t.b)().Model.FormMaster;if(e!==this.Rv&&(e&&e.observe(this.eR,[e.Schema.IntegratedSavingState]),this.Rv&&this.Rv.unobserve(this.eR),this.Rv=e),this.Rv)if("Saving"===this.Rv.Model.IntegratedSavingState){window.clearTimeout(this.Ti),this.Ti=window.setTimeout((function(){Object(Ht.a)().RetryingRecoverableError&&t.iR()}),1e4)}else this.rR();else this.rR()},n.iR=function(){var t=this;this.setState({ShowMessageBar:!0},(function(){return $(t.tR.current).stop().fadeIn("fast")}))},n.rR=function(){var t=this;Object(Ht.a)().RetryingRecoverableError=!1,window.clearTimeout(this.Ti),$(this.tR.current).stop().fadeOut("slow",(function(){t.setState({ShowMessageBar:!1})}))},e}(ue.a);function Hh(){Object(g.b)("DesignPage.AppLauncher.RenderShellData"),$("#formLauncher").removeClass("SwitcherLoading"),Gh()}function Gh(){var t=$(".o365cs-nav-appTile")[0]||$(".swBar");t&&t.focus()}function qh(t){"undefined"==typeof O365Shell?setTimeout((function(){qh(t)}),1e3,t):(Object(g.b)("DesignPage.AppLauncher.LoadShellData",{O365Shell:"O365 JS now available so start rendering shell"}),O365Shell.SetData($.parseJSON(t)),O365Shell.RenderAsync({launcher:"formLauncher",switcher:"formLauncher"},Hh,(function(){})))}var Qh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.oR=1,e.state={LoadingStatus:0,ShowMenu:!1},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this;this.collapseAppLauncher=this.collapseAppLauncher.bind(this),Object(u.a)().userInfo.IsMsa?function(t,e){var n=0;Object(g.b)("DesignPage.AppLauncher.GetConsumerShellServiceInfo",{O365Shell:"Getting Shell info needed to get O365 Consumer Shell JS and CSS"});var i=we.a.getInstance().createDataProvider(),r=Object(u.a)().cultureInfo.Name,o=function(t){try{for(var e=new Object,n=0;n<t.resourceKeys.length;n++)e[t.resourceKeys[n]]=t.resourceUrls[n];var i=$("<link href='"+e.shellg2coremincss+"' rel='stylesheet' type='text/css' charset='UTF-8' />");$(document.head).append(i),$.getScript(e.msajax,(function(){$.getScript(e.shellg2strings,(function(){$.getScript(e.shellcoreming2m,(function(){$.getScript(e.shellconsumerdata,(function(){try{var n={UPN:t.upn,UID:Object(u.a)().userInfo.PUID,Culture:r,WorkloadId:"OfficeForms",Resources:e},i=ConsumerShellDataGenerator.GetConsumerData(n);qh(JSON.stringify(i))}catch(t){Object(g.c)("ShellServiceGetDataFailure")}}))}))}))}))}catch(t){Object(g.c)("ShellServiceGetDataFailure")}},s=function(a){n++<e?i.getConsumerShellServiceInfo(r).then(o).catch(s):(t(),Object(g.c)("ShellServiceGetDataFailure",a))};i.getConsumerShellServiceInfo(r).then(o).catch(s)}((function(){t.setState({LoadingStatus:1})}),this.oR):function(t,e){var n=0;Object(g.b)("DesignPage.AppLauncher.GetConsumerShellServiceInfo",{O365Shell:"Getting Shell info needed to get O365 Shell JS and CSS"});var i=we.a.getInstance().createDataProvider(),r=Object(u.a)().cultureInfo.Name,o=function(t){try{if(t.cssUrl&&t.jsUrl&&t.navBarDataJson){var e=$("<link href='"+t.cssUrl+"' rel='stylesheet' type='text/css' charset='UTF-8' />");$(document.head).append(e);var n=$("<script src='"+t.jsUrl+"' type='text/javascript'><\/script>");n.ready((function(){return qh(t.navBarDataJson)})),$(document.head).append(n)}else Object(g.b)("DesignPage.AppLauncher.LoadError",{css:t.cssUrl,js:t.jsUrl,data:t.navBarDataJson})}catch(t){Object(g.c)("ShellServiceGetDataFailure")}},s=function(a){n++<e?i.getShellServiceInfo(r).then(o).catch(s):(t(),Object(g.c)("ShellServiceGetDataFailure",a))};i.getShellServiceInfo(r).then(o).catch(s)}((function(){t.setState({LoadingStatus:1})}),this.oR)},n.render=function(){var t=this,e={HTMLAttributes:{className:"headbar-waffle","aria-haspopup":"true","aria-expanded":Object(at.c)((function(){}),at.f),onClick:function(){return t.sR()}},ButtonStyle:"DarkBackGround",GlyphButtonStyle:"GlyphOnly",Icon:"Waffle",IconClassName:"headbar-waffle-icon",Text:Object(ae.a)().HeaderBar_AppSwitcher,ref:"appLauncherButton"};return oe.createElement("div",{className:"headbar-waffle-container"},Object(yn.a)(e),this.aR())},n.collapseAppLauncher=function(t){if(this.state.ShowMenu){var e=t.target,n=t,i=Ln.findDOMNode(this.refs.formLauncher),r=Ln.findDOMNode(this.refs.appLauncherButton);(n&&27===n.keyCode||i&&!i.contains(e)&&r&&!r.contains(e))&&this.cR()}},n.cR=function(){var t=Ln.findDOMNode(this.refs.formLauncher);$(t).addClass("hide"),this.state.ShowMenu=!1,this.props.AppLauncherCollapseTrigger&&this.props.AppLauncherCollapseTrigger.unregister(this.collapseAppLauncher),1===this.state.LoadingStatus&&this.setState({ShowMenu:this.state.ShowMenu})},n.sR=function(){var t=Ln.findDOMNode(this.refs.formLauncher);this.state.ShowMenu?($(t).addClass("hide"),this.props.AppLauncherCollapseTrigger&&this.props.AppLauncherCollapseTrigger.unregister(this.collapseAppLauncher)):($(t).removeClass("hide"),Gh(),this.props.AppLauncherCollapseTrigger&&this.props.AppLauncherCollapseTrigger.register(this.collapseAppLauncher)),this.state.ShowMenu=!this.state.ShowMenu,1===this.state.LoadingStatus&&this.setState({ShowMenu:this.state.ShowMenu})},n.aR=function(){var t={className:"swBar SwitcherLoading UnifiedHeader O365Switcher hide",id:"formLauncher",ref:"formLauncher",tabIndex:-1};return 0===this.state.LoadingStatus?oe.createElement("div",Object(S.__assign)({},t),oe.createElement("span",{className:"swLoadingText"},Object(ae.a)().Common_Loading_Text),oe.createElement("span",{className:"border-arrow arrow"}),oe.createElement("span",{className:"arrow"})):(this.state.ShowMenu&&(t.className="swBar SwitcherError UnifiedHeader O365Switcher"),oe.createElement("div",Object(S.__assign)({},t),oe.createElement("span",{className:"swLoadingErrorText"},oe.createElement("span",{className:"swErrorTitle"},Object(ae.a)().Error_Page_DefaultErrorTitle),oe.createElement("br",null),oe.createElement("span",{className:"swErrorBody"},Object(ae.a)().Common_Try_again_Text)),oe.createElement("span",{className:"border-arrow arrow"}),oe.createElement("span",{className:"arrow"})))},e}(ue.a),Vh=function(t){function e(e){var n=t.call(this,e)||this;n.ce=!0,n.updateReputationTier=n.updateReputationTier.bind(n);var i=n.props.Form;return i&&i.observe(n.updateReputationTier,[i.Schema.ReputationTier]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.updateReputationTier(),this.updateIsRestrictedUser()},n.componentWillUnmount=function(){var t=this.props.Form;t&&t.unobserve(this.updateReputationTier),this.ce=!1},n.render=function(){return oe.createElement("div",{className:"headbar-button-container"},this.createButton(),this.createFirstRunCallout())},n.createFirstRunCallout=function(){return this.props.FirstRunCallout},n.onClickHeadBarButton=function(){this.props.onClick(),Object(Ei.c)().Model.SendTeachingCalloutVersion=_i.a.toString(),Object(Ei.c)().Model.ThemeSuggestCalloutVersion=_i.a.toString()},n.updateReputationTier=function(){var t=this,e=this.props.Form;e&&e.fieldsReady([e.Schema.ReputationTier]).then((function(){var n=e&&e.Model&&e.Model.ReputationTier||1;t.ce&&t.setState({ReputationTier:n})}))},n.updateIsRestrictedUser=function(){var t=this;Object(Ti.c)().then((function(e){t.setState({IsRestrictedUser:4===e})}))},e}(ue.a),zh=function(t){function e(e){var n=t.call(this,e)||this;return n.Nt=oe.createRef(),n.state={ReputationTier:1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.focus=function(){this.Nt.current&&this.Nt.current.focus()},n.createButton=function(){return Object(yn.a)({ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Horizontal",HTMLAttributes:{className:"headbar-button",disabled:Object(Oo.e)(this.state.ReputationTier),onClick:this.onClickHeadBarButton.bind(this)},Icon:"View",IconClassName:Object(Z.b)()?"forms-icon-size16x16":"forms-icon-size18x18",ref:this.Nt,Text:Object(ae.a)().Common_Preview_Text,TextClassName:"headbar-button-text"})},e}(Vh),Uh=function(t){function e(e){var n=t.call(this,e)||this;return n.uR=oe.createRef(),n.lR=oe.createRef(),n.state={ReputationTier:1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.focus=function(){Object(Z.b)()&&this.uR.current?this.uR.current.focus():this.lR.current&&this.lR.current.focus()},n.createButton=function(){var t={"aria-expanded":this.props.Active,className:"headbar-button headbar-share-button",disabled:Object(Oo.d)(this.state.ReputationTier),onClick:this.onClickHeadBarButton.bind(this)},e=Object(u.a)().userInfo.IsMsa?Object(ae.a)().DesignPage_NavBar_Sendform:Object(ae.a)().DesignPage_NavBar_Shareform;if(Object(Z.b)())return Object(yn.a)({ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Horizontal",HTMLAttributes:t,Icon:"Share",IconClassName:"forms-icon-size16x16",ref:this.uR,Text:e,TextClassName:"headbar-button-text"});t.className=Object(pn.b)(t.className,"highlighted");var n={HTMLAttributes:t,ref:this.lR,Text:e};return oe.createElement(Gi.a,Object(S.__assign)({},n))},e}(Vh),$h=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.state={HasSuggestion:!1},n.hR=n.hR.bind(n),n.fR=n.fR.bind(n),n.dR=n.dR.bind(n),Object(Ei.c)().observe(n.hR,[Ei.b.Schema.ThemeSuggestCalloutVersion]),n.props.ThemeSuggestion.observe(n.fR,[Vr.a.Schema.suggestions]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.ce=!1,Object(Ei.c)().unobserve(this.hR),this.props.ThemeSuggestion.unobserve(this.fR)},n.componentWillUpdate=function(t,n){if(n.HasSuggestion){var i=Object(Ei.c)().Model;Object(Ei.d)(i.SendTeachingCalloutVersion)&&Object(Ei.d)(i.ThemeSuggestCalloutVersion)&&(i.SendTeachingCalloutVersion=_i.c.toString())}else this.state.HasSuggestion&&e.resetSendIfWaitRun()},n.render=function(){var t=Object(Ei.c)().Model;return this.state.HasSuggestion&&Object(Ei.d)(t.ThemeSuggestCalloutVersion)?(e.logData("Intelligence.Theme.ShowCallout"),this.bR("teachingCallout-theme","teachingCallout-theme-direction")):null},n.hR=function(){this.forceUpdate()},n.fR=function(){if(this.ce){var t=this.props.ThemeSuggestion.Model.suggestions;t&&t.length>0?this.setState({HasSuggestion:!0}):this.setState({HasSuggestion:!1})}},n.bR=function(t,e){var n=Object(ae.a)().Designer_Intelligence_Theme_Callout_Title,i=Object(ae.a)().Designer_Intelligence_Theme_Callout_Subtitle,r=Object(Un.b)({HTMLAttributes:{className:"theme-icon"},IconName:"LightningBolt"}),o=oe.createElement("div",{className:"theme-teaching-callout-header"},oe.createElement("div",{className:"theme-teaching-calllout-title-wrapper"},oe.createElement("div",{className:"theme-teaching-callout-icon"},r),oe.createElement("div",{className:"theme-teaching-callout-text"},n)),oe.createElement("div",{className:"theme-teaching-callout-subtitle"},i)),s=Object(_i.e)(this.dR),a=Object(_i.f)(Object(On.b)("/Images/theme-suggest.gif"));return Object(_i.d)(o,a,s,t,e)},n.dR=function(){Object(Ei.c)().Model.ThemeSuggestCalloutVersion=Ei.a.toString(),e.resetSendIfWaitRun(),this.props.closeCallback&&this.props.closeCallback(),e.logData("Intelligence.Theme.CloseCallout")},e.resetSendIfWaitRun=function(){var t=Object(Ei.c)().Model;Object(_i.i)(t.SendTeachingCalloutVersion)&&(t.SendTeachingCalloutVersion=_i.b.toString())},e.logData=function(t,e){Object(g.b)(t)},e}(ue.a),Wh=function(t){function e(e){var n=t.call(this,e)||this;if(n.Nt=oe.createRef(),n.Xp=500,n.state={HasSuggestion:!1,ReputationTier:1},n.mR=n.mR.bind(n),n.focus=n.focus.bind(n),n.tu=n.tu.bind(n),n.$p=n.$p.bind(n),n.lT=n.lT.bind(n),Object(Y.c)("PersonalContextSuggestion"))n.hT=Object(Bi.a)(n.props.Form),n.hT.observe(n.lT,[n.hT.Schema.SuggestionId]);else{var i=n.props.Form;i&&i.observe(n.$p,[i.Schema.Title])}return n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){if(Object(Y.c)("PersonalContextSuggestion"))this.hT.unobserve(this.lT);else{var t=this.props.Form;t&&t.unobserve(this.$p)}},n.componentDidMount=function(){Object(Y.c)("PersonalContextSuggestion")||this.tu(),this.updateReputationTier()},n.focus=function(){this.Nt.current&&this.Nt.current.focus()},n.createButton=function(){var t,e=Object(ae.a)().DesignPage_NavBar_Theme,n=0;if(this.props.Form.isFieldReady(Zt.a.Schema.ResponsesCount)&&(n=this.props.Form.Model.ResponsesCount),this.state.HasSuggestion&&!n){var i=Object(Un.b)({HTMLAttributes:{className:"themeLightIcon forms-icon-size12x12"},IconName:"LightningBolt"});e=Object(ae.a)().Designer_Intelligence_SuggestThemes_Tip,t=[oe.createElement("div",{className:"theme-headbar-button-icon-children",key:"theme-headbar-button-icon-children"},i)]}return Object(yn.a)({ButtonStyle:"DarkBackGround",children:t,GlyphButtonStyle:"Horizontal",HTMLAttributes:{"aria-expanded":this.props.Active,"aria-label":e,"aria-live":"polite",className:"headbar-button headbar-theme-button",disabled:Object(Oo.e)(this.state.ReputationTier),onClick:this.mR},Icon:"Color",IconClassName:Object(Z.b)()?"forms-icon-size16x16":void 0,ref:this.Nt,Text:Object(ae.a)().DesignPage_NavBar_Theme,TextClassName:"headbar-button-text"})},n.createFirstRunCallout=function(){var t=0;if(this.props.Form.isFieldReady(Zt.a.Schema.ResponsesCount)&&(t=this.props.Form.Model.ResponsesCount),this.props.Form&&!t){var e=Object(Vr.b)(this.props.Form.getInstanceId());if(e)return oe.createElement($h,{closeCallback:this.focus,ThemeSuggestion:e})}return null},n.mR=function(){this.state.HasSuggestion?this.vR("Intelligence.Theme.Navigate"):this.vR("Intelligence.Theme.NoSuggestion.Navigate"),this.onClickHeadBarButton()},n.$p=function(){this.gR&&window.clearTimeout(this.gR),this.gR=window.setTimeout(this.tu,this.Xp)},n.tu=function(){var t=this,e=this.props.Form;e&&e.fieldsReady([e.Schema.Title]).then((function(){mn.a.getThemeSuggestion(e&&e.Model.Title).then((function(n){if(n&&n.MatchQuery){var i=e,r=Object(Vr.b)(i.getInstanceId());r&&(r.Model.suggestions=n.ThemeCategories),n.ThemeCategories&&n.ThemeCategories.length>0?(t.state.HasSuggestion||t.vR("Intelligence.Theme.Idea.Track"),t.setState({HasSuggestion:!0})):t.setState({HasSuggestion:!1})}else t.setState({HasSuggestion:!1})}))}))},n.vR=function(t){var e=null;this.props.Form&&this.props.Form.isFieldReady(Zt.a.Schema.Settings)&&(e=this.props.Form.SettingMaster.Model.IsQuizMode),Object(g.b)(t,{HasSuggestion:this.state.HasSuggestion,IsQuiz:e})},n.lT=function(){var t=this.hT.getSuggestion("TitleSuggestsTheme");this.setState({HasSuggestion:!!t})},e}(Vh),Kh=function(t){function e(n){var i=t.call(this,n)||this;i.by=oe.createRef(),i.OR=!1,i.state={ShouldShowMultilingualEntryPoint:!1,ReputationTier:1},i.pR=i.pR.bind(i),i.jR=i.jR.bind(i),i.yR=i.yR.bind(i),i.wR=i.wR.bind(i),i.SR=i.SR.bind(i),i.NR=i.NR.bind(i),e.executeForHelpButton=e.executeForHelpButton.bind(i),e.executeForSignOutButton=e.executeForSignOutButton.bind(i),i.Oe=function(){return i.forceUpdate()},i.vl=Object(_t.b)().Model;var r=i.props.FormMaster;return r&&!r.isFieldReady(r.Schema.Settings)&&(i.OR=!0,r.observe(i.Oe,[r.Schema.Settings])),i.IR=i.IR.bind(i),r&&r.observe(i.IR,[r.Schema.ReputationTier]),i}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.CR()},n.componentWillUnmount=function(){var t=this.props.FormMaster;t&&this.OR&&t.unobserve(this.Oe)},n.render=function(){var t=this.props.FormMaster,n=[];if(t&&n.push(this.kR()),t&&this.state.ShouldShowMultilingualEntryPoint&&(!t.isFieldReady(Zt.a.Schema.Settings)||t.Model.Settings.IsQuizMode||Object(b.d)()||n.push(this.TR())),Object(Y.c)("PrintForm")&&n.push(this.xR()),n.push(oe.createElement(vo.a,{key:"line-breaker"},Object(mo.b)())),n.push(this.FR()),t&&n.push(e.createTermsItem()),!gi()){n.push(e.createHelpItem());var i=Object(u.a)().userInfo.DisplayName,r=Object(u.a)().userInfo.Email;(i||r)&&n.push(this.PR(i,r)),Object(et.a)()||n.push(e.createLogoutItem())}return oe.createElement(mo.a,{ButtonStyle:"DarkBackGround",MenuItemType:0,ClassName:"designer-more-options-menu",ClassNameForContainer:"headbar-button-container",HTMLAttributes:Zh(),onMenuExpand:Xh,ref:this.by},n)},n.xR=function(){return Jh(this.jR,"PrintForm",Object(ae.a)().DesignPage_NavBar_PrintForm,Object(Oo.e)(this.state.ReputationTier))},n.kR=function(){return Jh(this.yR,"Settings",Object(ae.a)().MoreOptionsMenu_Setting,Object(Oo.e)(this.state.ReputationTier))},n.TR=function(){return Jh(this.wR,"MultiLingual",Object(ae.a)().MoreOptionsMenu_Multilingual,Object(Oo.e)(this.state.ReputationTier))},n.FR=function(){return Jh(this.SR,"Feedback",Object(ae.a)().DesignPage_NavBar_Feedback)},e.createHelpItem=function(){return Jh(e.executeForHelpButton,"Help",Object(ae.a)().DesignPage_NavBar_Help)},e.createTermsItem=function(){return Jh(e.executeForTermsButton,"Terms",Object(ae.a)().Addin_Legal)},n.PR=function(t,e){return oe.createElement(vo.a,{onClick:this.NR,Active:!0,key:"userInfo"},oe.createElement("div",{className:"designer-more-options-menu-item"},t?oe.createElement("p",null,t):void 0,e?oe.createElement("p",null,e):void 0))},e.createLogoutItem=function(){return Jh(e.executeForSignOutButton,"SingOut",Object(ae.a)().MoreOptionsMenu_Sign_out)},n.pR=function(){this.vl.TopView="Branch",Object(g.b)("DesignPage.Menu.Branch")},n.jR=function(){var t=this;Object(g.b)("DesignPage.Menu.PrintForm");if(this.props.SetPrintViewState){this.props.SetPrintViewState(!0,(function(){setTimeout((function(){var e=document.createElement("style"),n=document.createTextNode("@page{size:unset;margin:0mm 5mm;}");e.appendChild(n),$(e).appendTo("head");var i=$("#content-root"),r=$("#reactshellheader"),o=$("#print-time-content");o.appendTo("body"),i&&i.hide(),r&&r.hide(),Object(et.c)((function(){o.appendTo("#content-root"),r.show(),i.show(),$(e).remove(),t.props.SetPrintViewState(!1)}))}),500)}))}},n.yR=function(){this.DR("Settings")},n.wR=function(){this.DR("MultiLingual")},n.SR=function(){this.DR("Feedback")},e.executeForHelpButton=function(){Object(g.b)("DesignPage.Help.Navigate");var t=Object(Rn.a)(Object(ii.b)(),"MicrosoftOfficeLyncWebAppHelp","width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes");t&&t.focus()},e.executeForTermsButton=function(){var t=Object(Rn.a)(Object(u.a)().userInfo.IsMsa?Object(Gc.c)():Object(Gc.b)(),"MicrosoftOfficeLyncWebAppHelp","width=400,height=500,menubar=no,status=no,scrollbars=no,titlebar=no,toolbar=no,resizable=yes");t&&t.focus()},n.NR=function(){Object(g.b)("DesignPage.Menu.UserInfo");var t=Object(v.n)();this.props.IsConsumerUserType&&(t=Object(v.d)()),Object(Z.b)()?Object(Rn.a)(t):Object(p.c)(t)},e.executeForSignOutButton=function(){Object(g.b)("DesignPage.Menu.SignOut"),Object(Ht.a)().AuthContext.signOut()},n.DR=function(t){var e,n=this,i=Object(_t.b)().Model.FlexPane===t?"None":t;switch("None"!==i&&Object(yr.f)("Flexpane-"+i,(function(){n.by.current&&n.by.current.focus()})),i){case"Feedback":e="DesignPage.Feedback.Navigate";break;case"Settings":e="DesignPage.Setting.Navigate";break;case"MultiLingual":e="DesignPage.MultiLingual.Navigate"}e&&Object(g.b)(e,{isSuiteHeader:gi(),source:"DesignPage.HeadBar"}),this.vl.FlexPane=i},n.IR=function(){var t=this,e=this.props.FormMaster;e&&e.fieldsReady([e.Schema.ReputationTier]).then((function(){var n=e&&e.Model&&e.Model.ReputationTier||0;t.setState({ReputationTier:n})}))},n.CR=function(){this.setState({ShouldShowMultilingualEntryPoint:Object(zc.e)()})},e}(ue.a);function Jh(t,e,n,i){return void 0===i&&(i=!1),oe.createElement(vo.a,{onClick:t,Active:!0,key:e,Disabled:i},oe.createElement("div",{className:"designer-more-options-menu-item"},oe.createElement("span",null,n)))}function Xh(){Object(g.b)("DesignPage.MoreOptionMenuClicked")}function Zh(){var t;return t=Object(Z.b)()?[oe.createElement("span",{className:"headbar-button-text",key:"moreButtonText"},Object(ae.a)().Designer_More_Button_Text),oe.createElement(Un.a,{IconName:"ChevronDown",HTMLAttributes:{className:"forms-icon-size12x12"},key:"moreButtonIcon"})]:oe.createElement(Un.a,{IconName:"More",HTMLAttributes:{className:"forms-icon-size20x20"}}),{"aria-label":Object(ae.a)().Common_More_Options_Text,children:t,className:"headbar-button",title:Object(ae.a)().Header_Bar_Menu_Tooltip}}var Yh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.MR=function(){e.forceUpdate(),e.props.form.unobserve(e.LR)},e.LR=function(t){e.props.form.isFieldReady(Zt.a.Schema.Questions)&&(!!(t.OldValues.Questions||[]).length!==!!t.Master.Model.Questions.length&&e.forceUpdate())},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){Object(Ei.c)().observe(this.MR,[Ei.b.Schema.SendTeachingCalloutVersion]),this.props.form.observe(this.LR,[Zt.a.Schema.Questions])},n.componentWillUnmount=function(){Object(Ei.c)().unobserve(this.MR),this.props.form.unobserve(this.LR)},n.render=function(){if(!Object(Ei.d)(Object(Ei.c)().Model.SendTeachingCalloutVersion))return null;var t=null;return this.props.form.isFieldReady(Zt.a.Schema.Questions)&&this.props.form.Model.Questions.length&&(t=this.bR("teachingCallout-send","teachingCallout-send-direction")),t},n.bR=function(t,e){var n=Object(ae.a)().FirstRun_Callout_ShareButton_Text,i=Object(_i.g)(n),r=Object(_i.e)((function(){Object(Ei.c)().Model.SendTeachingCalloutVersion=Ei.a.toString()})),o=Object(_i.f)(Object(On.b)("/Images/send-form.gif"));return Object(_i.d)(i,o,r,t,e)},e}(ue.a);var tf=function(t){function e(e){var n=t.call(this,e)||this;return n.AR=oe.createRef(),n.RR=oe.createRef(),n.ER=oe.createRef(),n.update=function(){return n.forceUpdate()},n.uxStateModel=Object(_t.b)().Model,n.state={UserType:0},ve().registerUsersStateChange(n.update),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(st.c)().then((function(e){t.setState({UserType:e})}))},n.componentWillUnmount=function(){ve().unregisterUsersStateChange(this.update)},n.render=function(){return oe.createElement("div",null,this.createHeadBar())},n.createHeadBar=function(){var t,e,n,i=this,r=Object(u.a)().isProPortal?Object(ae.a)().HeaderBar_FormsProAppTitle:Object(ae.a)().HeaderBar_AppTitle,o={className:"headbar-app-title",title:r,onClick:function(){return i.BR()}};if(Object(Z.b)()){t=Object(xr.a)({HTMLAttributes:{className:"headbar-app-title headerbar-app-tile-label segoeUISemilight"},Label:r})}else t=Object(Gi.b)({HTMLAttributes:o,Text:r,ButtonStyle:"DarkBackGround"});return Object(Z.b)()||(n={AppLauncherCollapseTrigger:this.props.AppLauncherCollapseTrigger},e=oe.createElement(Qh,Object(S.__assign)({},n))),oe.createElement("div",{className:"headbar-container",style:{display:this.props.ShouldDisabled?"none":void 0}},!gi()&&oe.createElement("div",{className:"headbar-left-content"},e,t),this._R())},n.BR=function(){var t=Object(_t.b)();t.bulkEdit((function(e){t.hideTopView(),e.FormId=void 0,e.FormMaster=void 0,e.CriticalError=void 0,e.Token=void 0,e.FormCollectionType="OwnedForms",e.SearchContent="",e.GroupMaster=void 0,Object(Hn.c)()})),Object(ni.d)(),this.forceUpdate()},n._R=function(){var t,e,n,i,r,o=!1,s=Object(_t.b)().Model.FormMaster;if(s&&(this.uxStateModel.FormId?s.isFieldReady(Zt.a.Schema.Id)&&s.Model.Id===this.uxStateModel.FormId&&(o=!0):o=!0),o&&!Object(Z.k)()){var a=ve().getUserCount(),c=ve().getUser(Object(u.a)().userInfo.UserId);if(1===a&&c&&c.userId===Object(u.a)().userInfo.UserId)t=void 0;else{var l=[];ve().getAllUsers().forEach((function(t){t.userId!==Object(u.a)().userInfo.UserId&&l.push(t)})),t=this.HR(l)}e=oe.createElement(zh,{Active:!1,onClick:this.GR.bind(this),ref:this.AR,Form:s});var h=this.uxStateModel.FlexPane;s.isFieldReady(Zt.a.Schema.Category)&&Object(Ri.a)(s,"DisableEditForm")||(n=oe.createElement(Wh,{Active:"Theme"===h,onClick:this.LF.bind(this),ref:this.RR,Form:s}));var f=(r={form:s},oe.createElement(Yh,Object(S.__assign)({},r)));i=oe.createElement(Uh,{Active:"SendForm"===h,onClick:this.qR.bind(this),ref:this.ER,FirstRunCallout:f,Form:s})}var d=20&this.state.UserType,b="MoreOptionMenu";s&&s.isFieldReady(Zt.a.Schema.Id)&&(b=s.Model.Id);var m=oe.createElement(Kh,{FormMaster:s,IsConsumerUserType:!!d,key:b,SetPrintViewState:this.props.SetPrintViewState});return oe.createElement("div",{className:"headbar-right-content"},oe.createElement("div",{className:"headbar-coauthor-list-div","aria-live":"polite"},t),e,n,i,m)},n.GR=function(){var t=this,e=Object(_t.b)();e.bulkEdit((function(){e.Model.Preview={PreviousTopView:"None"},e.showTopView("Preview",(function(){t.QR(t.AR)}))})),Object(g.b)("DesignPage.PreView.Navigate",{isSuiteHeader:gi(),previewMode:"Desktop"})},n.LF=function(){var t=this;Object(yr.f)("Flexpane-Theme",(function(){t.QR(t.RR)})),this.DR("Theme")},n.qR=function(){var t=this;Object(yr.f)("Flexpane-SendForm",(function(){t.QR(t.ER)})),this.uxStateModel&&this.uxStateModel.FormMaster&&"None"===this.uxStateModel.FlexPane&&mn.a.predictResponseTime(this.uxStateModel.FormMaster,!0),this.DR("SendForm")},n.VR=function(t){return oe.createElement("div",{className:"headbar-coauthor-container",key:t.userId},Object(Jo.b)({email:t.email,name:t.displayName,tooltip:t.displayName?Object(ae.a)().DesignPage_NavBar_CoAuthor.format(t.displayName):t.userId,displayText:Object(Xo.a)(t.displayName,t.firstName,t.lastName),isCoAuthUser:!0}))},n.HR=function(t){var e,n=this;if(t.length<=3)e=t.map((function(t){return n.VR(t)}));else{var i=t.slice(2).map((function(t){return t.displayName||t.userId})).join(Object(ae.a)().Common_ItemSeperator);e=[this.VR(t[0]),this.VR(t[1]),oe.createElement("div",{className:"headbar-coauthor-container",key:"moreAuthor"},Object(Jo.b)({tooltip:Object(ae.a)().DesignPage_NavBar_CoAuthors.format(i),displayText:(t.length-2).toString()+"+",isCoAuthUser:!0}))]}return e},n.DR=function(t){var e,n=this.uxStateModel.FlexPane===t?"None":t;switch(n){case"Feedback":e="DesignPage.Feedback.Navigate";break;case"SendForm":e="DesignPage.Send.Navigate";break;case"Settings":e="DesignPage.Setting.Navigate";break;case"MultiLingual":e="DesignPage.MultiLingual.Navigate";break;case"Theme":e="DesignPage.Theme.Navigate";break;case"ImagePicker":e="DesignPage.ImagePicker.Navigate"}e&&Object(g.b)(e,{isSuiteHeader:gi(),source:"DesignPage.HeadBar"}),this.uxStateModel.FlexPane=n},n.QR=function(t){t&&t.current&&t.current.focus()},e}(ue.a);function ef(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(2).then(n.bind(null,1118))];case 1:return[2,{default:t.sent().createCustomerVoiceIntroductionDialog}]}}))}))}function nf(t){var e=Object(Pi.a)(nf,ef);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}function rf(){return Object(S.__awaiter)(this,void 0,void 0,(function(){return Object(S.__generator)(this,(function(t){switch(t.label){case 0:return[4,n.e(2).then(n.bind(null,1119))];case 1:return[2,{default:t.sent().createCustomerVoiceInfoBar}]}}))}))}function of(t){var e=Object(Pi.a)(of,rf);return oe.createElement(Fi.a,null,oe.createElement(e,Object(S.__assign)({},t)))}var sf=n(170),af=function(t){function e(e){var n=t.call(this,e)||this;return n.pj=n.pj.bind(n),n.jj=n.jj.bind(n),n.state={ExpandMoreOptions:!1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){var t="mobile-portal-more-container";this.state.ExpandMoreOptions&&(t=Object(pn.b)(t,"active"));var e={children:oe.createElement(Un.a,{HTMLAttributes:{className:"forms-icon-size20x20"},IconName:"More"}),className:"mobile-portal-more-button",title:Object(ae.a)().Common_More_Options_Text};return oe.createElement(mo.a,{ButtonStyle:"LightBackground",MenuItemType:0,ClassName:"mobile-portal-more-menu",ClassNameForContainer:t,HTMLAttributes:e,onMenuCollapse:this.pj,onMenuExpand:this.jj},this.Dj())},n.Dj=function(){var t=Object(pn.b)("mobile-portal-switch-icon"),e=Object(ae.a)().Mobile_PortalView_SwitchToPC;return[oe.createElement(vo.a,{Active:!0,key:"switch-pc-mobile",onClick:this.props.onClickSwitch},oe.createElement("div",{className:"mobile-portal-switch-option"},oe.createElement(Un.a,{IconName:"SyncToPC",HTMLAttributes:{className:t}}),oe.createElement("span",{className:"mobile-design-question-dropdown-text"},e)))]},n.pj=function(){this.setState({ExpandMoreOptions:!1})},n.jj=function(){Object(g.b)("PortalPage.MyForms.MoreMenu"),this.setState({ExpandMoreOptions:!0})},e}(ue.a),cf=function(t){function e(e){var n=t.call(this,e)||this;return n.zR=!1,n.ce=!0,n.state={FormSearchIsActive:!1},n.UR=n.UR.bind(n),n.$R=n.$R.bind(n),n.$R(),n.WR=function(t){return n.KR(t)},n.zR=Object(Z.m)(),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidUpdate=function(){this.props.Value&&e.markSearchContent(this.props.Value)},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t,e=this,n=Object(Un.b)({HTMLAttributes:{className:"search-icon forms-icon-size20x20"},IconName:"Search"});t=this.zR?Object(ae.a)().Portal_FormSearch_Search_Icon_Text_For_DelegatePage:Object(u.a)().userInfo.IsMsa?Object(ae.a)().Portal_FormSearch_Search_Icon_Text_For_MSA:Object(ae.a)().Portal_FormSearch_Search_Icon_Text;var i={HTMLAttributes:{className:this.state.FormSearchIsActive?"portal-search-element is-active":"portal-search-element",onBlur:function(){return e.setState({FormSearchIsActive:!1})},onFocus:function(){return e.setState({FormSearchIsActive:!0})}},Label:"",MinimalHeight:Object(Pe.j)(),onValueChange:this.WR,Options:{HTMLPropsForInnerElement:{"aria-label":Object(ae.a)().Portal_FormSearch_AriaLabel}},Placeholder:t,TextFiledType:0,Value:this.props.Value},r=Object(ar.b)(i),o=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"portal-search-clear-button",onClick:this.UR},Icon:"Cancel",IconClassName:"forms-icon-size16x16",Text:Object(ae.a)().Common_Close_Text}),s=this.props.ShowIconWhileSearch||!this.state.FormSearchIsActive,a=this.props.ShowIconWhileSearch||this.props.Value;return oe.createElement("div",{className:"portal-search-container",role:"search"},s&&n,r,a&&o)},e.markSearchContent=function(t){if(e.markJSLoaded){var n=e.ensureMarkInstance();t&&n.mark(t,{className:"highlight-marked-strings",element:"span"})}},e.ensureMarkInstance=function(){var t=document.querySelectorAll(".searchable"),e=new Mark(t);return e.unmark(e),e},n.$R=function(){var t=this;Object(An.a)("Mark").then((function(){e.markJSLoaded=!0,t.ce&&t.props.Value&&e.markSearchContent(t.props.Value)}))},n.KR=function(t){this.props.onValueChange(t),t&&!e.useFormSearch&&(e.useFormSearch=!0,Object(g.b)("PortalPage.SearchForms.UseFormSearch"))},n.JR=function(){this.props.Value&&(e.ensureMarkInstance(),this.props.onValueChange(""),this.forceUpdate())},n.UR=function(){this.JR(),this.props.onClickClear&&this.props.onClickClear()},e.useFormSearch=!1,e}(ue.a),uf=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ExpandSearchBar:!1},n.XR=n.XR.bind(n),n.ZR=n.ZR.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.render=function(){return oe.createElement("div",{className:"mobile-portal-search-container"},this.state.ExpandSearchBar?this.$r():this.YR())},n.$r=function(){return oe.createElement(cf,{onClickClear:this.XR,onValueChange:this.props.onValueChange,ShowIconWhileSearch:!0,Value:this.props.Value})},n.YR=function(){return Object(Un.b)({HTMLAttributes:{className:"search-big-icon forms-icon-size20x20",onClick:this.ZR},IconName:"Search"})},n.ZR=function(){lf(),this.setState({ExpandSearchBar:!0},this.props.expandOrCollapseSearch)},n.XR=function(){lf(),this.setState({ExpandSearchBar:!1},this.props.expandOrCollapseSearch)},e}(ue.a);function lf(){Object(g.b)("PortalPage.SearchIcon.Click")}var hf=n(163),ff=function(t){function e(e){var n=t.call(this,e)||this;return n.tE=oe.createRef(),n.zR=!1,n.state={BranchRuleDependency:!1,CopyToEnvDialogPrompted:!1,DataFetchPending:!1,DeleteConfirmDialogPrompted:!1,DuplicateRemoveDialogPrompted:!1,IsFormNotFound:!1,IsResponseCountReady:!1,IsThemeReady:!1,IsTitleReady:!0,ShowCardResponseCount:!0,ShowCardTheme:!0,ShowCardTitle:!0},n.ce=!0,n.zR=Object(Z.m)(),n.eE=n.eE.bind(n),n.nE=n.nE.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.FormMaster;if(e){this.iE=function(){return t.forceUpdate()};var n=Zt.a.Schema;e.observe(this.iE,[n.ResponsesCount,n.SavingState,n.Title,n.Theme,n.Type]);var i=e.Synchronizer.Schema;e.Synchronizer.observe(this.iE,[i.CreationFailed,i.CreationInProcess,i.CreationScheduled]);var r=[n.ResponsesCount,n.Theme,n.Settings];this.props.FormMaster.IsSharedForm&&r.push(n.SoftDeleted),e.ensureFieldsReady(r).then((function(){t.ce&&t.setState({IsResponseCountReady:!0,IsThemeReady:!0})})).catch((function(e){if(t.ce)switch(e&&e.innerCode&&parseInt(e.innerCode)){case 674:t.setState({IsFormNotFound:!0});break;case 639:Object(Y.c)("EnableShowUnpinForMovedForm")&&t.setState({IsFormMoved:!0});break;case 707:t.setState({IsFormNoPermission:!0})}}))}},n.componentWillUnmount=function(){this.props.FormMaster&&(this.props.FormMaster.unobserve(this.iE),this.props.FormMaster.Synchronizer.unobserve(this.iE)),this.ce=!1},n.componentDidUpdate=function(){Object(Hn.b)(this.props.FormMaster)},n.createThemeContent=function(){return this.state.IsFormNotFound?oe.createElement("div",{className:"new-form-card-image",key:"theme",style:{backgroundColor:"#008272",backgroundImage:t.prototype.getBackgroundImageURL.call(this,this.getCardTitle())}}):t.prototype.createThemeContent.call(this)},n.createFooterContent=function(){if(!this.state.ShowCardResponseCount)return null;var e=this.props.FormMaster.Model;if(this.isFormOwnedByMe())return t.prototype.createFooterContent.call(this);var n=e.SharedFormOwnerName,i=Object(Jo.b)({displayText:n?Object(Xo.a)(n):"",name:n,tooltip:n||e.OwnerId}),r=oe.createElement("div",{className:"fl-displayname"},oe.createElement("span",{className:"searchable"},n||""));return oe.createElement("div",{className:"fl-owner-container",key:"owner"},oe.createElement("div",{className:"fl-facepile"},i),r)},n.getErrorMessage=function(){return this.props.FormMaster.getQuestionError()},n.isFormOwnedByMe=function(){return this.props.FormMaster.Model.OwnerId===Object(u.a)().userInfo.UserId||this.zR},n.showFormStatus=function(){var t=this.props.FormMaster.SettingMaster.Model;return t.FormClosed?Object(ae.a)().PortalView_FormClosed_Text:t.TimerEnabledEnd&&Date.now()>Date.parse(t.EndTime)?Object(ae.a)().PortalView_FormExpired_Text:null},n.onClick=function(){this.props.FormMaster&&Object(g.b)("PortalPage.MyForms.Load"),this.props.onClick(this.props.FormMaster)},n.getCardDescription=function(){if(this.isFormOwnedByMe())return t.prototype.getCardDescription.call(this);var e=this.props.FormMaster.Model;try{return Object(ae.a)().PortalView_FormCard_Shared.format(e.SharedFormOwnerName)}catch(t){throw Object(g.c)("PortalPage.MyForms.GetCardDescription.Failure",{ownerId:this.props.FormMaster.Model.OwnerId,userId:Object(u.a)().userInfo.UserId}),t}},n.getCardThemeName=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.Name:null},n.getCardThemeBackgroupUrl=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.BackgroundImage:null},n.getCardThemePrimaryColor=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.PrimaryColor:null},n.getCardTitle=function(){var t=this;return Object(at.c)((function(){return t.props.FormMaster.Model.Title}),at.f)},n.getCardType=function(){var t=this.props.FormMaster;return t.isFieldReady(Zt.a.Schema.Type)&&null!=t.Model.Type?t.Model.Type:""},n.getCardResponseCount=function(){var t=this.props.FormMaster;return t.isFieldReady(Zt.a.Schema.ResponsesCount)&&t.Model.ResponsesCount>0?t.Model.ResponsesCount:0},n.createCardOwnerContent=function(){if(this.isFormOwnedByMe())switch(this.props.FormMaster.Model.Category){case"Poll":return oe.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:Object(ae.a)().OutlookAddin_FormCard_CategoryLabel});case"Teams Poll":return oe.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:Object(ae.a)().Teams_FormCard_CategoryLabel});case"assignments":return oe.createElement("div",{className:"fl-category-label fl-category-assignments",key:"category-label",title:Object(ae.a)().Teams_Assignments_FormCard_CategoryLabel});default:return null}return null},n.createCardWarning=function(){return Object(hf.b)(this.props.FormMaster)},n.createCardTypeContent=function(){return Object(hf.a)(this.props.FormMaster)},n.createOtherContent=function(){var t=this,e=this.props.FormMaster;return this.state.IsThemeReady&&this.state.IsResponseCountReady&&(!e.Deleted||"Idle"!==e.Model.SavingState)&&!e.Synchronizer.Model.CreationFailed||this.zR||this.state.IsFormNotFound||this.props.FormMaster.IsSharedForm&&(this.state.IsFormNoPermission||this.state.IsFormMoved)?[Object(at.c)((function(){return t.rE()}),at.f),this.oE(),this.Ee(),!1]:null},n.createSpinner=function(){var e=this;return Object(at.c)((function(){return t.prototype.createSpinner.call(e)}),at.f)},n.shouldShowSpinner=function(){var t=this.props.FormMaster;if(!t)return!1;if(t.Model.TransferInProgress||t.Model.DeleteCollaborationPermission)return!0;var e=!1;t.isFieldReady(t.Schema.SoftDeleted)&&(e=!!t.Model.SoftDeleted);return t.Deleted||e||t.Synchronizer.Model.CreationInProcess||t.Synchronizer.Model.CreationScheduled||!1},n.getStatusMessage=function(){var t=this.props.FormMaster;return t&&t.Model.TransferInProgress?Object(ae.a)().PortalView_FormCard_MoveInProgress:null},n.rE=function(){var t=this;if(!this.shouldShowSpinner()&&!this.shouldHideDialogTriggerButton()){var e={"aria-disabled":this.state.ContentCovered,className:"fl-menu-button",onClick:function(){return t.setState({DuplicateRemoveDialogPrompted:!0,ContentCovered:!0})}};return(this.state.DuplicateRemoveDialogPrompted||this.state.DeleteConfirmDialogPrompted||this.state.CopyToEnvDialogPrompted)&&(e.className=Object(pn.b)(e.className,"dn")),Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,Icon:"More",IconClassName:"forms-icon-size20x20",key:"triggerButton",ref:this.tE,Text:Object(ae.a)().Common_More_Options_Text,Tooltip:Object(ae.a)().PortalView_Menu_Tooltip})}},n.oE=function(){var t=this,e=this.props.FormMaster,n=!this.isFormOwnedByMe();if(this.state.DuplicateRemoveDialogPrompted&&!this.shouldShowSpinner()){var i=[],r={ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Vertical",IconClass:n?"Unpin":"Delete",IconClassName:n?"unpinIconClass":"",Key:"removeItem",onClick:function(){if(n){Object(g.b)("PortalPage.OtherForms.Unpin");var i=t.props.onDeleteClick;i&&i(e),t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})}else Object(g.b)("PortalPage.MyForms.MoveToRecycleBin"),Object(at.c)((function(){t.setState({DeleteConfirmDialogPrompted:!0,DuplicateRemoveDialogPrompted:!1})}),at.f)},Text:n?Object(ae.a)().PortalView_Unpin_Button:Object(ae.a)().Common_Delete_Text,TextClassName:"fl-menu-text"};if(Object(Ri.a)(e,"DisableEditForm"))i.push(r);else{if(!this.zR){if(Object(at.c)((function(){return t.props.FormMaster.IsSharedForm||"survey"!==t.props.FormMaster.Model.Type}),at.f)){var o=this.sE();i.push(o)}i.push(r)}if(!this.props.FormMaster.IsAssignmentForm&&!Object(u.a)().userInfo.IsMsa&&!n)Object(at.c)((function(){return"survey"!==t.props.FormMaster.Model.Type}),at.f)&&i.push({ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Vertical",IconClass:"FabricMovetoFolder",Key:"transferItem",onClick:function(e){t.props.onMoveClicked&&(t.aE(),t.props.onMoveClicked(t.props.FormMaster))},Text:Object(ae.a)().PortalView_Move_Button,TextClassName:"fl-menu-text"})}var s={ButtonsProps:i,ClassName:"portal-view-form-card-copy-remove-container",key:"duplicateRemoveDialog",onBlur:function(){return t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.aE()},ShowDialog:this.state.DuplicateRemoveDialogPrompted};return Object(ce.b)(s)}},n.sE=function(){return{ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Vertical",IconClass:"Copy",Key:"duplicateItem",onClick:this.eE,Text:Object(ae.a)().Common_Copy_Text,TextClassName:"fl-menu-text"}},n.eE=function(){var t=this;Object(at.c)((function(){var e=t.props.FormMaster;t.aE();var n=t.props.onDuplicateClick;n&&n(e,{IsGroupForm:!1,OwnerId:Object(u.a)().userInfo.UserId,OwnerTenantId:Object(u.a)().userInfo.TenantId}),t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1}),t.isFormOwnedByMe()?Object(g.b)("PortalPage.MyForms.Duplicate"):Object(g.b)("PortalPage.OtherForms.Duplicate")}),at.f)},n.Ee=function(){var t=this,e=!this.isFormOwnedByMe();if(this.state.DeleteConfirmDialogPrompted){var n=e?Object(ae.a)().PortalView_ConfirmUnpin_Button:Object(ae.a)().PortalView_Continue_Text,i={ButtonsProps:[{ButtonStyle:"DarkBackGround",ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:function(){if(t.props.focusOut(Ln.findDOMNode(t)),Object(g.b)("PortalPage.MyForms.ConfirmMoveToRecycleBin"),e){var n=t.props.onDeleteClick;n&&n(t.props.FormMaster)}else{var i=t.props.onSoftDeleteClick;i&&i(t.props.FormMaster)}t.setState({DeleteConfirmDialogPrompted:!1,ContentCovered:!1})},Text:e?Object(ae.a)().PortalView_ConfirmUnpin_Button:Object(ae.a)().PortalView_Continue_Button,Title:n},{ButtonStyle:"DarkBackGround",ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){Object(g.b)("PortalPage.MyForms.CancelMoveToRecycleBin"),t.aE(),t.setState({ContentCovered:!1})},Text:Object(ae.a)().Common_Cancel_Text,Title:Object(ae.a)().PortalView_Cancel_Text}],ClassName:"portal-view-form-card-delete-cancel-container",Description:Object(ae.a)().PortalView_MoveFormToRecycleBin_Warning_Text,key:"deleteConfirmDialog",onBlur:function(){return t.setState({DeleteConfirmDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.aE()},ShowDialog:this.state.DeleteConfirmDialogPrompted};return Object(ce.b)(i)}},n.aE=function(){if(this.tE.current){var t=this.tE.current.getHtmlElement();t&&(t.classList.remove("dn"),t.focus())}},n.cE=function(){},n.uE=function(){},n.nE=function(t){},e}(Nl.a),df=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}Object(S.__extends)(e,t);var n=e.prototype;return n.getCardThemeName=function(){return null},n.getCardThemeBackgroupUrl=function(){return null},n.getCardThemePrimaryColor=function(){return null},n.getCardTitle=function(){return""},n.getCardType=function(){return""},n.createCardOwnerContent=function(){return null},n.createCardWarning=function(){return null},n.createCardTypeContent=function(){return null},n.getCardResponseCount=function(){return 0},e}(Nl.a),bf=function(t){function e(e){var n=t.call(this,e)||this;return n.lE=oe.createRef(),n.hE=oe.createRef(),n.fE=oe.createRef(),n.dE=oe.createRef(),n.bE=oe.createRef(),n.mE=oe.createRef(),n.vE=280,n.gE=n.gE.bind(n),n.RM=n.RM.bind(n),n.EM=n.EM.bind(n),n.OE=n.OE.bind(n),n.pE=n.pE.bind(n),n.jE=n.jE.bind(n),n.yE=n.yE.bind(n),n.wE=n.wE.bind(n),n.SE=n.SE.bind(n),n.state={MoreCreateOptionsExpanded:!1,ShowToggleTemplateButton:!0,TemplateDisplayState:"NotLoad",TemplateListQuota:0},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.setState({TemplateDisplayState:"Show"}),this.NE()},n.componentDidMount=function(){window.addEventListener("resize",this.SE),window.addEventListener("UpdateMSATemplatePortalView",this.SE),fi(this.SE),this.SE()},n.componentWillUnmount=function(){window.removeEventListener("resize",this.SE),di(this.SE)},n.render=function(){if("Hide"===this.state.TemplateDisplayState){var t=Object(yn.a)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"template-new-form-button office-form-theme-button __template-new-form-button__",onClick:this.RM},Icon:"Add",IconClassName:"forms-icon-size16x16 button-img",Text:Object(ae.a)().PortalView_NewFormTitle,TextClassName:"button-text"}),e=Object(yn.a)({ButtonStyle:"LightBackground",GlyphLocation:"Right",HTMLAttributes:{className:"template-icon-button office-form-theme-button-color __toggle-template-button__",onClick:this.wE},Icon:"ChevronDown",IconClassName:"forms-icon-size12x12",ref:this.fE,Text:Object(ae.a)().MSATemplate_ShowTemplate_Button,TextClassName:"template-icon-button-text"});return oe.createElement("div",{className:"portal-tiles"},oe.createElement("div",{ref:this.dE},t,this.gE(),this.state.ShowToggleTemplateButton&&e))}var n=Object(yn.a)({ButtonStyle:"LightBackground",GlyphLocation:"Right",HTMLAttributes:{className:"template-icon-button office-form-theme-button-color __toggle-template-button__",onClick:this.OE},Icon:"ChevronUp",IconClassName:"forms-icon-size12x12",ref:this.hE,Text:Object(ae.a)().MSATemplate_HideTemplate_Button,TextClassName:"template-icon-button-text"}),i=Object(yn.a)({ButtonStyle:"LightBackground",GlyphLocation:"Right",HTMLAttributes:{className:"template-icon-button office-form-theme-button-color __more-templates-button__",onClick:this.IE.bind(this,"PortalView")},Icon:"Forward",IconClassName:"forms-icon-size12x12",ref:this.bE,Text:Object(ae.a)().MSATemplate_MoreTemplate_Button,TextClassName:"template-icon-button-text"});return oe.createElement("div",{className:"portal-tiles"},oe.createElement("div",{ref:this.dE},oe.createElement("div",{className:"template-new-header"},oe.createElement("h1",{className:"template-new"},Object(ae.a)().MSATemplate_New_Text),n),oe.createElement(kl,{createCallback:this.props.createFormCallback,Origin:"PortalView",ref:this.lE}),oe.createElement(xl,{Origin:"PortalView",Quota:this.state.TemplateListQuota,updateTemplateList:this.SE,viewTemplateHandler:this.props.viewTemplateHandler}),oe.createElement("hr",{className:"template-hr"}),i))},n.RM=function(){this.props.createFormCallback("Form"),Object(g.b)("MyTemplate.createForm",{Origin:"PortalViewTemplateHide"})},n.EM=function(){this.props.createFormCallback("Quiz"),Object(g.b)("MyTemplate.createQuiz",{Origin:"PortalViewTemplateHide"})},n.gE=function(){var t=[];t.push(oe.createElement(vo.a,{Active:!0,key:"newQuiz",onClick:this.EM},oe.createElement("div",{className:"template-new-dropdown-option __template-new-quiz-dropdown-option__"},oe.createElement(Hi.a,{src:"/Images/icon-new-quiz-hover.png","aria-hidden":"true"}),oe.createElement("span",{className:"tempate-new-dropdown-text"},Object(ae.a)().PortalView_NewQuizTitle)))),t.push(oe.createElement(vo.a,{Active:!0,key:"newFromTemplate",onClick:this.IE.bind(this,"PortalView.MoreCreateOptions")},oe.createElement("div",{className:"template-new-dropdown-option __more-templates-dropdown-option__"},oe.createElement(Un.a,{IconName:"TextDocument"}),oe.createElement("span",{className:"tempate-new-dropdown-text"},Object(ae.a)().MSATemplate_MoreTemplate_Button))));var e={"aria-label":Object(ae.a)().MSATemplate_MoreCreateOptions,children:Object(Un.b)({HTMLAttributes:{className:"forms-icon-size16x16"},IconName:this.state.MoreCreateOptionsExpanded?"ChevronUp":"ChevronDown"}),className:Object(pn.b)("template-new-more-button __template-more-create-options-button__",this.state.MoreCreateOptionsExpanded?"active":void 0),title:Object(ae.a)().MSATemplate_MoreCreateOptions},n=Object(pn.b)("template-new-more-container office-form-theme-button",this.state.MoreCreateOptionsExpanded?"active":void 0);return oe.createElement(mo.a,{ButtonStyle:"LightBackground",ClassName:"template-new-more-menu",ClassNameForContainer:n,DisableAdjustPopupPosition:!0,HTMLAttributes:e,MenuItemType:0,onMenuCollapse:this.pE,onMenuExpand:this.jE,ref:this.mE},t)},n.pE=function(){this.setState({MoreCreateOptionsExpanded:!1}),Object(g.b)("PortalPage.TemplateGallery.MoreCreateOptions.Hide")},n.jE=function(){this.setState({MoreCreateOptionsExpanded:!0}),Object(g.b)("PortalPage.TemplateGallery.MoreCreateOptions.Show")},n.yE=function(){"Show"===this.state.TemplateDisplayState&&this.bE.current?this.bE.current.focus():"Hide"===this.state.TemplateDisplayState&&this.mE.current&&this.mE.current.focus()},n.wE=function(){var t=this;this.SE(),this.setState({MoreCreateOptionsExpanded:!1,TemplateDisplayState:"Show"},(function(){t.hE.current&&t.hE.current.focus()})),mf(!0),Object(g.b)("PortalPage.TemplateGallery.Show")},n.OE=function(){var t=this;this.setState({MoreCreateOptionsExpanded:!1,TemplateDisplayState:"Hide"},(function(){t.fE.current&&t.fE.current.focus()})),mf(!1),Object(g.b)("PortalPage.TemplateGallery.Hide")},n.IE=function(t){Object(_t.b)().showTopView("MSATemplateGallery",this.yE),Object(g.b)("PortalPage.TemplateGallery.ViewMore",{Origin:t})},n.SE=function(){var t=0;if(this.dE.current){var e=Ln.findDOMNode(this.dE.current),n=e&&e.parentElement?e.parentElement.parentElement:null;if(n){if(n.clientWidth<e.clientWidth)return void this.setState({ShowToggleTemplateButton:!1,TemplateDisplayState:"Hide"});if(0!==e.clientWidth){if(this.lE.current){var i=Ln.findDOMNode(this.lE.current);0!==i.clientWidth&&(this.vE=i.clientWidth+30)}t=e.clientWidth/this.vE-1}}}this.setState({ShowToggleTemplateButton:!0,TemplateListQuota:t}),Cn=t},n.NE=function(){var t=this,e=sf.a.getInstance();e.fieldsReady([e.Schema.TemplateGalleryToggleState]).then((function(){e.Model.TemplateGalleryToggleState||t.setState({TemplateDisplayState:"Hide"})}))},e}(ue.a);function mf(t){var e=sf.a.getInstance();e.fieldsReady([e.Schema.TemplateGalleryToggleState]).then((function(){e.Model.TemplateGalleryToggleState=t}))}var vf=function(t){function e(e){var n=t.call(this,e)||this;return n.ce=!0,n.Nt=oe.createRef(),n.state={AnimationLoaded:!1,RightPosition:0,ShowAnimation:!1,ShowEmptyImage:!1},n.CE=(new Date).getTime(),n.kE=n.kE.bind(n),n.TE=n.TE.bind(n),n.xE=n.xE.bind(n),n.FE=n.FE.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){this.xE(),fi(this.FE)},n.componentDidUpdate=function(t){var e=this;if(this.props.RecycleBinFormCount!==t.RecycleBinFormCount&&this.props.GroupMaster===t.GroupMaster){this.setState({AnimationLoaded:!1,ShowAnimation:!0,ShowEmptyImage:0===t.RecycleBinFormCount});setTimeout((function(){e.ce&&e.setState({AnimationLoaded:!1,ShowAnimation:!1})}),1e3),this.CE=(new Date).getTime()}this.xE(),window.addEventListener("resize",this.xE)},n.componentWillUnmount=function(){this.ce=!1,window.removeEventListener("resize",this.xE),fi(this.FE)},n.render=function(){var t;if(0===this.props.RecycleBinFormCount)return null;var e={ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":Object(ae.a)().RecycleBin_EnterButtonText,className:"fl-content glyph-button-control-vertical",id:"fl-content-recycleBin",onClick:this.props.onClick,title:Object(ae.a)().RecycleBin_EnterButtonText},ref:this.Nt},n=oe.createElement(qo.a,Object(S.__assign)({},e)),i=this.state.ShowEmptyImage?"/Images/emptyRecycleBinAnimation.gif?time="+this.CE:"/Images/recycleBinAnimation.gif?time="+this.CE,r=Object(at.c)((function(){return"right"}),at.f);return oe.createElement("div",{className:"recycle-bin-button",style:(t={},t[r]=this.state.RightPosition+"px",t),title:!1},n,oe.createElement(Hi.a,{alt:Object(ae.a)().RecycleBin_EnterButtonText,className:"recycle-bin-button-animation-img",key:"recycleBinAnimation",onClick:this.TE,onLoad:this.kE,src:i,hidden:!this.state.ShowAnimation}),oe.createElement(Hi.a,{alt:Object(ae.a)().RecycleBin_EnterButtonText,className:"recycle-bin-button-img",key:"recycleBinImage",onClick:this.TE,src:"/Images/fullRecycleBin_icon.png",hidden:this.state.ShowAnimation&&this.state.AnimationLoaded}))},n.focus=function(){this.Nt.current&&this.Nt.current.focus()},n.TE=function(t){t.stopPropagation(),this.props.onClick()},n.kE=function(){this.setState({AnimationLoaded:!0})},n.xE=function(){var t=document.getElementById("portalContentContainer");if(t){var n=t.offsetWidth-t.clientWidth+e.reservedWidthToRight;this.state.RightPosition!==n&&this.setState({RightPosition:n})}},n.FE=function(t,n){e.reservedWidthToRight=t?n.width:0,this.xE()},e.reservedWidthToRight=0,e}(ue.a),gf=function(){function t(){}t.prototype;return t.createFormsProAvailCallout=function(t,e,n,i,r,o,s,a){return oe.createElement("div",{className:"firstrun-callout-container","aria-live":"polite"},oe.createElement("div",{className:i},oe.createElement("div",{className:r}),oe.createElement("div",{className:o},e),oe.createElement("div",{className:s},t),oe.createElement("div",{className:a},n)))},t.createText=function(t,e){return e?oe.createElement("div",{className:e},t):oe.createElement("div",{className:"teaching-callout-text"},t)},t}(),Of=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.lS=function(){return e.forceUpdate()},e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=Object(Ei.c)();t.observe(this.lS,[Ei.b.Schema.PortalFormIntroduction]),t.observe(this.lS,[Ei.b.Schema.FormsProAvailableTeachingCallout])},n.componentWillUnmount=function(){Object(Ei.c)().unobserve(this.lS)},n.render=function(){var t=Object(Ei.c)().Model,e=Ei.a.toString();if(!Object(Ei.d)(t.PortalFormIntroduction)&&Object(Ei.d)(t.FormsProAvailableTeachingCallout)){var n=gf.createText(Object(ae.a)().FormsProAvailableTeachingCallout_Body,"teachingCallout-formsproavailable-text"),i=this.createButton(this.onClickFooterButton,"formsproavailable-callout-footerbutton",Object(ae.a)().FormsProAvailableTeachingCallout_ButtonText,Object(ae.a)().FormsProAvailableTeachingCallout_ButtonText),r=Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"formsproavailable-callout-closebutton",onClick:function(){return t.FormsProAvailableTeachingCallout=e}},Icon:"Cancel",IconClassName:"forms-icon-size14x14",Text:Object(ae.a)().Common_Close_Text});return gf.createFormsProAvailCallout(n,r,i,"teachingCallout-formsproavailable","teachingCallout-formsproavailable-direction","formsproavailable-callout-closetextwrap","formsproavailable-callout-textwrap","formsproavailable-callout-footertextwrap")}return null},n.onClickFooterButton=function(){Object(g.b)("DesignPage.FormsProAvailableTeachingCallout.ShowMe"),Object(Ei.c)().Model.FormsProAvailableTeachingCallout=Ei.a.toString();var t=Object(_t.b)();t.bulkEdit((function(){t.Model.TopView="ShowProFRE"}))},n.createButton=function(t,e,n,i){return Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:e,onClick:t,title:i},Text:n})},e}(ue.a),pf=n(172);function jf(){return Object(Ei.d)(Object(Ei.c)().Model.PortalFormIntroduction)}var yf=function(t){function e(e){var n=t.call(this,e)||this;return n.state={ClosePopUp:!1},n.PE=n.PE.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.DE()&&Object(g.b)("PortalPage.FormIntroductionDialog.Navigate")},n.componentDidMount=function(){Object(yr.g)(Ln.findDOMNode(this)),this.Cn=(new Date).getTime()/1e3},n.render=function(){return this.DE()?this.ME():null},n.DE=function(){return jf()&&!this.state.ClosePopUp},n.PE=function(t){27===t.keyCode&&(this.Wv("PortalPage.FormIntroductionDialog.Close"),this.setState({ClosePopUp:!0}))},n.qc=function(){var t=this;return Object(yn.a)({HTMLAttributes:{className:"form-introduction-dialog-close-button",onClick:function(){t.Wv("PortalPage.FormIntroductionDialog.Close"),t.setState({ClosePopUp:!0})}},ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",Icon:"Cancel",IconClassName:"form-introduction-dialog-close-icon forms-icon-size14x14",Text:Object(ae.a)().Common_Close_Text})},n.Od=function(t,e){return oe.createElement("div",{className:"form-introduction-dialog-image"},oe.createElement("img",{role:"presentation","aria-hidden":"true",src:t,alt:e}),oe.createElement("div",{className:"form-introduction-dialog-image-text"},e))},n.LE=function(){var t=this;return Object(Gi.b)({HTMLAttributes:{autoFocus:!0,className:"form-introduction-dialog-button",onClick:function(){t.Wv("PortalPage.FormIntroductionDialog.CreatNewForm"),t.props.createFormHandler()}},ButtonStyle:"LightBackground",Text:Object(ae.a)().Form_Introduction_Dialog_Create_Form_Button,ref:"createFormButton"})},n.AE=function(){var t=oe.createElement("div",{className:"form-introduction-dialog-image-container"},this.Od(Object(On.b)("/Images/PortalMyForms/Forms_info_1.png"),Object(ae.a)().Form_Introduction_Dialog_Introduction_1),this.Od(Object(On.b)("/Images/PortalMyForms/Forms_info_2.png"),Object(ae.a)().Form_Introduction_Dialog_Introduction_2),this.Od(Object(On.b)("/Images/PortalMyForms/Forms_info_3.png"),Object(ae.a)().Form_Introduction_Dialog_Introduction_3));return oe.createElement("div",{className:"form-introduction-dialog-container"},t,this.LE())},n.ME=function(){var t=oe.createElement("div",{className:"form-introduction-dialog-title-container"},oe.createElement("div",{className:"form-introduction-dialog-title"},Object(ae.a)().Form_Introduction_Dialog_Title1.format(this.RE())),oe.createElement("div",{className:"form-introduction-dialog-title"},Object(ae.a)().Form_Introduction_Dialog_Title2),oe.createElement("div",{className:"form-introduction-dialog-subtitle"},Object(ae.a)().LandingPage_Form_Introduction));return oe.createElement("div",{className:"form-introduction-dialog-div"},oe.createElement("div",{className:"form-introduction-dialog-get-start-container",onKeyUp:this.PE},t,this.AE(),this.qc()))},n.RE=function(){var t=Object(u.a)().userInfo.GivenName||Object(u.a)().userInfo.DisplayName;return t||Object(g.c)("MissingUserName",{displayName:!!Object(u.a)().userInfo.DisplayName,givenName:!!Object(u.a)().userInfo.GivenName,userId:!!Object(u.a)().userInfo.UserId}),t},n.Wv=function(t){var e=(new Date).getTime()/1e3-this.Cn;Object(g.b)(t,{duration:e}),Object(Ei.c)().Model.PortalFormIntroduction=Ei.a.toString(),this.props.onDialogClose&&this.props.onDialogClose()},e}(ue.a);ue.a;function wf(t){Object(p.c)("/Pages/DesignPage.aspx?origin=PortalPage#FormId="+t)}var Sf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={AreMembersReady:!1,IsGroupInfoReady:!1},e.ce=!0,e.Ze=Et.uniqueId("PortalViewGroupBar"),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.GroupMaster;e&&(e.ensureFieldsReady([e.Schema.members]).then((function(){t.ce&&t.setState({AreMembersReady:!0})})),e.ensureFieldsReady([e.Schema.classification,e.Schema.emailAddress,e.Schema.visibility]).then((function(){t.ce&&t.setState({IsGroupInfoReady:!0})})))},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){return this.props.GroupMaster?oe.createElement("div",{className:"portal-view group-bar"},this.vu(),this.EE(),this.BE(),this._E(),this.HE()):null},n.EE=function(){if(!this.state.IsGroupInfoReady||!this.state.AreMembersReady)return null;var t=this.props.GroupMaster.Model,e=t.classification,n=t.visibility;"public"===n.toLocaleLowerCase()?n=Object(ae.a)().PortalView_GroupForms_PublicGroup:"private"===n.toLocaleLowerCase()&&(n=Object(ae.a)().PortalView_GroupForms_PrivateGroup);var i=n||"";return e&&(i+=" ( "+e+" )"),oe.createElement("div",{className:"group-info"},oe.createElement("span",null,i))},n.BE=function(){return this.state.AreMembersReady&&this.state.IsGroupInfoReady?oe.createElement("div",{className:"group-info-cutting-line"}):null},n._E=function(){if(!this.state.AreMembersReady||!this.state.IsGroupInfoReady)return null;var t=this.props.GroupMaster,e=this.GE().map((function(e){var n=e.displayName,i=oe.createElement(ou.a,{DisplayName:e.displayName,Photo:t.getMemberPhoto(e.id),PhotoType:0,HideName:!0,key:e.id});return oe.createElement("div",{className:"group-member-photo",key:n},i)}));return oe.createElement("div",{className:"group-members"},e)},n.HE=function(){if(!this.state.AreMembersReady||!this.state.IsGroupInfoReady)return null;var t,e=this.props.GroupMaster.Model.members.length;if(e<1)throw Error("Group members count can not be smaller than 1.");t=1===e?"1 "+Object(ae.a)().GroupView_GroupInfoBar_Member_Text:e>=100?"99+ "+Object(ae.a)().GroupView_GroupInfoBar_Members_Text:e.toString()+" "+Object(ae.a)().GroupView_GroupInfoBar_Members_Text;var n=Object(M.f)()?"https://outlook.office.com/owa/?path=/group/"+this.props.GroupMaster.Model.emailAddress+"/people":"javascript:void(0)",i=this.Ze+"-link-description",r=this.GE().map((function(t){return t.displayName})).join(Object(ae.a)().Common_ItemSeperator),o=Object(ae.a)().PortalView_GroupForms_MemberLinkDescription.format(t,r),s=oe.createElement("a",{href:n,target:"_blank","aria-describedby":i},t);return oe.createElement("div",{className:"group-members-count"},s,oe.createElement("span",{id:i,style:{display:"none"}},o))},n.GE=function(){var t=this.props.GroupMaster,e=t.Model.members.length,n=Wt.a.convertToArray(t.Model.members);return e>3&&(n=n.slice(0,3)),n},n.vu=function(){return this.state.AreMembersReady&&this.state.IsGroupInfoReady?null:oe.createElement("div",{className:"spinner-tile-animation",key:"groupInfo"})},e}(ue.a),Nf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={IsFormsCountReady:!1,IsGroupPhotoReady:!1,ShowFormsCount:!0,ShowGroupPhoto:!0},e.ce=!0,e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.GroupMaster;e.ensureFieldsReady([e.Schema.formReferences]).then((function(){t.ce&&(Object(g.b)("PortalPage.GroupFormsPortal.Group.FormsCount",{formsCount:e.Model.formReferences.length,groupId:e.Model.id}),t.setState({IsFormsCountReady:!0}))})),e.Photo.then((function(){t.ce&&t.setState({IsGroupPhotoReady:!0})}))},n.componentWillUnmount=function(){this.ce=!1},n.render=function(){var t={className:"fl-group-content",onClick:this.onClick.bind(this)},e={ButtonStyle:"LightBackground",children:[this.qE(),this.QE()],HTMLAttributes:t,key:"card-content"},n=oe.createElement(qo.a,Object(S.__assign)({},e));return oe.createElement("div",{className:"fl-history-tile fl-tile fl-group-tile"},n)},n.onClick=function(){this.state.IsFormsCountReady&&Object(g.b)("PortalPage.GroupFormsPortal.GroupCard.Click"),this.props.createGroupFormsPortal(this.props.GroupMaster)},n.qE=function(){var t=this.props.GroupMaster;return oe.createElement(ou.a,{DisplayName:t.Model.displayName,Photo:t.Photo,PhotoType:1,key:t.Model.id})},n.QE=function(){if(!this.state.IsFormsCountReady)return oe.createElement("div",{className:"common-spinner-circle portal-recent-visit-groupForm-spinner"});var t,e=this.props.GroupMaster,n=Et.filter(e.Model.formReferences,(function(t){return Et.isEqual(t.softDeleted,He.a.Normal)})).length;switch(n){case 0:t=Object(ae.a)().PortalView_GroupForms_FormsCount_0_Text.format(n.toString());break;case 1:t=Object(ae.a)().PortalView_GroupForms_FormsCount_1_Text.format(n.toString());break;default:t=Object(ae.a)().PortalView_GroupForms_FormsCount_Multiple_Text.format(n.toString())}return oe.createElement("span",{className:"fl-formscount",key:"group-forms-count"},t)},e}(ue.a),If=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.VE="",e.zE=-1,e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=_e.a.getInstance();e.ensureFieldsReady([e.Schema.MruDocuments]).then((function(){if(t.zE!==e.Model.MruDocuments.length){switch(t.zE=e.Model.MruDocuments.length,t.zE){case 0:t.VE=Object(ae.a)().PortalView_GroupForms_FormsCount_0_Text.format(t.zE.toString());break;case 1:t.VE=Object(ae.a)().PortalView_GroupForms_FormsCount_1_Text.format(t.zE.toString());break;default:t.VE=Object(ae.a)().PortalView_GroupForms_FormsCount_Multiple_Text.format(t.zE.toString())}t.setState({IsFormsCountChanged:!0})}}))},n.render=function(){var t=oe.createElement(ou.a,{DisplayName:Object(ae.a)().PortalView_GroupForms_MruCard_Title_Text,Photo:Object(pe.e)(),PhotoType:2,key:"recent-group-forms"}),e=oe.createElement("span",{className:"fl-formscount",key:"recent-group-forms-count"},this.VE);if(""===this.VE){e=oe.createElement($o.a,Object(S.__assign)({},{ClassName:"recent-visit-groupForm-spinner",Ignorable:!1},{key:"group-forms-count-spinner"}))}var n={ButtonStyle:"LightBackground",children:[t,e],HTMLAttributes:{className:"fl-group-content",onClick:this.props.createGroupMruFormsPortal}},i=oe.createElement(qo.a,Object(S.__assign)({},n));return oe.createElement("div",{className:"fl-history-tile fl-tile fl-group-tile",key:"mru-card"},i)},e}(ue.a),Cf="PortalPage.GroupFormsPortal.GroupBar.Click",kf=function(t){function e(e){var n=t.call(this,e)||this;return n.UE=oe.createRef(),n.ce=!0,n.Ze=Et.uniqueId("PortalViewDropdownGroupList"),n.$E=n.Ze+"-group-description",n.WE=n.WE.bind(n),n.KE=n.KE.bind(n),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.GroupManager;e.ensureFieldsReady([e.Schema.groups]).then((function(){t.ce&&(Object(g.b)("PortalPage.GroupFormsPortal.GroupsCount",{groupsCount:e.Groups.length}),t.setState({AreGroupsReady:!0}))})),Object(_t.b)().observe((function(){return t.forceUpdate}),[Object(_t.b)().Schema.ShowGroupListInPortal])},n.render=function(){var t="portal-view group-view";return this.props.ShouldShowGroups&&(t=Object(pn.b)(t,"expand")),oe.createElement("div",{className:t},this.JE(),this.XE(),this.ZE())},n.componentDidUpdate=function(){this.props.ShouldShowGroups?Object(yr.g)(Ln.findDOMNode(this)):Object(yr.e)(Ln.findDOMNode(this))},n.componentWillUnmount=function(){this.ce=!1},n.JE=function(){var t,e,n=this;this.props.SelectedGroup?(e=this.props.SelectedGroup.Model.displayName,t=oe.createElement(ou.a,{DisplayName:e,Photo:this.props.SelectedGroup.Photo,PhotoType:1,key:this.props.SelectedGroup.Model.id})):(e=Object(ae.a)().PortalView_GroupForms_MruCard_Title_Text,t=oe.createElement(ou.a,{DisplayName:e,Photo:Object(pe.e)(),PhotoType:2,key:"recent-group-forms"}));var i={"aria-expanded":this.props.ShouldShowGroups,"aria-haspopup":!0,"aria-label":e,className:"group-select-group",onClick:function(){Object(g.b)(Cf),n.props.showGroupsCallback(!n.props.ShouldShowGroups)},onKeyDown:function(t){switch(Object(g.b)(Cf),t.keyCode){case 13:n.props.showGroupsCallback(!n.props.ShouldShowGroups);break;case 27:n.props.showGroupsCallback(!1)}},ref:this.UE,role:"button",tabIndex:0};return this.props.SelectedGroup&&(i["aria-describedby"]=this.$E),oe.createElement("div",{className:"group-select-placeholder"},oe.createElement("div",Object(S.__assign)({},i),t,this.bn()),this.YE())},n.XE=function(){return this.props.ShouldShowGroups?oe.createElement("div",{className:"group-list-scroll-content"},oe.createElement("div",{className:"group-list-view"},this.tB(),this.eB())):null},n.ZE=function(){var t=Object(_t.b)().Model;return this.props.ShouldShowGroups?t.ShowGroupListInPortal=!0:t.ShowGroupListInPortal=!1,oe.createElement("div",{className:"group-view-mask",onClick:this.props.showGroupsCallback.bind(this,!1)})},n.WE=function(t){this.nB(t),this.props.showGroupsCallback(!1)},n.eB=function(){var t=this;return this.state.AreGroupsReady?this.props.GroupManager.Groups.map((function(e){var n={createGroupFormsPortal:t.WE,GroupMaster:e};return oe.createElement(Nf,Object(S.__assign)({key:"group-card-"+e.Model.id},n))})):null},n.KE=function(){this.nB(),this.props.showGroupsCallback(!this.props.ShouldShowGroups)},n.tB=function(){var t={createGroupMruFormsPortal:this.KE};return oe.createElement(If,Object(S.__assign)({key:"mru-card"},t))},n.bn=function(){return Object(Un.b)({HTMLAttributes:{className:"select-placeholder-arrow forms-icon-size16x16"},IconName:this.props.ShouldShowGroups?"ChevronUp":"ChevronDown"})},n.YE=function(){return this.props.ShouldShowGroups?null:oe.createElement(Sf,{GroupDescriptionId:this.$E,GroupMaster:this.props.SelectedGroup})},n.nB=function(t){this.UE.current&&this.UE.current.focus(),this.props.onGroupCardClick(t)},e}(ue.a);var Tf=n(209),xf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={DeleteConfirmDialogPrompted:!1,DuplicateRemoveDialogPrompted:!1,IsCorruptedForm:!1,IsResponseCountReady:!1,IsThemeReady:!1,IsTitleReady:!0,ShowCardResponseCount:!0,ShowCardTheme:!0,ShowCardTitle:!0},e.ce=!0,e.tE=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.FormMaster;if(e){this.iE=function(){return t.forceUpdate()};var n=Zt.a.Schema;e.observe(this.iE,[n.ResponsesCount,n.SavingState,n.Title,n.Theme]);var i=e.Synchronizer.Schema;e.Synchronizer.observe(this.iE,[i.CreationFailed,i.CreationInProcess,i.CreationScheduled]),e.ensureFieldsReady([Zt.a.Schema.ResponsesCount,Zt.a.Schema.Theme]).then((function(){t.ce&&t.setState({IsResponseCountReady:!0,IsThemeReady:!0})}),(function(e){649===e.innerCode&&t.setState({IsCorruptedForm:!0})}))}},n.componentWillUnmount=function(){var t=this.props.FormMaster;t&&(t.unobserve(this.iE),t.Synchronizer.unobserve(this.iE)),this.ce=!1},n.onClick=function(){this.props.onClick(this.props.FormMaster)},n.getCardDescription=function(){return this.state.ShowCardResponseCount&&this.state.IsResponseCountReady?Object(ae.a)().PortalView_FormCard_Responses.format(this.getCardResponseCount()):null},n.getCardThemeName=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.Name:null},n.getCardThemeBackgroupUrl=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.BackgroundImage:null},n.getCardThemePrimaryColor=function(){var t=this.props.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.PrimaryColor:null},n.getCardTitle=function(){var t=this;return Object(at.c)((function(){return t.props.FormMaster.Model.Title}),at.f)},n.getCardType=function(){var t=this.props.FormMaster;return t.isFieldReady(Zt.a.Schema.Type)&&null!=t.Model.Type?t.Model.Type.toLowerCase():""},n.getCardResponseCount=function(){var t=this.props.FormMaster;return t.isFieldReady(Zt.a.Schema.ResponsesCount)&&t.Model.ResponsesCount>0?t.Model.ResponsesCount:0},n.createCardOwnerContent=function(){var t=this.props.FormMaster;if(t.isFieldReady(t.Schema.Category))switch(t.Model.Category){case"Poll":return oe.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:Object(ae.a)().OutlookAddin_FormCard_CategoryLabel});case"Teams Poll":return oe.createElement("div",{className:"fl-category-label fl-category-poll",key:"category-label",title:Object(ae.a)().Teams_FormCard_CategoryLabel});case"assignments":return oe.createElement("div",{className:"fl-category-label fl-category-assignments",key:"category-label",title:Object(ae.a)().Teams_Assignments_FormCard_CategoryLabel});default:return null}return null},n.createCardWarning=function(){return Object(hf.b)(this.props.FormMaster)},n.createCardTypeContent=function(){return Object(hf.a)(this.props.FormMaster)},n.createOtherContent=function(){var t=this.props.FormMaster;return this.state.IsThemeReady&&this.state.IsResponseCountReady&&(!t.Deleted||"Idle"!==t.Model.SavingState)&&!t.Synchronizer.Model.CreationFailed||this.state.IsCorruptedForm?[this.rE(),this.oE(),this.Ee()]:null},n.shouldShowSpinner=function(){var t=this.props.FormMaster;if(!t)return!1;if(t.Model.DeleteCollaborationPermission)return!0;var e=!1;return t.isFieldReady(t.Schema.MovingToRecycleBin)&&(e=t.Model.MovingToRecycleBin),t.Deleted||e||t.Synchronizer.Model.CreationInProcess||t.Synchronizer.Model.CreationScheduled||!t.isFieldReady(Zt.a.Schema.Id)},n.getErrorMessage=function(){return this.props.FormMaster.getQuestionError()},n.iB=function(){Object(g.b)("PortalPage.GroupFormsPortal.GroupForm.MoveToRecycleBin"),this.props.FormMaster.moveToRecycleBin()},n.rB=function(){Object(g.b)("PortalPage.GroupFormsPortal.GroupForm.Duplicate"),Object(Tf.d)(this.props.FormMaster,this.props.GroupMaster)},n.rE=function(){var t=this;if(!this.shouldHideDialogTriggerButton()){var e={"aria-disabled":this.state.ContentCovered,className:"fl-menu-button",onClick:function(){t.setState({DuplicateRemoveDialogPrompted:!0,ContentCovered:!0})}};return(this.state.DuplicateRemoveDialogPrompted||this.state.DeleteConfirmDialogPrompted)&&(e.className=Object(pn.b)(e.className,"dn")),Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:e,Icon:"More",IconClassName:"forms-icon-size20x20",key:"triggerButton",ref:this.tE,Text:Object(ae.a)().Common_More_Options_Text})}},n.oE=function(){var t=this;if(this.state.DuplicateRemoveDialogPrompted&&!this.shouldShowSpinner()){var e={ButtonsProps:[!this.state.IsCorruptedForm&&{ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Vertical",IconClass:"Copy",Key:"duplicateItem",onClick:function(){t.aE(),t.rB(),t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},Text:Object(ae.a)().Common_Copy_Text,TextClassName:"fl-menu-text"},{ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Vertical",IconClass:"Delete",Key:"removeItem",onClick:function(){t.state.IsCorruptedForm?Object(Tf.b)(t.props.FormMaster,t.props.GroupMaster):t.setState({DeleteConfirmDialogPrompted:!0,DuplicateRemoveDialogPrompted:!1})},Text:Object(ae.a)().Common_Delete_Text,TextClassName:"fl-menu-text"}],ClassName:"portal-view-form-card-copy-remove-container",key:"duplicateRemoveDialog",onBlur:function(){return t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.aE()},ShowDialog:this.state.DuplicateRemoveDialogPrompted};return Object(ce.b)(e)}},n.Ee=function(){var t=this;if(this.state.DeleteConfirmDialogPrompted){var e={ButtonsProps:[{ButtonStyle:"DarkBackGround",ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"deleteItem",onClick:function(){t.props.focusOut(Ln.findDOMNode(t)),t.iB(),t.setState({ContentCovered:!1,DeleteConfirmDialogPrompted:!1})},Text:Object(ae.a)().PortalView_Continue_Button,Title:Object(ae.a)().PortalView_Continue_Text},{ButtonStyle:"DarkBackGround",ClassName:"fl-menu-confirm-delete",GlyphButtonStyle:"Horizontal",Key:"cancelItem",onClick:function(){t.aE(),t.setState({ContentCovered:!1,DeleteConfirmDialogPrompted:!1})},Text:Object(ae.a)().Common_Cancel_Text,Title:Object(ae.a)().PortalView_Cancel_Text}],ClassName:"portal-view-form-card-delete-cancel-container",Description:Object(ae.a)().PortalView_MoveFormToRecycleBin_Warning_Text,key:"deleteConfirmDialog",onBlur:function(){return t.setState({DeleteConfirmDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.aE()},ShowDialog:this.state.DeleteConfirmDialogPrompted};return Object(ce.b)(e)}},n.aE=function(){if(this.tE.current){var t=Ln.findDOMNode(this.tE.current);t&&(t.classList.remove("dn"),t.focus())}},e}(Nl.a);var Ff=function(t){function e(e){var n=t.call(this,e)||this;n.iE=n.iE.bind(n);var i=n.props.GroupMaster;return i&&i.observe(n.iE,[i.Schema.formReferences]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){var t=this.props.GroupMaster;t&&t.unobserve(this.iE,[t.Schema.formReferences])},n.render=function(){return oe.createElement("div",{className:"group-forms-view"},this.oB(),this.sB())},n.iE=function(){this.forceUpdate()},n.oB=function(){var t=oe.createElement(Il,{CreateNew:!0,focusOut:this.props.focusOut,IsGroupForm:!0,IsQuizMode:!1,onClick:this.aB.bind(this,!1)}),e=oe.createElement(Il,{CreateNew:!0,focusOut:this.props.focusOut,IsGroupForm:!0,IsQuizMode:!0,onClick:this.aB.bind(this,!0)}),n=oe.createElement("div",{className:"creating-card-middle-line"});return oe.createElement("div",{className:"portal-creating-card"},t,n,e)},n.sB=function(){var t=this,e=this.props.GroupMaster,n=e.FormMasterExceptSoftDeleted;if(0===n.filter((function(t){return!t.isFieldReady(t.Schema.Modified)})).length)return n.sort((function(t,e){return Date.parse(e.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(n){return oe.createElement(xf,{focusOut:t.props.focusOut,FormMaster:n,GroupMaster:e,onClick:t.props.designExistingForm,key:n.getInstanceId()})}))},n.aB=function(t){var e=Object(Tf.a)(t,this.props.GroupMaster);this.props.designExistingForm(e)},e}(ue.a);var Pf=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.state={DuplicateRemoveDialogPrompted:!1,FocusOnTriggerButton:!1,IsOwnerNameReady:!0,IsResponseCountReady:!1,IsThemeReady:!1,IsTitleReady:!0,ShowCardOwnerName:!0,ShowCardResponseCount:!0,ShowCardSpinner:!1,ShowCardTheme:!0,ShowCardTitle:!0},e.tE=oe.createRef(),e}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this,e=this.props.MruDocumentMaster,n=e.FormMaster;if(n){this.cB=function(){return t.forceUpdate()};var i=Zt.a.Schema;n.observe(this.cB,[i.Title,i.ResponsesCount,i.Theme]),e.Model.NotExist?this.setState({IsResponseCountReady:!0,IsThemeReady:!0}):n.ensureReadyForMruCard().then((function(){t.setState({IsResponseCountReady:!0,IsThemeReady:!0})}),(function(n){n&&674===n.innerCode&&(e.Model.NotExist=!0),t.setState({IsResponseCountReady:!0,IsThemeReady:!0})}))}},n.componentWillUnmount=function(){var t=this.props.MruDocumentMaster.FormMaster;t&&(t.unobserve(this.cB),t.Synchronizer.unobserve(this.cB))},n.onClick=function(){var t=this.props.MruDocumentMaster.FormMaster;if(t&&this.uB("PortalPage.GroupFormsPortal.MruGroupFormLoad"),this.props.Actions.openForm){var e=this.props.MruDocumentMaster.Model;e.NotExist||(e.Timestamp=(new Date).toISOString()),this.props.Actions.openForm(t)}},n.getCardDescription=function(){if(this.state.ShowCardOwnerName&&this.state.IsOwnerNameReady){var e=this.props.MruDocumentMaster.Model.OwnerName;return Object(ae.a)().PortalView_FormCard_Mru.format(e,this.getCardResponseCount())}return t.prototype.getCardDescription.call(this)},n.getCardThemeName=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.Name:null},n.getCardThemeBackgroupUrl=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.BackgroundImage:null},n.getCardThemePrimaryColor=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.Theme)?t.ThemeMaster.Model.PrimaryColor:null},n.getCardTitle=function(){return this.props.MruDocumentMaster.Model.Title},n.getCardType=function(){return null!=this.props.MruDocumentMaster.Model.Type?this.props.MruDocumentMaster.Model.Type.toLowerCase():""},n.getCardResponseCount=function(){var t=this.props.MruDocumentMaster.FormMaster;return t.isFieldReady(t.Schema.ResponsesCount)?t.Model.ResponsesCount:0},n.createCardOwnerContent=function(){if(!this.state.ShowCardOwnerName)return null;if(!this.state.IsOwnerNameReady)return null;var t=this.props.MruDocumentMaster;return oe.createElement(ou.a,{DisplayName:t.Model.OwnerName,Photo:this.lB(),PhotoType:1,key:"face-pile"})},n.createCardWarning=function(){return Object(hf.b)(this.props.MruDocumentMaster.FormMaster)},n.createCardTypeContent=function(){return Object(hf.a)(this.props.MruDocumentMaster.FormMaster)},n.shouldShowSpinner=function(){return this.state.ShowCardSpinner},n.createOtherContent=function(){var t=this;return!this.state.ShowCardSpinner&&this.state.IsThemeReady&&this.state.IsResponseCountReady?[Object(at.c)((function(){return t.rE()}),at.f),this.hB()]:null},n.lB=function(){var t=this.props.MruDocumentMaster;return this.fB||("Group"===t.Model.OwnerType?this.fB=Object(ru.c)(t.Model.OwnerId):this.fB=Object(ru.e)(t.FormMaster)),this.fB},n.rE=function(){var t=this;if(!this.shouldHideDialogTriggerButton()){var e=this.state,n={"aria-disabled":this.state.ContentCovered,className:"fl-menu-button",onClick:function(){return t.setState({DuplicateRemoveDialogPrompted:!0,ContentCovered:!0})}};return(e.DuplicateRemoveDialogPrompted||e.DeleteConfirmDialogPrompted)&&(n.className=Object(pn.b)(n.className,"dn")),Object(yn.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:n,Icon:"More",IconClassName:"forms-icon-size20x20",key:"triggerButton",ref:this.tE,Text:Object(ae.a)().Common_More_Options_Text})}},n.hB=function(){var t=this,e=this.props,n=this.state;if(n.DuplicateRemoveDialogPrompted)return Object(ce.b)({ButtonsProps:[{ButtonStyle:"DarkBackGround",GlyphButtonStyle:"Vertical",IconClass:"Blocked12",Key:"removeItem",onClick:function(n){t.uB("PortalPage.GroupFormsPortal.MruGroupFormRemove"),e.Actions.removeFromMRU&&(t.props.focusOut(Ln.findDOMNode(t)),e.Actions.removeFromMRU(e.MruDocumentMaster.FormMaster),t.setState({ShowCardSpinner:!0}))},Text:Object(ae.a)().PortalView_Remove_Button,TextClassName:"fl-menu-text",Title:Object(ae.a)().PortalView_Remove_Text}],ClassName:"portal-view-form-card-copy-remove-container",key:"duplicateRemoveDialog",onBlur:function(){return t.setState({DuplicateRemoveDialogPrompted:!1,ContentCovered:!1})},onDismiss:function(){return t.aE()},ShowDialog:n.DuplicateRemoveDialogPrompted})},n.aE=function(){if(this.tE.current){var t=Ln.findDOMNode(this.tE.current);t&&(t.classList.remove("dn"),t.focus())}},n.uB=function(t){var e,n=this.props.MruDocumentMaster.FormMaster;n.isFieldReady(Zt.a.Schema.Id)&&(e=n.Model.Id),Object(g.b)(t,{FormId:e,FormOwnerType:"MruForm",IsGroupForms:this.props.MruDocumentMaster.Model.Extension===_e.b[_e.b.GroupForm]})},e}(Nl.a);function Df(t,e,n,i){var r=t.Documents;return i&&(r=r.filter((function(t){return t.matchSearchStrings(i)}))),r.map((function(t){return oe.createElement(Pf,{Actions:e,focusOut:n,MruDocumentMaster:t,key:t.Model.ServerDocId})}))}var Mf=function(t){function e(e){var n=t.call(this,e)||this;n.dB=oe.createRef(),n.vl=Object(_t.b)().Model,n.state={SelectedGroup:n.vl.GroupMaster,ShouldShowGroupCards:!1},n.bB=function(t){n.setState({ShouldShowGroupCards:t})},n.mB=n.mB.bind(n),n.vB=n.vB.bind(n),n.gB=n.gB.bind(n),n.OB=n.OB.bind(n),n.iE=function(){return n.forceUpdate()},n.pB=n.pB.bind(n),n.jB=n.jB.bind(n),n.state.SelectedGroup&&n.state.SelectedGroup.observe(n.iE,[n.state.SelectedGroup.Schema.formReferences]);var i=Object(_t.b)();return i.observe(n.pB,[i.Schema.GroupMaster]),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillUnmount=function(){this.state.SelectedGroup&&this.state.SelectedGroup.unobserve(this.iE,[this.state.SelectedGroup.Schema.formReferences]),Object(_t.b)().unobserve(this.pB)},n.render=function(){return oe.createElement("div",Object(S.__assign)({},this.props.HTMLAttributes),this.yB(),this.sB())},n.yB=function(){return function(t,e,n,i,r){return oe.createElement(kf,{GroupManager:t,SelectedGroup:e,ShouldShowGroups:n,onGroupCardClick:i,showGroupsCallback:r,key:"group-list"})}(Object(ri.b)(),this.state.SelectedGroup,this.state.ShouldShowGroupCards,this.nB.bind(this),this.bB)},n.sB=function(){return this.state.SelectedGroup?this.wB(this.state.SelectedGroup):this.SB()},n.wB=function(t){var e=function(t,e,n){return oe.createElement(Ff,{focusOut:t,GroupMaster:e,designExistingForm:n,key:e.Model.id})}(this.props.focusOut,t,this.OB);return Object(g.b)("PortalPage.GroupForms.FormCount",{groupsFormCount:t.FormMasters.length,groupSoftdeletedFormCount:t.getFormMasterSoftDeteledForms().length}),oe.createElement("div",{className:"portal-group-forms"},e,this.NB())},n.SB=function(){if("Loaded"!==this.vl.GroupMruFormListLoadState)return null;var t=this.IB();if(t.length)return t;var e={className:"discover-group-button",title:Object(ae.a)().PortalView_RecentGroupForms_Warning_Button_Text,onClick:this.vB},n=Object(Gi.b)({ButtonStyle:"LightBackground",HTMLAttributes:e,Text:Object(ae.a)().PortalView_RecentGroupForms_Warning_Button_Text});return oe.createElement("div",{className:"portal-other-form-warning-container"},this.CB(Object(On.b)("/Images/fish-bowl.png")),oe.createElement(xa.a,{HTMLAttributes:{className:"portal-other-form-warning-title"},LazyRendering:!0,Role:"Status"},Object(ae.a)().PortalView_RecentGroupForms_Warning_Title),n)},n.IB=function(t){var e=this;return Df(this.props.GroupMruDocumentManager,{deleteForm:function(t){return e.props.deleteFormHandler(t)},duplicateForm:function(){throw Error("Not supported.")},openForm:function(t){return e.gB(t)},removeFromMRU:function(t){return e.props.removeFromMRUHandler(t)}},this.props.focusOut,t)},n.NB=function(){if("Loaded"!==this.vl.FormListLoadState)return null;var t=this.state.SelectedGroup.getFormMasterSoftDeteledForms().length;return oe.createElement(vf,{GroupMaster:this.state.SelectedGroup,onClick:this.mB,RecycleBinFormCount:t,ref:this.dB})},n.nB=function(t){this.vl.GroupMaster=t},n.CB=function(t){return oe.createElement("div",{className:"portal-other-form-warning-img-container"},oe.createElement("img",{className:"portal-other-form-warning-img",role:"presentation",src:t,alt:!1}))},n.gB=function(t){if(t)if(this.vl.SearchContent)Object(g.b)("PortalPage.SearchForms.Click",{FormId:t.Model.Id});else switch(this.vl.FormCollectionType){case"OwnedForms":Object(g.b)("PortalPage.MyForms.Click",{FormId:t.Model.Id});break;case"GroupForms":Object(g.b)("PortalPage.MyForms.Click",{FormId:t.Model.Id,IsGroupForms:!0});break;case"SharedWithMe":Object(g.b)("PortalPage.OtherForms.Click",{FormId:t.Model.Id})}this.OB(t)},n.OB=function(t){"PortalPage"===Object(v.m)()&&t.Model.Id?wf(t.Model.Id):this.props.designExistingFormHandler(t)},n.mB=function(){var t=this.state.SelectedGroup.getFormMasterSoftDeteledForms().length;Object(g.b)("DesignPage.RecycleBin.Navigate",{recycleBinformCount:t}),Object(_t.b)().showTopView("RecycleBin",this.jB)},n.vB=function(){this.setState({ShouldShowGroupCards:!0})},n.pB=function(){var t=this.vl.GroupMaster;this.state.SelectedGroup!==t&&(this.state.SelectedGroup&&this.state.SelectedGroup.unobserve(this.iE,[this.state.SelectedGroup.Schema.formReferences]),t&&t.observe(this.iE,[t.Schema.formReferences]),this.setState({SelectedGroup:t}))},n.jB=function(){this.dB.current&&(this.state.SelectedGroup.getFormMasterSoftDeteledForms().length?this.dB.current.focus():Object(yr.b)(Ln.findDOMNode(this)))},e}(ue.a);var Lf=function(t){function e(e){var n=t.call(this,e)||this;return n.kB=[],n.vl=Object(_t.b)().Model,n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;this.TB=function(){return t.forceUpdate()};var e=this.vl.GroupMaster;e&&e.observe(this.TB,[e.Schema.formReferences])},n.componentWillUnmount=function(){var t=this.vl.GroupMaster;t&&t.unobserve(this.TB,[t.Schema.formReferences])},n.render=function(){this.kB=this.vl.SearchContent.toLowerCase().split(" ").filter((function(t){return!!t}));var t=this.xB();return oe.createElement("div",{className:"sub-tiles",role:"main"},this.FB(t.length),t,this.PB(t.length))},n.FB=function(t){return oe.createElement(xa.a,{HTMLAttributes:{className:"portal-search-live-region"},LazyRendering:!0,Role:"Status"},Object(ae.a)().Portal_FormSearch_Result_Screen_Reader_Message.format(t,this.vl.SearchContent.toLowerCase()))},n.xB=function(){if(this.kB.length<1)return[];var t=[],e=this.DB(),n=this.props.SearchGroupForm?this.MB():[],i=this.props.SearchSharedForm?this.LB():[];switch(this.vl.FormCollectionType){case"OwnedForms":t=t.concat(e,n,i);break;case"GroupForms":t=t.concat(n,e,i);break;case"SharedWithMe":t=t.concat(i,e,n);break;default:throw Error("The form type is invalid.")}return t},n.DB=function(){var t=this,e=[],n=Wt.a.convertToArray(Object(_t.b)().Model.FormList);return this.kB.forEach((function(t){n=n.filter((function(e){return e.Model.Title.toLowerCase().indexOf(t)>=0}))})),n.forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),e.sort((function(t,e){return Date.parse(e.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(e){return oe.createElement(ff,{CreateNew:!1,IsSampleForm:!1,focusOut:t.props.focusOut,FormMaster:e,onClick:t.props.designExistingForm,onDeleteClick:t.props.deleteForm,onSoftDeleteClick:t.props.softDeleteForm,onDuplicateClick:t.props.duplicateForm,onMoveClicked:t.props.changeFormOwner,onCopyToEnvClick:!1,key:e.getInstanceId()})}))},n.LB=function(){var t=this,e=[],n=Wt.a.convertToArray(Object(_t.b)().Model.SharedWithMeFormList);return this.kB.forEach((function(t){n=n.filter((function(e){return e.Model.Title.toLowerCase().indexOf(t)>=0||e.Model.SharedFormOwnerName&&e.Model.SharedFormOwnerName.toLowerCase().indexOf(t)>=0}))})),n.forEach((function(t){-1===e.indexOf(t)&&e.push(t)})),e.sort((function(t,e){return Date.parse(e.Model.SharedDate)-Date.parse(t.Model.SharedDate)})),e.map((function(e){return oe.createElement(ff,{CreateNew:!1,IsSampleForm:!1,focusOut:t.props.focusOut,FormMaster:e,onClick:t.props.designExistingForm,onDeleteClick:t.props.deleteForm,onSoftDeleteClick:t.props.softDeleteForm,onDuplicateClick:t.props.duplicateForm,onMoveClicked:t.props.changeFormOwner,onCopyToEnvClick:!1,key:e.getInstanceId()})}))},n.MB=function(){var t=this,e=this.props,n=this.vl.GroupMaster;return n?function(t,e,n,i){var r=t.FormMasterExceptSoftDeleted;return i.forEach((function(t){r=r.filter((function(e){return e.Model.Title.toLowerCase().indexOf(t)>=0}))})),r.sort((function(t,e){return Date.parse(e.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(i){return oe.createElement(xf,{focusOut:n,FormMaster:i,GroupMaster:t,key:i.getInstanceId(),onClick:e})}))}(n,this.props.designExistingForm,this.props.focusOut,this.kB):Df(e.GroupMruDocumentManager,{deleteForm:function(t){return e.deleteForm(t)},duplicateForm:function(n){var i=n;t.vl.FormCollectionType="OwnedForms",e.duplicateForm(i,{OwnerId:n.Model.OwnerId,OwnerTenantId:n.Model.OwnerTenantId,IsGroupForm:n.IsGroupForm})},openForm:function(t){return e.designExistingForm(t)},removeFromMRU:function(t){return e.removeFromMRU(t)}},this.props.focusOut,this.kB)},n.PB=function(t){return t>0?null:oe.createElement("div",{className:"portal-search-warning-container"},oe.createElement("div",{className:"portal-search-warning-title"},Object(ae.a)().Portal_FormSearch_Warning_Message_1),oe.createElement("div",{className:"portal-search-warning-message"},Object(ae.a)().Portal_FormSearch_Warning_Message_2))},e}(ue.a);var Af=function(t){function e(e){var n=t.call(this,e)||this;return n.AB=oe.createRef(),n.ce=!0,n.RB="",n.dB=oe.createRef(),n.vl=Object(_t.b)().Model,n.Ze=Et.uniqueId("portal"),n.EB=n.Ze+"-myForms",n.BB=n.Ze+"-sharedWithMe",n._B=n.Ze+"-groupForms",n.HB=Object(Tt.a)("CustomerVoiceTransitionCompletionDate"),n.GB=640,n.qB=880,n.state={ExpandSearchBar:!1,MenuExpanded:!1,ShowFormsProAvailableTeachingCallout:!1,ShowCustomerVoiceIntroductionDialog:!1,ExpandableSearchBarOnDesktop:!1,DropdownTabListOnDesktop:!1,TemplateGalleryToggleState:!0},n.QB=function(){return n.VB("Form")},n.zB=function(){return n.VB("Quiz")},n.UB=function(){return Object(v.q)()&&!n.$B()&&"1"===Object(u.a)().switcherExperience},n.$B=function(){var t=new Date,e=new Date(n.HB);return!(!t||!e)&&t>e},n.WB=function(){n.setState({ShowCustomerVoiceIntroductionDialog:n.UB()})},n.KB=function(t){var e=Object(Tt.a)("CustomerVoiceUrl")+"/Pages/ProjectPage.aspx#FormId="+t;window.open(e,"_blank")},n.JB=n.JB.bind(n),n.XB=n.XB.bind(n),n.OB=n.OB.bind(n),n.ZB=n.ZB.bind(n),n.YB=n.YB.bind(n),n.t_=n.t_.bind(n),n.e_=n.e_.bind(n),n.VB=n.VB.bind(n),n.n_=n.n_.bind(n),n.jB=n.jB.bind(n),n.i_=n.i_.bind(n),n.r_=function(t){return n.o_(t)},n.s_=n.s_.bind(n),n.a_(),n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){var t=this;Object(st.g)().then(!Object(Y.c)("ProRedirectInWeb")&&ni.a).then((function(){return t.setState({FormsProLicenseChecked:!0})})),Object(g.b)("PortalPage.MyForms.Navigate",{IsGroupForms:"GroupForms"===this.vl.FormCollectionType||null,IsMobileView:!!this.c_()||null}),this.u_=function(){t.ce&&t.forceUpdate()};var e=Object(_t.b)();if(e.observe(this.u_,[e.Schema.ForceDesktopView,e.Schema.FormList,e.Schema.FormCollectionType,e.Schema.SharedWithMeFormList,e.Schema.GroupMruFormListLoadState,e.Schema.SearchContent,e.Schema.ShowGroupListInPortal]),this.props.GroupMruDocumentManager.observeListChange(this.u_),Object(u.a)().userInfo.IsMsa){var n=sf.a.getInstance();this.setState({TemplateGalleryToggleState:void 0}),n.fieldsReady([n.Schema.TemplateGalleryToggleState]).then((function(){t.ce&&t.setState({TemplateGalleryToggleState:sf.a.getInstance().Model.TemplateGalleryToggleState})}))}this.QP(),ei().then((function(e){t.setState({ShowFormsProAvailableTeachingCallout:e})})),this.setState({ShowCustomerVoiceIntroductionDialog:!jf()&&this.UB()}),this.i_()},n.componentWillUnmount=function(){this.ce=!1,this.props.GroupMruDocumentManager.unobserveListChange(this.u_),Object(_t.b)().unobserve(this.u_),window.removeEventListener("resize",this.i_)},n.componentDidMount=function(){if(this.VP(),Object(Y.c)("IntelligenceUseMemoryCache")){var t=Object(u.a)().userInfo;t&&t.TenantId&&t.UserId&&Object(Me.g)(t.TenantId,t.UserId)}Rf(),this.l_(),window.addEventListener("resize",this.i_)},n.componentDidUpdate=function(){this.VP(),Rf()},n.render=function(){return this.state.FormsProLicenseChecked&&void 0!==this.state.TemplateGalleryToggleState?this.c_()?this.h_():this.f_():null},n.i_=function(){this.setState({ExpandableSearchBarOnDesktop:Object(pn.e)()<this.qB,DropdownTabListOnDesktop:Object(pn.e)()<this.GB})},n.f_=function(){var t,e=Object(_t.b)().Model.ShowGroupListInPortal?"expand":null;return e=Object(pn.b)("portal-content-container",e),oe.createElement("div",{className:"portal-page"},!Object(u.a)().userInfo.IsMsa&&(t={createFormHandler:this.QB,onDialogClose:this.WB},oe.createElement(yf,Object(S.__assign)({},t))),this.state.ShowCustomerVoiceIntroductionDialog&&nf(null),oe.createElement("div",{className:e,id:"portalContentContainer"},this.d_(),this.b_(),this.s_(),oe.createElement("div",{className:"portal-tiles",id:"portalTiles"},this.m_(),this.v_()),this.g_(),oe.createElement(Eh,{ref:this.AB})))},n.h_=function(){var t=Object(_t.b)().Model.ShowGroupListInPortal?"expand":null;t=Object(pn.b)("portal-content-container",t);var e=oe.createElement("iframe",{src:"/Pages/PrefetchPage.aspx?target=mobiledesignpage",style:{display:"none"}});return oe.createElement("div",{className:"mobile-portal-page"},oe.createElement("div",{className:t,id:"portalContentContainer"},oe.createElement("div",{className:"portal-tiles",id:"portalTiles"},this.O_(),this.v_()),this.g_(),oe.createElement(Eh,{ref:this.AB})),e)},n.O_=function(){return oe.createElement("div",{className:"mobile-portal-titlebar-container",role:"navigation"},this.p_(),oe.createElement("div",{className:"mobile-portal-search-more-container"},oe.createElement(uf,{expandOrCollapseSearch:this.YB,onValueChange:this.r_,Value:this.vl.SearchContent}),this.j_()))},n.m_=function(){var t,e;return e=this.state.ExpandableSearchBarOnDesktop?oe.createElement(uf,{expandOrCollapseSearch:this.YB,onValueChange:this.r_,Value:this.vl.SearchContent}):oe.createElement(cf,{onValueChange:this.r_,Value:this.vl.SearchContent}),t=this.state.DropdownTabListOnDesktop?this.p_():this.y_(),oe.createElement("div",{className:"portal-titlebar-container",role:"navigation"},t,e)},n.VP=function(){Gn&&"Loaded"===this.vl.FormListLoadState&&window.performance&&Object(g.f)("Endpoint.DesignPortalPage",Vn())},n.b_=function(){return Object(u.a)().userInfo.IsMsa&&oe.createElement("div",{className:"portal-template-gallery-container __portal-template-gallery-container__"},oe.createElement(bf,{createFormCallback:this.VB,viewTemplateHandler:this.props.designExistingFormHandler}))},n.s_=function(){return!Object(v.q)()&&Object(Y.c)("FormsProAvailableTeachingCallout")&&this.state.ShowFormsProAvailableTeachingCallout&&oe.createElement("div",{className:"portal-teachingbubble"},oe.createElement(Of,{}))},n.d_=function(){return!!this.UB()&&of(null)},n.QP=function(){var t=this.c_()?"Mobile":"Desktop";Object(Si.b)("AppResume",void 0,t),Object(Si.c)("AppUsageTime",void 0,t)},n.o_=function(t){this.vl.SearchContent=t},n.t_=function(t){if(this.AB.current){var e=Ln.findDOMNode(this.AB.current);Object(yr.c)(t,e)}},n.l_=function(){if(!jf()){var t="";switch(this.vl.FormCollectionType){case"OwnedForms":t="MyForms";break;case"SharedWithMe":t="SharedForms";break;case"GroupForms":t="GroupForms"}var e=Ln.findDOMNode(this.refs[t]);e&&e.focus()}},n.ZB=function(t){var e=t.Model.OwnerId,n=t.Model.OwnerTenantId,i=t.IsGroupForm;t.IsSharedForm&&(this.vl.FormCollectionType="OwnedForms",e=Object(u.a)().userInfo.UserId,n=Object(u.a)().userInfo.TenantId,i=!1),this.props.duplicateFormHandler(t,{OwnerId:e,OwnerTenantId:n,IsGroupForm:i})},n.v_=function(){var t,e;if(this.vl.SearchContent)return e={deleteForm:this.props.deleteFormHandler,focusOut:this.t_,softDeleteForm:this.props.softDeleteFormHandler,designExistingForm:this.OB.bind(this),duplicateForm:this.props.duplicateFormHandler,removeFromMRU:this.props.removeFromMRUHandler,changeFormOwner:this.props.changeFormOwnerHandler,GroupMruDocumentManager:this.props.GroupMruDocumentManager,SearchGroupForm:!0,SearchSharedForm:!0},oe.createElement(Lf,e);switch(this.RB="",this.vl.FormCollectionType){case"OwnedForms":t=this.w_();break;case"SharedWithMe":t=this.S_();break;case"GroupForms":t=function(t){return oe.createElement(Mf,t)}({HTMLAttributes:{id:this._B+"-tab","aria-labelledby":this._B,className:"portal-group-tab"},designExistingFormHandler:this.props.designExistingFormHandler,deleteFormHandler:this.props.deleteFormHandler,focusOut:this.t_,GroupMruDocumentManager:this.props.GroupMruDocumentManager,removeFromMRUHandler:this.props.removeFromMRUHandler});break;default:throw Error("The type is not valid.")}return oe.createElement("div",{className:"sub-tiles",role:"main"},oe.createElement("div",{className:"portal-search-live-region","aria-live":"polite"},this.RB),t)},n.y_=function(){return this.vl.SearchContent?oe.createElement("div",{className:"portal-title-button-container"},oe.createElement("div",{className:"portal-title selected"},Object(ae.a)().Portal_FormSearch_Title)):oe.createElement("div",{className:"portal-title-button-container",role:"tablist"},this.N_(),!Object(u.a)().userInfo.IsMsa&&this.I_(),!Object(u.a)().userInfo.IsMsa&&this.C_())},n.p_=function(){var t,e,n=[];switch(n.push({Key:"my-form-dropdown-option",Value:0,DisplayName:Object(ae.a)().PortalView_Title_Text}),Object(u.a)().userInfo.IsMsa||(n.push({Key:"share-with-me-form-dropdown-option",Value:1,DisplayName:Object(ae.a)().PortalView_SharedWithMe_Title_Text}),n.push({Key:"group-form-dropdown-option",Value:2,DisplayName:Object(ae.a)().PortalView_GroupForms_Title_Text})),this.vl.FormCollectionType){case"OwnedForms":t=0,e=Object(ae.a)().PortalView_Title_Text;break;case"SharedWithMe":t=1,e=Object(ae.a)().PortalView_SharedWithMe_Title_Text;break;case"GroupForms":t=2,e=Object(ae.a)().PortalView_GroupForms_Title_Text}var i=Object(pn.b)("mobile-portal-select-container",this.state.ExpandSearchBar&&"hidden");return Object(Pr.b)({HTMLAttributes:{className:i},Placeholder:e,SelectOptions:n,Value:t,onValueChange:this.JB})},n.JB=function(t){switch(t){case 0:this.vl.FormCollectionType="OwnedForms";break;case 1:this.vl.FormCollectionType="SharedWithMe";break;case 2:this.vl.FormCollectionType="GroupForms"}},n.N_=function(){var t=this,e="OwnedForms"===this.vl.FormCollectionType;return Object(Gi.b)({HTMLAttributes:{id:this.EB,"aria-controls":e?this.EB+"-tab":void 0,className:e?"portal-title selected":"portal-title",role:"tab",tabIndex:e?0:-1,"aria-selected":e,onClick:function(){Object(g.b)("DesignPage.Form.MyFormsButton"),t.vl.FormCollectionType="OwnedForms",t.vl.SearchContent="",t.vl.ShowGroupListInPortal=!1},onKeyDown:function(e){39===e.keyCode&&t.kA(e,"MyForms","SharedForms")}},ButtonStyle:"LightBackground",Text:Object(ae.a)().PortalView_Title_Text,ref:"MyForms"})},n.I_=function(){var t=this,e="SharedWithMe"===this.vl.FormCollectionType;return Object(Gi.b)({HTMLAttributes:{id:this.BB,"aria-controls":e?this.BB+"-tab":void 0,className:e?"portal-title selected":"portal-title",role:"tab",tabIndex:e?0:-1,"aria-selected":e,onClick:function(){Object(g.b)("DesignPage.Form.OtherFormsButton"),t.vl.FormCollectionType="SharedWithMe",t.vl.SearchContent="",t.vl.ShowGroupListInPortal=!1,"NotStarted"===t.vl.SharedWithMeFormListLoadState&&Ci.a.getFormSharedWithMe().catch((function(){t.vl.SharedWithMeFormListLoadState="NotStarted",t.vl.ErrorBarMessage=Object(ae.a)().Share_With_Me_Forms_Warning_Message}))},onKeyDown:function(e){39===e.keyCode?t.kA(e,"SharedForms","GroupForms"):37===e.keyCode&&t.kA(e,"SharedForms","MyForms")}},ButtonStyle:"LightBackground",Text:Object(ae.a)().PortalView_SharedWithMe_Title_Text,ref:"SharedForms"})},n.C_=function(){var t=this,e="GroupForms"===this.vl.FormCollectionType;return Object(Gi.b)({HTMLAttributes:{id:this._B,"aria-controls":e?this._B+"-tab":void 0,className:e?"portal-title selected":"portal-title",role:"tab",tabIndex:e?0:-1,"aria-selected":e,onClick:function(){Object(g.b)("DesignPage.Form.GroupFormsButton"),t.vl.FormCollectionType="GroupForms",t.vl.SearchContent="",t.vl.ShowGroupListInPortal=!1},onKeyDown:function(e){Object(g.b)("DesignPage.Form.GroupFormsButton"),37===e.keyCode&&t.kA(e,"GroupForms","SharedForms")}},ButtonStyle:"LightBackground",Text:Object(ae.a)().PortalView_GroupForms_Title_Text,ref:"GroupForms"})},n.kA=function(t,e,n){t.stopPropagation(),t.preventDefault();var i=Ln.findDOMNode(this.refs[e]),r=Ln.findDOMNode(this.refs[n]);r&&(r.focus(),$(r).attr("tabindex",0),$(i).attr("tabindex",-1))},n.w_=function(){var t;if(this.k_()){var e=oe.createElement(Il,{CreateNew:!0,focusOut:this.t_,IsGroupForm:!1,IsQuizMode:!1,onClick:this.T_()?this.e_:this.QB});t=oe.createElement("div",{className:"portal-creating-card"},e,oe.createElement("div",{className:"creating-card-middle-line"}),oe.createElement(Il,{CreateNew:!0,focusOut:this.t_,IsGroupForm:!1,IsQuizMode:!0,onClick:this.zB}))}return oe.createElement("div",{id:this.EB+"-tab","aria-labelledby":this.EB},t,this.x_(),this.F_(),!this.P_()&&this.NB())},n.g_=function(){return"Loaded"===this.vl.FormListLoadState&&"OwnedForms"===this.vl.FormCollectionType||"Loaded"===this.vl.SharedWithMeFormListLoadState&&"SharedWithMe"===this.vl.FormCollectionType||"GroupForms"===this.vl.FormCollectionType&&"Loaded"===this.vl.GroupMruFormListLoadState?void 0:Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text,TimeoutMessage:Object(ae.a)().RetryRecoverableErrorMessage_DisplayingForms})},n.x_=function(){var t=this;return Wt.a.convertToArray(Object(_t.b)().Model.PlaceholderList).sort((function(t,e){return Date.parse(e.Modified)-Date.parse(t.Modified)})).map((function(e,n){return oe.createElement(df,{CreateNew:!1,focusOut:t.t_,Form:e,key:n})}))},n.F_=function(){var t=this;if("GroupForms"===this.vl.FormCollectionType)return null;if("Loaded"!==this.vl.FormListLoadState)return null;var e=Wt.a.convertToArray(Object(_t.b)().Model.FormList).sort((function(t,e){return Date.parse(e.Model.Modified)-Date.parse(t.Model.Modified)})).map((function(e){return oe.createElement(ff,{CreateNew:!1,focusOut:t.t_,FormMaster:e,onClick:t.OB,onDeleteClick:t.props.deleteFormHandler,onSoftDeleteClick:t.props.softDeleteFormHandler,onDuplicateClick:t.ZB,onMoveClicked:t.props.changeFormOwnerHandler,key:e.getInstanceId()})}));return e.length?e:void 0},n.S_=function(){var t=this;if("Loaded"===this.vl.SharedWithMeFormListLoadState){if(0===this.vl.SharedWithMeFormList.length)return oe.createElement("div",{id:this.BB+"-tab","aria-labelledby":this.BB,className:"portal-other-form-warning-container"},(e=Object(On.b)("/Images/fish-bowl.png"),oe.createElement("div",{className:"portal-other-form-warning-img-container"},oe.createElement("img",{className:"portal-other-form-warning-img",role:"presentation",src:e}))),oe.createElement(xa.a,{HTMLAttributes:{className:"portal-other-form-warning-title"},LazyRendering:!0,Role:"Status"},Object(ae.a)().PortalView_SharedWithMe_Warning_Title));var e,n=Wt.a.convertToArray(Object(_t.b)().Model.SharedWithMeFormList).map((function(e){var n=e.getInstanceId();return oe.createElement(ff,{CreateNew:!1,focusOut:t.t_,FormMaster:e,onClick:t.OB,onDeleteClick:t.props.deleteFormHandler,onSoftDeleteClick:t.props.softDeleteFormHandler,onDuplicateClick:t.ZB,onMoveClicked:t.props.changeFormOwnerHandler,key:n})}));return oe.createElement("div",{id:this.BB+"-tab","aria-labelledby":this.BB},n)}},n.NB=function(){return"Loaded"!==this.vl.FormListLoadState?null:oe.createElement("div",null,oe.createElement(vf,{GroupMaster:null,onClick:this.n_,ref:this.dB,RecycleBinFormCount:this.vl.RecycleBin.length}))},n.OB=function(t){var e=this;t&&t.ensureFieldsReady([t.Schema.Type]).then((function(){if(Object(v.q)()&&"survey"===t.Model.Type){var n=t.isFieldReady(t.Schema.Id)?t.Model.Id:void 0;e.KB(n)}else e.c_()?function(t){return t&&t.ensureFieldsReady([t.Schema.Settings]).then((function(){return t.Model.Settings.IsQuizMode}))}(t).then((function(n){var i,r;n?e.D_(t):(i=t.Model.Id,r="/Pages/MobileDesignPage.aspx?id="+i,Object(p.c)(r))})):e.D_(t)}))},n.D_=function(t){var e=t.isFieldReady(t.Schema.Id)?t.Model.Id:void 0;if(this.vl.SearchContent)Object(g.b)("PortalPage.SearchForms.Click",{FormId:e});else switch(this.vl.FormCollectionType){case"OwnedForms":Object(g.b)("PortalPage.MyForms.Click",{FormId:e});break;case"GroupForms":Object(g.b)("PortalPage.MyForms.Click",{FormId:e,IsGroupForms:!0});break;case"SharedWithMe":Object(g.b)("PortalPage.OtherForms.Click",{FormId:e})}Qn(t&&t.isFieldReady(Zt.a.Schema.Questions)),"PortalPage"===Object(v.m)()&&e?wf(e):this.props.designExistingFormHandler(t)},n.VB=function(t){"PortalPage"===Object(v.m)()?function(t){var e="/Pages/DesignPage.aspx?origin=PortalPage#Action=Create";"Quiz"===t&&(e="/Pages/DesignPage.aspx?origin=PortalPage#Action=CreateQuiz"),Object(p.c)(e)}(t):this.props.createAndDesignFormHandler(Ef(t))},n.n_=function(){Object(g.b)("DesignPage.RecycleBin.Navigate",{recycleBinformCount:this.vl.RecycleBin.length}),Object(_t.b)().showTopView("RecycleBin",this.jB)},n.jB=function(){if(this.dB.current&&this.vl.RecycleBin.length)this.dB.current.focus();else if(this.AB.current){var t=Ln.findDOMNode(this.AB.current);Object(yr.b)(Ln.findDOMNode(this),t)}},n.YB=function(){var t=this.state.ExpandSearchBar;this.setState({ExpandSearchBar:!t})},n.e_=function(){if(!this.vl.ShouldDisableAllClick){Object(p.c)("/Pages/MobileDesignPage.aspx#Action=Create")}},n.k_=function(){return!Object(u.a)().userInfo.IsMsa||this.c_()},n.T_=function(){return this.c_()},n.c_=function(){return Object(et.t)()&&!this.vl.ForceDesktopView},n.P_=function(){return this.c_()},n.j_=function(){if(!this.state.ExpandSearchBar)return oe.createElement(af,{onClickSwitch:this.XB})},n.XB=function(){Object(g.b)("PortalPage.MyForms.SwitchToDesktop"),this.vl.ForceDesktopView=!0,this.M_()},n.a_=function(){this.c_()&&(this.L_||(this.L_=$('meta[name="viewport"]')[0].content),$('meta[name="viewport"]')[0].content="width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1, maximum-scale=1",$("#content-root").addClass("disable-over-scroll"),Object(et.E)())},n.M_=function(){this.L_&&($('meta[name="viewport"]')[0].content=this.L_),$("#content-root").removeClass("disable-over-scroll")},e}(ue.a);function Rf(){var t=Object(_t.b)().Model;if("Loaded"===t.FormListLoadState){var e=t.FormList,n=Et.find(e,(function(t){return!!t.getQuestionError()}));t.ErrorBarMessage=n?Object(ae.a)().UploadFile_ErrorMessage_PortalPage_Bar.format(n.Model.Title):null}}function Ef(t){Object(g.b)("PortalPage.MyForms.New",{Locale:Object(u.a)().cultureInfo.Name});var e="Quiz"===t;e?Object(g.b)("PortalPage.MyForms.NewQuiz",{Locale:Object(u.a)().cultureInfo.Name}):Object(g.b)("PortalPage.MyForms.NewForm",{Locale:Object(u.a)().cultureInfo.Name});var n=Object(_t.b)(),i=null;Object(ae.a)()&&(i=Object(fe.a)(e?Object(ae.a)().Designer_DefaultQuizTitle:Object(ae.a)().Designer_DefaultFormTitle,Object(ae.a)().Designer_Title_autoRenameFormat,Wt.a.convertToArray(n.Model.FormList).map((function(t){return t.Model.Title}))));var r=!!n.Model.FormsTenantSettings&&!n.Model.FormsTenantSettings.recordIdentityByDefault,o={IsQuizMode:e,RequiresUniqueResponse:e&&!Object(u.a)().userInfo.IsMsa,IsAnonymous:Object(u.a)().userInfo.IsMsa,NotRecordIdentity:r};return e&&(o.ShowGradedResults=!0,o.ManualGradingEnabled=!1),{Title:i,Settings:o}}var Bf=n(127),_f=n(181),Hf=n(183);var Gf=function(t){function e(e){var n=t.call(this,e)||this;return n.A_="#008272",n.state={IsRefreshing:!1},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){Object(g.b)("ResponsePage.PollResultView.Navigate")},n.componentDidUpdate=function(){var t=Ln.findDOMNode(this.refs["vote-detail"]);t&&t.focus()},n.render=function(){var t=this,e=Object(yn.a)({HTMLAttributes:{className:"poll-top-view-back-button light-background-button",onClick:function(){return t.props.submitAnother()}},Icon:"Back",IconClassName:"poll-top-view-back-icon forms-icon-size16x16",Text:Object(ae.a)().Common_Back_Text,TextClassName:"poll-top-view-back-text"});return oe.createElement("div",{className:"office-poll-result-container"},oe.createElement("div",{className:"office-poll office-form office-form-theme-shadow office-poll-info-container",role:"main"},oe.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"},e),oe.createElement("div",{className:"poll-result-container office-form-padding-align"},this.R_(),this.E_(),oe.createElement("div",{className:"office-form-info-other"},this.B_()))),oe.createElement(Hf.a,{TopExtraContent:this.__()}))},n.R_=function(){var t=this.props.Form;return oe.createElement("div",{className:"office-form-question-title"},t.Model.Questions[0]&&t.Model.Questions[0].Title)},n.E_=function(){var t=this,e=this.props.Form,n=e.Model.Questions[0].ChoiceType===te.a.MultiChoice,i=e.Model.Questions[0].AllowOtherAnswer,r=Et.map(e.Model.Questions[0].Choices,(function(t){return{option:t.Description,voteCount:0,names:[],voted:!1}}));i&&r.push({option:"Other",voteCount:0,names:[],otherOptions:[],voted:!1}),Et.each(e.Model.Responses,(function(t){var e=t.Answers,o=[];n?Et.each(Object(et.G)(e[0].Answer),(function(t){return o.push(t)})):o.push(e[0].Answer);var s=t.ResponderName||t.Responder||Object(ae.a)().Response_Poll_Result_Anonymous;s&&Et.each(o,(function(t){var e=Et.findIndex(r,(function(e){return e.option===t}));i&&-1===e&&(e=r.length-1),-1!==e&&(r[e].voteCount+=1,r[e].names.push(s),"otherOptions"in r[e]&&r[e].otherOptions.push(t),s===Object(u.a)().userInfo.Email&&(r[e].voted=!0))}))})),r.sort((function(t,e){return e.voteCount-t.voteCount}));var o=Et.first(r).voteCount,s=r.map((function(e,n){var i=e.voteCount||0,r=0===o?0:80*i/o,s=String(r)+"%",a=String(100-r)+"%",c=oe.createElement("span",{className:"office-poll-vote-count-container"},oe.createElement("span",{className:"poll-result-vote-count"},Object(ae.a)().Response_Poll_Result_VoteCount.format(i))),u=oe.createElement("div",{className:"poll-result-progressbar-container"},oe.createElement("div",{className:"poll-result-progressbar-cell",style:{width:s}},oe.createElement("a",{className:"poll-result-progressbar",style:{backgroundColor:t.A_}})),oe.createElement("div",{className:"poll-result-progressbar-cell",style:{width:a}},oe.createElement("a",{className:"poll-result-progressbar"})));return oe.createElement("div",{className:"poll-result-option-container",key:e.option},oe.createElement("div",null,e.option,e.voted?oe.createElement("span",{className:"poll-result-voted"},Object(ae.a)().Response_Poll_Voted):void 0,c),u)}));return oe.createElement("div",{className:"poll-result-options-container"},s)},n.B_=function(){var t=this;return oe.createElement("div",{className:"poll-result-refresh-link"},oe.createElement("a",{className:"office-form-info-reload office-form-info-children",href:"javascript:void(0)",onClick:function(){var e=t.props.Form;t.setState({IsRefreshing:!0}),Promise.all([e.ensureFieldsReady([Zt.a.Schema.Questions,Zt.a.Schema.DescriptiveElements,Zt.a.Schema.Responses]),e.syncRuntimeResponses()]).then((function(){t.setState({IsRefreshing:!1})}))}},Object(ae.a)().Response_Poll_Result_Refresh),this.vf())},n.__=function(){var t=this;if(!Object(je.f)()){var e={className:"office-form-info-premotion office-form-info-children",href:"DesignPage.aspx",onClick:function(){return t.props.beforePromotion&&t.props.beforePromotion(),!0}};return(Object(et.v)()||Object(et.w)()||Object(Z.b)())&&(e.href="javascript:void(0)",e.onClick=function(){t.props.beforePromotion&&t.props.beforePromotion();var e=Object(et.i)(),n=Object(Z.b)()?"../Pages/DesignPage.aspx":"../Pages/DesignPage.aspx?"+jQuery.param(e);return Object(Rn.a)(Object(f.a)(n)),!0}),oe.createElement("div",null,oe.createElement("a",e,Object(ae.a)().Renderer_PromotionMessage))}},n.vf=function(){if(this.state.IsRefreshing)return oe.createElement("div",{className:"poll-submit-spinner"},oe.createElement("div",{className:"spinner-tile-animation"}))},e}(ue.a);var qf=function(t){function e(e){var n=t.call(this,e)||this;return n.H_=function(){return n.eh()},n.state={IsSmallScreen:$(window).width()<768,SubmitState:"DetailResult"===Object(d.d)().view?3:0,ShowErrorPage:!1,ResponderEmail:Object(u.a)().userInfo.Email},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentWillMount=function(){this.er=new ol.a(this.props.Master),this.Wh(),window.addEventListener("resize",this.H_)},n.componentWillUnmount=function(){window.removeEventListener("resize",this.H_)},n.render=function(){var t,e=this;if(this.state.ShowErrorPage)return Object(yi.a)({Error:this.G_,FormId:this.props.Master.Model.Id,ShowCreateFormLink:!1});var n,i={className:"office-poll office-form-content office-form-page-padding"};if((this.props.ViewMode===jn.a.Mobile||this.state.IsSmallScreen)&&(i.className=Object(pn.b)(i.className,"small-screen")),this.wc()&&(i.className=Object(pn.b)(i.className,"mobile-view")),3===this.state.SubmitState){var r=void 0;this.props.Master.Model.Settings.RequiresUniqueResponse||(r=function(){return e.xh()}),n={ShowPromotionMessage:!0,submitAnother:r,beforePromotion:function(){Object(g.b)("ResponsePage.PollResultView.NavigateToPortal")},Form:this.props.Master},t=oe.createElement(Gf,n)}else t=oe.createElement("div",null,oe.createElement("div",{"aria-label":this.props.Master.Model.Title,className:"office-form office-form-theme-shadow",role:"form"},this.He(),oe.createElement("div",{className:"office-form-body"},this.Dh(),oe.createElement("div",null,this.Zh()),this.q_(),this.bf(),this.Q_(),this.Eh(),this.Bh())),oe.createElement(Hf.a,{FormMaster:this.props.Master,FooterType:"ShowStatementWithNotice",FooterText:!1}));return oe.createElement("div",{className:"form-content-container"},oe.createElement("div",i,oe.createElement(es.a,{ThemeMaster:this.props.Master.ThemeMaster}),t))},n.Dh=function(){return oe.createElement("div",{className:"office-form-notice-container"},this.Yh(),this.tf())},n.Yh=function(){var t=this.props.Master.Model.Settings;if(!t.IsAnonymous&&!t.NotRecordIdentity){var e=Object(u.a)().userInfo.GivenName;return oe.createElement("div",{},oe.createElement("span",{className:"office-form-notice-long-text"},Object(ae.a)().Response_NonAnonymous_Notice.format(e)))}},n.tf=function(){return Et.some(this.props.Master.Model.Questions,(function(t){return t.Required}))?oe.createElement("div",null,oe.createElement("span",{className:"office-form-required-notice-star"}),oe.createElement("span",null,Object(ae.a)().Answer_Required_Notice)):void 0},n.Eh=function(){var t=this.er.getQuestionsWithWrongAnswer(this.er.TopQuestionRuntimeMasters()),e=t.map((function(t){return Object(ae.a)().Form_QuestionWithOrdinal.format(t)})).join(Object(ae.a)().Common_ItemSeperator),n=Object(ae.a)().Form_Question_Error_Message.format(t.length,e),i=Object(Un.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),r=!!this.state.ShowValidationStyle&&!!t.length;return oe.createElement("div",{className:Object(pn.b)("office-form-submit-error",r?"":"NotVisible"),role:"alert"},i,oe.createElement("span",{className:"error-message"},r?n:""))},n.He=function(){return oe.createElement("div",{className:"office-poll-title-container office-form-theme-primary-background"})},n.Zh=function(){var t=this,e=this.state.ShowValidationStyle;return Wt.a.convertToArray(this.er.Model.QuestionRuntimeMasters).map((function(n,i){var r=n.Question.Model.Id,o={Master:n,LocalizedStrings:Object(ae.a)(),Ordinal:i+1,Disabled:!1,ExpandAll:!0,key:r,IsMobile:t.wc(),ShowValidationStyle:e,ShowQuizResult:!1,HideMedia:!1,IsStudentViewMode:!1};return Object(ts.a)(o)}))},n.Bh=function(){var t=Object(Un.b)({HTMLAttributes:{className:"office-form-alert-icon forms-icon-size24x24"},IconName:"IncidentTriangle"}),e=2===this.state.SubmitState;return oe.createElement("div",{className:Object(pn.b)("office-form-submit-error",e?"":"NotVisible"),role:"alert"},t,oe.createElement("span",{className:"error-message"},e?this.state.ErrorMessage:""))},n.q_=function(){var t=this;return oe.createElement("div",{className:"design-question-choice-label"},oe.createElement("div",{className:"poll-email-label"},Object(ae.a)().Response_Poll_Email_Label,oe.createElement("span",{className:"required-star"})),Object(ar.b)({Value:this.state.ResponderEmail,AutoSelection:!0,Placeholder:Object(ae.a)().Response_Poll_Email_Placeholder,HTMLAttributes:{className:"inline-display poll-email-textbox"},onValueChange:function(e){var n=!e||!e.trim();t.setState({ResponderEmail:e,ShowValidationStyle:n})}}),this.state.ShowValidationStyle?oe.createElement("div",{className:"poll-email-validation-error"},Object(xr.a)({HTMLAttributes:{className:"validation-error-message-label",role:"alert"},Label:Object(ae.a)().Response_Poll_Email_ValidationError,Alert:!0})):void 0)},n.Q_=function(){var t=this;return oe.createElement("span",{className:"poll-view-result-link"},oe.createElement("a",{className:"office-form-info-premotion office-form-info-children",href:"javascript:void(0)",onClick:function(){t.setState({SubmitState:1});var e=t.props.Master;Promise.all([e.ensureFieldsReady([Zt.a.Schema.Questions,Zt.a.Schema.DescriptiveElements,Zt.a.Schema.Responses]),e.syncRuntimeResponses()]).then((function(){t.setState({SubmitState:3})}))}},Object(ae.a)().Response_Poll_ViewResult),this.vf())},n.bf=function(){var t=this,e=1===this.state.SubmitState;return oe.createElement("div",{className:"office-form-bottom-button-div"},Object(Gi.b)({HTMLAttributes:{className:"office-poll-submit-button office-form-theme-primary-background",disabled:e,onClick:function(){t.V_();var e=t.props.Master.Model,n=t.er.Answers?Wt.a.convertToArray(t.er.Answers):[];Object(g.b)("ResponsePage.Form.Submit",{isPoll:!0,allQuestionCount:e.Questions.length,allAnswersLength:Et.reduce(n,(function(t,e){return t+(e&&e.Answer?JSON.stringify(e.Answer).length:0)}),0)})}},ButtonStyle:"LightBackground",Text:Object(ae.a)().Response_Poll_VoteButtonText}))},n.vf=function(){if(1===this.state.SubmitState)return oe.createElement("div",{className:"poll-submit-spinner"},oe.createElement("div",{className:"spinner-tile-animation"}))},n.z_=function(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t)},n.V_=function(){var t=this;if(this.er.getQuestionsWithWrongAnswer(this.er.TopQuestionRuntimeMasters()).length>0)this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError);else if(this.state.ResponderEmail&&this.state.ResponderEmail.trim()&&this.z_(this.state.ResponderEmail.trim())){this.setState({SubmitState:1});var n={StartDate:this.Cn,SubmitDate:new Date,Answers:this.er.Answers,Responder:this.state.ResponderEmail,ResponderName:this.state.ResponderEmail},i=this.props.Master;i.submitResponse(n).then((function(e){Promise.all([i.ensureFieldsReady([Zt.a.Schema.Questions,Zt.a.Schema.DescriptiveElements,Zt.a.Schema.Responses]),i.syncRuntimeResponses()]).then((function(){t.setState({SubmitState:3,ErrorMessage:void 0})}))})).catch((function(e){var n=Object(ae.a)(),i="";if(e.innerCode){if(i=Object(Ue.a)(""+e.innerCode)||n.Error_Inline_DefaultMessage,5e3===e.innerCode){var r;r=e.customizedMessage,i=n.Error_Message_5000_title.format(r)}10001===e.innerCode&&(i=n.Error_Inline_RefreshMessage),631!==e.innerCode&&6503!==e.innerCode||(i=n.Error_Inline_DelayTryMessage)}t.setState({SubmitState:2,ErrorMessage:i}),5e3===e.innerCode&&(i=Object(ae.a)().Error_Message_FormClosed),Object(g.b)(Object(Ft.a)(e)?"Error.InlineError.ShowAtSubmitResponse.Expected":"Error.InlineError.ShowAtSubmitResponse.Unexpected",{Error:Object(Ft.c)(e),ErrorMessage:i||void 0},e&&e.correlationId)}))}else this.setState({ShowValidationStyle:!0},e.scrollToShowSubmitError)},n.xh=function(){Object(g.b)("ResponsePage.PollResultView.SubmitAnother"),this.Wh(),this.er.updateWithResponse(null),this.setState({ErrorMessage:void 0,ShowValidationStyle:!1,SubmitState:0},e.scrollToTop)},n.Wh=function(t){this.Cn=new Date,this.er.Answers=t||[]},n.wc=function(){switch(this.props.ViewMode){case jn.a.Desktop:return!1;case jn.a.Mobile:return!0;case jn.a.Auto:return Object(et.r)();default:throw Error("unknown view mode")}},n.eh=function(){$(window).width()<=768!==this.state.IsSmallScreen&&this.setState({IsSmallScreen:!this.state.IsSmallScreen})},e.scrollToTop=function(){Object(pn.j)($(".office-form-form-title"),$(".office-form-content"),void 0,void 0,!0)},e.scrollToShowSubmitError=function(){Object(pn.j)($(".office-form-submit-error"),$(".office-form-content"),void 0,20,!0)},e}(ue.a);var Qf=function(t){function e(e){var n=t.call(this,e)||this,i=Object(_t.b)().Model.Preview,r=i&&i.ViewModeIndex,o=Object(et.r)()?jn.a.Mobile:jn.a.Desktop;return n.state={FormLoaded:!1,ViewMode:null!=r?r:o},n}Object(S.__extends)(e,t);var n=e.prototype;return n.componentDidMount=function(){var t=this,e=this.props.Form;e&&e.ensureReadyToResponse().then((function(){if(void 0!==t.props.ResponseIndex)return e.syncFormResponses()})).then((function(){t.setState({FormLoaded:!0})})),h.a.Resolve("IBootEvent").raiseBootComplete()},n.render=function(){var t,e=this,n=Object(et.r)();return n||(t=Object(us.n)({onValueChange:function(t){e.setState({ViewMode:t});var n=Object(_t.b)(),i=n.Model.Preview;n.Model.Preview={PreviousTopView:i&&i.PreviousTopView||"None",ResponseIndex:i&&i.ResponseIndex,ViewModeIndex:t}},Value:this.state.ViewMode})),oe.createElement("div",this.getContainerProps(),this.createHeader(t),this.U_(n))},n.onBackButtonClick=function(){var t=Object(_t.b)(),e=t.Model.Preview;t.bulkEdit((function(){t.Model.TopView=e&&e.PreviousTopView||"None",t.Model.Preview=void 0}));var n=$("body").attr("dir");n=n&&n.toLowerCase();var i=$(".form-content").attr("dir");i=i&&i.toLowerCase(),"ltr"===n&&"rtl"===i?Object(_f.a)(Bf.a.DesignPage):"rtl"===n&&"ltr"===i&&Object(_f.a)(Bf.a.DesignPageRtl)},n.U_=function(t){if(!this.state.FormLoaded)return Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text});var e=this.props.Form;e||Object(g.b)("formMaster.isnull.previewcontainer");var n,i,r=e.Model.Responses[this.props.ResponseIndex],o=void 0!==this.props.ResponseIndex,s={DisableSubmitButton:Object(Oo.d)(this.props.Form.Model.ReputationTier),HeaderMessage:o&&Object(ae.a)().PreviewStudentFeedbackView_StudentName_Label.format(Object(Bl.d)(r).name),HideSubmitAnotherResponseLink:o,HTMLAttributes:{className:"preview-form"},Master:e,Response:o?r:void 0,ViewMode:this.state.ViewMode,PhishingReviewUXFactory:null};Object(Ri.a)(this.props.Form,"ResponsePage.PollView")?(i=s,n=oe.createElement(qf,i)):n=Object(ki.b)(s);var a={className:"top-view-content"},c={className:"form-content"};return this.state.ViewMode!==jn.a.Mobile||t?a.className=Object(pn.b)(a.className,"office-form-theme-page-background"):c.className=Object(pn.b)(c.className,"preview-mobile-container","office-form-theme-page-background"),oe.createElement("div",Object(S.__assign)({},a),oe.createElement("div",Object(S.__assign)({},c),n))},n.W_=function(t){0},n.K_=function(){this.setState({FormLoaded:!0,ShowErrorPage:!0})},e}(Uu),Vf=function(t){function e(e){var n=t.call(this,e)||this;return n.J_=new me.a.CallbackManager,n.vl=Object(_t.b)().Model,n.N=new Ci.a,n.state=n.getDefaultState(),n.X_=function(t){return n.Z_(t)},n.Y_=n.Y_.bind(n),n.tH=n.tH.bind(n),window.FormPrefetchCache&&Object(Ti.c)().then((function(t){3===t&&(Object(g.b)("ShowBlockingPageForCompromisedUser"),n.setState({ShowBlockingPageForCompromisedUser:!0}))})),n.eH(),n}Object(S.__extends)(e,t);var n=e.prototype;return e.onShellFlexPaneVisibilityChanged=function(t,e){t&&window.innerWidth>800?($("#content-root").addClass("shell-flexpane-on"),mo.a.setReservedWidthToRight(e.width)):($("#content-root").removeClass("shell-flexpane-on"),mo.a.setReservedWidthToRight(0))},n.getDefaultState=function(){var t=Object(_t.b)();return{ShowBlockingPageForCompromisedUser:!1,ShowPortalPage:!t.shouldShowDesignView(),CopySharedTemplate:"CopySharedTemplate"===t.Model.Action}},n.componentWillMount=function(){var t=Object(_t.b)();t.observe(this.X_,[t.Schema.CriticalError,t.Schema.FlexPane,t.Schema.FormId,t.Schema.FormMaster,t.Schema.FormList,t.Schema.FormListLoadState,t.Schema.SharedWithMeFormListLoadState,t.Schema.Store,t.Schema.TopView,t.Schema.SelectedPortalForm,t.Schema.ShowXLUnsyncedDialog])},n.componentWillUnmount=function(){Object(_t.b)().unobserve(this.X_),di(e.onShellFlexPaneVisibilityChanged)},n.render=function(){var t,e,n,i,r=this,o=Object(_t.b)();if(this.state.ShowBlockingPageForCompromisedUser)t=Object(xi.a)();else if(this.vl.CriticalError)t=Object(yi.a)({Error:this.vl.CriticalError,FormId:this.vl.FormId});else if(this.state.DuplicatingForm||this.state.CopySharedTemplate)t=Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text});else if(this.state.ShowPortalPage)switch(t=this.nH(),this.vl.TopView){case"RecycleBin":e=this.iH();break;case"MSATemplateGallery":e=this.rH();break;case"UserFeatureSettings":e=oe.createElement(Bh)}else if(this.vl.FormMaster){switch(n=o.Model.FormMaster,Object(Y.c)("ProgressBarNew")&&n&&n.ensureReadyToDesign().then((function(){var t=n.FormElementManager.SectionMasters,e=n.FormElementManager.AllElementMasters;(null==t?void 0:t.length)&&(null==e?void 0:e.length)&&"Question.ColumnGroup"!==e[0].Model.Type&&ko(n,!0,"NotASection")})),this.vl.TopView){case"Preview":i={Form:n,key:"preview-"+n.getInstanceId(),ResponseIndex:this.vl.Preview?this.vl.Preview.ResponseIndex:void 0},e=oe.createElement(Qf,Object(S.__assign)({},i));break;case"Branch":e=oe.createElement(Xu,{Form:n,key:"branch-"+n.getInstanceId()});break;case"MultiLingualEditionView":e=oe.createElement(Sl,{Form:n});break;default:e=Lh(o.Model)}t=function(t){return oe.createElement(zu,t)}({FormMaster:n,key:"content-"+n.getInstanceId(),TopView:!!e})}else o.shouldShowDesignView()?t=Object(Ai.a)({Message:Object(ae.a)().Common_Loading_Text}):"Loaded"===this.vl.FormListLoadState&&(t=this.nH());var s=this.vl.FlexPane,a="page-container",c=gi();c&&($("#content-root").addClass("suiteheader"),this.state.ShowPortalPage&&(a=Object(pn.b)(a,"portal")));var u,l={className:a,role:"main",onClick:function(t){s===r.vl.FlexPane&&Object(_t.b)().collapseFlexPaneIfNeeded(t.target),r.J_.trigger(t)},onKeyDown:function(t){r.J_.trigger(t)},onScroll:function(t){r.J_.trigger(t)}};c&&this.state.ShowPortalPage||(u=function(t){return oe.createElement(tf,Object(S.__assign)({},t))}({AppLauncherCollapseTrigger:this.J_,ShouldDisabled:"None"!==this.vl.TopView&&"RecycleBin"!==this.vl.TopView&&"MSATemplateGallery"!==this.vl.TopView&&"UserFeatureSettings"!==this.vl.TopView,SetPrintViewState:this.tH})),n=Object(_t.b)().Model.FormMaster;var h,f=Object(_t.b)().Model.SelectedPortalForm,d={className:Object(pn.b)("design-body-container",Object(et.m)()?"edge":void 0,Object(et.o)()?"ie":void 0,Object(et.n)()?"firefox":void 0,Object(et.p)()?"ios-avoid-scroll":void 0),style:e?{display:"none"}:void 0},b=oe.createElement("div",Object(S.__assign)({},d),qu({Form:n,FlexPaneType:"Feedback"}),qu({changeFormOwnerHandler:function(t,e){return r.PP(t,e)},FlexPaneType:"MoveFormPane",Form:f}),t);if(Object(Y.c)("BaseProFRE")&&"ShowProFRE"===this.vl.TopView.toString()&&(bi(),h=oe.createElement(nl,{isProUser:!1})),this.state.ShowPrintView){var m=Object(_t.b)().Model.FormMaster;m||Object(g.b)("formMaster.isnull.designpagecontainer");var v=Object(ki.b)({Master:m,PrintView:!0,PhishingReviewUXFactory:null});return oe.createElement("div",{id:"print-time-content"},v)}return oe.createElement("div",Object(S.__assign)({},l),u,e,h,function(t){return oe.createElement(Zu,t)}(),oe.createElement(el,null),function(t){return oe.createElement(_h,Object(S.__assign)({},t))}({Message:Object(ae.a)().RetryRecoverableErrorMessage_Saving}),function(t){return oe.createElement(Yu,Object(S.__assign)({},t))}(),b,Object(_t.b)().Model.ShowXLUnsyncedDialog?oe.createElement(tl,{}):null)},n.tH=function(t,e){Object(_t.b)().Model.FormMaster&&this.setState({ShowPrintView:t},e)},n.PP=function(t,e){var n=Object(_t.b)();return n.bulkEdit((function(){n.Model.FlexPane="None",n.Model.SelectedPortalForm=null})),this.N.changeFormOwner(t,e)},n.eH=function(){var t=this,e=Object(O.c)(),n=e.getItem("FormCopy.LoginToAutoCopy"),i=e.getItem("FormCopy.FormModelToJSON");if(e.removeItem("FormCopy.GUID"),n&&e.removeItem("FormCopy.LoginToAutoCopy"),i){e.removeItem("FormCopy.FormModelToJSON");try{var r=JSON.parse(i);delete r.Id,delete r.ReputationTier,r.Settings&&(delete r.Settings.AllowCopy,delete r.Settings.ShareToken,delete r.Settings.FormClosed,delete r.Settings.StartTime,delete r.Settings.EndTime,delete r.Settings.TimerEnabledStart,delete r.Settings.TimerEnabledEnd,delete r.Settings.TimerEnabled),Object(st.j)()&&!Object(Ht.a)().Flighting.isEnabled("EnableOnlineExcelForMSA")&&delete r.XlWorkbookId,r.Title+=Object(ae.a)().Tile_For_Duplicate_Form;var o="GroupForms"===this.vl.FormCollectionType,s=this.N.createForm(r,o);this.N.designForm(s),s.ensureCreationDone().then((function(){t.setState({CopySharedTemplate:!1}),t.vl.Action="NoAction"}))}catch(t){Object(g.b)("PortalPage.MyForms.NewFromCopy.Failure:"+t)}}},n.nH=function(){var t,e=this;if(!Object(Y.c)("PortalPageRedirection"))return t={changeFormOwnerHandler:function(t){var e=Object(_t.b)();e.bulkEdit((function(){e.Model.SelectedPortalForm=t,e.Model.FlexPane="MoveFormPane"}))},createAndDesignFormHandler:function(t,n){return e.RM(t,n)},deleteFormHandler:this.N.deleteForm,designExistingFormHandler:this.N.designForm,duplicateAndDesignFormHandler:this.oH.bind(this),duplicateFormHandler:function(t,e){return Ci.a.duplicateForm(t,e)},focusOut:function(){},GroupMruDocumentManager:this.N.GroupMruDocumentManager,removeFromMRUHandler:this.N.removeFromMRU,softDeleteFormHandler:this.N.moveToRecycleBin},oe.createElement(Af,t);Object(g.b)("PortalPageUrl",{hash:window.location.hash,search:window.location.search});var n=function(){var t,e=window.OfficeFormServerInfo,n="";switch(e.environmentType){case"MSProd":case"WWProd":n="https://www.office.com/launch/forms";break;case"Int":case"MSInt":n="https://www.officeppe.com/launch/forms"}return n&&((null===(t=e.userInfo)||void 0===t?void 0:t.IsMsa)?n+="?auth=1":n+="?auth=2"),n}();Object(p.c)(n)},n.iH=function(){return Mi({deleteFormHandler:this.N.deleteForm,restoreFormHandler:this.N.restoreFromRecycleBin})},n.rH=function(){return Object(u.a)().userInfo.IsMsa&&oe.createElement(Fl,{backToPortalViewPageHandler:e.closeTopView,createFormCallback:this.Y_,viewTemplateHandler:this.N.designForm})},n.Y_=function(t){this.RM(Ef(t))},e.closeTopView=function(){Object(_t.b)().hideTopView(),Object(et.e)("UpdateMSATemplatePortalView")},n.RM=function(t,e){var n="GroupForms"===this.vl.FormCollectionType,i=this.N.createForm(t,n);this.N.designForm(i),e&&i.ensureCreationDone().then((function(){Object(g.b)("PortalPage.MyForms.NewFromCopy",{CopyCorrelationID:e,Time:(new Date).toUTCString()})}))},n.oH=function(t,e){var n=this;this.setState({DuplicatingForm:!0}),Ci.a.duplicateForm(t,e).then(this.N.designForm).then((function(){return n.setState({DuplicatingForm:!1})}),(function(){return n.setState({DuplicatingForm:!1})}))},n.Z_=function(t){var e=t.Master.Model,n=Object(_t.b)();if(Et.contains(t.FieldSchemas,n.Schema.FormId)&&!Et.contains(t.FieldSchemas,n.Schema.FormMaster)){var i=void 0;if(e.FormMaster&&!e.FormId||(i=Object(Ge.e)({Id:e.FormId},!1)),i!==e.FormMaster)return void(e.FormMaster=i)}if(Et.contains(t.FieldSchemas,n.Schema.ShowXLUnsyncedDialog))this.setState({ShowXLUnsyncedDialog:t.Master.Model.ShowXLUnsyncedDialog});else{var r,o={};o.ShowPortalPage=!n.shouldShowDesignView(),o.ShowPortalPage&&!this.state.ShowPortalPage&&(o=this.getDefaultState()),Et.contains(t.FieldSchemas,n.Schema.TopView)&&"None"===t.Master.Model.TopView&&(r=t.Master.resetTopViewCloseCallback()),this.setState(o,r)}},e}(ue.a);function zf(t){t.existingOnServerSide().catch((function(t){return Kf().CriticalError=t}));var e=t.Synchronizer;e.observe((function(n){Et.contains(n.FieldSchemas,e.Schema.UpdateError)&&$f(t.Deleted?"DeleteForm":"SaveForm",e.Model.UpdateError,t.getInstanceId())}),[e.Schema.UpdateError]),t.fieldsReady([Zt.a.Schema.Questions]).then((function(){t.FormElementManager.AllElementMasters.forEach((function(t){return Uf})),Wt.a.getCollectionMasterFromModel(t.Model.Questions).observe((function(t){t.AddedModels.map(te.h).forEach(Uf)}))})),t.fieldsReady([Zt.a.Schema.DescriptiveElements]).then((function(){t.FormElementManager.DescriptiveElementMasters.forEach((function(t){return Uf})),Wt.a.getCollectionMasterFromModel(t.Model.DescriptiveElements).observe((function(t){t.AddedModels.map(ke.c).forEach(Uf)}))}))}function Uf(t){var e=t,n=e.Synchronizer;n.observe((function(){e.Deleted||($f("CreateQuestion",n.Model.CreationError,e.getInstanceId()),e.observe((function(){e.Deleted&&$f("CreateQuestion",null,e.getInstanceId())})))}),[n.Schema.CreationError]),n.observe((function(t){Et.contains(t.FieldSchemas,n.Schema.UpdateError)&&$f(e.Deleted?"DeleteQuestion":"SaveQuestion",n.Model.UpdateError,e.getInstanceId())}),[n.Schema.UpdateError])}function $f(t,e,n){e?Object(Hn.d)(t,e,n):Object(Hn.a)(t,n)}var Wf=window.onerror;function Kf(){return Object(Y.c)("MobileCriticalErrorFix")?Object(zi.a)().Model:Object(_t.b)().Model}window.onerror=function(t,e,n,i,r){try{(function(t,e,n){"string"!=typeof e&&(e="");if(-1!==e.indexOf("mathquill")||e.toLowerCase().match(/officebrowserfeedback_floodgate\.min.js$/))return!1;if(t.match("jQuery.*is not a function.*"))return!1;if(!Object(M.f)())return!0;if(("Script error."===t||"Script error"===t)&&(e.match(/\/jsll-4\.js$/)||!e))return!1;if(function(t,e){if(!t&&!e)return!1;var n=[window.location.origin.toLowerCase()];Object(u.a)().isCdnEnabled&&n.push(Object(f.b)(Object(Tt.a)("CdnEndPoint")));if(e||t)for(var i=e?e.toLowerCase():"",r=t?t.toLowerCase():"",o=0;o<n.length;o++)if(-1!==r.indexOf(n[o])||-1!==i.indexOf(n[o]))return!1;return!0}(e,n&&n.stack))return Object(g.b)("Error.ErrorPage.ErrorOutOfOrigin",{message:t,fileName:e,origin:window.location.origin,stack:n&&n.stack}),!1;var i=Object(Tt.b)("IgnoredClientError_Prod");if(i&&i.indexOf(n&&n.message||t)>=0)return!1;if("SyntaxError"===t&&Object(et.m)()&&-1===e.indexOf(".js"))return!1;return!0})(t,e,r)&&(r||((r=new Error(t)).stack=e+":"+n+":"+i),window.setTimeout((function(){Kf().CriticalError||(Kf().CriticalError=r)})))}catch(t){}Wf&&Wf(t,e,n,i,r)};var Jf,Xf,Zf,Yf,td,ed=n(162),nd=function(t){function e(){var e=this,n=Object(_t.b)();(e=t.call(this,{defaultParameters:{Action:"NoAction",Analysis:!1,BranchingElementId:null,CopyFormId:null,DataIdeas:!1,FlexPane:"None",FormId:null,Grading:null,Host:null,Locale:null,MeetingInfo:null,Preview:null,Scenario:null,SectionElementId:null,SharingToken:null,Store:!1,Title:null,Token:null,TopView:"None",XlWorkbookId:null,SurveyReportId:null},keys:[n.Schema.Action,n.Schema.Analysis,n.Schema.BranchingElementId,n.Schema.CopyFormId,n.Schema.DataIdeas,n.Schema.FormId,n.Schema.FlexPane,n.Schema.Grading,n.Schema.Host,n.Schema.Locale,n.Schema.MeetingInfo,n.Schema.Preview,n.Schema.Scenario,n.Schema.SectionElementId,n.Schema.SharingToken,n.Schema.Store,n.Schema.Title,n.Schema.Token,n.Schema.TopView,n.Schema.XlWorkbookId,n.Schema.SurveyReportId],serializedFields:["Analysis","Grading","MeetingInfo","Preview"]})||this).readHashValues(),e.writeHashValues(!0);var i=e.Master.Schema;return $(window).on("hashchange",e.readHashValues.bind(e)),e.Master.observe((function(t){var n=Et.intersection(t.FieldSchemas,[i.Action,i.Title,i.XlWorkbookId]);e.writeHashValues(n.length>0)}),e.Keys),e}return Object(S.__extends)(e,t),e}(function(){function t(t){t=t||{},this.master=t.master||Object(zi.a)();var e=this.master.Schema;this.sH=t.defaultParameters||{Token:null},this.keys=t.keys||[e.Token],this.aH=t.serializedFields||[]}var e=t.prototype;return Object.defineProperty(e,"Master",{get:function(){return this.master},enumerable:!1,configurable:!0}),Object.defineProperty(e,"Keys",{get:function(){return this.keys},enumerable:!1,configurable:!0}),e.readHashValues=function(){var t=this.getHashFromCurrentUrl();this.master.setData(t,this.keys)},e.writeHashValues=function(t,e){var n=this,i=this.keys.map((function(t){return Wt.a.getFieldSchemaInfo(t).Name})),r=Et.pick(this.master.Model,i);if(!Et.isEqual(r,this.getHashFromCurrentUrl())){var o=i.filter((function(t){return!Et.isEqual(n.master.Model[t],n.sH[t])})).map((function(t){var e=n.master.Model[t];return Object(ed.b)(e)||(e=JSON.stringify(e)),t+"="+encodeURIComponent(e)})).join("&");if(t){var s=window.location.href.split("#")[0]+"#"+o;e?window.location.replace(s):Object(p.f)(s)}else window.location.hash=o}},e.getHashFromCurrentUrl=function(){var t=this,e=this.keys.map((function(t){return Wt.a.getFieldSchemaInfo(t).Name})),n=e.map((function(t){return t.toLowerCase()})),i=Et.clone(this.sH);return(window.location.hash||"").substring(1).split("&").forEach((function(r){var o=r.split("="),s=n.indexOf(o[0].trim().toLowerCase()),a=e[s];if(a){var c=decodeURIComponent(o[1]||"undefined").trim();Et.include(t.aH,a)&&(c=Object(et.G)(c)),i[a]=c}})),i},t}());function id(){dn("authEnd",Object(rt.b)());var t,e,n="OfficeDotCom"===(t=Object(d.d)()).origin&&(t.route||Object(st.j)())?{Action:t.Action||"Open",RawSearch:window.location.search.substring(1),Route:t.route,SessionId:t.sessionId}:void 0;Object(g.g)(n&&{StartPage:n}),e=Object(f.c)(window.location.href,["sessionId","Action"]),window.history.replaceState({},document.title,e),new nd,Object(d.d)().t&&Object(g.b)("DesignPage.Form.SharedFormByOwner"),Object(d.b)()[Z.c]&&Object(g.b)("DesignPage.Form.SharedOwnershipByOwner"),Object(Ge.h)(zf),Object(b.h)((function(){return cd().FormId})),Object(b.g)((function(){return Object(_t.b)().Model.FormMaster}));var i,r,o,s=Ni.a.getFormsTenantSettings();switch(cd().Action){case"Activate":case"Close":i="Close"===cd().Action,r=cd().FormId,o=Object(Ge.e)({Id:r},!1),Promise.all([o.ensureFieldsReady([Zt.a.Schema.Settings]),Object(ae.d)()]).then((function(){var t=o.Model.Settings;if(!t.FormClosed!=!i)return t.FormClosed=!!i,o.Synchronizer.flush()})).finally((function(){window.setTimeout((function(){rd(),Ci.a.triggerReadProcess(),ud(!1)}),3e3),window.close()}));break;case"Create":s.finally((function(){return sd("Form")}));break;case"CreateQuiz":s.finally((function(){return sd("Quiz")}));break;case"Delete":!function(){var t=cd().FormId,e=Object(Ge.e)({Id:t},!1),n=function(t){Object(at.d)(),Ln.render(Object(yi.a)({Error:{innerCode:t},ErrorType:"Information"}),document.getElementById("content-root"))};Promise.all([e.ensureFieldsReady([Zt.a.Schema.OwnerId]),Object(ae.d)()]).then((function(){(new Ci.a).deleteForm(e),n(10202),window.close()})).catch((function(){n(1001),window.close()}))}();break;case"NoAction":default:Ci.a.triggerReadProcess(),ud(!1)}}function rd(){var t=Object(_t.b)();t.bulkEdit((function(){var e=t.Model;e.Action="NoAction",e.Title=null,e.XlWorkbookId=void 0,e.MeetingInfo=null,e.Scenario=null}))}function od(t){Object(at.c)((function(){return Object(Ii.a)(t)}),at.f),Object(g.d)(t)}function sd(t){var e=Object(_t.b)(),n=e.Model;"ODC"===e.Model.Host&&(e.Model.ShowExcelSurveyIntroductionDialog=!0);var i,r,o=function(e,i){var r=i?pi.c:void 0,o=Ef(t),s=(new Ci.a).createForm(Object(S.__assign)(Object(S.__assign)({},o),{CreatedFromOneDrive:!!n.XlWorkbookId,OwnerId:e,Title:n.Title||void 0,XlWorkbookId:n.XlWorkbookId||r}),i);n.FormMaster=s,ad(s)};if((r=n.XlWorkbookId)&&(r.indexOf("/teams/")>=0||r.indexOf("/sites/")>=0))(i=n.XlWorkbookId,we.a.getInstance().createDataProvider().getGroupId(i).then((function(t){if(Object(ye.a)(t)){var e=new Error;throw e.name="TeamSiteNoGroupError",e}return t}))).then((function(t){o(t,!0),ud(!0)})).catch(od);else if(Object(Z.q)())o(Object(Z.f)(),!0),ud(!0);else if(Object(Y.c)("IntelligenceScenarioProcess")&&e.Model.MeetingInfo&&e.Model.Scenario)!function(){var t=Object(_t.b)().Model;return(e=t.MeetingInfo,new Promise((function(t,n){Object(kn.b)().then((function(n){n=function(t,e){var n=e;if(t&&t.Subject&&(n=n.replace(/\[organization all hands\]/g,t.Subject)),t&&t.Date){var i=Object(u.a)().cultureInfo.Name||"en-us",r=new Date(t.Date).toLocaleDateString(i);n=n.replace(/\[dateTime\]/g,r)}return JSON.parse(n)||{}}(e,JSON.stringify(n)),t(n)})).catch(n)}))).then((function(e){var n=e[t.Scenario];n&&n.Title&&n.Title.length>90&&(n.Title=n.Title.substring(0,87)+"...");var i=Et.clone(n),r=i.OtherInfo;i.OwnerId=Object(u.a)().userInfo.UserId,i.OwnerTenantId=Object(u.a)().userInfo.TenantId,i.Background.ResourceUrl=Object(f.a)(Object(On.b)(i.Background.ResourceUrl)),i.Logo.ResourceUrl=Object(f.a)(Object(On.b)(i.Logo.ResourceUrl)),i.MeetingId=t.MeetingInfo.Id;var o=Object(Ge.d)(i,"User",!1);o.Model.Background.IsPredefined=!0,o.Model.OtherInfo=r,t.FormMaster=o,ad(o)})).then((function(){ud(!0)})).catch(od);var e}();else{var s=Object(d.b)().GroupId;s?o(s,!0):o(Object(u.a)().userInfo.UserId,!1),ud(!0)}}function ad(t){var e=Object(_t.b)(),n=e.Model;t.existingOnServerSide().then((function(){e.bulkEdit((function(){t===n.FormMaster&&(n.FormId=t.Model.Id),e.Model.Host=void 0,rd()}))})).catch(od)}function cd(){return Object(_t.b)().Model}function ud(t){var e=Object(_t.b)();e.observe((function(){return Ci.a.triggerReadProcess()}),[e.Schema.FormId,e.Schema.FormCollectionType]);var n=Object(Oi.b)("getForms",function(){var t,e=Object(_t.b)();return e.observe((function n(){"Loaded"===e.Model.FormListLoadState&&(t(),e.unobserve(n))}),[e.Schema.FormListLoadState]),new Promise((function(e){t=e}))}());n.then((function(){dn("formApiFinished",Object(rt.b)())}));var i=Object(Oi.b)("scripts",Object(An.b)(["combined-design"]));i.then((function(){dn("otherJsLoaded",Object(rt.b)())}));var r=Object(Y.c)("FormsPro");if(gi()||r){var o=Object(Oi.b)("O365ShellBootstrap",Object(An.a)("O365ShellBootstrap"));$("#reactshellheader").addClass("suiteheader-placeholder"),o.then((function(){Object(g.b)("DesignPage.SuiteHeader.LoadBootstrap.Success"),ai(),fi(Vf.onShellFlexPaneVisibilityChanged)})).catch((function(){Object(g.b)("DesignPage.SuiteHeader.LoadBootstrap.Fail")}))}Object(ae.e)(Object(ae.b)());var s=Object(Oi.b)("strings",Object(ae.d)());s.then((function(){if(dn("resourceStringLoaded",Object(rt.b)()),t){var n=e.Model.FormMaster.Model,i=n.Settings.IsQuizMode;n.Title||(n.Title=i?Object(ae.a)().Designer_DefaultQuizTitle:Object(ae.a)().Designer_DefaultFormTitle)}})),Object(Si.a)();var a=Object(ji.a)().initialize();Object(wi.a)(Promise.all([i,s,a]),"GetDesignPageResources"),Promise.all([n,i,s,a]).then((function(){Object(Oi.a)(),Object(Ht.a)().RetryingRecoverableError=!1})),Object(st.g)().then((function(t){return!Object(Y.c)("ProRedirectInWeb")&&!cd().FormMaster&&Object(ni.a)(t)})).then((function(){var t=[i,s];Promise.all(t).then((function(){Object(at.d)(),Object(st.i)().then((function(t){var e,n,i;t&&(n="https://content.lifecycle."+("true"===Object(d.d)().dimePPE?"officeppe":"office")+".net/dime/v1/dime.js",(i="true"===Object(d.d)().dimePPE?Object(Tt.a)("DimeJsPPEUrl"):Object(Tt.a)("DimeJsProdUrl"))||(i=n),Object(pn.a)(i,e||Bn))})),Ln.render(oe.createElement(Object(at.c)((function(){return Vf}),at.f)),document.getElementById("content-root")),function(){if(!Object(et.h)("nps-value")){var t=Object(M.f)()?Object(v.v)()?5:100:2;0===Math.floor(Math.random()*t)&&Object(et.F)("nps-value","readytoshow",5184e6)}}(),Object(g.d)()}))}))}h.a.Register("IPageContext").UsingSingleton((function(){return new X(Jf)})),h.a.Register("IAWTEventProperties").UsingFactory((function(){return new AWTEventProperties})),h.a.Register("IFormsLogManager").UsingSingleton((function(){return new kt})),h.a.Register("IAWTLogger").UsingSingleton((function(){return new Ct(h.a.Resolve("IFormsLogManager"),Xf&&Xf()||Promise.resolve(),b.b)})),h.a.Register("ILogger").UsingSingleton((function(){return new Lt(h.a.Resolve("IAWTLogger"))})),Object(Ht.a)().Flighting.setFlights(Object(u.a)().flights),h.a.Register("IMixin").UsingSingleton((function(){return new nn})),h.a.Register("IFormApiMixin").UsingSingleton((function(){return new $t})),Zf=new rn,h.a.Register("IBootEvent").UsingSingleton((function(){return Zf})),Yf=Promise.resolve($),td=function(){return Yf},h.a.Register("IThirdPartyRateIt").UsingSingleton(td),h.a.Register("IThirdPartyLinkify").UsingSingleton(td),h.a.Register("IThirdPartyDateTimePicker").UsingSingleton(td),h.a.Register("ITemplateQuestions").UsingSingleton(Fn),h.a.Register("IIntelligenceQuestionSuggestion").UsingSingleton((function(){return new gn})),h.a.Register("ICustomerVoiceUxFactory").UsingSingleton((function(){return new Nn})),Object(g.b)("DesignPage.Referrer",{referrer:document.referrer&&Object(f.b)(document.referrer)}),Object(d.d)().nocdn&&Object(g.c)("DesignPage.CdnFallback"),Object(Mn.b)(.1),Object(Ht.a)().AuthContext.handleAuthForContentPage(!0).then((function(){Object(at.c)(id,at.f)})).catch((function(t){od(t)}))}]);