(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{370:function(e,t,n){"use strict";n.r(t),n.d(t,"UserInteractionSuggestionCardV2",(function(){return T}));var i=n(2),s=n(0),o=n(3),a=n(6),r=n(1),g=n(156),u=n(159),l=n(5),c=n(248),d=n(16),h=n(249),m=n(24),S=n(8),p=n(208),T=function(e){function t(t){var n,i,s=e.call(this,t)||this;s.defaultSuggestionCount=6,s.newQuestionSuggestionCount=3,s.expandSuggestionCard=s.expandSuggestionCard.bind(s),s.createAddAllButton=s.createAddAllButton.bind(s),s.createCloseButton=s.createCloseButton.bind(s),s.createDotLoading=s.createDotLoading.bind(s),s.createExpandButton=s.createExpandButton.bind(s),s.createMoreSuggestionsButton=s.createMoreSuggestionsButton.bind(s),s.createToast=s.createToast.bind(s),s.closeSuggestionCard=s.closeSuggestionCard.bind(s),s.closeToast=s.closeToast.bind(s),s.loadMoreSuggestion=s.loadMoreSuggestion.bind(s),s.onSuggestionChange=s.onSuggestionChange.bind(s),s.onLoadingStateChange=s.onLoadingStateChange.bind(s),s.update=s.update.bind(s),s.getHistorySuggestionTitle=s.getHistorySuggestionTitle.bind(s),s.changeGalleryDot=s.changeGalleryDot.bind(s),s.updateSelectedSuggestion=s.updateSelectedSuggestion.bind(s),s.onInsertQuestions=s.onInsertQuestions.bind(s),s.intelligenceSuggestionsMaster=Object(u.a)(s.props.Form),s.intelligenceSuggestionsMaster.registerTargetElement(s.props.InsertAfter),(null===(n=s.intelligenceSuggestionsMaster.RemainingQuestionSuggestions)||void 0===n?void 0:n.length)?i=o.clone(s.intelligenceSuggestionsMaster.RemainingQuestionSuggestions):(s.intelligenceSuggestionsMaster.MaxSuggestionCount=s.defaultSuggestionCount,i=s.getQuestionSuggestions(s.defaultSuggestionCount));var a=s.getHistorySuggestions();return s.intelligenceSuggestionsMaster.RemainingQuestionSuggestions=[],s.state={ShowToast:!1,CurrentSuggestionType:a.length>0?"HistorySuggestion":"QuestionSuggestion",HistorySuggestions:a,QuestionSuggestions:i,SelectedIndex:[],ShowSuggestionCard:s.shouldPopUpSuggestion(),ShowSuggestionLoading:!1},s}Object(i.__extends)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.intelligenceSuggestionsMaster.observe(this.onSuggestionChange,[this.intelligenceSuggestionsMaster.Schema.SuggestionId]),this.intelligenceSuggestionsMaster.observe(this.onLoadingStateChange,[this.intelligenceSuggestionsMaster.Schema.IsLoading])},n.componentWillUnmount=function(){window.clearTimeout(this.showSpinnerTimer),window.clearTimeout(this.showToastTimer),this.intelligenceSuggestionsMaster.unobserve(this.onSuggestionChange),this.intelligenceSuggestionsMaster.unobserve(this.onLoadingStateChange),this.intelligenceSuggestionsMaster.unregisterTargetElement(this.props.InsertAfter),this.intelligenceSuggestionsMaster.RemoveCurrentSuggestion("TitleSuggestsQuestion")},n.update=function(){this.forceUpdate()},n.render=function(){if(this.state.QuestionSuggestions.length>0||this.state.HistorySuggestions.length>0){if(this.props.InsertPaneExpanded&&this.state.ShowSuggestionCard){return this.logQuestionSuggestionSeen(),this.intelligenceSuggestionsMaster.AddCurrentSuggestion("TitleSuggestsQuestion"),s.createElement("div",{className:"form-intelligence-container office-form-theme-focus-border office-form-theme-border-top",key:"formIntelligenceCardContainer",id:"form-intelligence-question-suggestion-card",tabIndex:-1},this.createHeader(),this.createQuestionGroup(),this.createMoreSuggestionsButton(),this.createGallery())}return this.intelligenceSuggestionsMaster.RemoveCurrentSuggestion("TitleSuggestsQuestion"),this.createExpandButton()}return null},n.createHeader=function(){var e="",t=this.createAddAllButton();"HistorySuggestion"===this.state.CurrentSuggestionType?e=Object(r.a)().Designer_Intelligence_History_Suggest_Relevant.format(this.getHistorySuggestionTitle()):"QuestionSuggestion"===this.state.CurrentSuggestionType&&(e=Object(r.a)().Intelligence_Question_Suggestion_Title);var n=s.createElement("div",{className:"question-suggestion-header-text-container"},s.createElement("i",{className:"ms-Icon forms-icon-size16x16 ms-Icon--LightningBolt"}),s.createElement("div",{className:"question-suggestion-header-text"},e));return s.createElement("div",{className:"question-suggestion-header-container"},n,s.createElement("div",{className:"question-suggestion-header-button-container"},s.createElement("div",{className:"form-intelligence-header-buttons"},t,this.createCloseButton())))},n.createAddAllButton=function(){var e=this.state.SelectedIndex.length>0?Object(r.a)().IntelligenceSuggestion_Add_With_Count.format(this.state.SelectedIndex.length):Object(r.a)().Designer_Intelligence_AddAll;return Object(m.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"question-suggestion-header-button-add-all",onClick:this.onInsertQuestions},Text:e})},n.createCloseButton=function(){return Object(d.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-close-button",onClick:this.closeSuggestionCard},Icon:"Cancel",IconClassName:"forms-icon-size14x14"})},n.createQuestionGroup=function(){var e=this,t=("HistorySuggestion"===this.state.CurrentSuggestionType?this.state.HistorySuggestions:this.state.QuestionSuggestions).map((function(t,n){return Object(g.f)({Index:n,key:t.QuestionTagForIntelligence,Question:t,Selected:e.state.SelectedIndex.indexOf(n)>=0,updateSelectedSuggestion:e.updateSelectedSuggestion})}));return s.createElement("div",{className:"form-intelligence-user-interaction-question-group",id:"intelligence-question-suggestion-group",key:"formIntelligenceGroup",role:"group"},t,this.state.ShowSuggestionLoading&&this.createDotLoading())},n.createMoreSuggestionsButton=function(){return"QuestionSuggestion"===this.state.CurrentSuggestionType&&this.hasNewQuestionSuggestions()?Object(m.b)({ButtonStyle:"LightBackground",HTMLAttributes:{className:"form-intelligence-question-suggestion-more",onClick:this.loadMoreSuggestion},Text:Object(r.a)().Intelligence_Question_Suggestion_More}):null},n.createDotLoading=function(){var e="";return e=this.hasNewQuestionSuggestions()?"form-intelligence-question-suggestion-loading-cover-with-more":this.intelligenceSuggestionsMaster.MaxSuggestionCount>=this.defaultSuggestionCount?"form-intelligence-question-suggestion-loading-cover":"form-intelligence-question-suggestion-loading",Object(c.a)({ClassName:e})},n.createToast=function(){var e=Object(r.a)().Intelligence_Question_Suggestion_Toast_Message,t={ClassName:"form-intelligence-question-suggestion-toast",closeToast:this.closeToast,Message:e,TimerInMs:3500,ToastStyle:"Dark"};return s.createElement(h.a,Object(i.__assign)({},t))},n.createExpandButton=function(){var e=this.props.InsertPaneExpanded?"form-intelligence-header-expand-button form-intelligence-header-expand-button-right":"form-intelligence-header-expand-button form-intelligence-header-expand-button-left",t=Object(d.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"form-intelligence-header-expand-button-icon",onClick:this.expandSuggestionCard},Icon:"LightningBolt",IconClassName:"forms-icon-size16x16"});return s.createElement("div",{className:e,onClick:this.expandSuggestionCard},t)},n.closeToast=function(){this.setState({ShowToast:!1})},n.closeSuggestionCard=function(){this.intelligenceSuggestionsMaster.AddDismissedSuggestion("TitleSuggestsQuestion"),this.setState({ShowSuggestionCard:!1})},n.expandSuggestionCard=function(){this.intelligenceSuggestionsMaster.AddCurrentSuggestion("TitleSuggestsQuestion"),this.setState({ShowSuggestionCard:!0}),this.props.expandInsertPane()},n.loadMoreSuggestion=function(){var e=this;window.clearTimeout(this.showSpinnerTimer),this.setState({ShowSuggestionLoading:!0},(function(){e.showSpinnerTimer=window.setTimeout((function(){e.intelligenceSuggestionsMaster.MaxSuggestionCount+=e.newQuestionSuggestionCount;var n=e.refreshQuestionSuggestions();e.setState({QuestionSuggestions:n,ShowSuggestionLoading:!1,ShowToast:!0},(function(){t.autoScrollDown()}))}),1e3)}))},n.onInsertQuestions=function(){var e,t,n=this,i=this.props.Form.FormElementManager,s=this.props.InsertAfter,a="HistorySuggestion"===this.state.CurrentSuggestionType?this.state.HistorySuggestions:this.state.QuestionSuggestions,r=[];if("HistorySuggestion"===this.state.CurrentSuggestionType?r=this.intelligenceSuggestionsMaster.getSuggestion("HistoryFormSuggestion").Suggestion.Result.Questions:"QuestionSuggestion"===this.state.CurrentSuggestionType&&(r=this.intelligenceSuggestionsMaster.SubQuestionCollection),this.state.SelectedIndex.length>0){var g=this.state.SelectedIndex;g.sort((function(e,t){return e-t})),t=g.map((function(e){return a[e]}))}else t=a;if(s||"Title"===s){t.reverse();var u="Title"===s?null:s;e=function(e,t){return i.insertElementAfter(e,u,t)}}else e=function(e,t){return i.appendElement(e,t)};var l=!1,c=null;t.forEach((function(t){var n;"Question.MatrixChoiceGroup"===(t=o.clone(t)).Type&&(n=r.filter((function(e){return e.GroupId===t.Id})).map((function(e){var t=o.clone(e);return delete t.Id,t}))),delete t.Id,!s||l?e(t,n):(c=e(t,n),l=!0)}));var d=[];"QuestionSuggestion"===this.state.CurrentSuggestionType&&(d=this.state.QuestionSuggestions.filter((function(e){return!t.find((function(t){return t.Title===e.Title||t.QuestionTagForIntelligence===e.QuestionTagForIntelligence}))})),this.intelligenceSuggestionsMaster.MaxSuggestionCount+=t.length*(this.newQuestionSuggestionCount-1),this.intelligenceSuggestionsMaster.RemainingQuestionSuggestions=d),this.logQuestionSuggestionKept(),this.setState({HistorySuggestions:[],SelectedIndex:[],QuestionSuggestions:d},(function(){n.props.designElement&&n.props.designElement(c),n.props.expandInsertPane()}))},n.onSuggestionChange=function(){var e=this.state.QuestionSuggestions.length,n=this.refreshQuestionSuggestions(),i="QuestionSuggestion"===this.state.CurrentSuggestionType&&n.length>e&&e>this.defaultSuggestionCount,s=this.getHistorySuggestions();this.setState({CurrentSuggestionType:s.length>0?"HistorySuggestion":"QuestionSuggestion",ShowSuggestionCard:this.shouldPopUpSuggestion(),HistorySuggestions:s,QuestionSuggestions:n,ShowToast:i},(function(){t.autoScrollDown()}))},n.onLoadingStateChange=function(){var e="QuestionSuggestion"===this.state.CurrentSuggestionType&&!1===this.state.ShowToast&&this.intelligenceSuggestionsMaster.Model.IsLoading;this.setState({ShowSuggestionLoading:e})},n.shouldPopUpSuggestion=function(){return this.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("TitleSuggestsQuestion")},n.getHistorySuggestions=function(){var e,t=[],n=null===(e=this.intelligenceSuggestionsMaster.getSuggestion("HistoryFormSuggestion"))||void 0===e?void 0:e.Suggestion;0===this.props.Form.Model.Questions.length&&n&&n.Result&&n.Result.Questions&&(t=a.a.convertToArray(n.Result.Questions).filter((function(e){return"Question.MatrixChoice"!==e.Type})));return null!=t?t:[]},n.getHistorySuggestionTitle=function(){var e,t="",n=null===(e=this.intelligenceSuggestionsMaster.getSuggestion("HistoryFormSuggestion"))||void 0===e?void 0:e.Suggestion;switch(n.SuggestionType||-1){case 2:case 1:t=n.Result.Title}return t},n.hasNewQuestionSuggestions=function(){return this.getQuestionSuggestions(this.intelligenceSuggestionsMaster.MaxSuggestionCount+this.newQuestionSuggestionCount).length>this.state.QuestionSuggestions.length},n.refreshQuestionSuggestions=function(){return this.getQuestionSuggestions(this.intelligenceSuggestionsMaster.MaxSuggestionCount)},n.getQuestionSuggestions=function(e){var t,n,i,s=null!==(n=null===(t=this.intelligenceSuggestionsMaster.getSuggestion("TitleSuggestsQuestion"))||void 0===t?void 0:t.Suggestion)&&void 0!==n?n:[];if(0===s.length)return[];var o=a.a.convertToArray(this.props.Form.Model.Questions),r=null!==(i=this.state.QuestionSuggestions)&&void 0!==i?i:[],g=s.filter((function(e){var t=!o.find((function(t){return t.Title===e.Title||t.QuestionTagForIntelligence===e.QuestionTagForIntelligence})),n=!r.find((function(t){return t.Title===e.Title||t.QuestionTagForIntelligence===e.QuestionTagForIntelligence}));return t&&n})),u=e-r.length,l=r.concat(g.slice(0,u));return null!=l?l:[]},n.createGallery=function(){if(this.state.HistorySuggestions.length>0&&this.state.QuestionSuggestions.length>0)return s.createElement("div",{className:"question-suggestion-card-gallery"},s.createElement("div",{className:"question-suggestion-card-gallery-dots-container"},s.createElement(p.a,{changeGalleryDot:this.changeGalleryDot,Index:0,key:0,Selected:"HistorySuggestion"===this.state.CurrentSuggestionType}),s.createElement(p.a,{changeGalleryDot:this.changeGalleryDot,Index:1,key:1,Selected:"QuestionSuggestion"===this.state.CurrentSuggestionType})))},n.changeGalleryDot=function(e){this.setState({SelectedIndex:[]}),0===e?this.setState({CurrentSuggestionType:"HistorySuggestion"}):1===e&&this.setState({CurrentSuggestionType:"QuestionSuggestion"})},n.updateSelectedSuggestion=function(e,t){var n=this.state.SelectedIndex,i=n.indexOf(e);i>=0&&t?n.splice(i,1):n.push(e),this.setState({SelectedIndex:n})},n.logQuestionSuggestionSeen=function(){var e,t;this.currentSuggestionId!==this.intelligenceSuggestionsMaster.Model.SuggestionId&&(Object(l.b)("IntelligenceStatistic.QuestionSuggestion.Seen",{ActionSubCategory:"Show",SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(l.b)("Intelligence.QuestionSuggestion.Seen",{ActionSubCategory:"Show",HasHistorySuggestion:(null===(e=this.state.HistorySuggestions)||void 0===e?void 0:e.length)>0,HasQuestionSuggestion:(null===(t=this.state.QuestionSuggestions)||void 0===t?void 0:t.length)>0}),this.currentSuggestionId=this.intelligenceSuggestionsMaster.Model.SuggestionId)},n.logQuestionSuggestionKept=function(){Object(l.b)("IntelligenceStatistic.QuestionSuggestion.Kept",{ActionSubCategory:"Choose",SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(l.b)("Intelligence.QuestionSuggestion.Kept",{ActionSubCategory:"Choose",IsHistorySuggestion:"HistorySuggestion"===this.state.CurrentSuggestionType})},t.autoScrollDown=function(){var e=document.getElementById("intelligence-question-suggestion-group");if(e&&e.scrollHeight>e.offsetHeight){var t=$("#intelligence-question-suggestion-group");t&&t.animate({scrollTop:e.scrollHeight},500)}},t}(S.a)},371:function(e,t,n){"use strict";n.r(t),n.d(t,"UserInteractionQuestionSuggestion",(function(){return l}));var i=n(2),s=n(0),o=n(1),a=n(9),r=n(18),g=n(24),u=n(8),l=function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseEnterQuestion=n.onMouseEnterQuestion.bind(n),n.onMouseLeaveQuestion=n.onMouseLeaveQuestion.bind(n),n.onClickAddQuestion=n.onClickAddQuestion.bind(n),n.state={IsHover:!1,WillUnmount:!1},n}Object(i.__extends)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){window.clearTimeout(this.disappearTimer)},n.render=function(){var e,t=this.props.Question,n=t.QuestionTagForIntelligence,u="forms-icon-size18x18";switch(t.Type){case"Question.Choice":e="RadioBtnOn",u="forms-icon-size16x16";break;case"Question.TextField":e="TextField",u="forms-icon-size20x20";break;case"Question.Rating":e="Like";break;case"Question.DateTime":e="Calendar";break;case"Question.Ranking":e="Sort";break;case"Question.MatrixChoiceGroup":e="ViewList";break;case"Question.NPS":e="AutoRacing",u="forms-icon-size20x20";break;case"Question.FileUpload":e="Upload";break;default:e="Add"}u=Object(a.b)(u,"form-intelligence-icon-black"),u=Object(a.b)(u,"form-intelligence-question-row-icon");var l={className:"form-intelligence-question-row",key:"formIntelligenceRow"+n,ref:"formIntelligenceRow"+n,tabIndex:0},c=s.createElement("p",{className:"form-intelligence-question-row-text"},t.Title),d="form-intelligence-question-row-container";this.state.WillUnmount&&(d="form-intelligence-question-row-container-hide form-intelligence-question-row-container-disappear");var h=Object(o.a)().Common_Add_Text,m=Object(r.b)({HTMLAttributes:{className:u},IconName:e}),S=Object(g.b)({Text:h,HTMLAttributes:{className:"form-intelligence-question-row-button",onClick:this.onClickAddQuestion}});return s.createElement("div",{className:d,key:"formIntelligenceRowContainer"+n,onMouseEnter:this.onMouseEnterQuestion,onMouseLeave:this.onMouseLeaveQuestion},s.createElement("div",Object(i.__assign)({},l),c,this.state.IsHover?S:m))},n.onMouseEnterQuestion=function(){this.setState({IsHover:!0})},n.onMouseLeaveQuestion=function(){this.setState({IsHover:!1})},n.onClickAddQuestion=function(){var e=this;this.setState({WillUnmount:!0}),this.disappearTimer=window.setTimeout((function(){e.props.addQuestion(e.props.Question,e.props.Index)}),300)},t}(u.a)},372:function(e,t,n){"use strict";n.r(t),n.d(t,"UserInteractionQuestionSuggestionV2",(function(){return r}));var i=n(2),s=n(0),o=n(9),a=n(18),r=function(e){function t(t){var n=e.call(this,t)||this;return n.onMouseEnterQuestion=n.onMouseEnterQuestion.bind(n),n.onMouseLeaveQuestion=n.onMouseLeaveQuestion.bind(n),n.onSelect=n.onSelect.bind(n),n.state={IsHover:!1,WillUnmount:!1},n}Object(i.__extends)(t,e);var n=t.prototype;return n.componentWillUnmount=function(){window.clearTimeout(this.disappearTimer)},n.render=function(){var e,t=this.props.Question,n=t.QuestionTagForIntelligence,r="form-intelligence-question-row",g="forms-icon-size18x18";if(this.props.Selected)r=Object(o.b)(r,"office-form-intelligence-theme-li"),g="office-form-theme-secondary-color",e="CheckMark";else switch(t.Type){case"Question.Choice":e="RadioBtnOn",g="forms-icon-size16x16";break;case"Question.TextField":e="TextField",g="forms-icon-size20x20";break;case"Question.Rating":e="Like";break;case"Question.DateTime":e="Calendar";break;case"Question.Ranking":e="Sort";break;case"Question.MatrixChoiceGroup":e="ViewList";break;case"Question.NPS":e="AutoRacing",g="forms-icon-size20x20";break;case"Question.FileUpload":e="Upload";break;default:e="Add"}g=Object(o.b)(g,"form-intelligence-icon-black"),g=Object(o.b)(g,"form-intelligence-question-row-icon");var u={className:r,key:"formIntelligenceRow"+n,onClick:this.onSelect,ref:"formIntelligenceRow"+n,tabIndex:0},l=s.createElement("p",{className:"form-intelligence-question-row-text"},t.Title),c="form-intelligence-question-row-container";this.state.WillUnmount&&(c="form-intelligence-question-row-container-hide form-intelligence-question-row-container-disappear");var d=Object(a.b)({HTMLAttributes:{className:g},IconName:e});return s.createElement("div",{className:c,key:"formIntelligenceRowContainer"+n,onMouseEnter:this.onMouseEnterQuestion,onMouseLeave:this.onMouseLeaveQuestion},s.createElement("div",Object(i.__assign)({},u),l,d))},n.onMouseEnterQuestion=function(){this.setState({IsHover:!0})},n.onMouseLeaveQuestion=function(){this.setState({IsHover:!1})},n.onSelect=function(){this.props.updateSelectedSuggestion(this.props.Index,this.props.Selected)},t}(n(8).a)},373:function(e,t,n){"use strict";n.r(t),n.d(t,"ShareAssistantCard",(function(){return p}));var i=n(2),s=n(0),o=n(12),a=n(1),r=n(9),g=n(174),u=n(159),l=n(5),c=n(18),d=n(16),h=n(128),m=n(24),S=n(61),p=function(e){function t(t){var n=e.call(this,t)||this;return n.responseTimeEstimationInterval=1e3,n.recommendResponseTime=5,n.regex=new RegExp(Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Description.format("(\\d)*")),n.shareAssistantRef=s.createRef(),n.predictResponseTime=n.predictResponseTime.bind(n),n.onClickInsertResponseTimeEstimationButton=n.onClickInsertResponseTimeEstimationButton.bind(n),n.onClickCloseResponseTimeEstimationButton=n.onClickCloseResponseTimeEstimationButton.bind(n),n.onClickBranchingCloseButton=n.onClickBranchingCloseButton.bind(n),n.onDismiss=n.onDismiss.bind(n),n.onClickExpandTip=n.onClickExpandTip.bind(n),n.onMouseEnterTip=n.onMouseEnterTip.bind(n),n.onMouseLeaveTip=n.onMouseLeaveTip.bind(n),n.onKeyUpCloseTip=n.onKeyUpCloseTip.bind(n),n.onKeyUpExpandTip=n.onKeyUpExpandTip.bind(n),n.onSuggestionChanged=n.onSuggestionChanged.bind(n),Object(o.c)("PersonalContextSuggestion")&&(n.intelligenceSuggestionsMaster=Object(u.a)(n.props.Form)),n.state={HasFocused:!1,HasReminded:!1,HasResponseTimePrediction:!1,IsAdded:n.regex.test(n.props.Form.Model.Description),IsCloseTip:!1,IsShowCard:!n.props.Form.Model.HasValidBranching,ResponseTimePrediction:0,ShowCloseButton:!1},n}Object(i.__extends)(t,e);var n=t.prototype;return n.componentWillMount=function(){var e=this,t=this.props.Form;Object(o.c)("PersonalContextSuggestion")?this.intelligenceSuggestionsMaster.observe(this.onSuggestionChanged,[this.intelligenceSuggestionsMaster.Schema.SuggestionId]):(t.observe(this.predictResponseTime,[t.Schema.Description,t.Schema.Questions,t.Schema.Title]),t.ensureReadyToDesign().then((function(){e.predictResponseTime()})))},n.componentDidUpdate=function(){var e=Object(o.c)("UserInterationSuggestionCard")&&$("#form-intelligence-question-suggestion-card").length;!this.shareAssistantRef.current||this.state.HasFocused||e?!this.shareAssistantRef.current&&this.state.HasFocused&&this.setState({HasFocused:!1}):(this.shareAssistantRef.current.focus(),this.setState({HasFocused:!0}))},n.componentWillUnmount=function(){window.clearTimeout(this.responseTimeEstimationTimeout),Object(o.c)("PersonalContextSuggestion")?this.intelligenceSuggestionsMaster.unobserve(this.onSuggestionChanged):this.props.Form.unobserve(this.predictResponseTime)},n.render=function(){return this.state.HasResponseTimePrediction&&!this.props.Form.SettingMaster.Model.IsQuizMode&&this.props.Form.Model.Questions.length>0&&this.state.ResponseTimePrediction>=3&&!this.state.IsCloseTip?(T("Intelligence.PredictResponseTime.Show","Seen"),this.state.IsShowCard&&!this.props.Form.Model.HasValidBranching?s.createElement("div",{className:"estimate-response-time-container"},this.createShareAssistantHeader(),this.createResponseTimeEstimationDescription(),this.createResponseTimeEstimationButton()):s.createElement("div",null,this.createEstimateResponseTimeTip())):null},n.createShareAssistantHeader=function(){var e=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Suggestion.format(this.state.ResponseTimePrediction),t=Object(r.i)(e);return s.createElement("div",{className:"estimate-response-time-estimation-container"},s.createElement(c.a,{HTMLAttributes:{className:"forms-icon-size12x12 estimate-response-time-estimation-icon"},IconName:"Clock"}),s.createElement(h.a,{Role:"Log",LazyRendering:!0},s.createElement("div",{className:"estimate-response-time-estimation-title",dangerouslySetInnerHTML:{__html:t}})))},n.createResponseTimeEstimationDescription=function(){if(!this.state.HasResponseTimePrediction)return null;var e=Object(a.a)().Share_Assistant_Card_Description_1;return this.state.ResponseTimePrediction>this.recommendResponseTime&&(e=this.state.IsAdded?Object(a.a)().Share_Assistant_Card_Description_3:Object(a.a)().Share_Assistant_Card_Description_2),s.createElement("div",{className:"estimate-response-time-description"},s.createElement(h.a,{Role:"Log",LazyRendering:!0},e))},n.createResponseTimeEstimationButton=function(){var e=this.state.IsAdded?Object(a.a)().Share_Assistant_Card_Button_Update:Object(a.a)().Share_Assistant_Card_Button_Add,t=Object(a.a)().Share_Assistant_Card_Button_Got_It,n={ButtonStyle:"None",HTMLAttributes:{className:"estimate-response-time-button-got-it",onClick:this.onDismiss,"aria-label":t},Text:t},o=this.state.IsAdded||this.state.ResponseTimePrediction<=this.recommendResponseTime?s.createElement(m.a,{ButtonStyle:"LightBackground",HTMLAttributes:{className:"estimate-response-time-button-add",onClick:this.onClickInsertResponseTimeEstimationButton,"aria-label":e},ref:this.shareAssistantRef,Text:e}):null;return s.createElement("div",{className:"estimate-response-time-button-container"},o,s.createElement(m.a,Object(i.__assign)({},n)))},n.createEstimateResponseTimeTip=function(){var e=this.props.Form.Model.HasValidBranching,t=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Tip_Minutes,n=Object(d.a)({ButtonStyle:"LightBackground",GlyphButtonStyle:"GlyphOnly",HTMLAttributes:{className:"estimate-response-time-button-close",onClick:this.onClickCloseResponseTimeEstimationButton,onKeyUp:this.onKeyUpCloseTip,onBlur:this.onMouseLeaveTip,"aria-label":Object(a.a)().Common_Close_Text},Icon:"ChromeClose",IconClassName:"forms-icon-size10x10"}),i=e?"estimate-response-time-tip-container-opacity":"estimate-response-time-tip-container";return s.createElement("div",{className:i,onMouseEnter:e?null:this.onMouseEnterTip,onMouseLeave:e?null:this.onMouseLeaveTip,tabIndex:-1},s.createElement("div",{className:"estimate-response-time-tip-number",onClick:e?null:this.onClickExpandTip,onFocus:e?null:this.onMouseEnterTip,onKeyUp:e?null:this.onKeyUpExpandTip,tabIndex:e?-1:0,"aria-hidden":e,role:"button","aria-expanded":e?null:"false","aria-label":e?null:this.state.ResponseTimePrediction+t},s.createElement("b",null,this.state.ResponseTimePrediction),t),this.state.ShowCloseButton&&!e&&s.createElement("div",{className:"estimate-response-time-tip-close"},n),e&&s.createElement("div",null,this.createBranchingTip()))},n.onClickCloseResponseTimeEstimationButton=function(){this.setState({IsCloseTip:!0}),T("Intelligence.PredictResponseTime.Close","Closed",!0)},n.onClickBranchingCloseButton=function(){this.setState({IsCloseTip:!0}),T("Intelligence.PredictResponseTime.BranchingClose","Closed",!0)},n.createBranchingTip=function(){var e=Object(a.a)().Share_Assistant_Card_Button_Got_It,t=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Branching_Tip_Title,n=this.state.IsAdded?Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Branching_Tip_Description_1:Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Branching_Tip_Description_2,o={ButtonStyle:"None",HTMLAttributes:{className:"estimate-response-time-branching-tip-button",onClick:this.onClickBranchingCloseButton,"aria-label":e},Text:e};return s.createElement("div",{className:"estimate-response-time-branching-tip-container"},s.createElement("div",{className:"estimate-response-time-branching-tip"},s.createElement("div",{className:"estimate-response-time-branching-tip-title","aria-live":"polite"},t),s.createElement("div",{className:"estimate-response-time-branching-tip-content"},n),s.createElement("div",{className:"estimate-response-time-branching-tip-button-container"},s.createElement(m.a,Object(i.__assign)({},o)))),s.createElement("div",{className:"estimate-response-time-branching-tip-arrow"}))},n.predictResponseTime=function(){var e=this;window.clearTimeout(this.responseTimeEstimationTimeout),this.setState({IsAdded:this.regex.test(this.props.Form.Model.Description)}),this.responseTimeEstimationTimeout=window.setTimeout((function(){S.a.predictResponseTime(e.props.Form).then((function(t){if(t){var n=Math.ceil(t.EstimatedTimeInSeconds/60);!e.state.HasReminded&&n>e.recommendResponseTime&&e.setState({HasReminded:!0,IsShowCard:!0}),e.setState({HasResponseTimePrediction:!0,ResponseTimePrediction:n})}}))}),this.responseTimeEstimationInterval)},n.onClickInsertResponseTimeEstimationButton=function(){var e=this,t=Object(a.a)().Designer_Intelligence_Share_Assistant_Card_Response_Time_Estimation_Description.format(this.state.ResponseTimePrediction);this.props.Form.Model.Description?this.regex.test(this.props.Form.Model.Description)?this.props.Form.Model.Description=this.props.Form.Model.Description.replace(this.regex,t):this.props.Form.Model.Description=t+"\n"+this.props.Form.Model.Description:this.props.Form.Model.Description=t,T(this.state.IsAdded?"Intelligence.PredictResponseTime.Update":"Intelligence.PredictResponseTime.Add","Clicked",!0);$("#body-scrollable-content").animate({scrollTop:0},300),this.setState({IsAdded:!0,IsShowCard:!1,ShowCloseButton:!1},(function(){Object(o.c)("PersonalContextSuggestion")&&e.intelligenceSuggestionsMaster.AddDismissedSuggestion("PredictResponseTime")}))},n.onDismiss=function(){var e=this;T("Intelligence.PredictResponseTime.GotIt","Clicked",!0),this.setState({IsShowCard:!1,ShowCloseButton:!1},(function(){Object(o.c)("PersonalContextSuggestion")&&e.intelligenceSuggestionsMaster.AddDismissedSuggestion("PredictResponseTime")}))},n.onClickExpandTip=function(){var e=this;this.setState({IsShowCard:!0},(function(){Object(o.c)("PersonalContextSuggestion")&&e.intelligenceSuggestionsMaster.AddCurrentSuggestion("PredictResponseTime")}))},n.onMouseEnterTip=function(){this.setState({ShowCloseButton:!0})},n.onMouseLeaveTip=function(){this.setState({ShowCloseButton:!1})},n.onKeyUpExpandTip=function(e){switch(e.keyCode){case 13:case 32:e.stopPropagation(),this.onClickExpandTip()}},n.onKeyUpCloseTip=function(e){switch(e.keyCode){case 13:case 32:e.preventDefault(),this.onClickCloseResponseTimeEstimationButton()}},n.onSuggestionChanged=function(){var e=this,t=this.intelligenceSuggestionsMaster.getSuggestion("PredictResponseTime"),n=this.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("PredictResponseTime");if(t){var i=t.Suggestion,s=Math.ceil(i.EstimatedTimeInSeconds/60);this.setState({HasResponseTimePrediction:!0,ResponseTimePrediction:s,IsShowCard:n},(function(){n&&e.intelligenceSuggestionsMaster.AddCurrentSuggestion("PredictResponseTime")}))}else this.setState({HasResponseTimePrediction:!1,IsShowCard:!1})},t}(n(8).a);function T(e,t,n){void 0===n&&(n=!1),Object(g.a)().initialize().then((function(i){Object(o.c)("EstimationTimeExp")&&i.EstimationTimeExperiment&&n&&Object(g.a)().track("EstimationTimeExperiment",t),Object(l.b)(e,{variation:i.EstimationTimeExperiment})}))}},374:function(e,t,n){"use strict";n.r(t),n.d(t,"ThemeSuggestionCard",(function(){return p}));var i=n(2),s=n(0),o=n(12),a=n(1),r=n(11),g=n(246),u=n(159),l=n(245),c=n(5),d=n(16),h=n(24),m=n(8),S=n(251),p=function(e){function t(t){var n=e.call(this,t)||this;n.mounted=!0,n.uxStateMaster=Object(r.b)(),n.expandThemeFlexPane=n.expandThemeFlexPane.bind(n),n.onSuggestionChange=n.onSuggestionChange.bind(n);var i=!1;return Object(o.c)("PersonalContextSuggestion")&&(n.intelligenceSuggestionsMaster=Object(u.a)(n.props.FormMaster),n.intelligenceSuggestionsMaster.observe(n.onSuggestionChange,[n.intelligenceSuggestionsMaster.Schema.SuggestionId]),i=n.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("TitleSuggestsTheme")),n.state={ShowThemeSuggestionCard:i,Suggestions:[]},n}Object(i.__extends)(t,e);var n=t.prototype;return n.componentDidMount=function(){this.onSuggestionChange()},n.componentWillUnmount=function(){this.mounted=!1,Object(o.c)("PersonalContextSuggestion")&&this.intelligenceSuggestionsMaster.unobserve(this.onSuggestionChange)},n.render=function(){return!this.state.ShowThemeSuggestionCard||!this.state.Suggestions||this.state.Suggestions.length<=0?null:(this.logSuggestionSeen(),s.createElement("div",{className:"theme-suggestion-card-container"},this.createCloseButton(),t.createThemeSuggestionDescription(),this.createThemeSuggestionGroup(),this.createThemeSuggestionExpandButton()))},n.createCloseButton=function(){var e=this,t=Object(a.a)().Common_Close_Text;return Object(d.a)({ButtonStyle:"LightBackground",HTMLAttributes:{"aria-label":t,className:"theme-suggestion-card-close-button",onClick:function(){e.logSuggestionEngage("close"),Object(l.a)(g.a[g.a.ThemeSuggestion],5,4,!0),e.setState({ShowThemeSuggestionCard:!1},(function(){e.intelligenceSuggestionsMaster.AddDismissedSuggestion("TitleSuggestsTheme")}))},title:t},Icon:"Cancel",IconClassName:"top-view-close-icon forms-icon-size16x16",ref:"close-button"})},t.createThemeSuggestionDescription=function(){var e=Object(a.a)().Designer_Intelligence_Theme_Card_Description;return s.createElement("div",{className:"theme-suggestion-card-description"},e)},n.createThemeSuggestionGroup=function(){var e=this;if(this.state.Suggestions&&this.state.Suggestions.length>0){var t=this.state.Suggestions.map((function(t,n){return s.createElement(S.a,{applyTheme:e.props.applyTheme,HTMLAttributes:{"aria-posinset":n+1,"aria-setsize":e.state.Suggestions.length},IsActive:e.props.FormMaster.ThemeMaster.Model.Name===t.Name,IsFromSuggestionCard:!0,IsQuiz:e.props.FormMaster.SettingMaster.Model.IsQuizMode,key:t.Name,Theme:t})}));return s.createElement("div",{className:"theme-suggestion-card-theme-group"},s.createElement("div",{className:"theme-suggestion-card-theme-item-large"},t[0]),s.createElement("div",{className:"theme-suggestion-card-theme-item"},t[1]),s.createElement("div",{className:"theme-suggestion-card-theme-item"},t[2]))}return null},n.createThemeSuggestionExpandButton=function(){var e=Object(a.a)().Designer_Intelligence_Theme_Card_Button_Text,t={ButtonStyle:"None",HTMLAttributes:{className:"theme-suggestion-card-expand-button",onClick:this.expandThemeFlexPane,"aria-label":e},Text:e};return s.createElement(h.a,Object(i.__assign)({},t))},n.expandThemeFlexPane=function(){var e=this;this.logSuggestionEngage("expand"),this.uxStateMaster.Model.FlexPane="Theme",this.setState({ShowThemeSuggestionCard:!1},(function(){e.intelligenceSuggestionsMaster.AddDismissedSuggestion("TitleSuggestsTheme")}))},n.onSuggestionChange=function(){var e=this;if(this.mounted){var t=this.intelligenceSuggestionsMaster.getSuggestion("TitleSuggestsTheme"),n=this.intelligenceSuggestionsMaster.ShouldPopUpSuggestion("TitleSuggestsTheme");t?this.setState({Suggestions:t.Suggestion,ShowThemeSuggestionCard:n},(function(){n&&e.intelligenceSuggestionsMaster.AddCurrentSuggestion("TitleSuggestsTheme")})):this.setState({Suggestions:[],ShowThemeSuggestionCard:!1})}},n.logSuggestionSeen=function(){this.currentSuggestionId!==this.intelligenceSuggestionsMaster.Model.SuggestionId&&(Object(c.b)("IntelligenceStatistic.ThemeSuggestionCard.Seen",{ActionSubCategory:"Show",SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(c.b)("Intelligence.ThemeSuggestionCard.Seen",{ActionSubCategory:"Show"}),this.currentSuggestionId=this.intelligenceSuggestionsMaster.Model.SuggestionId)},n.logSuggestionEngage=function(e){Object(c.b)("IntelligenceStatistic.ThemeSuggestionCard.Engage",{ActionSubCategory:e,SuggestionId:this.intelligenceSuggestionsMaster.Model.SuggestionId}),Object(c.b)("Intelligence.ThemeSuggestionCard.Engage",{ActionSubCategory:e})},t}(m.a)}}]);